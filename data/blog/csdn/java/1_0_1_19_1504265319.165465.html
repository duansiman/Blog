
        <div class="markdown_views"><p>记录spring boot出现的一些奇奇怪怪的问题解决方案.</p>

<h2 id="1文件上传临时文件夹无效问题">1.文件上传,临时文件夹无效问题</h2>

<p>异常信息:</p>



<pre class="prettyprint"><code class=" hljs avrasm">Caused by: java<span class="hljs-preprocessor">.io</span><span class="hljs-preprocessor">.IOException</span>: The temporary upload location [/tmp/tomcat<span class="hljs-number">.7986646121236549874</span><span class="hljs-number">.8090</span>/work/Tomcat/localhost/ROOT] is not valid
    at org<span class="hljs-preprocessor">.apache</span><span class="hljs-preprocessor">.catalina</span><span class="hljs-preprocessor">.connector</span><span class="hljs-preprocessor">.Request</span><span class="hljs-preprocessor">.parseParts</span>(Request<span class="hljs-preprocessor">.java</span>:<span class="hljs-number">2767</span>) ~[tomcat-embed-core-<span class="hljs-number">8.5</span><span class="hljs-number">.4</span><span class="hljs-preprocessor">.jar</span>!/:<span class="hljs-number">8.5</span><span class="hljs-number">.4</span>]
    at org<span class="hljs-preprocessor">.apache</span><span class="hljs-preprocessor">.catalina</span><span class="hljs-preprocessor">.connector</span><span class="hljs-preprocessor">.Request</span><span class="hljs-preprocessor">.parseParameters</span>(Request<span class="hljs-preprocessor">.java</span>:<span class="hljs-number">3167</span>) ~[tomcat-embed-core-<span class="hljs-number">8.5</span><span class="hljs-number">.4</span><span class="hljs-preprocessor">.jar</span>!/:<span class="hljs-number">8.5</span><span class="hljs-number">.4</span>]
    at org<span class="hljs-preprocessor">.apache</span><span class="hljs-preprocessor">.catalina</span><span class="hljs-preprocessor">.connector</span><span class="hljs-preprocessor">.Request</span><span class="hljs-preprocessor">.getParameter</span>(Request<span class="hljs-preprocessor">.java</span>:<span class="hljs-number">1109</span>) ~[tomcat-embed-core-<span class="hljs-number">8.5</span><span class="hljs-number">.4</span><span class="hljs-preprocessor">.jar</span>!/:<span class="hljs-number">8.5</span><span class="hljs-number">.4</span>]
    at org<span class="hljs-preprocessor">.apache</span><span class="hljs-preprocessor">.catalina</span><span class="hljs-preprocessor">.connector</span><span class="hljs-preprocessor">.RequestFacade</span><span class="hljs-preprocessor">.getParameter</span>(RequestFacade<span class="hljs-preprocessor">.java</span>:<span class="hljs-number">381</span>) ~[tomcat-embed-core-<span class="hljs-number">8.5</span><span class="hljs-number">.4</span><span class="hljs-preprocessor">.jar</span>!/:<span class="hljs-number">8.5</span><span class="hljs-number">.4</span>]
    at org<span class="hljs-preprocessor">.springframework</span><span class="hljs-preprocessor">.web</span><span class="hljs-preprocessor">.filter</span><span class="hljs-preprocessor">.HiddenHttpMethodFilter</span><span class="hljs-preprocessor">.doFilterInternal</span>(HiddenHttpMethodFilter<span class="hljs-preprocessor">.java</span>:<span class="hljs-number">70</span>) ~[spring-web-<span class="hljs-number">4.3</span><span class="hljs-number">.2</span><span class="hljs-preprocessor">.RELEASE</span><span class="hljs-preprocessor">.jar</span>!/:<span class="hljs-number">4.3</span><span class="hljs-number">.2</span><span class="hljs-preprocessor">.RELEASE</span>]
    at org<span class="hljs-preprocessor">.springframework</span><span class="hljs-preprocessor">.web</span><span class="hljs-preprocessor">.filter</span><span class="hljs-preprocessor">.OncePerRequestFilter</span><span class="hljs-preprocessor">.doFilter</span>(OncePerRequestFilter<span class="hljs-preprocessor">.java</span>:<span class="hljs-number">107</span>) ~[spring-web-<span class="hljs-number">4.3</span><span class="hljs-number">.2</span><span class="hljs-preprocessor">.RELEASE</span><span class="hljs-preprocessor">.jar</span>!/:<span class="hljs-number">4.3</span><span class="hljs-number">.2</span><span class="hljs-preprocessor">.RELEASE</span>]
    at org<span class="hljs-preprocessor">.apache</span><span class="hljs-preprocessor">.catalina</span><span class="hljs-preprocessor">.core</span><span class="hljs-preprocessor">.ApplicationFilterChain</span><span class="hljs-preprocessor">.internalDoFilter</span>(ApplicationFilterChain<span class="hljs-preprocessor">.java</span>:<span class="hljs-number">192</span>) ~[tomcat-embed-core-<span class="hljs-number">8.5</span><span class="hljs-number">.4</span><span class="hljs-preprocessor">.jar</span>!/:<span class="hljs-number">8.5</span><span class="hljs-number">.4</span>]
    at org<span class="hljs-preprocessor">.apache</span><span class="hljs-preprocessor">.catalina</span><span class="hljs-preprocessor">.core</span><span class="hljs-preprocessor">.ApplicationFilterChain</span><span class="hljs-preprocessor">.doFilter</span>(ApplicationFilterChain<span class="hljs-preprocessor">.java</span>:<span class="hljs-number">165</span>) ~[tomcat-embed-core-<span class="hljs-number">8.5</span><span class="hljs-number">.4</span><span class="hljs-preprocessor">.jar</span>!/:<span class="hljs-number">8.5</span><span class="hljs-number">.4</span>]
    at org<span class="hljs-preprocessor">.springframework</span><span class="hljs-preprocessor">.web</span><span class="hljs-preprocessor">.filter</span><span class="hljs-preprocessor">.CharacterEncodingFilter</span><span class="hljs-preprocessor">.doFilterInternal</span>(CharacterEncodingFilter<span class="hljs-preprocessor">.java</span>:<span class="hljs-number">197</span>) ~[spring-web-<span class="hljs-number">4.3</span><span class="hljs-number">.2</span><span class="hljs-preprocessor">.RELEASE</span><span class="hljs-preprocessor">.jar</span>!/:<span class="hljs-number">4.3</span><span class="hljs-number">.2</span><span class="hljs-preprocessor">.RELEASE</span>]
    at org<span class="hljs-preprocessor">.springframework</span><span class="hljs-preprocessor">.web</span><span class="hljs-preprocessor">.filter</span><span class="hljs-preprocessor">.OncePerRequestFilter</span><span class="hljs-preprocessor">.doFilter</span>(OncePerRequestFilter<span class="hljs-preprocessor">.java</span>:<span class="hljs-number">107</span>) ~[spring-web-<span class="hljs-number">4.3</span><span class="hljs-number">.2</span><span class="hljs-preprocessor">.RELEASE</span><span class="hljs-preprocessor">.jar</span>!/:<span class="hljs-number">4.3</span><span class="hljs-number">.2</span><span class="hljs-preprocessor">.RELEASE</span>]
    at org<span class="hljs-preprocessor">.apache</span><span class="hljs-preprocessor">.catalina</span><span class="hljs-preprocessor">.core</span><span class="hljs-preprocessor">.ApplicationFilterChain</span><span class="hljs-preprocessor">.internalDoFilter</span>(ApplicationFilterChain<span class="hljs-preprocessor">.java</span>:<span class="hljs-number">192</span>) ~[tomcat-embed-core-<span class="hljs-number">8.5</span><span class="hljs-number">.4</span><span class="hljs-preprocessor">.jar</span>!/:<span class="hljs-number">8.5</span><span class="hljs-number">.4</span>]
    at org<span class="hljs-preprocessor">.apache</span><span class="hljs-preprocessor">.catalina</span><span class="hljs-preprocessor">.core</span><span class="hljs-preprocessor">.ApplicationFilterChain</span><span class="hljs-preprocessor">.doFilter</span>(ApplicationFilterChain<span class="hljs-preprocessor">.java</span>:<span class="hljs-number">165</span>) ~[tomcat-embed-core-<span class="hljs-number">8.5</span><span class="hljs-number">.4</span><span class="hljs-preprocessor">.jar</span>!/:<span class="hljs-number">8.5</span><span class="hljs-number">.4</span>]
    at org<span class="hljs-preprocessor">.apache</span><span class="hljs-preprocessor">.catalina</span><span class="hljs-preprocessor">.core</span><span class="hljs-preprocessor">.StandardWrapperValve</span><span class="hljs-preprocessor">.invoke</span>(StandardWrapperValve<span class="hljs-preprocessor">.java</span>:<span class="hljs-number">198</span>) ~[tomcat-embed-core-<span class="hljs-number">8.5</span><span class="hljs-number">.4</span><span class="hljs-preprocessor">.jar</span>!/:<span class="hljs-number">8.5</span><span class="hljs-number">.4</span>]
    at org<span class="hljs-preprocessor">.apache</span><span class="hljs-preprocessor">.catalina</span><span class="hljs-preprocessor">.core</span><span class="hljs-preprocessor">.StandardContextValve</span><span class="hljs-preprocessor">.invoke</span>(StandardContextValve<span class="hljs-preprocessor">.java</span>:<span class="hljs-number">108</span>) ~[tomcat-embed-core-<span class="hljs-number">8.5</span><span class="hljs-number">.4</span><span class="hljs-preprocessor">.jar</span>!/:<span class="hljs-number">8.5</span><span class="hljs-number">.4</span>]
    at org<span class="hljs-preprocessor">.apache</span><span class="hljs-preprocessor">.catalina</span><span class="hljs-preprocessor">.authenticator</span><span class="hljs-preprocessor">.AuthenticatorBase</span><span class="hljs-preprocessor">.invoke</span>(AuthenticatorBase<span class="hljs-preprocessor">.java</span>:<span class="hljs-number">522</span>) ~[tomcat-embed-core-<span class="hljs-number">8.5</span><span class="hljs-number">.4</span><span class="hljs-preprocessor">.jar</span>!/:<span class="hljs-number">8.5</span><span class="hljs-number">.4</span>]
    at org<span class="hljs-preprocessor">.apache</span><span class="hljs-preprocessor">.catalina</span><span class="hljs-preprocessor">.core</span><span class="hljs-preprocessor">.StandardHostValve</span><span class="hljs-preprocessor">.invoke</span>(StandardHostValve<span class="hljs-preprocessor">.java</span>:<span class="hljs-number">140</span>) [tomcat-embed-core-<span class="hljs-number">8.5</span><span class="hljs-number">.4</span><span class="hljs-preprocessor">.jar</span>!/:<span class="hljs-number">8.5</span><span class="hljs-number">.4</span>]
    ... <span class="hljs-number">12</span> common frames omitted
</code></pre>

<p>原因:  <a href="http://blog.csdn.net/daniel7443/article/details/51620308">http://blog.csdn.net/daniel7443/article/details/51620308</a></p>

<p>解决方案:</p>

<p>注入一个Bean,手动配置临时目录</p>



<pre class="prettyprint"><code class=" hljs java"><span class="hljs-javadoc">/**
 * 文件上传临时路径
 */</span>
 <span class="hljs-annotation">@Bean</span>
 MultipartConfigElement multipartConfigElement() {
    MultipartConfigFactory factory = <span class="hljs-keyword">new</span> MultipartConfigFactory();
    factory.setLocation(<span class="hljs-string">"/app/pttms/tmp"</span>);
    <span class="hljs-keyword">return</span> factory.createMultipartConfig();
}
</code></pre></div>&#13;
        <script type="text/javascript">&#13;
            $(function () {&#13;
                $('pre.prettyprint code').each(function () {&#13;
                    var lines = $(this).text().split('\n').length;&#13;
                    var $numbering = $('&lt;ul/&gt;').addClass('pre-numbering').hide();&#13;
                    $(this).addClass('has-numbering').parent().append($numbering);&#13;
                    for (i = 1; i &lt;= lines; i++) {&#13;
                        $numbering.append($('&lt;li/&gt;').text(i));&#13;
                    };&#13;
                    $numbering.fadeIn(1700);&#13;
                });&#13;
            });&#13;
        </script>&#13;
   &#13;
