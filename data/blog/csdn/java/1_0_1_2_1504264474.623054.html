

<h2>1.strust简介（发展）：</h2>&#13;
<blockquote>大概的流行时间：2010前后各3年<br />&#13;
※有两个版本：Struts1，Struts2<br />&#13;
       Struts1: 采用servlet机制，JSP+Action(Servlet+JavaBean)+BaseServlet<br />&#13;
       Struts2: 采用拦截器机制， JSP+Action(Servlet+JavaBean)+拦截器(动态代理Action)+Filter<br />&#13;
<p>        Struts中的Action(本质上是EJB) 和 拦截器都是通过xml配置的方式创建</p>&#13;
<p><br />&#13;
</p>&#13;
Struts框架帮我们做的功能：<br />&#13;
<blockquote>1)帮我们把页面传过来的数据(参数)封装成JavaBean(Action对象)<br />&#13;
2)帮我们把结果信息存放到request中<br />&#13;
3)实现可配置的转发路径(即结果页面的url地址可配置)<br />&#13;
4)除了上面3个核心功能之外，还帮我们实现了一些辅助：国际化、表单可配置、上传下载组件、表单页面的标签库。Struts2还提供了校验框架，对ajax的支持，数据库连接和事务等<br />&#13;
</blockquote>&#13;
Struts1:所有“*.do”的请求都会被它拦截<br />&#13;
Struts2:早期版本所有“*.action”的请求都会被它拦截，后来所有的都会被拦截<br />&#13;
<p>struts框架是apache公司,官网：http://struts.apache.org</p>&#13;
<p><br />&#13;
</p>&#13;
</blockquote>&#13;
<h2><span style="color:black">2.Struts2</span><span style="color:black">概念</span></h2>&#13;
<p></p>&#13;
<p><span style="color:black">      </span><span style="color:#CC0000">Struts2</span><span style="color:black">是</span><span style="color:black">Struts</span><span style="color:black">的第二代产品，以</span><span style="color:#0033CC">WebWork</span><span style="color:black">为核心，采用</span><span style="color:#0033CC">拦截器的机制</span><span style="color:black">处理用户请求，使业务逻辑控制器能与</span><span style="color:black">ServletAPI</span><span style="color:black">完全脱离。</span><span style="color:#CC0000">Struts1</span><span style="color:black">采用</span><span style="color:#0033CC">Servlet</span><span style="color:#0033CC">的机制</span><span style="color:black">处理用户请求。</span></p>&#13;
<p><span style="color:black">     </span>Struts 2<span style="color:black">框架的所有类都基于接口，核心接口独立于</span><span style="color:black">HTTP</span><span style="color:black">。</span><span style="color:black">Struts 2</span><span style="color:black">配置文件中的</span><span style="color:#0033CC">大多数配置元素都会有默认值</span><span style="color:black">，有助于减少在</span><span style="color:black">XML</span><span style="color:black">文件中需要进行的配置。</span></p>&#13;
<p><span style="color:#CC0000">    Struts2</span><span style="color:#CC0000">框架主要由三部分组成：</span></p>&#13;
<p><span style="color:black">    </span><span style="color:#0033CC">核心控制器</span><span style="color:black">(</span><span style="color:black">StrutsPrepareAndExecuteFilter</span><span style="color:black">)</span><span style="color:black">、</span><span style="color:#0033CC">业务控制器</span><span style="color:black">和</span><span style="color:#0033CC">用户定义的业务逻辑组件</span><span style="color:black">。</span></p>&#13;
<p><span style="color:black">    </span><span style="color:black">(</span><span style="color:black">也有核心控制器使用</span><span style="color:black">FilterDispatcher</span><span style="color:black">)</span></p>&#13;
<blockquote><span style="color:#CC0000"> </span><span style="color:#CC0000">1</span><span style="color:#CC0000">、核心控制器</span><br />&#13;
<span style="color:black">      </span><span style="color:#0033CC">FilterDispatcher</span><span style="color:black">是早期</span><span style="color:black">struts2</span><span style="color:black">的过滤器，可以对客户端</span><span style="color:black">URL</span><span style="color:black">请求进行过滤，负责处理用户所有以</span><span style="color:black">.action</span><span style="color:black">结尾的请求。</span><span style="color:black">2.1.3</span><span style="color:black">版后，官方推荐使用</span><span style="color:#0033CC">StrutsPrepareAndExecuteFilter</span><br />&#13;
<span style="color:#CC0000"> </span>2<span style="color:#CC0000">、业务控制器</span><br />&#13;
<span style="color:black">     </span>是用户实现的<span style="color:#0033CC">Action</span><span style="color:#0033CC">类实例</span><span style="color:black">。</span><span style="color:black">Action</span><span style="color:black">类通常包含一个</span><span style="color:#0033CC">execute</span><span style="color:#0033CC">方法</span><span style="color:black">，返回一个字符串作为逻辑视图名。创建了</span><span style="color:black">Action</span><span style="color:black">类之后，还需要</span><span style="color:#0033CC">在</span><span style="color:#0033CC">struts.xml</span><span style="color:#0033CC">文件中配置</span><span style="color:black">此</span><span style="color:black">Action</span><span style="color:black">的相关信息</span><br />&#13;
<span style="color:black"></span>&#13;
<p><span style="color:#CC0000">3</span><span style="color:#CC0000">、业务逻辑组件</span></p>&#13;
<p><span style="color:black"> </span><span style="color:black">   </span>通常是指<span style="color:#0033CC">用户自己针对系统功能开发的功能模块</span><span style="color:black">组件。</span><span style="color:black">被业务控制器组件所调用</span><span style="color:black">来</span><span style="color:#0033CC">处理业务逻辑</span><span style="color:black">的。</span></p>&#13;
</blockquote>&#13;
<h2>&#13;
</h2><p>3.Struts2框架的处理流程</p>&#13;
&#13;
<blockquote><span style="font-size:18px; color:#0033CC">第</span><span style="font-size:18px; color:#0033CC">1</span><span style="font-size:18px; color:#0033CC">步：</span><span style="font-size:18px; color:#0033CC">客户端</span><span style="font-size:18px; color:black">浏览器</span><span style="font-size:18px; color:#0033CC">发送一个请求</span><span style="font-size:18px; color:black">。</span><span style="font-size:18px"><br />&#13;
<span style="color:#0033CC">第</span><span style="color:#0033CC">2</span><span style="color:#0033CC">步：</span><span style="color:#0033CC">web</span><span style="color:#0033CC">服务器</span><span style="color:black">如</span><span style="color:black">Tomcat</span><span style="color:black">收到该请求，</span><span style="color:#0033CC">读取配置文件</span><span style="color:black">，将</span><span style="color:#0033CC">请求&#13;
 导向</span><span style="color:black">Struts2</span><span style="color:black">的</span><span style="color:#0033CC">StrutsPrepareAndExecuteFilter</span><span style="color:black">（核心控制器）， 后者根据请求决定</span><span style="color:#0033CC">调用合适</span><span style="color:#0033CC">Action</span><span style="color:black">。</span><br />&#13;
</span>&#13;
<p><span style="font-size:18px"><span style="color:#0033CC">第</span><span style="color:#0033CC">3</span><span style="color:#0033CC">步：</span><span style="color:black">StrutsPrepareAndExecuteFilter</span><span style="color:black">在调用</span><span style="color:black">Action</span><span style="color:black">之前被</span><span style="color:black">Struts2</span><span style="color:black">的</span><span style="color:#0033CC">拦截器拦截</span><span style="color:black">，拦截器自动对请求应用通用功能，如数据转换，校验等。</span></span></p>&#13;
<span style="font-size:18px"><span style="color:#0033CC">第</span><span style="color:#0033CC">4</span><span style="color:#0033CC">步：</span><span style="color:#0033CC">调用</span><span style="color:#0033CC">Action</span><span style="color:#0033CC">的</span><span style="color:#0033CC">execute</span><span style="color:#0033CC">方法</span><span style="color:black">，该方法根据请求的参数来执行一定的操作。</span><br />&#13;
</span>&#13;
<p><span style="font-size:18px"><span style="color:#0033CC">第</span><span style="color:#0033CC">5</span><span style="color:#0033CC">步：</span><span style="color:black">依据</span><span style="color:black">Action</span><span style="color:black">的</span><span style="color:black">execute</span><span style="color:black">方法处理结果，</span><span style="color:#0033CC">导向不同的</span><span style="color:#0033CC">URL</span><span style="color:black">。如在</span><span style="color:black">execute</span><span style="color:black">中验证用户，验证成功可以导向成功的页面。否则重新登录</span></span></p>&#13;
<p><span style="font-size:18px"><span style="color:black"><br />&#13;
</span></span></p>&#13;
</blockquote>&#13;
<h2><span style="font-size:18px"></span>&#13;
</h2><p>4.Struts2入门示例</p>&#13;
&#13;
<blockquote>&#13;
<p><span style="font-size:18px"><span style="color:black"><br />&#13;
</span></span></p>&#13;
<p></p>&#13;
<p><span style="color:#0033CC">第</span><span style="color:#0033CC">1</span><span style="color:#0033CC">步：</span><span style="color:black">新建一个</span><span style="color:black">web</span><span style="color:black">工程，向工程中导入</span><span style="color:black">struts</span><span style="color:black">核心包</span></p>&#13;
<p><span style="color:#0033CC">第</span><span style="color:#0033CC">2</span><span style="color:#0033CC">步：</span><span style="color:black">编写一个登陆界面</span><span style="color:black">inex.jsp</span><span style="color:black">。</span><span style="color:#669900">注意使用</span><span style="color:#669900">Struts2</span><span style="color:#669900">的标签</span></p>&#13;
<p><span style="color:#669900"></span></p>&#13;
<p><span style="color:#0033CC">第</span><span style="color:#0033CC">3</span><span style="color:#0033CC">步：</span><span style="color:black">编写一个登陆成功后导向的页面</span><span style="color:black">succ</span><span style="color:black">.jsp</span><span style="color:black">。</span></p>&#13;
<p><span style="color:black"></span></p>&#13;
<p><span style="color:#0033CC">第</span><span style="color:#0033CC">4</span><span style="color:#0033CC">步：</span><span style="color:black">在</span><span style="color:black">src</span><span style="color:black">目录中添加一个配置文件</span><span style="color:black">struts.xml</span><span style="color:black">。在</span><span style="color:black">web</span><span style="color:black">服务器启动时读取该文件。</span></p>&#13;
<p><span style="color:#0033CC">第</span><span style="color:#0033CC">5</span><span style="color:#0033CC">步：</span><span style="color:black">改写网站配置文件</span><span style="color:black">web.xml,</span><span style="color:black">添加</span><span style="color:black">Struts2</span><span style="color:black">过滤器。</span></p>&#13;
<p><span style="color:#0033CC">第</span><span style="color:#0033CC">6</span><span style="color:#0033CC">步：</span><span style="color:black">建立控制器类</span><span style="color:black">LoginAction</span><span style="color:black">，页面输入后导向该</span><span style="color:black">Action</span><span style="color:black">。文件名为</span><span style="color:black">LoginAction.java</span><span style="color:black">。</span></p>&#13;
<p><span style="color:#0033CC">第</span><span style="color:#0033CC">7</span><span style="color:#0033CC">步：</span><span style="color:black">将项目部署到</span><span style="color:black">web</span><span style="color:black">服务器中</span></p>&#13;
<p><span style="color:#0033CC">第</span><span style="color:#0033CC">8</span><span style="color:#0033CC">步：</span><span style="color:black">测试</span></p>&#13;
<br />&#13;
<p><span style="color:black"><br />&#13;
</span></p>&#13;
</blockquote>&#13;
<h2>&#13;
</h2><p><span style="color:#669900"></span></p>&#13;
<p><span style="color:#CC0000">5.Struts2</span><span style="color:#CC0000">运行流程</span></p>&#13;
&#13;
<blockquote>&#13;
<p></p>&#13;
<p><span style="color:#669900"></span></p>&#13;
<div><span style="font-size:14px">①<span style="color:black">首先客户端输入</span><span style="color:black">url</span><span style="color:black">：</span><span style="color:black">http://localhost:8080/strutsHello</span></span></div>&#13;
<div><span style="font-size:14px">②<span style="color:black">提交按钮按下后向服务器端发出请求，请求</span><span style="color:black">/index</span><span style="color:black">了</span></span></div>&#13;
<div><span style="font-size:14px">③<span style="color:black">该</span><span style="color:black">url</span><span style="color:black">被</span><span style="color:black">struts</span><span style="color:black">过滤器拦截</span></span></div>&#13;
<div><span style="font-size:14px">④<span style="color:black">过滤器根据</span><span style="color:black">url</span><span style="color:black">中的路径名struts2</span><span style="color:black">读取配置文件，该</span><span style="color:black">action</span><span style="color:black">对应</span><span style="color:black">Action</span><span style="color:black">类是</span><span style="color:black">LoginAction</span></span></div>&#13;
<div><span style="font-size:14px">⑤<span style="color:black">则</span><span style="color:black">Struts2</span><span style="color:black">控制器创建一个</span><span style="color:black">LoginAction</span><span style="color:black">实例</span><span style="color:black">,</span><span style="color:black">调用该实例的</span><span style="color:black">setUsername</span><span style="color:black">以及</span><span style="color:black">setPassword</span><span style="color:black">函数实际参数值来源于客户端页面用户输入的</span><span style="color:black">username,password</span><span style="color:black">两个变量。</span></span></div>&#13;
<div><span style="font-size:14px">⑥<span style="color:black">然后调用</span><span style="color:black">LoginAction</span><span style="color:black">中的</span><span style="color:black">execute</span><span style="color:black">函数，根据该函数返回值导向不同的页面。如果是</span><span style="color:black">success</span><span style="color:black">导向成功页面</span><span style="color:black">succ.jsp</span><span style="color:black">。如果是</span><span style="color:black">input</span><span style="color:black">导向输入页面</span><span style="color:black">login.jsp</span><span style="color:black">。</span></span></div>&#13;
<br />&#13;
<p></p>&#13;
</blockquote>&#13;
<h2><span style="color:black">6.Struts2</span><span style="color:black">的配置文件</span></h2>&#13;
<blockquote>&#13;
<p></p>&#13;
<p><span style="color:black">（1）Struts2</span><span style="color:black">框架配置文件中的</span><span style="color:#0033CC">包</span><span style="color:black">就是</span><span style="color:#0033CC">由多个</span><span style="color:#0033CC">Action</span><span style="color:#0033CC">、多个拦截器、多个拦截器引用构成</span><span style="color:black">。包的作用和</span><span style="color:black">java</span><span style="color:black">中的类包是非常类似的</span><span style="color:black">,</span><span style="color:black">它主要用于管理一组业务功能相关的</span><span style="color:black">action,</span><span style="color:black">在实际应用中</span><span style="color:black">,</span><span style="color:black">我们应该</span><span style="color:#0033CC">把一组业务功能相关的</span><span style="color:#0033CC">action</span><span style="color:#0033CC">放在同一个包下</span><span style="color:black">。</span></p>&#13;
<pre code_snippet_id="1857819" snippet_file_name="blog_20160830_1_2892524" name="code" class="html">&lt;struts&gt;

   &lt;!-- Struts2的action必须放在一个指定的包空间下定义--&gt;

   &lt;package name="default"extends="struts-default"&gt;

      &lt;!-- 定义处理请求URL为login.action的Action --&gt;

       &lt;action name="login" class=action.LoginAction"&gt;

          &lt;!-- 定义处理结果字符串和URL之间的映射关系--&gt;

           &lt;result name="success"&gt;/success.jsp&lt;/result&gt;

           &lt;result name="input"&gt;/login.jsp&lt;/result&gt;

       &lt;/action&gt;

   &lt;/package&gt;

&lt;/struts&gt;</pre>&#13;
<p><span style="font-size:14px; color:black">（2）</span><span style="font-size:14px; color:black">、</span><span style="font-size:14px; color:black">namespace</span><span style="font-size:14px; color:black">命名空间配置</span></p>&#13;
<p><span style="font-size:14px; color:black">     </span><span style="font-size:14px">考虑到同一个<span style="color:black">Web</span><span style="color:black">应用中需要同名的</span><span style="color:black">Action</span><span style="color:black">，</span><span style="color:black">Struts2</span><span style="color:black">以命名空间的方式来管理</span><span style="color:black">Action</span><span style="color:black">，同一个命名空间不能有同名的</span><span style="color:black">Action</span><span style="color:black">。</span></span></p>&#13;
<p><span style="font-size:14px; color:black">     </span><span style="font-size:14px">Struts2<span style="color:#0033CC">通过为包指定</span><span style="color:#0033CC">namespace</span><span style="color:#0033CC">属性来为包下面的所有</span><span style="color:#0033CC">Action</span><span style="color:#0033CC">指定共同的命名空间</span><span style="color:black">。把上示例的配置改为如下形式：</span></span></p>&#13;
<span style="font-size:14px"></span>&#13;
<p><span style="color:black">包</span><span style="color:black">student</span><span style="color:black">：没有指定</span><span style="color:black">namespace</span><span style="color:black">属性。</span><span style="color:#0033CC">默认的命名空间是</span><span style="color:#0033CC">""，</span><span style="color:black">访问的时候不需要加命名空间。</span></p>&#13;
<p><span style="color:black">包</span><span style="color:black">admin</span><span style="color:black">：指定了命名空间</span><span style="color:black">/admin</span><span style="color:black">。则如上名为</span><span style="color:black">adminaction.LoginAction</span><span style="color:black">的</span><span style="color:black">Action</span><span style="color:black">，它处理的</span><span style="color:black">URL</span><span style="color:black">为：</span></p>&#13;
<p><span style="color:black">http://localhost:8080/chapter10web</span><span style="color:black">/</span><span style="color:#0033CC">admin/</span><span style="color:black">adminLogin.action</span></p>&#13;
<p><span style="color:black">（3）、</span><span style="color:black">include</span><span style="color:black">包含配置</span></p>&#13;
<p><span style="color:black">在</span><span style="color:black">Struts2</span><span style="color:black">中可以将一个配置文件分解成多个配置文件，那么我们必须在</span><span style="color:black">struts.xml</span><span style="color:black">中包含其他配置文件。</span></p>&#13;
<p><span style="color:black">&lt;struts&gt;</span></p>&#13;
<p><span style="color:black">   </span><span style="color:#0033CC">&lt;includefile="struts-default.xml"/&gt;</span></p>&#13;
<p><span style="color:#0033CC">    &lt;includefile="struts-student.xml"/&gt;</span></p>&#13;
<p><span style="color:#0033CC">    &lt;includefile="struts-admin.xml"/&gt;</span></p>&#13;
<p><span style="color:#0033CC">    &lt;includefile="struts-user.xml"/&gt;</span></p>&#13;
<p><span style="color:black">   </span>......</p>&#13;
<p><span style="color:black">&lt;/struts&gt;</span></p>&#13;
<p><span style="color:black"><br />&#13;
</span></p>&#13;
</blockquote>&#13;
<h2><span style="font-size:14px"></span>&#13;
</h2><p><span style="color:black">7.Action类</span></p>&#13;
&#13;
<blockquote>&#13;
<p><span style="font-size:14px"></span></p>&#13;
<p><span style="color:black">       </span>在<span style="color:black">Struts2</span><span style="color:black">中，</span><span style="color:black">Action</span><span style="color:black">不同于</span><span style="color:black">struts1.x</span><span style="color:black">中的</span><span style="color:black">Action</span><span style="color:black">。</span><span style="color:#0033CC">Struts2</span><span style="color:#0033CC">中</span><span style="color:#0033CC">Action</span><span style="color:#0033CC">并不需要继承任何控制器类型或实现相应接口</span><span style="color:black">。比如</span><span style="color:black">struts1.x</span><span style="color:black">中的</span><span style="color:black">Action</span><span style="color:black">需要继承</span><span style="color:black">Action</span><span style="color:black">或者</span><span style="color:black">DispatcherAction</span><span style="color:black">。</span></p>&#13;
<p><span style="color:black">同时</span><span style="color:#0033CC">Struts2</span><span style="color:#0033CC">中的</span><span style="color:#0033CC">Action</span><span style="color:black">并不需要借助于象</span><span style="color:black">struts1</span><span style="color:black">中的</span><span style="color:black">ActionForm</span><span style="color:black">获取表单的数据。</span><span style="color:#0033CC">可以直接通过与表单元素相同名称的数据成员（</span><span style="color:#0033CC">setter-getter</span><span style="color:#0033CC">函数）获取页面表单数据</span><span style="color:black">。</span></p>&#13;
<p><span style="color:black">     </span>虽然<span style="color:black">Struts2</span><span style="color:black">中的</span><span style="color:black">Action</span><span style="color:black">原则上不用继承任何类。但是</span><span style="color:#0033CC">一般需要实现</span><span style="color:#0033CC">Action</span><span style="color:#0033CC">接口或者继承</span><span style="color:#0033CC">ActionSupport</span><span style="color:#0033CC">类，重写</span><span style="color:#0033CC">execute</span><span style="color:#0033CC">方法</span><span style="color:black">。如果继承</span><span style="color:black">ActionSupport</span><span style="color:black">类，我们可以在的控制器中增加更多的功能。</span></p>&#13;
<br />&#13;
<p><span style="color:#CC0000">定义</span><span style="color:#CC0000">Action</span><span style="color:#CC0000">类的两种形式：</span></p>&#13;
<p><span style="color:#0033CC">1</span><span style="color:#0033CC">、基本形式：从</span><span style="color:#0033CC">ActionSupport</span><span style="color:#0033CC">类继承</span></p>&#13;
<p><span style="color:black">  </span></p>&#13;
<pre code_snippet_id="1857819" snippet_file_name="blog_20160830_2_2401373" name="code" class="html">  public class LoginAction extendsActionSupport{

         private String username;

         private String password;

         /*getter-setter代码略*/

         public void validate(){…}

         public String execute()throwsException {….}

    }</pre><br />&#13;
<br />&#13;
<p></p>&#13;
<p><span style="color:#0033CC">2</span><span style="color:#0033CC">、普通</span><span style="color:#0033CC">JavaBean</span></p>&#13;
<p><span style="color:black">  </span></p>&#13;
<pre code_snippet_id="1857819" snippet_file_name="blog_20160830_3_6163364" name="code" class="html">  package com.bean;

    public class User {

   private String username;

   private String password;

            /*getter-setter代码略*/

     public String execute()throwsException {...}

    }

</pre><br />&#13;
<p></p>&#13;
<h3><span style="color:black"><span style="color:black">Action</span><span style="color:black">动态处理函数</span></span></h3>&#13;
<p></p>&#13;
<p><span style="font-size:14px; color:black"></span></p>&#13;
<p><span style="color:#0033CC">1</span><span style="color:#0033CC">、</span><span style="color:#0033CC">Action</span><span style="color:#0033CC">默认的</span><span style="color:#0033CC">execute</span><span style="color:#0033CC">函数</span></p>&#13;
<p><span style="color:black">    </span><span style="color:black">一般客户端请求</span><span style="color:black">url</span><span style="color:black">被</span><span style="color:black">Struts2</span><span style="color:black">的拦截后，</span><span style="color:#0033CC">根据</span><span style="color:#0033CC">url</span><span style="color:#0033CC">指定</span><span style="color:#0033CC">action</span><span style="color:#0033CC">名称，查找相应的</span><span style="color:#0033CC">action</span><span style="color:black">,</span><span style="color:black">默认调用</span><span style="color:black">Action</span><span style="color:black">类的</span><span style="color:black">execute</span><span style="color:black">函数。如：</span></p>&#13;
<p><span style="color:black">&lt;packagename="struts2" extends="struts-default"&gt;</span></p>&#13;
<p><span style="color:black">  </span>&lt;!-- <span style="color:black">通过</span><span style="color:black">Action</span><span style="color:black">类处理才导航的</span><span style="color:black">Action</span><span style="color:black">定义</span><span style="color:black">--&gt;</span></p>&#13;
<p><span style="color:black">  </span><span style="color:#0033CC">&lt;action name="Login"class="com.action.LoginAction"&gt;</span></p>&#13;
<p><span style="color:black">  </span><span style="color:black">&lt;result name="input"&gt;/</span><span style="color:black">login.jsp</span><span style="color:black">&lt;/result&gt;</span></p>&#13;
<p><span style="color:black">  </span>&lt;result name="success"&gt;/<span style="color:black">success.jsp</span><span style="color:black">&lt;/result&gt;</span></p>&#13;
<p><span style="color:black">  </span>&lt;/action&gt;</p>&#13;
<p><span style="color:black">&lt;/package&gt;</span></p>&#13;
<p><span style="font-size:18px"><span style="color:black"></span></span></p>&#13;
<p><span style="color:#0033CC">2</span><span style="color:#0033CC">、如果不用调用默认</span><span style="color:#0033CC">execute()</span><span style="color:#0033CC">。要求调用指定函数</span><span style="color:#0033CC">fun()</span><span style="color:#0033CC">函数。</span></p>&#13;
<p><span style="font-size:14px; color:#669900">第</span><span style="font-size:14px; color:#669900">1</span><span style="font-size:14px; color:#669900">种方法</span><span style="font-size:14px; color:black">是修改配置文件，修改</span><span style="font-size:14px; color:#0033CC">action</span><span style="font-size:14px; color:#0033CC">标记的</span><span style="font-size:14px; color:#0033CC">method</span><span style="font-size:14px; color:#0033CC">属性值</span></p>&#13;
<p><span style="font-size:14px; color:black">&lt;actionname="</span><span style="font-size:14px; color:black">userLogin</span><span style="font-size:14px; color:black">"class="</span><span style="font-size:14px; color:black">com.action.LoginAction</span><span style="font-size:14px; color:black">" </span><span style="font-size:14px; color:#0033CC">method="fun"</span><span style="font-size:14px; color:black">&gt;</span></p>&#13;
<p><span style="font-size:14px; color:black">             </span><span style="font-size:14px">&lt;result name="input"&gt;/<span style="color:black">login.jsp</span><span style="color:black">&lt;/result&gt;</span></span></p>&#13;
<p><span style="font-size:14px; color:black">  </span><span style="font-size:14px">     &lt;result name="success"&gt;/<span style="color:black">success.jsp</span><span style="color:black">&lt;/result&gt;</span></span></p>&#13;
<p><span style="font-size:14px; color:black"> &lt;/action&gt;</span></p>&#13;
<p><span style="font-size:14px; color:#669900">第</span><span style="font-size:14px; color:#669900">2</span><span style="font-size:14px; color:#669900">种方法</span><span style="font-size:14px; color:black">是在页面</span><span style="font-size:14px; color:#0033CC">form</span><span style="font-size:14px; color:#0033CC">标记</span><span style="font-size:14px; color:#0033CC">action</span><span style="font-size:14px; color:#0033CC">属性</span><span style="font-size:14px; color:black">中指定调用处理方法名</span><span style="font-size:14px; color:black">,</span><span style="font-size:14px; color:black">如</span><span style="font-size:14px; color:black">Action</span><span style="font-size:14px; color:black">类编写如下：</span></p>&#13;
<p><span style="font-size:14px; color:black">publicclass </span><span style="font-size:14px; color:black">LoginAction</span><span style="font-size:14px; color:black">{</span></p>&#13;
<p><span style="font-size:14px; color:black">      </span><span style="font-size:14px">public String fun1() throws Exception{  .....    }</span></p>&#13;
<p><span style="font-size:14px; color:black">     </span><span style="font-size:14px">  public String fun2() throwsException{ <span style="color:black">......  </span>}</span></p>&#13;
<p><span style="font-size:14px; color:black">}</span></p>&#13;
<p><span style="font-size:14px; color:black">在页面</span><span style="font-size:14px; color:black">form</span><span style="font-size:14px; color:black">标记的</span><span style="font-size:14px; color:black">action</span><span style="font-size:14px; color:black">属性中指定调用处理方法名。</span></p>&#13;
<p><span style="font-size:14px; color:black">      </span><span style="font-size:14px">&lt;form<span style="color:#0033CC">action="/login!fun1.action"</span><span style="color:black">method="post"&gt;</span></span></p>&#13;
<p><span style="font-size:14px; color:black">     </span><span style="font-size:14px">&lt;form<span style="color:#0033CC">action="/login!fun2.action"</span><span style="color:black">method="post"&gt;</span></span></p>&#13;
<p><span style="color:#0033CC">3</span><span style="color:#0033CC">、使用通配符映射方式</span></p>&#13;
<p><span style="color:black"> <span style="font-size:14px"> </span></span><span style="font-size:14px; color:black">配置文件</span><span style="font-size:14px; color:black">admin_*&#13;
</span><span style="font-size:14px; color:black">：定义一系列请求</span><span style="font-size:14px; color:black">URL</span><span style="font-size:14px; color:black">是</span><span style="font-size:14px; color:black">admin_*.action</span><span style="font-size:14px; color:black">模式的逻辑</span><span style="font-size:14px; color:black">Action</span></p>&#13;
<p><span style="font-size:14px; color:black">  </span><span style="font-size:14px">&lt;action name="<span style="color:#0033CC">admin_*</span><span style="color:black">"</span></span></p>&#13;
<p><span style="font-size:14px; color:black">         </span><span style="font-size:14px">class="<span style="color:black">action.UserAction</span><span style="color:black">"</span><span style="color:#0033CC">method="{1}"</span><span style="color:black">&gt;</span></span></p>&#13;
<p><span style="font-size:14px; color:black">             </span><span style="font-size:14px">&lt;result name="input"&gt;/<span style="color:black">login.jsp</span><span style="color:black">&lt;/result&gt;</span></span></p>&#13;
<p><span style="font-size:14px; color:black">        </span><span style="font-size:14px">&lt;resultname="success"&gt;/<span style="color:black">success.jsp</span><span style="color:black">&lt;/result&gt;</span></span></p>&#13;
<p><span style="font-size:14px; color:black"> &lt;/action&gt;</span></p>&#13;
<p><span style="font-size:14px; color:black">    </span><span style="font-size:14px">如上，<span style="color:black">&lt;action name=“admin_*”&gt;</span><span style="color:#0033CC">定义一系列请求</span><span style="color:#0033CC">URL</span><span style="color:#0033CC">是</span><span style="color:#0033CC">admin_*.action</span><span style="color:#0033CC">模式的逻辑</span><span style="color:#0033CC">Action</span><span style="color:black">。同时</span><span style="color:black">method</span><span style="color:black">属性值为一个表达式</span><span style="color:black">{1}</span><span style="color:black">，表示它的值是</span><span style="color:black">name</span><span style="color:black">属性值中第一个</span><span style="color:black">*</span><span style="color:black">的值。</span></span></p>&#13;
<p><span style="font-size:14px; color:black">例如：用户请求</span><span style="font-size:14px; color:black">URL</span><span style="font-size:14px; color:black">为</span><span style="font-size:14px; color:#0033CC">admin_login.action</span><span style="font-size:14px; color:black">时，将调用</span><span style="font-size:14px; color:black">AdminAction</span><span style="font-size:14px; color:black">类的</span><span style="font-size:14px; color:#0033CC">login</span><span style="font-size:14px; color:black">方法；用户请求</span><span style="font-size:14px; color:black">URL</span><span style="font-size:14px; color:black">为</span><span style="font-size:14px; color:black">admin_regist.action</span><span style="font-size:14px; color:black">时，将调用到</span><span style="font-size:14px; color:black">AdminAction</span><span style="font-size:14px; color:black">类的</span><span style="font-size:14px; color:black">regist</span><span style="font-size:14px; color:black">方法。</span></p>&#13;
<p><span style="font-size:14px; color:black"><br />&#13;
</span></p>&#13;
</blockquote>&#13;
<h2><span style="font-size:18px"><span style="color:black"><span style="color:black">8.Action</span><span style="color:black">访问</span><span style="color:black">ServletAPI</span></span></span></h2>&#13;
<blockquote>&#13;
<p><span style="font-size:18px"><span style="color:black"><span style="color:black"></span></span></span></p>&#13;
<p><span style="color:black">  <span style="font-size:14px">  </span></span><span style="font-size:14px">在进行<span style="color:black">Web</span><span style="color:black">编程时，很多时候需要使用</span><span style="color:black">Servlet</span><span style="color:black">相关对象，例如：</span><span style="color:black">HttpServletRequest</span><span style="color:black">、</span><span style="color:black">HttpServletResponse</span><span style="color:black">、</span><span style="color:black">HttpSession</span><span style="color:black">、</span><span style="color:black">ServletContext</span><span style="color:black">。我们可以将一些信息存放到</span><span style="color:black">session</span><span style="color:black">中，然后在需要的时候取出。</span></span></p>&#13;
<p><span style="font-size:14px; color:black">    </span><span style="font-size:14px; color:black">Struts2</span><span style="font-size:14px; color:black">中提供了一个</span><span style="font-size:14px; color:#0033CC">ActionContext</span><span style="font-size:14px; color:#0033CC">类</span><span style="font-size:14px; color:black">(</span><span style="font-size:14px; color:black">当前</span><span style="font-size:14px; color:black">Action</span><span style="font-size:14px; color:black">的上下文对象</span><span style="font-size:14px; color:black">)</span><span style="font-size:14px; color:black">，此类的</span><span style="font-size:14px; color:black">getContext</span><span style="font-size:14px; color:black">方法</span><span style="font-size:14px; color:#0033CC">可以得到当前</span><span style="font-size:14px; color:#0033CC">Action</span><span style="font-size:14px; color:#0033CC">的上下文，也就是当前</span><span style="font-size:14px; color:#0033CC">Action</span><span style="font-size:14px; color:#0033CC">所处的容器环境，进而得到相关对象</span><span style="font-size:14px; color:black">。下面是该类中提供的几个常用方法：</span></p>&#13;
<span style="font-size:18px"><span style="color:black"><em><strong><span style="color:black"></span></strong></em></span></span>&#13;
<p><span style="color:black"></span></p>&#13;
<div><span style="font-size:14px; color:black">public static </span><span style="font-size:14px; color:black">ActionContext</span><span style="font-size:14px; color:#CC0000">getContext</span><span style="font-size:14px; color:#CC0000">()</span><span style="font-size:14px; color:black">：获得当前</span><span style="font-size:14px; color:black">ActionActionContext</span><span style="font-size:14px; color:black">实例。publicObject</span><span style="font-size:14px; color:#333399">get(Object&#13;
 key)</span><span style="font-size:14px; color:black">：此方法类似于调用</span><span style="font-size:14px; color:black">HttpServletRequest</span><span style="font-size:14px; color:black">的</span><span style="font-size:14px; color:black">getAttribute</span><span style="font-size:14px; color:black">(Stringname)</span><span style="font-size:14px; color:black">方法。publicvoid</span><span style="font-size:14px; color:#333399">put(Object&#13;
 key, Object value)</span><span style="font-size:14px; color:black">：此方法类似于调用</span><span style="font-size:14px; color:black">HttpServletRequest</span><span style="font-size:14px; color:black">的</span><span style="font-size:14px; color:black">setAttribute</span><span style="font-size:14px; color:black">(Stringname,&#13;
 Object o)</span><span style="font-size:14px; color:black">。<br />&#13;
<br />&#13;
</span></div>&#13;
<div><span style="font-size:14px; color:black">publicMap </span><span style="font-size:14px; color:#333399">getParameters</span><span style="font-size:14px; color:#333399">()</span><span style="font-size:14px; color:black">：获取所有的请求参数。类似于调用</span><span style="font-size:14px; color:black">HttpServletRequest</span><span style="font-size:14px; color:black">对象的</span><span style="font-size:14px; color:black">getParameterMap</span><span style="font-size:14px; color:black">()</span><span style="font-size:14px; color:black">方法。<br />&#13;
<br />&#13;
</span></div>&#13;
<div><span style="font-size:14px; color:black">publicMap </span><span style="font-size:14px; color:#333399">getSession</span><span style="font-size:14px; color:#333399">()</span><span style="font-size:14px; color:black">：返回一个</span><span style="font-size:14px; color:black">Map</span><span style="font-size:14px; color:black">对象，该</span><span style="font-size:14px; color:black">Map</span><span style="font-size:14px; color:black">对象模拟了</span><span style="font-size:14px; color:black">HttpSession</span><span style="font-size:14px; color:black">实例。<br />&#13;
<br />&#13;
</span></div>&#13;
<div><span style="font-size:14px; color:black">publicvoid </span><span style="font-size:14px; color:#333399">setSession</span><span style="font-size:14px; color:#333399">(Map session)</span><span style="font-size:14px; color:black"> :</span><span style="font-size:14px; color:black">直接传入一个</span><span style="font-size:14px; color:black">Map</span><span style="font-size:14px; color:black">实例，将该</span><span style="font-size:14px; color:black">Map</span><span style="font-size:14px; color:black">实例的</span><span style="font-size:14px; color:black">key-value</span><span style="font-size:14px; color:black">对转换成</span><span style="font-size:14px; color:black">session</span><span style="font-size:14px; color:black">的属性名－属性值对。<br />&#13;
<br />&#13;
</span></div>&#13;
<div><span style="font-size:14px; color:black">publicMap </span><span style="font-size:14px; color:#333399">getApplication</span><span style="font-size:14px; color:#333399">()</span><span style="font-size:14px; color:black">：返回一个</span><span style="font-size:14px; color:black">Map</span><span style="font-size:14px; color:black">对象，该对象模拟了该应用的</span><span style="font-size:14px; color:black">ServletContext</span><span style="font-size:14px; color:black">实例。<br />&#13;
<br />&#13;
</span></div>&#13;
<div><span style="font-size:14px; color:black">publicvoid </span><span style="font-size:14px; color:#333399">setApplication</span><span style="font-size:14px; color:#333399">(Map application)</span><span style="font-size:14px; color:black">：直接传入一个</span><span style="font-size:14px; color:black">Map</span><span style="font-size:14px; color:black">实例，将该</span><span style="font-size:14px; color:black">Map</span><span style="font-size:14px; color:black">实例里的</span><span style="font-size:14px; color:black">key-value</span><span style="font-size:14px; color:black">对转换成</span><span style="font-size:14px; color:black">application</span><span style="font-size:14px; color:black">的属性名－属性值对。</span></div>&#13;
<br />&#13;
<p></p>&#13;
</blockquote>&#13;
<h2><span style="font-size:18px"><span style="color:black"><span style="color:black"></span></span></span>&#13;
</h2><p><span style="color:black">9.<span style="color:black">Struts2</span><span style="color:black">校验框架</span></span></p>&#13;
&#13;
<blockquote>&#13;
<p><span style="font-size:18px"><span style="color:black"><span style="color:black"></span></span></span></p>&#13;
<p><span style="color:black"><span style="color:black"></span></span></p>&#13;
<p><span style="color:black"><span style="color:black"><span style="color:black"> &#13;
</span><span style="font-size:14px">输入校验几乎是任何一个系统都需要开发的功能模块，我们无法预料用户如何输入，但是必须全面考虑用户输入的各种情况，尤其需要注意那些非正常输入。<span style="color:black">Struts2</span><span style="color:black">提供了功能强大的输入校验机制，通过</span><span style="color:#0033CC">Struts2</span><span style="color:#0033CC">内建的输入校验器</span><span style="color:black">，在应用程序中</span><span style="color:#0033CC">无需书写任何代码，即可完成大部分的校验功能</span><span style="color:black">，并可以同时完成客户端和服务器端的校验。</span></span></span></span></p>&#13;
<p><span style="font-size:14px; color:black"><span style="color:black"><span style="color:black">     </span><span style="color:black">如果应用的输入校验规则特别，</span><span style="color:black">Struts2</span><span style="color:#0033CC">也允许通过重写</span><span style="color:#0033CC">validate</span><span style="color:#0033CC">方法来完成自定义校验</span><span style="color:black">，另外</span><span style="color:black">Struts2</span><span style="color:black">的开放性</span><span style="color:#0033CC">还允许</span><span style="color:black">开发者提供</span><span style="color:#0033CC">自定义的校验器</span><span style="color:black">。</span></span></span></p>&#13;
<p><span style="color:black"><span style="color:black"><span style="color:black"></span></span></span></p>&#13;
<p><span style="font-size:14px; color:black">      </span><span style="font-size:14px">Struts2<span style="color:black">中</span><span style="color:#0033CC">可以通过重写</span><span style="color:#0033CC">validate</span><span style="color:#0033CC">方法来完成输入校验</span><span style="color:black">。如果我们重写了</span><span style="color:black">validate</span><span style="color:black">方法，则该方法会</span><span style="color:#0033CC">应用于此</span><span style="color:#0033CC">Action</span><span style="color:#0033CC">中的所有提供服务的业务方法</span><span style="color:black">。</span></span></p>&#13;
<p><span style="font-size:14px"><span style="color:black"><br />&#13;
</span></span></p>&#13;
<p><span style="color:#0033CC">Struts2</span><span style="color:#0033CC">的输入校验流程如下：</span></p>&#13;
<p><span style="font-size:14px; color:black">      1</span><span style="font-size:14px; color:black">、类型转换器负责</span><span style="font-size:14px; color:#0033CC">对字符串的请求参数</span><span style="font-size:14px; color:black">执行类型转换，并将这此值</span><span style="font-size:14px; color:#0033CC">设置成</span><span style="font-size:14px; color:#0033CC">Action</span><span style="font-size:14px; color:#0033CC">的属性值</span><span style="font-size:14px; color:black">。</span></p>&#13;
<p><span style="font-size:14px; color:black">      2</span><span style="font-size:14px; color:black">、在执行类型转换过程中可能出现异常，如果</span><span style="font-size:14px; color:#0033CC">出现异常</span><span style="font-size:14px; color:black">，将异常信息</span><span style="font-size:14px; color:#0033CC">保存到</span><span style="font-size:14px; color:#0033CC">ActionContext</span><span style="font-size:14px; color:black">中，</span><span style="font-size:14px; color:black">conversionError</span><span style="font-size:14px; color:black">拦截器  &#13;
 负责将其封装到</span><span style="font-size:14px; color:black">fieldError</span><span style="font-size:14px; color:black">里，然后执行第</span><span style="font-size:14px; color:black">3</span><span style="font-size:14px; color:black">步；如果转换过程</span><span style="font-size:14px; color:#0033CC">没有异常信息</span><span style="font-size:14px; color:black">，则</span><span style="font-size:14px; color:#0033CC">直接进入第</span><span style="font-size:14px; color:#0033CC">3</span><span style="font-size:14px; color:#0033CC">步</span><span style="font-size:14px; color:black">。</span></p>&#13;
<p><span style="font-size:14px; color:black">       3</span><span style="font-size:14px; color:black">、通过反射</span><span style="font-size:14px; color:#0033CC">调用</span><span style="font-size:14px; color:#0033CC">validateXxx</span><span style="font-size:14px; color:#0033CC">()</span><span style="font-size:14px; color:#0033CC">方法</span><span style="font-size:14px; color:black">，其中</span><span style="font-size:14px; color:#CC0000">Xxx</span><span style="font-size:14px; color:black">是即将处理用户请求的处理逻辑所对应的</span><span style="font-size:14px; color:#CC0000">方法名</span><span style="font-size:14px; color:black">。</span></p>&#13;
<p><span style="font-size:14px; color:black">       4</span><span style="font-size:14px; color:black">、调用</span><span style="font-size:14px; color:black">Action</span><span style="font-size:14px; color:black">类里的</span><span style="font-size:14px; color:#0033CC">validate()</span><span style="font-size:14px; color:#0033CC">方法</span><span style="font-size:14px; color:black">。</span></p>&#13;
<p><span style="font-size:14px; color:black">       5</span><span style="font-size:14px; color:black">、如果经过上面</span><span style="font-size:14px; color:black">4</span><span style="font-size:14px; color:black">步都</span><span style="font-size:14px; color:#0033CC">没有出现</span><span style="font-size:14px; color:#0033CC">fieldError</span><span style="font-size:14px; color:black">，将</span><span style="font-size:14px; color:#0033CC">调用</span><span style="font-size:14px; color:#0033CC">Action</span><span style="font-size:14px; color:#0033CC">里处理用户请求的处理方法</span><span style="font-size:14px; color:black">；如果</span><span style="font-size:14px; color:#0033CC">出现了</span><span style="font-size:14px; color:#0033CC">fieldError</span><span style="font-size:14px; color:black">，系统将</span><span style="font-size:14px; color:#0033CC">转入</span><span style="font-size:14px; color:black">input</span><span style="font-size:14px; color:black">逻辑视图所指定的</span><span style="font-size:14px; color:#0033CC">视图资源</span><span style="font-size:14px; color:black">。</span></p>&#13;
<p><span style="color:#CC0000">校验示例:</span></p>&#13;
<p><span style="color:#CC0000"></span></p>&#13;
<p><span style="color:#0033CC"></span></p>&#13;
<p><span style="color:#0033CC">第</span><span style="color:#0033CC">1</span><span style="color:#0033CC">步：编写一个</span><span style="color:#0033CC">User2Action</span><span style="color:#0033CC">类，该</span><span style="color:#0033CC">Action</span><span style="color:#0033CC">接受页面提交过来的参数</span></p>&#13;
<pre code_snippet_id="1857819" snippet_file_name="blog_20160830_4_481763" name="code" class="html">&lt;span style="font-family:Microsoft YaHei;font-size:14px;"&gt;&lt;span style="font-size:12px;color:#330033;"&gt;package cn.hncu.user.login;

import com.opensymphony.xwork2.ActionSupport;

public class User2Action extends ActionSupport{
	private String name;
	private String pwd;
	private String email;
	private String other;
	public String getEmail() {
		return email;
	}
	public void setEmail(String email) {
		this.email = email;
	}
	public Integer getAge() {
		return age;
	}
	public void setAge(Integer age) {
		this.age = age;
	}
	private Integer age;
	public String getName() {
		return name;
	}
	public void setName(String name) {
		this.name = name;
	}
	public String getPwd() {
		return pwd;
	}
	public void setPwd(String pwd) {
		this.pwd = pwd;
	}
	@Override
	public String execute() throws Exception {
		return SUCCESS;
	}
}&lt;/span&gt;
&lt;/span&gt;</pre><span style="font-family:Microsoft YaHei; font-size:14px"><span style="color:#0033CC"></span></span>&#13;
<p><span style="font-family:Microsoft YaHei; font-size:14px"></span></p>&#13;
<p><span style="color:#0033CC">第</span><span style="color:#0033CC">2</span><span style="color:#0033CC">步：在该</span><span style="color:#0033CC">Action</span><span style="color:#0033CC">相同的目录下建一个</span><span style="color:#0033CC">xml</span><span style="color:#0033CC">文件，该文件的命名为</span><span style="color:#CC0000">ActionName</span><span style="color:#0033CC">-validation.xml</span><span style="color:#0033CC">，其中</span><span style="color:#0033CC">ActionName</span><span style="color:#0033CC">为该</span><span style="color:#0033CC">Action</span><span style="color:#0033CC">的类名，例如</span><span style="color:#CC0000">LoginValidateAction</span><span style="color:#0033CC">-validation.xml</span><span style="color:#0033CC">。然后在</span><span style="color:#0033CC">xml</span><span style="color:#0033CC">配置文件中配置需要验证的字段。</span></p>&#13;
<p><span style="color:#0033CC"></span></p>&#13;
<pre code_snippet_id="1857819" snippet_file_name="blog_20160830_5_7831803" name="code" class="html">&lt;span style="font-family:Microsoft YaHei;font-size:12px;color:#330033;"&gt;&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;!DOCTYPE validators PUBLIC
        "-//OpenSymphony Group//XWork Validator 1.0.3//EN"
        "http://www.opensymphony.com/xwork/xwork-validator-1.0.3.dtd"&gt;
&lt;validators&gt;
	&lt;field name="name"&gt;
		&lt;field-validator type="requiredstring"&gt;
			&lt;message key="用户名不能为空" /&gt;
		&lt;/field-validator&gt;
	&lt;/field&gt;
	&lt;field name="pwd"&gt;
		&lt;field-validator type="requiredstring"&gt;
			&lt;message key="密码不能为空" /&gt;
		&lt;/field-validator&gt;
		&lt;field-validator type="stringlength"&gt;
			&lt;param name="minLength"&gt;6&lt;/param&gt;
			&lt;param name="maxLength"&gt;16&lt;/param&gt;
			&lt;message&gt;密码长度应在6~16个字符之间&lt;/message&gt;
		&lt;/field-validator&gt;
	&lt;/field&gt;
	&lt;field name="age"&gt;
		&lt;field-validator type="int"&gt;
			&lt;param name="min"&gt;1&lt;/param&gt;
			&lt;param name="max"&gt;10&lt;/param&gt;
			&lt;message key="validate.integerValidatorField" &gt;年龄不正确&lt;/message&gt;
		&lt;/field-validator&gt;
	&lt;/field&gt;

	&lt;field name="email"&gt;
		&lt;field-validator type="email"&gt;
			&lt;message key="validate.emailValidatorField" &gt;邮箱不正确&lt;/message&gt;
		&lt;/field-validator&gt;
	&lt;/field&gt;
	&lt;field name="other"&gt;
		&lt;field-validator type="regex"&gt;
		&lt;param name="expression"&gt;.*\.txt&lt;/param&gt;
		&lt;message key="正则表达式" /&gt;
		&lt;/field-validator&gt;
	&lt;/field&gt;
	
&lt;/validators&gt;&lt;/span&gt;&lt;span style="font-family:Microsoft YaHei;"&gt;
&lt;/span&gt;</pre>&#13;
<p></p>&#13;
<p><span style="color:#0033CC"></span></p>&#13;
<p><span style="color:#0033CC">第</span><span style="color:#0033CC">3</span><span style="color:#0033CC">步：在</span><span style="color:#0033CC">struts.xml</span><span style="color:#0033CC">文件中配置</span><span style="color:#0033CC">Action</span><span style="color:#0033CC">，<span style="color:#FF6666">在</span></span><span style="color:#FF6666">Action配置中必须有input视图(<span style="color:#3366FF">input视图是验证失败的进入的页面，默认的result是成功的页面</span>）</span></p>&#13;
<pre code_snippet_id="1857819" snippet_file_name="blog_20160830_6_1593795" name="code" class="html">&lt;span style="color:#330033;"&gt;&lt;action name="validate" class="cn.hncu.user.login.User2Action"&gt;
			&lt;span style="color:#FF6600;"&gt;&lt;result name="input"&gt;/index.jsp&lt;/result&gt;&lt;!-- 这个是转向失败的页面 --&gt;
			 &lt;result&gt;/succ.jsp&lt;/result&gt;&lt;!-- 这个是登陆成功失败的页面 --&gt;&lt;/span&gt;
&lt;/action&gt;	&lt;/span&gt;</pre><span style="color:#0033CC">第</span><span style="color:#0033CC">4</span><span style="color:#0033CC">步：添加一个</span><span style="color:#0033CC">jsp</span><span style="color:#0033CC">页面</span><span style="color:#0033CC">loginvalidate.jsp</span><span style="color:#0033CC">，放入一个</span><span style="color:#0033CC">struts</span><span style="color:#0033CC">标签</span>（导入s标签）&#13;
<p><span style="color:#0033CC"></span></p>&#13;
<pre code_snippet_id="1857819" snippet_file_name="blog_20160830_7_4516753" name="code" class="html">&lt;span style="font-size:12px;color:#330099;"&gt;	&lt;span style="font-family:Microsoft YaHei;color:#330033;"&gt;&lt;form action="validate"&gt;
   	   &lt;s:fielderror /&gt;
   		Name&lt;input type="text" name="name"&gt;&lt;br/&gt;
   		Pwd&lt;input type="text" name="pwd"&gt;&lt;br/&gt;
   		age&lt;input type="text" name="age"&gt;&lt;br/&gt;
   		email&lt;input type="text" name="email"&gt;&lt;br/&gt;
   		other&lt;input type="text" name="other"&gt;&lt;br/&gt;
   		&lt;input type="submit" value="登录"&gt;&lt;br/&gt;
   	&lt;/form&gt;&lt;/span&gt;&lt;/span&gt;</pre><br />&#13;
<p></p>&#13;
<p><span style="color:#0033CC"><br />&#13;
</span></p>&#13;
<h2><span style="color:#0033CC"></span>&#13;
</h2><p><span style="color:#0033CC">基础的</span><span style="color:#0033CC">Struts2</span><span style="color:#0033CC">输入校验规则：</span></p>&#13;
<p><span style="color:#0033CC"><br />&#13;
</span></p>&#13;
&#13;
<p><span style="font-size:18px"><span style="color:black"><span style="color:black"></span></span></span></p>&#13;
<p><span style="color:black"><span style="color:black"></span></span></p>&#13;
<p><span style="color:black"><span style="color:black"><span style="color:black"></span></span></span></p>&#13;
<p><span style="color:#CC0000"></span></p>&#13;
<p><span style="font-family:Microsoft YaHei; font-size:14px"></span></p>&#13;
<p><span style="color:#0033CC"></span></p>&#13;
<pre code_snippet_id="1857819" snippet_file_name="blog_20160830_8_579256" name="code" class="html">&lt;validators&gt;

    对必填校验

    &lt;field name="name"&gt;

        &lt;field-validator type="required"&gt;

            &lt;message&gt;必填内容&lt;/message&gt;

        &lt;/field-validator&gt;

    &lt;/field&gt;

    必填字符串校验

    &lt;field name="name"&gt;

        &lt;field-validator type="requiredstring"&gt;

            &lt;param name="trim"&gt;true&lt;/param&gt;

            &lt;message&gt;字符串必填校验&lt;/message&gt;

        &lt;/field-validator&gt;

    &lt;/field&gt;

    对int类型的校验

    &lt;fieldname = age "&gt;

        &lt;field-validator type="int"&gt;

            &lt;paramname = min "&gt;
                1
            &lt;/param&gt;

                &lt;paramname = max "&gt;
                    100
                &lt;/param&gt;

                    &lt;message key="年龄不正确" /&gt;

        &lt;/field-validator&gt;

    &lt;/field&gt;

        对日期的校验

        &lt;field name="dta"&gt;

            &lt;field-validator type="date"&gt;

                &lt;param name="min"&gt;01/01/1990&lt;/param&gt;

                &lt;param name="max"&gt;01/01/2000&lt;/param&gt;

                &lt;message key="日期不正确" /&gt;

            &lt;/field-validator&gt;

        &lt;/field&gt;

        对email的校验

        &lt;field name="email"&gt;

            &lt;field-validator type="email"&gt;

                &lt;message key="email不正确" /&gt;

            &lt;/field-validator&gt;

        &lt;/field&gt;

        对URL的校验

        &lt;field name="url"&gt;

            &lt;field-validator type="url"&gt;

                &lt;message key="ulr不正确" /&gt;

            &lt;/field-validator&gt;

        &lt;/field&gt;

        对字符串长度的校验

        &lt;field name="stringLengthValidatorField"&gt;

            &lt;field-validator type="stringlength"&gt;

                &lt;param name="maxLength"&gt;4&lt;/param&gt;

                &lt;param name="minLength"&gt;2&lt;/param&gt;

                &lt;paramname = trim "&gt;
                    true
                &lt;/param&gt;

                    &lt;message key="validate.stringLengthValidatorField" /&gt;

            &lt;/field-validator&gt;

        &lt;/field&gt;

        对正则表达式的校验

        &lt;field name="regexValidatorField"&gt;

            &lt;field-validator type="regex"&gt;

                &lt;paramname = expression "&gt;
                    .*\.txt
                &lt;/param&gt;

                    &lt;message key="validate.regexValidatorField" /&gt;

            &lt;/field-validator&gt;

        &lt;/field&gt;
&lt;/validators&gt;


</pre><br />&#13;
<br />&#13;
<p></p>&#13;
</blockquote>&#13;
<h2><span style="font-size:18px"><span style="color:black"><span style="color:black"></span></span></span>&#13;
</h2><p><span style="color:black"><span style="color:black"></span></span></p>&#13;
<p><span style="color:black"><span style="color:black"><span style="color:black"></span></span></span></p>&#13;
<p><span style="color:#CC0000"></span></p>&#13;
<p><span style="font-family:Microsoft YaHei; font-size:14px">10.<span style="color:black">Struts2</span><span style="color:black">拦截器</span></span><br />&#13;
</p>&#13;
&#13;
<blockquote></blockquote>&#13;
<blockquote><br />&#13;
<br />&#13;
<p><span style="font-size:18px"><span style="color:black"><span style="color:black"></span></span></span></p>&#13;
<p><span style="color:black"><span style="color:black"></span></span></p>&#13;
<p><span style="color:black"><span style="color:black"><span style="color:black"></span></span></span></p>&#13;
<p><span style="color:#CC0000"></span></p>&#13;
<p><span style="font-family:Microsoft YaHei; font-size:14px"></span></p>&#13;
<p><span style="color:black">  <span style="font-size:12px">   </span></span><span style="font-size:12px">拦截器，在<span style="color:black">AOP</span><span style="color:black">（</span><span style="color:black">Aspect-Oriented Programming</span><span style="color:black">）中用于</span><span style="color:#0033CC">在某个方法或字段被访问之前，进行拦截然后在之前或之后加入某些操作</span><span style="color:black">。拦截是</span><span style="color:black">AOP</span><span style="color:black">的一种实现策略。</span></span></p>&#13;
<p><span style="font-size:12px; color:black">     </span><span style="font-size:12px">Struts 2<span style="color:black">拦截器是</span><span style="color:#0033CC">动态拦截</span><span style="color:#0033CC">Action</span><span style="color:#0033CC">调用的对象</span><span style="color:black">。它提供了一种机制，使开发者可以定义一个特定的功能模块，这个模块可以</span><span style="color:#0033CC">在</span><span style="color:#0033CC">Action</span><span style="color:#0033CC">执行之前或者之后运行</span><span style="color:black">，也可以在一个</span><span style="color:black">Action</span><span style="color:black">执行之前阻止</span><span style="color:black">Action</span><span style="color:black">执行。同时也提供了一种可以提取</span><span style="color:black">Action</span><span style="color:black">中可重用的部分的方式。</span></span></p>&#13;
<p><span style="font-size:12px; color:black">      </span><span style="font-size:12px">拦截器（<span style="color:black">Interceptor</span><span style="color:black">）是</span><span style="color:black">Struts 2</span><span style="color:black">的核心组成部分。</span><span style="color:#0033CC">很多功能都是构建在拦截器基础之上的，例如文件的上传和下载、国际化、转换器和数据校验等</span><span style="color:black">，</span><span style="color:black">Struts&#13;
 2</span><span style="color:black">利用内建的拦截器，完成了框架内的大部分操作。</span></span></p>&#13;
<p><span style="font-size:12px; color:black">      </span><span style="font-size:12px; color:black">Struts2</span><span style="font-size:12px; color:black">的拦截器</span><span style="font-size:12px; color:#0033CC">和</span><span style="font-size:12px; color:#0033CC">Servlet</span><span style="font-size:12px; color:#0033CC">过滤器类似</span><span style="font-size:12px; color:black">。在</span><span style="font-size:12px; color:#0033CC">执行</span><span style="font-size:12px; color:#0033CC">Action</span><span style="font-size:12px; color:#0033CC">的</span><span style="font-size:12px; color:#0033CC">execute</span><span style="font-size:12px; color:#0033CC">方法之前</span><span style="font-size:12px; color:black">，</span><span style="font-size:12px; color:black">Struts2</span><span style="font-size:12px; color:black">会首先执行在</span><span style="font-size:12px; color:black">struts.xml</span><span style="font-size:12px; color:black">中引用的拦截器，在执行完所有引用的</span><span style="font-size:12px; color:#0033CC">拦截器的</span><span style="font-size:12px; color:#0033CC">intercept</span><span style="font-size:12px; color:#0033CC">方法</span><span style="font-size:12px; color:black">后，会执行</span><span style="font-size:12px; color:black">Action</span><span style="font-size:12px; color:black">的</span><span style="font-size:12px; color:black">execute</span><span style="font-size:12px; color:black">方法。</span></p>&#13;
<p><span style="font-size:12px; color:black">       </span><span style="font-size:12px">Struts2<span style="color:black">拦截器类</span><span style="color:#0033CC">必须实现</span><span style="color:#0033CC">Interceptor</span><span style="color:#0033CC">接口或继承</span><span style="color:#0033CC">AbstractInterceptor</span><span style="color:#0033CC">类</span><span style="color:black">。</span></span></p>&#13;
<p><span style="font-size:12px; color:black">    </span><span style="font-size:12px">在<span style="color:black">Struts2</span><span style="color:black">中称为</span><span style="color:#333399">拦截器栈</span><span style="color:black">InterceptorStack</span><span style="color:black">。拦截器栈就是将拦截器按一定的顺序联结成一条链。在访问被拦截的方法或字段时，拦截器链中的拦截器就会按其之前定义的顺序依次被调用。</span></span></p>&#13;
<p><span style="font-size:12px"><span style="color:black">使用：<br />&#13;
</span></span></p>&#13;
<span style="font-size:12px"></span><span style="font-size:12px"></span>&#13;
<p><span style="color:black">第</span><span style="color:black">1</span><span style="color:black">步：创建一个拦截器的</span><span style="color:#CC0000">触发页面</span><span style="color:#333399">test_interceptor.jsp</span></p>&#13;
<p><span style="color:black">&lt;%@page language="java" </span><span style="color:black">pageEncoding</span><span style="color:black">="UTF-8"%&gt;</span></p>&#13;
<p><span style="color:black">&lt;%@</span><span style="color:black">taglib</span><span style="color:black">prefix="s"</span><span style="color:black">uri</span><span style="color:black">="/struts-tags"%&gt;</span></p>&#13;
<p><span style="color:black">&lt;html&gt;</span></p>&#13;
<p><span style="color:black">    </span><span style="color:black">&lt;head&gt;&lt;/head&gt;</span></p>&#13;
<p><span style="color:black">    </span>&lt;body&gt;</p>&#13;
<p><span style="color:black">        </span>&lt;<span style="color:black">s:form</span><span style="color:#333399">action="</span><span style="color:#333399">test_interceptor</span><span style="color:#333399">"</span><span style="color:black">&gt;</span></p>&#13;
<p><span style="color:black">            </span>&lt;<span style="color:black">s:textfield</span><span style="color:black"> name="username"label="username"&gt;&lt;/</span><span style="color:black">s:textfield</span><span style="color:black">&gt;</span></p>&#13;
<p><span style="color:black">            </span>&lt;<span style="color:black">s:submit</span><span style="color:black"> name="submit"&gt;&lt;/</span><span style="color:black">s:submit</span><span style="color:black">&gt;</span></p>&#13;
<p><span style="color:black">        </span>&lt;/<span style="color:black">s:form</span><span style="color:black">&gt;</span></p>&#13;
<p><span style="color:black">    </span>&lt;/body&gt;</p>&#13;
<p><span style="color:black">&lt;/html&gt;</span></p>&#13;
<p><span style="color:black">第</span><span style="color:black">2</span><span style="color:black">步：定义</span><span style="color:#333399">拦截器类</span><span style="color:#CC0000">MyInterceptor1.java</span></p>&#13;
<pre code_snippet_id="1857819" snippet_file_name="blog_20160830_9_5105398" name="code" class="html">&lt;span style="color:#330033;"&gt;package com.interceptor;

import com.opensymphony.xwork2.ActionInvocation;
import com.opensymphony.xwork2.interceptor.Interceptor;

public class MyInterceptor1 implements Interceptor {
    public void init() {// 覆盖Interceptor接口中的init函数
        System.out.println("拦截器已经被加载");
    }

    public void destroy() {// 覆盖Interceptor接口中的destroy函数
        System.out.println("destroy");
    }

    /* 覆盖Interceptor接口中的intercept函数 */
    public String intercept(ActionInvocation invocation) throws Exception {
        System.out.println("调用intercept方法");
        /* invocation.invoke()方法检查是否还有拦截器 有的话继续调用余下的拦截器 没有了则执行action的业务逻辑 */
        String result = invocation.invoke();
        return result;
    }
}&lt;/span&gt;</pre>&#13;
<p><span style="color:black">第</span><span style="color:black">3</span><span style="color:black">步：</span><span style="color:#CC0000">Struts2</span><span style="color:#CC0000">配置文件</span><span style="color:black">，</span><span style="color:#333399">拦截器</span><span style="color:black">的映射</span></p>&#13;
<pre code_snippet_id="1857819" snippet_file_name="blog_20160830_10_7231186" name="code" class="html">&lt;span style="color:#330033;"&gt; &lt;package name="myinterceptor" extends="struts-default"&gt;
        &lt;!-- 定义拦截器 --&gt;
        &lt;interceptors&gt;
          &lt;interceptor name="myInterceptor" class="com.interceptor.MyInterceptor1"/&gt;
        &lt;/interceptors&gt;
        &lt;!-- 配置action --&gt;
    &lt;action name="test_interceptor" class="com.action.InterceptorTest"&gt;
            &lt;result name="success"&gt;/interceptorsuccess.jsp&lt;/result&gt;
            &lt;result name="input"&gt;/test_interceptor.jsp&lt;/result&gt;
            &lt;!-- 将声明好的拦截器插入action中 --&gt;
            &lt;interceptor-ref name="myInterceptor" /&gt;
            &lt;interceptor-ref name="defaultStack" /&gt;
        &lt;/action&gt;
    &lt;/package&gt;&lt;/span&gt;</pre><br />&#13;
<p><span style="color:black">第</span><span style="color:black">4</span><span style="color:black">步：通过拦截器后进入</span><span style="color:#333399">Action</span></p>&#13;
<p><span style="color:#333399"></span></p>&#13;
<pre code_snippet_id="1857819" snippet_file_name="blog_20160830_11_1549585" name="code" class="html">package com.action;
import com.opensymphony.xwork2.ActionSupport;
public class  InterceptorTest extends ActionSupport {
    private String username;
    public String getUsername() {
        return username;
    }
    public void setUsername(String username) {
        this.username = username;
    }
    public String execute() throws Exception {
    	 System.out.println("come");
         return SUCCESS;
    }
  
}
</pre><br />&#13;
<p></p>&#13;
<p><span style="color:#333399"><br />&#13;
</span></p>&#13;
<p><span style="color:#333399"></span></p>&#13;
<p><span style="color:#CC0000">在</span><span style="color:#CC0000">Struts2</span><span style="color:#CC0000">中配置自定义的拦截器</span></p>&#13;
<p><span style="color:black">1</span><span style="color:black">、扩展拦截器接口的自定义拦截器配置</span><span style="color:#333399">(</span><span style="color:#333399">实现接口</span><span style="color:#333399">)</span></p>&#13;
<p><span style="color:black">2</span><span style="color:black">、继承抽象拦截器的自定义拦截器配置</span><span style="color:#333399">(</span><span style="color:#333399">继承抽象类</span><span style="color:#333399">)</span></p>&#13;
<p><span style="color:black">注：</span></p>&#13;
<p><span style="color:black">           </span>struts.xml<span style="color:black">配置文件中</span><span style="color:#333399">缺省拦截器栈</span><span style="color:#333399">&lt;default-interceptor-ref &gt;</span><span style="color:#333399">定义</span><span style="color:black">。</span><span style="color:#CC0000">如果定义</span><span style="color:black">则</span><span style="color:#333399">所有</span><span style="color:#333399">Action</span><span style="color:#333399">都会执行</span><span style="color:black">的缺省拦截器栈拦截器，并</span><span style="color:#333399">按照循序从上到下执行</span><span style="color:black">。如果哪个拦截器没有通过则下面拦截器不会执行。</span></p>&#13;
<p><span style="color:black">           </span>如果没有定义缺省拦截器栈，则缺省拦截器栈不起作用。</p>&#13;
<br />&#13;
<br />&#13;
<h2><span style="font-family:Microsoft YaHei; font-size:14px"><span style="font-size:12px"></span></span></h2>&#13;
</blockquote>&#13;
<h1><span style="font-family:Microsoft YaHei; font-size:14px"><span style="font-size:12px"></span></span></h1>&#13;
<h2><span style="font-size:18px">11.<span style="color:black">Struts2</span><span style="color:black">转换器</span></span></h2>&#13;
<h2><br />&#13;
</h2>&#13;
<blockquote>&#13;
<h2><span style="font-family:Microsoft YaHei; font-size:14px"><span style="font-size:12px"><span style="color:black"></span></span></span></h2>&#13;
<p><span style="font-size:18px"><span style="color:black"><span style="color:black"></span></span></span></p>&#13;
<p><span style="color:black"><span style="color:black"></span></span></p>&#13;
<p><span style="color:black"><span style="color:black"><span style="color:black"></span></span></span></p>&#13;
<p><span style="color:#CC0000"></span></p>&#13;
<p><span style="font-family:Microsoft YaHei; font-size:14px"><span style="font-size:12px"></span></span></p>&#13;
<p><span style="color:black">  </span>在<span style="color:black">B/S</span><span style="color:black">中，</span><span style="color:#333399">将字符串请求参数转换为相应的数据类型</span><span style="color:black">，应该是</span><span style="color:black">MVC</span><span style="color:black">框架提供的基本功能。</span><span style="color:black">Struts2</span><span style="color:black">也提供了类型转换功能。</span></p>&#13;
<p><span style="color:black">   </span>在<span style="color:black">Struts2</span><span style="color:black">中分两种转换，一种是</span><span style="color:#333399">局部转换</span><span style="color:black">，另一种是</span><span style="color:#333399">全局类型转换</span><span style="color:black">。具体转换的实施需要一个</span><span style="color:#333399">转换类</span><span style="color:black">和一个</span><span style="color:#333399">自定义类</span><span style="color:black">。</span></p>&#13;
<p><span style="color:black">  </span>1<span style="color:black">、局部类型转换</span></p>&#13;
<p><span style="color:black">    </span>对于<span style="color:#333399">int,long,double,char,float</span><span style="color:#333399">等基本类型</span><span style="color:black">，</span><span style="color:black">Struts2</span><span style="color:black">会</span><span style="color:#333399">自动完成类型转换</span><span style="color:black">，像</span><span style="color:black">age</span><span style="color:black">年龄，在输入页面是</span><span style="color:black">String</span><span style="color:black">型的，到</span><span style="color:black">Action</span><span style="color:black">后会自动转换成</span><span style="color:black">int</span><span style="color:black">型。而如果是</span><span style="color:#333399">转换成其它类类型</span><span style="color:black">的话，就</span><span style="color:#333399">需要自定义类型转换</span><span style="color:black">。这样就需要一个</span><span style="color:#333399">自定义类</span><span style="color:black">。要定义一个转换类，需要</span><span style="color:#333399">继承</span><span style="color:#333399">ognl.DefaultTypeConverter</span><span style="color:black">这个类&#13;
 ，这是个类型转换的类。</span></p>&#13;
使用：&#13;
<p><span style="font-family:Microsoft YaHei; font-size:14px"><span style="font-size:12px"></span></span></p>&#13;
<p><span style="color:black">第</span><span style="color:black">1</span><span style="color:black">步： 编写转换类</span><span style="color:#333399">UserConverter.java</span></p>&#13;
<p><span style="color:#333399"></span></p>&#13;
<pre code_snippet_id="1857819" snippet_file_name="blog_20160830_12_1756545" name="code" class="html">package cn.hncu.domain;

import java.lang.reflect.Member;
import java.util.Map;

import com.opensymphony.xwork2.conversion.impl.DefaultTypeConverter;


public class UserConverter extends DefaultTypeConverter{

    @Override
    public Object convertValue(Map&lt;String, Object&gt; context, Object value,
            Class toType) {
        if (User.class == toType) { 
            User user = new User();
            String[] str = (String[]) value;
            String[] values = str[0].split(",");
            user.setName(values[0]);
            user.setAge(Integer.valueOf(values[1]));
            return user;
        }
        if (String.class == toType) {
            User User = (User) value;
            return User.toString();
        }
        return null;
    }

    

}
</pre><br />&#13;
<span style="color:black">第</span><span style="color:black">2</span><span style="color:black">步： 编写</span><span style="color:black">User</span><span style="color:black">类</span>&#13;
<p></p>&#13;
<p><span style="color:#333399"><span style="color:black"></span></span></p>&#13;
<pre code_snippet_id="1857819" snippet_file_name="blog_20160830_13_6074943" name="code" class="html">package cn.hncu.domain;

public class User {
	private String name;
	private Integer age;
	public String getName() {
		return name;
	}
	public void setName(String name) {
		this.name = name;
	}
	public Integer getAge() {
		return age;
	}
	public void setAge(Integer age) {
		this.age = age;
	}
	@Override
	public String toString() {
		return name +","+ age ;
	}
	
	
}
</pre><br />&#13;
<p></p>&#13;
<p><span style="color:black">第</span><span style="color:black">3</span><span style="color:black">步： 编写</span><span style="color:black">Action</span><span style="color:black">类。</span><span style="color:black">TypeConverterAction.java</span></p>&#13;
<pre code_snippet_id="1857819" snippet_file_name="blog_20160830_14_949750" name="code" class="html">package cn.hncu.domain;

import com.opensymphony.xwork2.ActionSupport;

public class TypeConverterAction extends ActionSupport{
    User user;

    public User getUser() {
        return user;
    }

    public void setUser(User user) {
        this.user = user;
    }
    @Override
    public String execute() throws Exception {
        System.out.println(user);
        return SUCCESS;
    }
    
}</pre><br />&#13;
<p><span style="color:black">第</span><span style="color:black">4</span><span style="color:black">步：</span><span style="color:#333399">编写转换属性文件</span><span style="color:black">。</span><span style="color:#CC0000">TypeConverterAction</span><span style="color:#333399">-conversion.properties</span></p>&#13;
<p><span style="color:black">内容为：user</span><span style="color:black">=</span><font color="black">com.converter.<font size="4"><font color="black"><font color="black"><font color="black"><font color="black"><font color="black"><font color="black"><span style="color:black"><span style="color:#CC0000"><span style="font-family:Microsoft YaHei; font-size:14px"><span style="font-size:12px"><span style="color:#333399"><span style="color:black">User</span></span></span></span></span></span></font></font></font></font></font></font></font>Converter</font></p>&#13;
<p><span style="color:black">自定义类、转换类、</span><span style="color:black">action</span><span style="color:black">都创建好之后，要创建一个属性文件，放置在与</span><span style="color:black">action</span><span style="color:black">在同一包。该属性文件名为：</span><span style="color:#CC0000">action</span><span style="color:#CC0000">文件名</span><span style="color:black">-</span><span style="color:#333399">conversion.properties</span><span style="color:black">。文件中的内容如下：</span></p>&#13;
<p><span style="color:black">  </span><font size="4"><font color="black"><font color="black"><font color="black"><font color="black"><font color="black"><font color="black"><span style="color:black"><span style="color:#CC0000"><span style="font-family:Microsoft YaHei; font-size:14px"><span style="font-size:12px"><span style="color:#333399"><span style="color:black">user</span></span></span></span></span></span></font></font></font></font></font></font></font><span style="color:#333399">=</span><span style="color:#333399">转换类名</span><span style="color:black"> &#13;
</span>即<font size="4"><font color="black"><font color="black"><font color="black"><font color="black"><font color="black"><font color="black"><span style="color:black"><span style="color:#CC0000"><span style="font-family:Microsoft YaHei; font-size:14px"><span style="font-size:12px"><span style="color:#333399"><span style="color:black"></span></span></span></span></span></span></font></font></font></font></font></font></font>user=cn.hncu.domain.UserConverter<span style="color:black"></span></p>&#13;
<p><span style="color:black">     </span><span style="color:black">注意：</span></p>&#13;
<p><span style="color:black">(1)  </span><font size="4"><font color="black"><font color="black"><font color="black"><font color="black"><font color="black"><font color="black"><span style="color:black"><span style="color:#CC0000"><span style="font-family:Microsoft YaHei; font-size:14px"><span style="font-size:12px"><span style="color:#333399"><span style="color:black">user</span></span></span></span></span></span></font></font></font></font></font></font></font><span style="color:#CC0000">是</span><span style="color:#CC0000">Action</span><span style="color:#CC0000">的一个属性</span><span style="color:black">，转换类指明所使用哪个</span><span style="color:#333399">转换类</span><span style="color:black">对此</span><span style="color:#333399">属性</span><span style="color:black">进行转换。</span></p>&#13;
<p><span style="color:black">(2)</span><span style="color:black">有</span><span style="color:#CC0000">两种类型的转换器</span><span style="color:black">：一是</span><span style="color:#333399">局部类型</span><span style="color:black">转换器。仅仅</span><u><span style="color:#333399">对某个</span><span style="color:#333399">Action</span><span style="color:#333399">的属性</span></u><span style="color:black">起作用。属性</span><span style="color:#CC0000">文件名：</span><span style="color:#CC0000">ActionName-conversion.properties</span><span style="color:black">。内容：属性名</span><span style="color:black">=</span><span style="color:black">类型转换器类</span><span style="color:black">,</span><span style="color:black">如</span><span style="color:black">date=</span><span style="color:black">com.DateConverter</span><span style="color:black">。存放位置与</span><span style="color:black">ActionName</span><span style="color:black">类相同路径。二是</span><span style="color:#333399">全局类型</span><span style="color:black">转换器。对</span><u><span style="color:#333399">所有</span><span style="color:#333399">Action</span><span style="color:#333399">的特定类型的属性</span></u><span style="color:black">都会生效。属性</span><span style="color:#CC0000">文件名</span><span style="color:#CC0000">:</span><span style="color:#CC0000">xwork-conversion.properties</span><span style="color:black">。内容如</span><span style="color:black">java.util.Date</span><span style="color:black">=</span><span style="color:black">com.DateConverter</span><span style="color:black">.</span><span style="color:black">存放位置为</span><span style="color:black">WEB-INF/classes/</span><span style="color:black">目录下</span><span style="color:black">。</span></p>&#13;
<br />&#13;
<p><span style="color:black">第</span><span style="color:black">5</span><span style="color:black">步：编写</span><span style="color:#333399">JSP</span><span style="color:#333399">页面</span><span style="color:black">。</span></p>&#13;
<p><span style="color:black"></span></p>&#13;
<pre code_snippet_id="1857819" snippet_file_name="blog_20160830_15_8299790" name="code" class="html">&lt;form action="converter" method="post"&gt;
	   		user&lt;input type="text" name="user"&gt;&lt;br/&gt;
   		&lt;input type="submit" value="登录"&gt;&lt;br/&gt;
&lt;/form&gt;</pre><br />&#13;
<br />&#13;
<p></p>&#13;
<p><span style="color:#CC0000">类型转换的流程</span><span style="color:#CC0000">:</span></p>&#13;
<p><span style="color:black">    </span>1<span style="color:black">、用户进行请求，根据请求名在</span><span style="color:#333399">struts.xml</span><span style="color:#333399">中寻找</span><span style="color:#333399">Action</span><span style="color:black">。</span></p>&#13;
<p><span style="color:black">    </span>2<span style="color:black">、在</span><span style="color:black">Action</span><span style="color:black">中，根据请求域中的名字去</span><span style="color:#333399">寻找对应的</span><span style="color:#333399">set</span><span style="color:#333399">方法</span><span style="color:black">。找到后在赋值之前会检查这个属性有没有自定义的类型转换。没有的话，按照默认进行转换；如果某个属性已经定义好了类型转换，则会去</span><span style="color:#333399">检查</span><span style="color:black">在</span><span style="color:black">Action</span><span style="color:black">同一目录下的</span><span style="color:#333399">action</span><span style="color:#333399">文件名</span><span style="color:#333399">-</span><span style="color:#333399">conversion.properties</span><span style="color:#333399">文件</span><span style="color:black">。</span></p>&#13;
<p><span style="color:black">    </span>3<span style="color:black">、从文件中</span><span style="color:#333399">找到要转换的属性及其转换类</span><span style="color:black">。</span></p>&#13;
<p><span style="color:black">    </span>4<span style="color:black">、然后</span><span style="color:#333399">进入转换类中</span><span style="color:black">，在此类中判断转换的方向。我们是先从用户请求开始的，所以这时先进入从字符串到类的转换。返回转换后的对象。流程返回</span><span style="color:black">Action</span><span style="color:black">。</span></p>&#13;
<p><span style="color:black">    </span>5<span style="color:black">、将返回的对象赋值给</span><span style="color:black">Action</span><span style="color:black">中的属性，</span><span style="color:#333399">执行</span><span style="color:#333399">Action</span><span style="color:#333399">中的</span><span style="color:#333399">execute()</span><span style="color:black">。</span></p>&#13;
<p><span style="color:black"> 6</span><span style="color:black">、执行完</span><span style="color:black">execute()</span><span style="color:black">方法，</span><span style="color:#333399">根据</span><span style="color:#333399">struts.xml</span><span style="color:#333399">的配置转向页面</span><span style="color:black">。</span></p>&#13;
<p><span style="color:black">    </span>7<span style="color:black">、在</span><span style="color:black">jsp</span><span style="color:black">中显示内容时，根据页面中的属性名去</span><span style="color:#333399">调用相应的</span><span style="color:#333399">get</span><span style="color:#333399">方法</span><span style="color:black">，以便输出。</span></p>&#13;
<p><span style="color:black">    </span>8<span style="color:black">、在调用</span><span style="color:black">get</span><span style="color:black">方法之前，</span><span style="color:#333399">会检查有没有此属性的自定义类型转换</span><span style="color:black">。如果有，</span><span style="color:#333399">再次跳转到转换类</span><span style="color:black">当中。</span></p>&#13;
<p><span style="color:black">    </span>9<span style="color:black">、在转换类中再次判断转换方向，进入由类到字符串的转换，</span><span style="color:#333399">完成转换后返回字符串</span><span style="color:black">。</span></p>&#13;
<p><span style="color:black">    </span>10<span style="color:black">、将返回的值</span><span style="color:#333399">直接带出到要展示的页面</span><span style="color:black">当中去显示。</span></p>&#13;
</blockquote>&#13;
<h2><span style="font-size:18px"><span style="color:black"><span style="color:black"></span></span></span>&#13;
</h2><p><span style="color:black"><span style="color:black"></span></span></p>&#13;
<p><span style="color:black"><span style="color:black"><span style="color:black"></span></span></span></p>&#13;
<p><span style="color:#CC0000"></span></p>&#13;
<p><span style="font-family:Microsoft YaHei; font-size:14px"><span style="font-size:12px"></span></span></p>&#13;
<p><span style="font-size:24px; color:#330033">12.Struts2国际化(1)</span><br />&#13;
</p>&#13;
&#13;
<blockquote>&#13;
<p><span style="font-size:18px"><span style="color:black"><span style="color:black"></span></span></span></p>&#13;
<p><span style="color:black"><span style="color:black"></span></span></p>&#13;
<p><span style="color:black"><span style="color:black"><span style="color:black"></span></span></span></p>&#13;
<p><span style="color:#CC0000"></span></p>&#13;
<p><span style="font-family:Microsoft YaHei; font-size:14px"><span style="font-size:12px"></span></span></p>&#13;
<p><span style="color:#333399"></span></p>&#13;
<p><span style="color:black">   </span><span style="color:black"> </span><span style="color:#333399">所谓国际化</span><u><span style="color:black">是指你的</span><span style="color:black">web</span><span style="color:black">系统，在不同国家或地区被访问，其中的一些主要信息</span></u><span style="color:black">，如注册信息中字段，错误信息提示等</span><u><span style="color:black">显示结果应该与该地区或国家语言相同</span></u><span style="color:black">。这样用户很好理解你的网页。</span></p>&#13;
<p><span style="color:black">    </span>Web<span style="color:black">系统国际化</span><span style="color:#333399">通过两步</span><span style="color:black">来完成。</span><span style="color:#333399">第一</span><span style="color:black">通过将文字内容以特定的方式</span><span style="color:#333399">存放在特定的文件</span><span style="color:black">中。</span><span style="color:#333399">第二</span><span style="color:black">，在运行时根据当前的语言环境</span><span style="color:#333399">决定从哪个文件中读取</span><span style="color:black">文字内容。</span></p>&#13;
<p><span style="color:black">     </span>Java<span style="color:black">中国际化的概念是将不同国家的语言描述的相同的东西放在各自对应的属性文件中，如果这个文件的名字叫做</span><span style="color:black">Message</span><span style="color:black">，那么对应语言的文件分别为：</span></p>&#13;
<p><span style="color:#333399">中文中国 </span><span style="color:#333399">message_zh_CN.properties</span></p>&#13;
<p><span style="color:#333399">日文日本</span><span style="color:#333399">message_ja_JP.properties</span></p>&#13;
<p><span style="color:#333399">英文美国</span><span style="color:#333399">message_en_US.properties</span></p>&#13;
<p><span style="color:#333399"> </span>1<span style="color:#333399">、</span><span style="color:#333399">JSP</span><span style="color:#333399">页面上的国际化</span></p>&#13;
<p><span style="color:black"> </span><span style="color:black">&lt;s:i18n name="message"&gt;</span></p>&#13;
<p><span style="color:black">  </span>&lt; !-- key="hello"<span style="color:black">依据读取资源文件中的</span><span style="color:black">hello</span><span style="color:black">关键字对应的内容</span><span style="color:black">,</span><span style="color:#333399">{0}</span><span style="color:#333399">表示第一个参数输出位置即</span><span style="color:#333399">${username}</span><span style="color:#333399">在这里输出</span><span style="color:black">--&gt;</span></p>&#13;
<p><span style="color:black"> &lt;s:text key="hello"&gt;</span></p>&#13;
<p><span style="color:black">   &lt;s:param&gt;${username}&lt;/s:param&gt;</span></p>&#13;
<p><span style="color:black"> &lt;/s:text&gt;</span></p>&#13;
<p><span style="color:black"> </span>&lt;/s:i18n&gt;</p>&#13;
<p><span style="color:#333399">中英文资源如下：</span></p>&#13;
<p><span style="color:#669900">     </span><span style="color:#669900">message_en_US.properties</span><span style="color:#669900">文件配置</span><span style="color:#669900">:</span></p>&#13;
<p><span style="color:#669900">     </span>hello=hello world,{0}</p>&#13;
<p><span style="color:#D60093">     </span>message_zh_CN.properties<span style="color:#D60093">文件配置</span><span style="color:#D60093">:</span></p>&#13;
<p><span style="color:#D60093">     </span>hello=<span style="color:#D60093">你好</span><span style="color:#D60093">,{0}</span></p>&#13;
<p><span style="color:#333399">2</span><span style="color:#333399">、表单元素的</span><span style="color:#333399">Label</span><span style="color:#333399">国际化</span></p>&#13;
<p><span style="color:#333399">未国际化</span><span style="color:#333399">:</span></p>&#13;
<p><span style="color:black">&lt;</span><span style="color:black">s:textfield</span><span style="color:black">name="username" label="username"&gt;&lt;/</span><span style="color:black">s:textfield</span><span style="color:black">&gt;</span></p>&#13;
<p><span style="color:black">&lt;</span><span style="color:black">s:textfield</span><span style="color:black">name="password" label="password"&gt;&lt;/</span><span style="color:black">s:textfield</span><span style="color:black">&gt;</span></p>&#13;
<p><span style="color:#333399">国际化后</span><span style="color:#333399">:</span></p>&#13;
<p><span style="color:black">&lt;</span><span style="color:black">s:textfield</span><span style="color:black">name="username" key="</span><span style="color:black">uname</span><span style="color:black">"&gt;&lt;/</span><span style="color:black">s:textfield</span><span style="color:black">&gt;</span></p>&#13;
<p><span style="color:black">&lt;</span><span style="color:black">s:textfield</span><span style="color:black">name="password" key="</span><span style="color:black">pword</span><span style="color:black">"&gt;&lt;/</span><span style="color:black">s:textfield</span><span style="color:black">&gt;</span></p>&#13;
<p><span style="color:#333399">中英文资源如下：</span></p>&#13;
<p><span style="color:#669900">message_en_US.properties</span><span style="color:#669900">文件</span><span style="color:#669900">,</span><span style="color:#669900">配置</span><span style="color:#669900">:</span></p>&#13;
<p><span style="color:#669900">uname=username</span></p>&#13;
<p><span style="color:#669900">pword=password</span></p>&#13;
<p><span style="color:#9966FF">message_zh_CN.properties</span><span style="color:#9966FF">文件</span><span style="color:#9966FF">,</span><span style="color:#9966FF">配置</span><span style="color:#9966FF">:</span></p>&#13;
<p><span style="color:#9966FF">uname=</span><span style="color:#9966FF">用户名</span></p>&#13;
<p><span style="color:#9966FF">pword=</span><span style="color:#9966FF">密码</span></p>&#13;
<p><span style="color:#333399">3</span><span style="color:#333399">、</span><span style="color:#333399">Action</span><span style="color:#333399">中的国际化</span></p>&#13;
<p><span style="color:#333399">未国际化</span><span style="color:#333399">:</span></p>&#13;
<p><span style="color:black">this.addFieldError("username","the username error!");</span></p>&#13;
<p><span style="color:black">this.addFieldError("password","the password error!");</span></p>&#13;
<p><span style="color:#333399">国际化后</span><span style="color:#333399">:</span></p>&#13;
<p><span style="color:black">this.addFieldError("username","</span><span style="color:#0033CC">username.error</span><span style="color:black">");</span></p>&#13;
<p><span style="color:black">this.addFieldError("password","</span><span style="color:#0033CC">password.error</span><span style="color:black">");</span></p>&#13;
<p><span style="color:#333399">中英文资源如下：</span></p>&#13;
<p><span style="color:#669900">message_en_US.properties</span><span style="color:#669900">文件配置</span><span style="color:#669900">:</span></p>&#13;
<p><span style="color:#669900">username.error</span><span style="color:#669900"> = the username error !</span></p>&#13;
<p><span style="color:#669900">password.error</span><span style="color:#669900"> = the password error!</span></p>&#13;
<p><span style="color:#9966FF">message_zh_CN.properties</span><span style="color:#9966FF">文件配置</span><span style="color:#9966FF">:</span></p>&#13;
<p><span style="color:#9966FF">username.error</span><span style="color:#9966FF">=</span><span style="color:#9966FF">用户名错误</span><span style="color:#9966FF">!</span></p>&#13;
<p><span style="color:#9966FF">username.error</span><span style="color:#9966FF">=</span><span style="color:#9966FF">密码错误</span><span style="color:#9966FF">!</span></p>&#13;
<p><span style="color:#0033CC"> </span>4<span style="color:#0033CC">、配置文件中的国际化。</span><span style="color:black">以输入校验的</span><span style="color:black">LoginAction-validation.xml</span><span style="color:black">为例</span><span style="color:black">:</span></p>&#13;
<p><span style="color:black">&lt;fieldname="username"&gt;</span></p>&#13;
<p><span style="color:black">    &lt;field-validator type="</span><span style="color:black">requiredstring</span><span style="color:black">"&gt;</span></p>&#13;
<p><span style="color:black">      </span><span style="color:black">&lt;paramname="trim"&gt;true&lt;/param&gt;</span></p>&#13;
<p><span style="color:black">      </span><span style="color:black">&lt;messagekey="</span><span style="color:#0033CC">username.empty</span><span style="color:black">"&gt;&lt;/message&gt;</span></p>&#13;
<p><span style="color:black">    &lt;/field-validator&gt;</span></p>&#13;
<p><span style="color:black">    &lt;field-validator type="</span><span style="color:black">stringlength</span><span style="color:black">"&gt;</span></p>&#13;
<p><span style="color:black">      &lt;</span><span style="color:black">param</span><span style="color:black">name="</span><span style="color:black">minLength</span><span style="color:black">"&gt;6&lt;/</span><span style="color:black">param</span><span style="color:black">&gt;</span></p>&#13;
<p><span style="color:black">      &lt;</span><span style="color:black">param</span><span style="color:black">name="</span><span style="color:black">maxLength</span><span style="color:black">"&gt;12&lt;/</span><span style="color:black">param</span><span style="color:black">&gt;</span></p>&#13;
<p><span style="color:black">      &lt;message key="</span><span style="color:#0033CC">username.size</span><span style="color:black">"&gt;&lt;/message&gt;</span></p>&#13;
<p><span style="color:black">    &lt;/field-validator&gt;</span></p>&#13;
<p><span style="color:black">&lt;/field&gt;</span></p>&#13;
<br />&#13;
<br />&#13;
</blockquote>&#13;
<p><span style="font-size:18px"><span style="color:black"><span style="color:black"></span></span></span></p>&#13;
<p><span style="color:black"><span style="color:black"></span></span></p>&#13;
<p><span style="color:black"><span style="color:black"><span style="color:black"></span></span></span></p>&#13;
<p><span style="color:#CC0000"></span></p>&#13;
<p><strong><span style="font-family:Microsoft YaHei; font-size:24px"></span></strong></p>&#13;
<p><span style="color:#333399">13.<span style="color:black">Struts2</span><span style="color:black">上传下载</span></span></p>&#13;
<br />&#13;
<blockquote>&#13;
<p><span style="font-size:18px"><span style="color:black"><span style="color:black"></span></span></span></p>&#13;
<p><span style="color:black"><span style="color:black"></span></span></p>&#13;
<p><span style="color:black"><span style="color:black"><span style="color:black"></span></span></span></p>&#13;
<p><span style="color:#CC0000"></span></p>&#13;
<p><span style="font-family:Microsoft YaHei; font-size:14px"><span style="font-size:12px"></span></span></p>&#13;
<p><span style="color:#333399"></span></p>&#13;
<p><span style="color:black">      </span>Struts2<span style="color:black">并未提供自己的请求解析器，也就是就</span><span style="color:black">Struts2</span><span style="color:#333399">不会自己去处理</span><span style="color:#333399">multipart/form-data</span><span style="color:#333399">的请求</span><span style="color:black">，它需要</span><span style="color:#333399">调用其他请求解析器</span><span style="color:black">，将</span><span style="color:black">HTTP</span><span style="color:black">请求中的表单域解析出来。但</span><span style="color:black">Struts2</span><span style="color:black">在原有的上传解析器基础上做了进一步封装，更进一步简化了文件上传。</span></p>&#13;
<p><span style="color:black">      </span><span style="color:black">Struts2</span><span style="color:black">默认使用的是</span><span style="color:black">Jakarta</span><span style="color:black">的</span><span style="color:#333399">Common-</span><span style="color:#333399">FileUpload</span><span style="color:#333399">框架</span><span style="color:black">来上传文件，因此，要在</span><span style="color:black">web</span><span style="color:black">应用中</span><span style="color:#333399">增加两个</span><span style="color:#333399">Jar</span><span style="color:#333399">文件</span><span style="color:black">：</span><span style="color:#669900">commons-fileupload-1.2.jar</span><span style="color:black">和</span><span style="color:#669900">commons-io-1.3.1.jar</span><span style="color:black">。</span></p>&#13;
<p><span style="font-size:18px">文件上传：</span></p>&#13;
<p><span style="font-size:18px">1.写一个Action类</span></p>&#13;
<p><span style="font-size:18px">FileUploadAction.java<br />&#13;
</span></p>&#13;
<p><span style="font-size:18px"></span></p><pre code_snippet_id="1857819" snippet_file_name="blog_20160831_16_2022755" name="code" class="html">&lt;span style="font-size:14px;"&gt;package cn.hncu.file;
import java.io.*;
import org.apache.struts2.ServletActionContext;
import com.opensymphony.xwork2.ActionSupport;

public class FileUploadAction extends ActionSupport {
	private static final int BUFFER_SIZE = 16 * 1024;
	private String title; // 文件标题
	private File upload; // 上传文件域对象
	private String uploadFileName; // 上传文件名
	private String uploadContentType; // 上传文件类型

	private String savePath; // 保存文件的目录路径(通过依赖注入)
	/* 省略getter和setter... */

	private static void copy(File src, File dst) {
		InputStream in = null;
		OutputStream out = null;
		try {
			in = new BufferedInputStream(new FileInputStream(src), BUFFER_SIZE);
			out = new BufferedOutputStream(new FileOutputStream(dst),
					BUFFER_SIZE);
			byte[] buffer = new byte[BUFFER_SIZE];
			int len = 0;
			while ((len = in.read(buffer)) &gt; 0) {
				out.write(buffer, 0, len);
			}
			in.close();
			out.close();
		} catch (Exception e) {
			e.printStackTrace();
		}
	}

	public String execute() throws Exception {
		// 根据服务器的文件保存地址和原文件名创建目录文件全路径
		String dstPath = ServletActionContext.getServletContext().getRealPath(
				this.getSavePath())
				+ "/" + this.getUploadFileName();

		System.out.println("上传的文件的类型：" + this.getUploadContentType());
		File dstFile = new File(dstPath);
		copy(this.upload, dstFile);
		return SUCCESS;
	}

	public String getTitle() {
		return title;
	}

	public void setTitle(String title) {
		this.title = title;
	}

	public File getUpload() {
		return upload;
	}

	public void setUpload(File upload) {
		this.upload = upload;
	}

	public String getUploadFileName() {
		return uploadFileName;
	}

	public void setUploadFileName(String uploadFileName) {
		this.uploadFileName = uploadFileName;
	}

	public String getUploadContentType() {
		return uploadContentType;
	}

	public void setUploadContentType(String uploadContentType) {
		this.uploadContentType = uploadContentType;
	}

	public String getSavePath() {
		return savePath;
	}

	public void setSavePath(String savePath) {
		this.savePath = savePath;
	}
}&lt;/span&gt;
</pre><br />&#13;
&#13;
<p><span style="font-size:18px">2.在页面上写jsp代码</span><br />&#13;
<span style="font-size:18px"></span></p>&#13;
<br />&#13;
<pre code_snippet_id="1857819" snippet_file_name="blog_20160831_17_212611" name="code" class="html">&lt;form action="fileUpload " method="POST" enctype="multipart/form-data"&gt; 
        文件标题：&lt;input type="text" name="title" size="50"/&gt;&lt;br/&gt; 
        选择文件：&lt;input type="file" name="upload" size="50"/&gt;&lt;br/&gt; 
       &lt;input type="submit" value=" 上传 "/&gt;       
    &lt;/form&gt; </pre><br />&#13;
<p><span style="font-size:18px">3.写入struts.xml中</span></p>&#13;
<p></p><pre code_snippet_id="1857819" snippet_file_name="blog_20160831_18_3942365" name="code" class="html">&lt;/action&gt;
         	&lt;action name ="fileUpload" class ="cn.hncu.file.FileUploadAction"&gt; 
            &lt;!-- 动态设置Action中的savePath属性的值 --&gt; 
            &lt;param name="savePath"&gt;/upload&lt;/param&gt; 
            &lt;result name ="success"&gt;/index.jsp&lt;/result&gt; 
         &lt;/action&gt;</pre><br />&#13;
<br />&#13;
&#13;
<p><span style="font-size:18px">文件下载：</span></p>&#13;
<p><span style="font-size:18px">1.写一个Action类</span></p>&#13;
<p><span style="font-size:18px">FileDownAction.java在类中写getDownloadFile方法</span></p>&#13;
<p><span style="font-size:18px"></span></p><pre code_snippet_id="1857819" snippet_file_name="blog_20160831_19_9275302" name="code" class="html">package cn.hncu.file;

import java.io.File;
import java.io.FileInputStream;
import java.io.FileNotFoundException;
import java.io.InputStream;

import com.opensymphony.xwork2.ActionSupport;

public class FileDownloadAction extends ActionSupport{
	public InputStream getDownloadFile(){
		File file=new File("G:/a/a.xls");
		FileInputStream fis=null;
		try {
			fis=new FileInputStream(file);
		} catch (FileNotFoundException e) {
			e.printStackTrace();
		}
		return fis;
	}
	@Override
	public String execute() throws Exception {
		return super.execute();
	}
}
</pre><br />&#13;
<br />&#13;
&#13;
<p><span style="font-size:18px">2.在页面写入jsp代码</span></p>&#13;
<p><span style="font-size:18px">&lt;a href="&lt;c:url value='fileDown'/&gt;"&gt;下载&lt;/a&gt;<br />&#13;
</span></p>&#13;
<p><span style="font-size:18px">3.在struts中配置</span></p>&#13;
<p><span style="font-size:18px"></span></p><pre code_snippet_id="1857819" snippet_file_name="blog_20160831_20_1368854" name="code" class="html">&lt;action name="fileDown" class ="cn.hncu.file.FileDownloadAction"&gt;
         	  &lt;result name ="success" type="stream"&gt;
               &lt;param name="contentType"&gt; application/vnd.ms-excel&lt;/param&gt;
               &lt;param name="contentDisposition"&gt;
                  attachment;filename="aa.xls";
               &lt;/param&gt;
               &lt;param name="inputName"&gt;downloadFile&lt;/param&gt;
            &lt;/result&gt; 
         &lt;/action&gt;</pre><br />&#13;
<br />&#13;
&#13;
<span style="font-family:Microsoft YaHei; font-size:14px"><br />&#13;
</span><br />&#13;
<span style="color:black"><span style="color:black"><br />&#13;
</span></span>&#13;
<p><br />&#13;
</p>&#13;
<br />&#13;
<em><strong><span style="color:black"></span></strong></em>&#13;
<p><span style="color:black"><span style="color:black"></span></span></p>&#13;
<p><span style="color:black"> </span><br />&#13;
</p>&#13;
</blockquote>&#13;
<h2>&#13;
</h2><p><br />&#13;
</p>&#13;
&#13;
<p></p>&#13;
<p><span style="color:black"></span></p>&#13;
<p><span style="color:black"><br />&#13;
</span></p>&#13;
<br />&#13;
<p><span style="color:black"><br />&#13;
</span></p>&#13;
<br />&#13;
<p><br />&#13;
<br />&#13;
</p>&#13;
   &#13;
