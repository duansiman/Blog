
        <div class="markdown_views"><p>适用于想要回复某个时间点的数据，类似于数据库的恢复。</p>

<p>类图： <br />
<img src="http://img.blog.csdn.net/20170410083620886?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvcmVucGVuZ2RkeHg=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast" alt="这里写图片描述" title="" /></p>

<p>java实现： <br />
原始类</p>



<pre class="prettyprint"><code class=" hljs cs"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> Originator {

    <span class="hljs-keyword">private</span> String status = <span class="hljs-string">""</span>;

    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">setStatus</span>(String status){
        <span class="hljs-keyword">this</span>.status = status;
    }

    <span class="hljs-keyword">public</span> String <span class="hljs-title">getStatus</span>(){
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.status;
    }

    <span class="hljs-keyword">public</span> Memento <span class="hljs-title">createMemento</span>(){
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> Memento(<span class="hljs-keyword">this</span>.getStatus());
    }

    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">restoreMemento</span>(Memento memento){
        <span class="hljs-keyword">this</span>.setStatus(memento.getStatus());
    }
}
</code></pre>

<p>备忘录类</p>



<pre class="prettyprint"><code class=" hljs cs"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> Memento {

    <span class="hljs-keyword">private</span> String status=<span class="hljs-string">""</span>;

    <span class="hljs-keyword">public</span> <span class="hljs-title">Memento</span>(String status){
        <span class="hljs-keyword">this</span>.status = status;
    }

    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">setStatus</span>(String status){
        <span class="hljs-keyword">this</span>.status = status;
    }

    <span class="hljs-keyword">public</span> String <span class="hljs-title">getStatus</span>(){
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.status;
    }
}</code></pre>

<p>管理类</p>



<pre class="prettyprint"><code class=" hljs cs"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> MementoManager {

    <span class="hljs-keyword">private</span> Memento memento;

    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">setMemento</span>(Memento memento){
        <span class="hljs-keyword">this</span>.memento = memento;
    }

    <span class="hljs-keyword">public</span> Memento <span class="hljs-title">getMemento</span>(){
        <span class="hljs-keyword">return</span> memento;
    }
}</code></pre>

<p>场景类</p>



<pre class="prettyprint"><code class=" hljs cs">ublic class Client {

    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">main</span>(String[] args){
        Originator originator = <span class="hljs-keyword">new</span> Originator();
        MementoManager mementoManager  = <span class="hljs-keyword">new</span> MementoManager();
        mementoManager.setMemento(originator.createMemento());
        originator.restoreMemento(mementoManager.getMemento());
    }
}</code></pre>

<p>php实现</p>

<pre class="prettyprint"><code class=" hljs php"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Originator</span>
{</span>
    <span class="hljs-keyword">private</span> <span class="hljs-variable">$status</span> = <span class="hljs-string">''</span>;

    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">setStatus</span><span class="hljs-params">(<span class="hljs-variable">$status</span>)</span>
    {</span>
        <span class="hljs-variable">$this</span>-&gt;status = <span class="hljs-variable">$status</span>;
    }

    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">getStatus</span><span class="hljs-params">()</span>
    {</span>
        <span class="hljs-keyword">return</span> <span class="hljs-variable">$this</span>-&gt;status;
    }

    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">createMemento</span><span class="hljs-params">()</span>
    {</span>
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> Memento(<span class="hljs-variable">$this</span>-&gt;status);
    }

    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">restorMemento</span><span class="hljs-params">(Memento <span class="hljs-variable">$m</span>)</span>
    {</span>
        <span class="hljs-variable">$this</span>-&gt;setStatus(<span class="hljs-variable">$m</span>-&gt;getStatus());
    }
}


<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Memento</span>
{</span>
    <span class="hljs-keyword">private</span> <span class="hljs-variable">$status</span>;

    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__construct</span><span class="hljs-params">(<span class="hljs-variable">$status</span>)</span>
    {</span>
        <span class="hljs-variable">$this</span>-&gt;status = <span class="hljs-variable">$status</span>;
    }

    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">getStatus</span><span class="hljs-params">()</span>
    {</span>
        <span class="hljs-keyword">return</span> <span class="hljs-variable">$this</span>-&gt;status;
    }
}

<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">MementoManager</span>
{</span>
    <span class="hljs-keyword">private</span> <span class="hljs-variable">$memento</span>;

    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">getMemento</span><span class="hljs-params">()</span>
    {</span>
        <span class="hljs-keyword">return</span> <span class="hljs-variable">$this</span>-&gt;<span class="hljs-variable">$memento</span>;
    }

    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">setMemento</span><span class="hljs-params">(Memento <span class="hljs-variable">$memento</span>)</span>
    {</span>
        <span class="hljs-variable">$this</span>-&gt;memento = <span class="hljs-variable">$memento</span>;
    }
}</code></pre></div>&#13;
        <script type="text/javascript">&#13;
            $(function () {&#13;
                $('pre.prettyprint code').each(function () {&#13;
                    var lines = $(this).text().split('\n').length;&#13;
                    var $numbering = $('&lt;ul/&gt;').addClass('pre-numbering').hide();&#13;
                    $(this).addClass('has-numbering').parent().append($numbering);&#13;
                    for (i = 1; i &lt;= lines; i++) {&#13;
                        $numbering.append($('&lt;li/&gt;').text(i));&#13;
                    };&#13;
                    $numbering.fadeIn(1700);&#13;
                });&#13;
            });&#13;
        </script>&#13;
   &#13;
