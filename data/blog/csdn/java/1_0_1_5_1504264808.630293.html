
<p>1，新建工程，类型为Web Project，设置默认编码为UTF-8，并创建如下文件夹<br /> 1，Source Folder<br />  1，src  项目源码<br />  2，conf  配置文件<br />  3，test  单元测试<br /> 2，普通文件夹<br />  1，WebRoot/style  css与图片等文件<br />  2，WebRoot/script  js脚本文件<br />  3，WebRoot/WEB-INF/jsp jsp页面文件<br /> 3，包结构<br />  1，实体<br />   cn.itcast.oa.domain<br />  2，Dao<br />   cn.itcast.oa.dao   Dao接口<br />   cn.itcast.oa.dao.impl  Dao实现类<br />  3，Service<br />   cn.itcast.oa.service  Service接口<br />   cn.itcast.oa.service.impl Service实现类<br />  4，View(Struts2)<br />   cn.itcast.oa.strtus2.action <br />  5，其他<br />   cn.itcast.oa.cfg   配置<br />   cn.itcast.oa.util   工具类<br />   ...</p><p>2，新建数据库，指定编码为UTF-8。<br />  <br />3，添加jar包（放在 WebRoot/WEB-INF/lib/ 下）<br /> 1，环境为：JDK_1.6、JavaEE_5.0<br /> 2，Junit-4.4：<br />  junit4.4.jar<br /> 3，Struts-2.1.8.1：<br />  1，添加 ${Struts2_Home}/apps/struts2-blank-2.1.8.1.war/WEB-INF/lib/*.jar<br />  2，添加struts2-spring整合插件的jar：${Struts2_Home}/lib/struts2-spring-plugin-2.1.8.1.jar<br /> 4，Hibernate-3.6：<br />  1，添加 ${HIBERNATE_HOME}/hibernate3.jar<br />  2，添加 ${HIBERNATE_HOME}/lib/required/*.jar<br />    ${HIBERNATE_HOME}/lib/jpa/hibernate-jpa-2.0-api-1.0.0.Final.jar<br />  3，添加 JDBC 驱动包，mysql-connector-java-5.1.5-bin.jar<br />  4，添加 slf4j-log4j12-1.5.8.jar、log4j-1.2.15.jar，<br />  5，添加 c3p0-0.9.1.2.jar<br /> 5，Spring 2.5.6<br />  1，添加 ${SPRING_HOME}/dist/spring.jar<br />  2，添加 ${SPRING_HOME}/lib/aspectj/*.jar（共2个）<br />  3，添加 ${SPRING_HOME}/lib/cglib/cglib-nodep-2.1_3.jar<br />  5，添加 ${SPRING_HOME}/lib/jakarta-commons/commons-logging.jar（1.1.1版）<br />  6，添加工具jar包：commons-codec.jar，commons-lang.jar<br /> 6，Jbpm 4.4（带了Hibernate 3.3.1的jar包与MySQL的JDBC驱动包，所以要把重复的包删除）<br />  1，添加 ${JBPM_HOME}/jpbm.jar<br />  2，添加 ${JBPM_HOME}/lib/*.jar，除了junit.jar、servlet-api.jar、cglib.jar<br />  3，注意：不要添加 cglib.jar，因为Spring中有更高版本的 cglib-nodep-2.1_3.jar<br />  4, 问题 启动Tomcat后，访问JSP时（使用的是MyEclipse自带的Tomcat，是6.0的版本），报错：<br />   Caused by: java.lang.LinkageError: loader constraints violated when linking javax/el/ExpressionFactory class<br />    at org.apache.jsp.WEB_002dINF.jsp.UserAction.loginUI_jsp._jspInit(loginUI_jsp.java:39)<br />    at org.apache.jasper.runtime.HttpJspBase.init(HttpJspBase.java:52)<br />    at org.apache.jasper.servlet.JspServletWrapper.getServlet(JspServletWrapper.java:159)<br />    at org.apache.jasper.servlet.JspServletWrapper.service(JspServletWrapper.java:329)<br />    at org.apache.jasper.servlet.JspServlet.serviceJspFile(JspServlet.java:320)<br />    at org.apache.jasper.servlet.JspServlet.service(JspServlet.java:266)<br />    ... 40 more<br />    或<br />java.lang.LinkageError: loader constraint violation: when resolving interface method "javax.servlet.jsp.JspApplicationContext.getExpressionFactory()Ljavax/el/ExpressionFactory;" the class loader (instance of org/apache/jasper/servlet/JasperLoader) of the current class, org/apache/jsp/index_jsp, and the class loader (instance of org/apache/catalina/loader/StandardClassLoader) for resolved class, javax/servlet/jsp/JspApplicationContext, have different Class objects for the type javax/el/ExpressionFactory used in the signature<br /> org.apache.jsp.index_jsp._jspInit(index_jsp.java:23)<br /> org.apache.jasper.runtime.HttpJspBase.init(HttpJspBase.java:52)<br /> org.apache.jasper.servlet.JspServletWrapper.getServlet(JspServletWrapper.java:159)<br /> org.apache.jasper.servlet.JspServletWrapper.service(JspServletWrapper.java:329)<br /> org.apache.jasper.servlet.JspServlet.serviceJspFile(JspServlet.java:320)<br /> org.apache.jasper.servlet.JspServlet.service(JspServlet.java:266)<br /> javax.servlet.http.HttpServlet.service(HttpServlet.java:803)<br /> org.apache.struts2.dispatcher.ng.filter.StrutsPrepareAndExecuteFilter.doFilter(StrutsPrepareAndExecuteFilter.java:88)</p><p> </p><p><br />  说明：原因是Jbpm的juel.jar, juel-engine.jar, juel-impl.jar包和Tomcat6.0中的el-api.jar包冲突了。<br />  有三个解决办法：<br />  1，方法一：换成tomcat5.5，就没有问题了。<br />  2，方法二：在MyEclipse的Preferences -&gt; MyEclipse -&gt; Application Servers -&gt; Tomcat -&gt; .. -&gt; Paths 中配置 Append to classpath，选中 juel.jar, juel-engine.jar, juel-impl.jar 这三个jar包就可以了。<br />  3，方法三：将 juel.jar, juel-engine.jar, juel-impl.jar 这三个包复制到tomcat6下 lib/ 中，并删除原来的el-api.jar，<br />  切记还要把工程中 WEB-INF\lib 下的 juel.jar, juel-engine.jar, juel-impl.jar 删除，不然还是要冲突。<br /> </p><p><br /> 8，其他的jar包（在Spring中有）<br />  commons-codec.jar 含有MD5的工具类<br />  commons-lang.jar java.lang包中有关类的工具类</p><p> 提示：注意不要发生jar包冲突的问题。<br /> <br />4，配置文件（除web.xml外，都放在源码文件夹 conf/ 下）<br /> 1，Log4j的配置文件：<br />  log4j.properties<br /> 2，Strtus2的配置文件：<br />  1，MessageResources.properties<br />  2，在 web.xml 中配置Struts2的Filter：<br />   &lt;!-- Struts2的配置 --&gt;<br />   &lt;filter&gt;<br />    &lt;filter-name&gt;struts2&lt;/filter-name&gt;<br />    &lt;filter-class&gt;org.apache.struts2.dispatcher.ng.filter.StrutsPrepareAndExecuteFilter&lt;/filter-class&gt;<br />   &lt;/filter&gt;<br />   &lt;filter-mapping&gt;<br />    &lt;filter-name&gt;struts2&lt;/filter-name&gt;<br />    &lt;url-pattern&gt;/*&lt;/url-pattern&gt;<br />   &lt;/filter-mapping&gt;<br />  3，配置struts.xml<br />   &lt;?xml version="1.0" encoding="UTF-8" ?&gt;<br />   &lt;!DOCTYPE struts PUBLIC<br />       "-//Apache Software Foundation//DTD Struts Configuration 2.1.7//EN"<br />       "<a target="_blank" href="http://struts.apache.org/dtds/struts-2.1.7.dtd">http://struts.apache.org/dtds/struts-2.1.7.dtd</a>"&gt;<br />   &lt;struts&gt;<br />    &lt;!-- 设置开发模式 --&gt;<br />    &lt;constant name="struts.devMode" value="true" /&gt;<br />    &lt;!-- 指定主题使用simple（默认值为xhtml） --&gt;<br />    &lt;constant name="struts.ui.theme" value="simple" /&gt;<br />    &lt;!-- 定义全局的国际化资源文件 --&gt;<br />    &lt;constant name="struts.custom.i18n.resources" value="MessageResources"&gt;&lt;/constant&gt;</p><p>    &lt;!-- 可以把相关的action都放在一个package中，以便于管理，形成模块 --&gt;<br />    &lt;package name="default" extends="struts-default"&gt;</p><p>     &lt;!-- 将paramsPrepareParamsStack设置为默认栈，使用该栈是和ModelDriven以及Prepare拦截器配合使用 --&gt;<br />     &lt;default-interceptor-ref name="paramsPrepareParamsStack"&gt;&lt;/default-interceptor-ref&gt;</p><p>    &lt;/package&gt;<br />   &lt;/struts&gt;<br /> 3，Hibernate的配置文件：hibernate.cfg.xml<br />  1，对于MySQL数据库，（JBPM4要求）方言要配置为：org.hibernate.dialect.MySQL5InnoDBDialect<br />  2，配置如下：<br />   &lt;!-- 方言 --&gt;<br />   &lt;property name="hibernate.dialect"&gt;org.hibernate.dialect.MySQLDialect&lt;/property&gt;<br />   &lt;!-- 其他配置 --&gt;<br />   &lt;property name="show_sql"&gt;true&lt;/property&gt;<br />   &lt;property name="hbm2ddl.auto"&gt;update&lt;/property&gt;<br />   &lt;property name="hibernate.jdbc.batch_size"&gt;30&lt;/property&gt;<br />      &lt;!-- MySQL不支持fetch_size --&gt;<br />      &lt;property name="hibernate.jdbc.fetch_size"&gt;100&lt;/property&gt;<br />  3，说明：在这里不配置数据库连接信息，是在后面Spring中整合Hibernate时配置的（配置c3p0数据库连接池）。<br /> 4，Spring的配置文件：applicationContext.xml<br />  1，声明如下：<br />   &lt;?xml version="1.0" encoding="UTF-8"?&gt;<br />   &lt;beans xmlns="<a target="_blank" href="http://www.springframework.org/schema/beans">http://www.springframework.org/schema/beans</a>" xmlns:xsi="<a target="_blank" href="http://www.w3.org/2001/XMLSchema-instance">http://www.w3.org/2001/XMLSchema-instance</a>"<br />    xmlns:aop="<a target="_blank" href="http://www.springframework.org/schema/aop">http://www.springframework.org/schema/aop</a>" xmlns:context="<a target="_blank" href="http://www.springframework.org/schema/context">http://www.springframework.org/schema/context</a>"<br />    xmlns:tx="<a target="_blank" href="http://www.springframework.org/schema/tx">http://www.springframework.org/schema/tx</a>"<br />    xsi:schemaLocation="<a target="_blank" href="http://www.springframework.org/schema/beans">http://www.springframework.org/schema/beans</a><a target="_blank" href="http://www.springframework.org/schema/beans/spring-beans.xsd">http://www.springframework.org/schema/beans/spring-beans.xsd</a><br />     <a target="_blank" href="http://www.springframework.org/schema/aop">http://www.springframework.org/schema/aop</a><a target="_blank" href="http://www.springframework.org/schema/aop/spring-aop.xsd">http://www.springframework.org/schema/aop/spring-aop.xsd</a><br />     <a target="_blank" href="http://www.springframework.org/schema/context">http://www.springframework.org/schema/context</a><a target="_blank" href="http://www.springframework.org/schema/context/spring-context.xsd">http://www.springframework.org/schema/context/spring-context.xsd</a><br />     <a target="_blank" href="http://www.springframework.org/schema/tx">http://www.springframework.org/schema/tx</a><a target="_blank" href="http://www.springframework.org/schema/tx/spring-tx.xsd">http://www.springframework.org/schema/tx/spring-tx.xsd</a>"&gt;<br />  2，配置bean的自动扫描与装配<br />   &lt;!-- 配置bean的自动扫描与装配 --&gt;<br />   &lt;context:component-scan base-package="cn.itcast.oa"&gt;&lt;/context:component-scan&gt;<br /> 5，Jbpm的配置文件：jbpm.cfg.xml</p><p><br />一些问题说明：<br /> 如果使用JavaEE1.4，则可能会出现以下错误：<br /> 1，Caused by: javax.xml.parsers.FactoryConfigurationError: Provider org.apache.xerces.jaxp.DocumentBuilderFactoryImpl not found<br /> 2，Caused by: java.lang.NoClassDefFoundError: org/jboss/mx/util/PropertyAccess<br /> 解决办法：使用JavaEE_5.0就可以了。<br /> 3，${SPRING_HOME}/lib/j2eecommon-annotations.jar（如果是JDK6.0则不需要）<br /> </p><p> </p><p> </p><p>Struts2的dtd文件的位置：<br />{Struts2_Home}\src\core\src\main\resources<br /></p>   &#13;
