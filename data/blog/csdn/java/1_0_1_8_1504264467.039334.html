
        <div class="markdown_views"><p>本项目是javaWeb和email结合的项目，模拟网站必须要激活邮箱账号才可以使用，</p>

<p>创建数据库</p>



<pre class="prettyprint"><code class=" hljs sql"><span class="hljs-operator"><span class="hljs-keyword">create</span> <span class="hljs-keyword">table</span> <span class="hljs-keyword">user</span>(
id <span class="hljs-keyword">varchar</span>(<span class="hljs-number">32</span>) <span class="hljs-keyword">primary</span> <span class="hljs-keyword">key</span>,
name <span class="hljs-keyword">varchar</span>(<span class="hljs-number">30</span>),
pwd <span class="hljs-keyword">varchar</span>(<span class="hljs-number">20</span>),
email <span class="hljs-keyword">varchar</span>(<span class="hljs-number">20</span>),
active <span class="hljs-keyword">char</span>(<span class="hljs-number">1</span>),
acode <span class="hljs-keyword">varchar</span>(<span class="hljs-number">32</span>)
)</span></code></pre>

<p>User.java值对象</p>



<pre class="prettyprint"><code class=" hljs java"><span class="hljs-keyword">package</span> cn.hncu.reg.domain;

<span class="hljs-keyword">import</span> javax.persistence.Table;

<span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">User</span> {</span>
    <span class="hljs-keyword">private</span> String id;
    <span class="hljs-keyword">private</span> String name;
    <span class="hljs-keyword">private</span> String pwd;
    <span class="hljs-keyword">private</span> String acode;
    <span class="hljs-keyword">private</span> String active;
    <span class="hljs-keyword">private</span> String email;
    <span class="hljs-keyword">public</span> String <span class="hljs-title">getId</span>() {
        <span class="hljs-keyword">return</span> id;
    }
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">setId</span>(String id) {
        <span class="hljs-keyword">this</span>.id = id;
    }
    <span class="hljs-keyword">public</span> String <span class="hljs-title">getName</span>() {
        <span class="hljs-keyword">return</span> name;
    }
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">setName</span>(String name) {
        <span class="hljs-keyword">this</span>.name = name;
    }
    <span class="hljs-keyword">public</span> String <span class="hljs-title">getPwd</span>() {
        <span class="hljs-keyword">return</span> pwd;
    }
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">setPwd</span>(String pwd) {
        <span class="hljs-keyword">this</span>.pwd = pwd;
    }
    <span class="hljs-keyword">public</span> String <span class="hljs-title">getAcode</span>() {
        <span class="hljs-keyword">return</span> acode;
    }
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">setAcode</span>(String acode) {
        <span class="hljs-keyword">this</span>.acode = acode;
    }
    <span class="hljs-keyword">public</span> String <span class="hljs-title">getActive</span>() {
        <span class="hljs-keyword">return</span> active;
    }
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">setActive</span>(String active) {
        <span class="hljs-keyword">this</span>.active = active;
    }
    <span class="hljs-keyword">public</span> String <span class="hljs-title">getEmail</span>() {
        <span class="hljs-keyword">return</span> email;
    }
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">setEmail</span>(String email) {
        <span class="hljs-keyword">this</span>.email = email;
    }
    <span class="hljs-annotation">@Override</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">int</span> <span class="hljs-title">hashCode</span>() {
        <span class="hljs-keyword">final</span> <span class="hljs-keyword">int</span> prime = <span class="hljs-number">31</span>;
        <span class="hljs-keyword">int</span> result = <span class="hljs-number">1</span>;
        result = prime * result + ((id == <span class="hljs-keyword">null</span>) ? <span class="hljs-number">0</span> : id.hashCode());
        <span class="hljs-keyword">return</span> result;
    }
    <span class="hljs-annotation">@Override</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">boolean</span> <span class="hljs-title">equals</span>(Object obj) {
        <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span> == obj)
            <span class="hljs-keyword">return</span> <span class="hljs-keyword">true</span>;
        <span class="hljs-keyword">if</span> (obj == <span class="hljs-keyword">null</span>)
            <span class="hljs-keyword">return</span> <span class="hljs-keyword">false</span>;
        <span class="hljs-keyword">if</span> (getClass() != obj.getClass())
            <span class="hljs-keyword">return</span> <span class="hljs-keyword">false</span>;
        User other = (User) obj;
        <span class="hljs-keyword">if</span> (id == <span class="hljs-keyword">null</span>) {
            <span class="hljs-keyword">if</span> (other.id != <span class="hljs-keyword">null</span>)
                <span class="hljs-keyword">return</span> <span class="hljs-keyword">false</span>;
        } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (!id.equals(other.id))
            <span class="hljs-keyword">return</span> <span class="hljs-keyword">false</span>;
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">true</span>;
    }
}</code></pre>

<p>C3p0Pool.java</p>



<pre class="prettyprint"><code class=" hljs java"><span class="hljs-keyword">package</span> cn.hncu.pubs;

<span class="hljs-keyword">import</span> java.sql.Connection;
<span class="hljs-keyword">import</span> java.sql.SQLException;

<span class="hljs-keyword">import</span> javax.sql.DataSource;

<span class="hljs-keyword">import</span> com.mchange.v2.c3p0.ComboPooledDataSource;

<span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">C3p0Pool</span> {</span>
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> DataSource ds=<span class="hljs-keyword">new</span> ComboPooledDataSource();;
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> ThreadLocal&lt;Connection&gt; tl=<span class="hljs-keyword">new</span> ThreadLocal&lt;Connection&gt;();
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> Connection <span class="hljs-title">getCon</span>() <span class="hljs-keyword">throws</span> SQLException { Connection con = (Connection)tl.get();
    <span class="hljs-keyword">if</span> (con == <span class="hljs-keyword">null</span>) {
        con = ds.getConnection();
        tl.set(con);
    }
    <span class="hljs-keyword">return</span> con; }

    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> DataSource <span class="hljs-title">getPool</span>() {
        <span class="hljs-keyword">return</span> ds; }

    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> ThreadLocal&lt;Connection&gt; <span class="hljs-title">getTl</span>() {
        <span class="hljs-keyword">return</span> tl;
    }
}</code></pre>

<p>C3p0-config.xml</p>



<pre class="prettyprint"><code class=" hljs xml"><span class="hljs-tag">&lt;<span class="hljs-title">c3p0-config</span>&gt;</span>
    <span class="hljs-comment">&lt;!-- 默认配置，如果没有指定则使用这个配置 --&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-title">default-config</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-title">property</span> <span class="hljs-attribute">name</span>=<span class="hljs-value">"driverClass"</span>&gt;</span>com.mysql.jdbc.Driver<span class="hljs-tag">&lt;/<span class="hljs-title">property</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-title">property</span> <span class="hljs-attribute">name</span>=<span class="hljs-value">"jdbcUrl"</span>&gt;</span>
            <span class="hljs-cdata">&lt;![CDATA[jdbc:mysql://127.0.0.1:3306/sstud?useUnicode=true&amp;characterEncoding=UTF-8]]&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-title">property</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-title">property</span> <span class="hljs-attribute">name</span>=<span class="hljs-value">"user"</span>&gt;</span>root<span class="hljs-tag">&lt;/<span class="hljs-title">property</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-title">property</span> <span class="hljs-attribute">name</span>=<span class="hljs-value">"password"</span>&gt;</span>1234<span class="hljs-tag">&lt;/<span class="hljs-title">property</span>&gt;</span>
        <span class="hljs-comment">&lt;!-- 初始化池大小 --&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-title">property</span> <span class="hljs-attribute">name</span>=<span class="hljs-value">"initialPoolSize"</span>&gt;</span>2<span class="hljs-tag">&lt;/<span class="hljs-title">property</span>&gt;</span>
        <span class="hljs-comment">&lt;!-- 最大空闲时间 --&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-title">property</span> <span class="hljs-attribute">name</span>=<span class="hljs-value">"maxIdleTime"</span>&gt;</span>30<span class="hljs-tag">&lt;/<span class="hljs-title">property</span>&gt;</span>
        <span class="hljs-comment">&lt;!-- 最多有多少个连接 --&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-title">property</span> <span class="hljs-attribute">name</span>=<span class="hljs-value">"maxPoolSize"</span>&gt;</span>10<span class="hljs-tag">&lt;/<span class="hljs-title">property</span>&gt;</span>
        <span class="hljs-comment">&lt;!-- 最少几个连接 --&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-title">property</span> <span class="hljs-attribute">name</span>=<span class="hljs-value">"minPoolSize"</span>&gt;</span>2<span class="hljs-tag">&lt;/<span class="hljs-title">property</span>&gt;</span>
        <span class="hljs-comment">&lt;!-- 每次最多可以执行多少个批处理语句 --&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-title">property</span> <span class="hljs-attribute">name</span>=<span class="hljs-value">"maxStatements"</span>&gt;</span>50<span class="hljs-tag">&lt;/<span class="hljs-title">property</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-title">default-config</span>&gt;</span> 
    <span class="hljs-comment">&lt;!-- 命名的配置 --&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-title">named-config</span> <span class="hljs-attribute">name</span>=<span class="hljs-value">"hncu"</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-title">property</span> <span class="hljs-attribute">name</span>=<span class="hljs-value">"driverClass"</span>&gt;</span>com.mysql.jdbc.Driver<span class="hljs-tag">&lt;/<span class="hljs-title">property</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-title">property</span> <span class="hljs-attribute">name</span>=<span class="hljs-value">"jdbcUrl"</span>&gt;</span>jdbc:mysql://127.0.0.1:3306/sstud<span class="hljs-tag">&lt;/<span class="hljs-title">property</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-title">property</span> <span class="hljs-attribute">name</span>=<span class="hljs-value">"user"</span>&gt;</span>root<span class="hljs-tag">&lt;/<span class="hljs-title">property</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-title">property</span> <span class="hljs-attribute">name</span>=<span class="hljs-value">"password"</span>&gt;</span>1234<span class="hljs-tag">&lt;/<span class="hljs-title">property</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-title">property</span> <span class="hljs-attribute">name</span>=<span class="hljs-value">"acquireIncrement"</span>&gt;</span>5<span class="hljs-tag">&lt;/<span class="hljs-title">property</span>&gt;</span><span class="hljs-comment">&lt;!-- 如果池中数据连接不够时一次增长多少个 --&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-title">property</span> <span class="hljs-attribute">name</span>=<span class="hljs-value">"initialPoolSize"</span>&gt;</span>100<span class="hljs-tag">&lt;/<span class="hljs-title">property</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-title">property</span> <span class="hljs-attribute">name</span>=<span class="hljs-value">"minPoolSize"</span>&gt;</span>50<span class="hljs-tag">&lt;/<span class="hljs-title">property</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-title">property</span> <span class="hljs-attribute">name</span>=<span class="hljs-value">"maxPoolSize"</span>&gt;</span>1000<span class="hljs-tag">&lt;/<span class="hljs-title">property</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-title">property</span> <span class="hljs-attribute">name</span>=<span class="hljs-value">"maxStatements"</span>&gt;</span>0<span class="hljs-tag">&lt;/<span class="hljs-title">property</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-title">property</span> <span class="hljs-attribute">name</span>=<span class="hljs-value">"maxStatementsPerConnection"</span>&gt;</span>5<span class="hljs-tag">&lt;/<span class="hljs-title">property</span>&gt;</span> <span class="hljs-comment">&lt;!-- he's important, but there's only one of him --&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-title">named-config</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-title">c3p0-config</span>&gt;</span> </code></pre>

<p>RegDAO.java</p>



<pre class="prettyprint"><code class=" hljs java"><span class="hljs-keyword">package</span> cn.hncu.reg.dao;

<span class="hljs-keyword">import</span> cn.hncu.reg.domain.User;

<span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">interface</span> <span class="hljs-title">RegDAO</span> {</span>
    <span class="hljs-keyword">public</span> User <span class="hljs-title">reg</span>(User user);
    <span class="hljs-keyword">public</span> User <span class="hljs-title">active</span>(String acode);
}</code></pre>

<p>RegDaoJdbc.java</p>



<pre class="prettyprint"><code class=" hljs avrasm">package cn<span class="hljs-preprocessor">.hncu</span><span class="hljs-preprocessor">.reg</span><span class="hljs-preprocessor">.dao</span><span class="hljs-comment">;</span>

import java<span class="hljs-preprocessor">.sql</span><span class="hljs-preprocessor">.SQLException</span><span class="hljs-comment">;</span>
import java<span class="hljs-preprocessor">.util</span><span class="hljs-preprocessor">.UUID</span><span class="hljs-comment">;</span>

import javax<span class="hljs-preprocessor">.sql</span><span class="hljs-preprocessor">.DataSource</span><span class="hljs-comment">;</span>

import org<span class="hljs-preprocessor">.apache</span><span class="hljs-preprocessor">.commons</span><span class="hljs-preprocessor">.dbutils</span><span class="hljs-preprocessor">.QueryRunner</span><span class="hljs-comment">;</span>
import org<span class="hljs-preprocessor">.apache</span><span class="hljs-preprocessor">.commons</span><span class="hljs-preprocessor">.dbutils</span><span class="hljs-preprocessor">.handlers</span><span class="hljs-preprocessor">.BeanHandler</span><span class="hljs-comment">;</span>
import org<span class="hljs-preprocessor">.apache</span><span class="hljs-preprocessor">.commons</span><span class="hljs-preprocessor">.dbutils</span><span class="hljs-preprocessor">.handlers</span><span class="hljs-preprocessor">.BeanListHandler</span><span class="hljs-comment">;</span>

import cn<span class="hljs-preprocessor">.hncu</span><span class="hljs-preprocessor">.pool</span><span class="hljs-preprocessor">.C</span>3p0Pool<span class="hljs-comment">;</span>
import cn<span class="hljs-preprocessor">.hncu</span><span class="hljs-preprocessor">.reg</span><span class="hljs-preprocessor">.domain</span><span class="hljs-preprocessor">.User</span><span class="hljs-comment">;</span>

public class RegDaoJdbc implements RegDAO{

    @Override
    public User reg(User user) {
        DataSource ds=C3p0Pool<span class="hljs-preprocessor">.getPool</span>()<span class="hljs-comment">;</span>
        QueryRunner qr=new QueryRunner(ds)<span class="hljs-comment">;</span>
        String sql=<span class="hljs-string">"insert into user(id,name,pwd,email,active,acode) values(?,?,?,?,?,?)"</span><span class="hljs-comment">;</span>
        try {
            String id=UUID<span class="hljs-preprocessor">.randomUUID</span>()<span class="hljs-preprocessor">.toString</span>()<span class="hljs-preprocessor">.replaceAll</span>(<span class="hljs-string">"-"</span>, <span class="hljs-string">""</span>)<span class="hljs-comment">;</span>
            String acode=UUID<span class="hljs-preprocessor">.randomUUID</span>()<span class="hljs-preprocessor">.toString</span>()<span class="hljs-preprocessor">.replaceAll</span>(<span class="hljs-string">"-"</span>, <span class="hljs-string">""</span>)<span class="hljs-comment">;</span>
            qr<span class="hljs-preprocessor">.update</span>(sql,id,user<span class="hljs-preprocessor">.getName</span>(),user<span class="hljs-preprocessor">.getPwd</span>(),user<span class="hljs-preprocessor">.getEmail</span>(),<span class="hljs-string">"0"</span>,acode)<span class="hljs-comment">;</span>
            user<span class="hljs-preprocessor">.setAcode</span>(acode)<span class="hljs-comment">;</span>
            user<span class="hljs-preprocessor">.setId</span>(id)<span class="hljs-comment">;</span>
            user<span class="hljs-preprocessor">.setActive</span>(<span class="hljs-string">"0"</span>)<span class="hljs-comment">;</span>
        } catch (SQLException e) {
//          e<span class="hljs-preprocessor">.printStackTrace</span>()<span class="hljs-comment">;</span>
            System<span class="hljs-preprocessor">.out</span><span class="hljs-preprocessor">.println</span>(<span class="hljs-string">"注册失败"</span>)<span class="hljs-comment">;</span>
            return null<span class="hljs-comment">;</span>
        }
        return user<span class="hljs-comment">;</span>
    }

    @Override
    public User active(String acode) {
        DataSource ds=C3p0Pool<span class="hljs-preprocessor">.getPool</span>()<span class="hljs-comment">;</span>
        QueryRunner qr=new QueryRunner(ds)<span class="hljs-comment">;</span>
        String sql=<span class="hljs-string">"select * from user where acode=?"</span><span class="hljs-comment">;</span>
        User user=null<span class="hljs-comment">;</span>
        try {
            user=qr<span class="hljs-preprocessor">.query</span>(sql, new BeanHandler(User<span class="hljs-preprocessor">.class</span>),acode)<span class="hljs-comment">;</span>
            if(user!=null){
                sql=<span class="hljs-string">"update user set active='1' ,acode=''where acode=?"</span><span class="hljs-comment">;</span>
                qr<span class="hljs-preprocessor">.update</span>(sql,acode)<span class="hljs-comment">;</span>
                return user<span class="hljs-comment">;</span>
            }
        } catch (SQLException e) {
            user=null<span class="hljs-comment">;</span>
            e<span class="hljs-preprocessor">.printStackTrace</span>()<span class="hljs-comment">;</span>
        }
        return null<span class="hljs-comment">;</span>
    }
    }</code></pre>

<p>IRegService.java</p>



<pre class="prettyprint"><code class=" hljs java"><span class="hljs-keyword">package</span> cn.hncu.reg.service;

<span class="hljs-keyword">import</span> cn.hncu.reg.domain.User;

<span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">interface</span> <span class="hljs-title">IRegService</span> {</span>
    <span class="hljs-keyword">public</span> User <span class="hljs-title">reg</span>(User user);
    <span class="hljs-keyword">public</span> User <span class="hljs-title">active</span>(String acode);
}</code></pre>

<p>RegService.java</p>



<pre class="prettyprint"><code class=" hljs java"><span class="hljs-keyword">package</span> cn.hncu.reg.service;

<span class="hljs-keyword">import</span> cn.hncu.reg.dao.RegDAO;
<span class="hljs-keyword">import</span> cn.hncu.reg.dao.RegDaoJdbc;
<span class="hljs-keyword">import</span> cn.hncu.reg.domain.User;

<span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">RegService</span> <span class="hljs-keyword">implements</span> <span class="hljs-title">IRegService</span> {</span>
    <span class="hljs-keyword">private</span> RegDAO dao=<span class="hljs-keyword">new</span> RegDaoJdbc();
    <span class="hljs-annotation">@Override</span>
    <span class="hljs-keyword">public</span> User <span class="hljs-title">reg</span>(User user) {
        <span class="hljs-keyword">return</span> dao.reg(user);
    }

    <span class="hljs-annotation">@Override</span>
    <span class="hljs-keyword">public</span> User <span class="hljs-title">active</span>(String acode) {
        <span class="hljs-keyword">return</span> dao.active(acode);
    }

}</code></pre>

<p>RegServlet.java</p>



<pre class="prettyprint"><code class=" hljs avrasm">package cn<span class="hljs-preprocessor">.hncu</span><span class="hljs-preprocessor">.reg</span><span class="hljs-preprocessor">.servlet</span><span class="hljs-comment">;</span>

import java<span class="hljs-preprocessor">.io</span><span class="hljs-preprocessor">.IOException</span><span class="hljs-comment">;</span>
import java<span class="hljs-preprocessor">.io</span><span class="hljs-preprocessor">.PrintWriter</span><span class="hljs-comment">;</span>

import javax<span class="hljs-preprocessor">.servlet</span><span class="hljs-preprocessor">.ServletException</span><span class="hljs-comment">;</span>
import javax<span class="hljs-preprocessor">.servlet</span><span class="hljs-preprocessor">.http</span><span class="hljs-preprocessor">.HttpServlet</span><span class="hljs-comment">;</span>
import javax<span class="hljs-preprocessor">.servlet</span><span class="hljs-preprocessor">.http</span><span class="hljs-preprocessor">.HttpServletRequest</span><span class="hljs-comment">;</span>
import javax<span class="hljs-preprocessor">.servlet</span><span class="hljs-preprocessor">.http</span><span class="hljs-preprocessor">.HttpServletResponse</span><span class="hljs-comment">;</span>

import cn<span class="hljs-preprocessor">.hncu</span><span class="hljs-preprocessor">.reg</span><span class="hljs-preprocessor">.domain</span><span class="hljs-preprocessor">.User</span><span class="hljs-comment">;</span>
import cn<span class="hljs-preprocessor">.hncu</span><span class="hljs-preprocessor">.reg</span><span class="hljs-preprocessor">.sendMail</span><span class="hljs-preprocessor">.SendEMailThread</span><span class="hljs-comment">;</span>
import cn<span class="hljs-preprocessor">.hncu</span><span class="hljs-preprocessor">.reg</span><span class="hljs-preprocessor">.service</span><span class="hljs-preprocessor">.IRegService</span><span class="hljs-comment">;</span>
import cn<span class="hljs-preprocessor">.hncu</span><span class="hljs-preprocessor">.reg</span><span class="hljs-preprocessor">.service</span><span class="hljs-preprocessor">.RegService</span><span class="hljs-comment">;</span>

public class RegServlet extends HttpServlet {
    private IRegService service=new RegService()<span class="hljs-comment">;</span>
    public void doGet(HttpServletRequest request, HttpServletResponse response)
            throws ServletException, IOException {

        response<span class="hljs-preprocessor">.setContentType</span>(<span class="hljs-string">"text/html"</span>)<span class="hljs-comment">;</span>
        PrintWriter <span class="hljs-keyword">out</span> = response<span class="hljs-preprocessor">.getWriter</span>()<span class="hljs-comment">;</span>
        <span class="hljs-keyword">out</span><span class="hljs-preprocessor">.println</span>(<span class="hljs-string">"&lt;!DOCTYPE HTML PUBLIC \"-//W3C//DTD HTML 4.01 Transitional//EN\"&gt;"</span>)<span class="hljs-comment">;</span>
        <span class="hljs-keyword">out</span><span class="hljs-preprocessor">.println</span>(<span class="hljs-string">"&lt;HTML&gt;"</span>)<span class="hljs-comment">;</span>
        <span class="hljs-keyword">out</span><span class="hljs-preprocessor">.println</span>(<span class="hljs-string">"  &lt;HEAD&gt;&lt;TITLE&gt;A Servlet&lt;/TITLE&gt;&lt;/HEAD&gt;"</span>)<span class="hljs-comment">;</span>
        <span class="hljs-keyword">out</span><span class="hljs-preprocessor">.println</span>(<span class="hljs-string">"  &lt;BODY&gt;"</span>)<span class="hljs-comment">;</span>
        <span class="hljs-keyword">out</span><span class="hljs-preprocessor">.println</span>(<span class="hljs-string">"请按要求填写"</span>)<span class="hljs-comment">;</span>
        <span class="hljs-keyword">out</span><span class="hljs-preprocessor">.println</span>(<span class="hljs-string">"  &lt;/BODY&gt;"</span>)<span class="hljs-comment">;</span>
        <span class="hljs-keyword">out</span><span class="hljs-preprocessor">.println</span>(<span class="hljs-string">"&lt;/HTML&gt;"</span>)<span class="hljs-comment">;</span>
        <span class="hljs-keyword">out</span><span class="hljs-preprocessor">.flush</span>()<span class="hljs-comment">;</span>
        <span class="hljs-keyword">out</span><span class="hljs-preprocessor">.close</span>()<span class="hljs-comment">;</span>
    }


    public void doPost(HttpServletRequest request, HttpServletResponse response)
            throws ServletException, IOException {

        PrintWriter <span class="hljs-keyword">out</span> = response<span class="hljs-preprocessor">.getWriter</span>()<span class="hljs-comment">;</span>
        String name=request<span class="hljs-preprocessor">.getParameter</span>(<span class="hljs-string">"name"</span>)<span class="hljs-comment">;</span>
        String pwd=request<span class="hljs-preprocessor">.getParameter</span>(<span class="hljs-string">"pwd"</span>)<span class="hljs-comment">;</span>
        String email=request<span class="hljs-preprocessor">.getParameter</span>(<span class="hljs-string">"email"</span>)<span class="hljs-comment">;</span>
        User user=new User()<span class="hljs-comment">;</span>
        user<span class="hljs-preprocessor">.setName</span>(name)<span class="hljs-comment">;</span>
        user<span class="hljs-preprocessor">.setPwd</span>(pwd)<span class="hljs-comment">;</span>
        user<span class="hljs-preprocessor">.setEmail</span>(email)<span class="hljs-comment">;</span>

        user=service<span class="hljs-preprocessor">.reg</span>(user)<span class="hljs-comment">;</span>
        if (user!=null) {
            <span class="hljs-keyword">out</span><span class="hljs-preprocessor">.print</span>(<span class="hljs-string">"注册成功，请到邮箱验证"</span>)<span class="hljs-comment">;</span>
            new SendEMailThread(user<span class="hljs-preprocessor">.getAcode</span>())<span class="hljs-preprocessor">.start</span>()<span class="hljs-comment">;</span>
        }else{
            <span class="hljs-keyword">out</span><span class="hljs-preprocessor">.print</span>(<span class="hljs-string">"注册失败"</span>)<span class="hljs-comment">;</span>
        }

    }

}</code></pre>

<p>SendEMailThread.java</p>



<pre class="prettyprint"><code class=" hljs java"><span class="hljs-keyword">package</span> cn.hncu.reg.sendMail;

<span class="hljs-keyword">import</span> java.util.Properties;

<span class="hljs-keyword">import</span> javax.mail.Authenticator;
<span class="hljs-keyword">import</span> javax.mail.Message.RecipientType;
<span class="hljs-keyword">import</span> javax.mail.MessagingException;
<span class="hljs-keyword">import</span> javax.mail.PasswordAuthentication;
<span class="hljs-keyword">import</span> javax.mail.Session;
<span class="hljs-keyword">import</span> javax.mail.Transport;
<span class="hljs-keyword">import</span> javax.mail.internet.AddressException;
<span class="hljs-keyword">import</span> javax.mail.internet.InternetAddress;
<span class="hljs-keyword">import</span> javax.mail.internet.MimeMessage;

<span class="hljs-keyword">import</span> org.apache.log4j.Logger;

<span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">SendEMailThread</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">Thread</span> {</span>
    <span class="hljs-keyword">private</span> String acode;
    <span class="hljs-keyword">private</span> Logger log=Logger.getLogger(SendEMailThread.class);
    <span class="hljs-keyword">public</span> <span class="hljs-title">SendEMailThread</span>(String acode) {
        <span class="hljs-keyword">this</span>.acode = acode;
    }

    <span class="hljs-annotation">@Override</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">run</span>() {
        Properties p=<span class="hljs-keyword">new</span> Properties();
        p.setProperty(<span class="hljs-string">"mail.host"</span>, <span class="hljs-string">"smtp.sina.com"</span>);
        p.setProperty(<span class="hljs-string">"mail.smtp.auth"</span>, <span class="hljs-string">"true"</span>);
        Session session=Session.getDefaultInstance(p, <span class="hljs-keyword">new</span> Authenticator() {

            <span class="hljs-annotation">@Override</span>
            <span class="hljs-keyword">protected</span> PasswordAuthentication <span class="hljs-title">getPasswordAuthentication</span>() {
                PasswordAuthentication pa=<span class="hljs-keyword">new</span> PasswordAuthentication(<span class="hljs-string">"hncujava"</span>, <span class="hljs-string">"1234567"</span>);
                <span class="hljs-keyword">return</span> pa;
            }
        });
        session.setDebug(<span class="hljs-keyword">true</span>);
        MimeMessage msg=<span class="hljs-keyword">new</span> MimeMessage(session);

        <span class="hljs-keyword">try</span> {
            msg.setFrom( <span class="hljs-keyword">new</span> InternetAddress(<span class="hljs-string">"hncujava@sina.com"</span>) );
            msg.setRecipient(RecipientType.TO,  <span class="hljs-keyword">new</span> InternetAddress(<span class="hljs-string">"747205398@qq.com"</span>));
            msg.setSubject(<span class="hljs-string">"激活hncu账号"</span>);
            StringBuilder sb=<span class="hljs-keyword">new</span> StringBuilder();
            sb.append(<span class="hljs-string">"请激活邮箱:&lt;a href='http://127.0.0.1:8080/mailWeb/ActiveServlet"</span>);
            sb.append(<span class="hljs-string">"?acode="</span>+acode+<span class="hljs-string">" '&gt;点击激活&lt;/a&gt;"</span>);
            sb.append(<span class="hljs-string">"&lt;br/&gt;如果激活未成功,请复制下面地址到浏览器地址栏进行手动激活:"</span>);
            sb.append(<span class="hljs-string">"http://www.hncu.cn/mailWeb/ActiveServlet?acode="</span>+acode);
            msg.setContent(sb.toString(),<span class="hljs-string">"text/html;charset=utf-8"</span>);
            Transport.send(msg);
            log.info(<span class="hljs-string">"邮件发送成功"</span>);
        } <span class="hljs-keyword">catch</span> (AddressException e) {
            log.error(<span class="hljs-string">"邮箱地址错误，邮件发送失败"</span>);
            e.printStackTrace();
        } <span class="hljs-keyword">catch</span> (MessagingException e) {
            e.printStackTrace();
            log.error(<span class="hljs-string">"邮箱信息格式错误，邮件发送失败"</span>);
        }
    }

}
</code></pre>

<p>ActiveServlet.java</p>

<pre class="prettyprint"><code class=" hljs avrasm">package cn<span class="hljs-preprocessor">.hncu</span><span class="hljs-preprocessor">.reg</span><span class="hljs-preprocessor">.servlet</span><span class="hljs-comment">;</span>

import java<span class="hljs-preprocessor">.io</span><span class="hljs-preprocessor">.IOException</span><span class="hljs-comment">;</span>
import java<span class="hljs-preprocessor">.io</span><span class="hljs-preprocessor">.PrintWriter</span><span class="hljs-comment">;</span>

import javax<span class="hljs-preprocessor">.servlet</span><span class="hljs-preprocessor">.ServletException</span><span class="hljs-comment">;</span>
import javax<span class="hljs-preprocessor">.servlet</span><span class="hljs-preprocessor">.http</span><span class="hljs-preprocessor">.HttpServlet</span><span class="hljs-comment">;</span>
import javax<span class="hljs-preprocessor">.servlet</span><span class="hljs-preprocessor">.http</span><span class="hljs-preprocessor">.HttpServletRequest</span><span class="hljs-comment">;</span>
import javax<span class="hljs-preprocessor">.servlet</span><span class="hljs-preprocessor">.http</span><span class="hljs-preprocessor">.HttpServletResponse</span><span class="hljs-comment">;</span>

import cn<span class="hljs-preprocessor">.hncu</span><span class="hljs-preprocessor">.reg</span><span class="hljs-preprocessor">.domain</span><span class="hljs-preprocessor">.User</span><span class="hljs-comment">;</span>
import cn<span class="hljs-preprocessor">.hncu</span><span class="hljs-preprocessor">.reg</span><span class="hljs-preprocessor">.service</span><span class="hljs-preprocessor">.IRegService</span><span class="hljs-comment">;</span>
import cn<span class="hljs-preprocessor">.hncu</span><span class="hljs-preprocessor">.reg</span><span class="hljs-preprocessor">.service</span><span class="hljs-preprocessor">.RegService</span><span class="hljs-comment">;</span>

public class ActiveServlet extends HttpServlet {
    private IRegService service=new RegService()<span class="hljs-comment">;</span>
        public void doGet(HttpServletRequest request, HttpServletResponse response)
            throws ServletException, IOException {
        PrintWriter <span class="hljs-keyword">out</span> = response<span class="hljs-preprocessor">.getWriter</span>()<span class="hljs-comment">;</span>
        String acode=request<span class="hljs-preprocessor">.getParameter</span>(<span class="hljs-string">"acode"</span>)<span class="hljs-comment">;</span>
        User user=service<span class="hljs-preprocessor">.active</span>(acode)<span class="hljs-comment">;</span>
        request<span class="hljs-preprocessor">.setAttribute</span>(<span class="hljs-string">"user"</span>, user)<span class="hljs-comment">;</span>
        System<span class="hljs-preprocessor">.out</span><span class="hljs-preprocessor">.println</span>(<span class="hljs-string">"user:"</span>+user)<span class="hljs-comment">;</span>
        request<span class="hljs-preprocessor">.getRequestDispatcher</span>(<span class="hljs-string">"/jsps/result.jsp"</span>)<span class="hljs-preprocessor">.forward</span>(request, response)<span class="hljs-comment">;</span>
    }

}</code></pre>

<p>index.jsp</p>



<pre class="prettyprint"><code class=" hljs xml"><span class="vbscript">&lt;%@ page language=<span class="hljs-string">"java"</span> import=<span class="hljs-string">"java.util.*"</span> pageEncoding=<span class="hljs-string">"UTF-8"</span>%&gt;</span>
<span class="vbscript">&lt;%@taglib uri=<span class="hljs-string">"http://java.sun.com/jsp/jstl/core"</span> prefix=<span class="hljs-string">"c"</span>%&gt;</span>

<span class="hljs-doctype">&lt;!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-title">html</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-title">head</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-title">title</span>&gt;</span>邮箱登录<span class="hljs-tag">&lt;/<span class="hljs-title">title</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-title">script</span> <span class="hljs-attribute">type</span>=<span class="hljs-value">"text/javascript"</span>&gt;</span><span class="javascript">
        <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">reg</span><span class="hljs-params">()</span>{</span>
            document.forms[<span class="hljs-number">0</span>].action=<span class="hljs-string">'&lt;c:url value="/jsps/reg.jsp"/&gt;'</span>;
            document.forms[<span class="hljs-number">0</span>].submit();
        }
        <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">login</span><span class="hljs-params">()</span>{</span>
            document.forms[<span class="hljs-number">0</span>].action=<span class="hljs-string">'&lt;c:url value="/LoginServlet"/&gt;'</span>;
            document.forms[<span class="hljs-number">0</span>].submit();
        }
    </span><span class="hljs-tag">&lt;/<span class="hljs-title">script</span>&gt;</span>
  <span class="hljs-tag">&lt;/<span class="hljs-title">head</span>&gt;</span>

  <span class="hljs-tag">&lt;<span class="hljs-title">body</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-title">c:if</span> <span class="hljs-attribute">test</span>=<span class="hljs-value">"${!empty error }"</span>&gt;</span>
    登录失败
    <span class="hljs-tag">&lt;<span class="hljs-title">c:remove</span> <span class="hljs-attribute">var</span>=<span class="hljs-value">"error"</span> <span class="hljs-attribute">scope</span>=<span class="hljs-value">"session"</span>/&gt;</span>
  <span class="hljs-tag">&lt;/<span class="hljs-title">c:if</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-title">c:if</span> <span class="hljs-attribute">test</span>=<span class="hljs-value">"${empty sessionScope.user }"</span> <span class="hljs-attribute">var</span>=<span class="hljs-value">"boo"</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-title">h3</span>&gt;</span>用户注册<span class="hljs-tag">&lt;/<span class="hljs-title">h3</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-title">form</span> <span class="hljs-attribute">action</span>=<span class="hljs-value">""</span> <span class="hljs-attribute">method</span>=<span class="hljs-value">"post"</span> &gt;</span>
            姓名:<span class="hljs-tag">&lt;<span class="hljs-title">input</span> <span class="hljs-attribute">type</span>=<span class="hljs-value">"text"</span> <span class="hljs-attribute">name</span>=<span class="hljs-value">"name"</span> <span class="hljs-attribute">value</span>=<span class="hljs-value">"wang"</span>/&gt;</span><span class="hljs-tag">&lt;<span class="hljs-title">br</span>/&gt;</span>
            密码:<span class="hljs-tag">&lt;<span class="hljs-title">input</span> <span class="hljs-attribute">type</span>=<span class="hljs-value">"text"</span> <span class="hljs-attribute">name</span>=<span class="hljs-value">"pwd"</span> <span class="hljs-attribute">value</span>=<span class="hljs-value">"1234"</span>/&gt;</span><span class="hljs-tag">&lt;<span class="hljs-title">br</span>/&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-title">input</span> <span class="hljs-attribute">type</span>=<span class="hljs-value">"button"</span>  <span class="hljs-attribute">value</span>=<span class="hljs-value">"登录"</span> <span class="hljs-attribute">onclick</span>=<span class="hljs-value">"login();"</span>/&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-title">input</span> <span class="hljs-attribute">type</span>=<span class="hljs-value">"button"</span>  <span class="hljs-attribute">value</span>=<span class="hljs-value">"注册"</span> <span class="hljs-attribute">onclick</span>=<span class="hljs-value">"reg();"</span>/&gt;</span><span class="hljs-tag">&lt;<span class="hljs-title">br</span>/&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-title">form</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-title">c:if</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-title">c:if</span> <span class="hljs-attribute">test</span>=<span class="hljs-value">"${!boo }"</span>&gt;</span>
        欢迎回来,${ sessionScope.user.name}
    <span class="hljs-tag">&lt;/<span class="hljs-title">c:if</span>&gt;</span>
  <span class="hljs-tag">&lt;/<span class="hljs-title">body</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-title">html</span>&gt;</span>
</code></pre>

<p>reg.jsp</p>



<pre class="prettyprint"><code class=" hljs xml"><span class="vbscript">&lt;%@ page language=<span class="hljs-string">"java"</span> import=<span class="hljs-string">"java.util.*"</span> pageEncoding=<span class="hljs-string">"UTF-8"</span>%&gt;</span>
<span class="vbscript">&lt;%@taglib uri=<span class="hljs-string">"http://java.sun.com/jsp/jstl/core"</span> prefix=<span class="hljs-string">"c"</span>%&gt;</span>

<span class="hljs-doctype">&lt;!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-title">html</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-title">head</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-title">title</span>&gt;</span>邮箱注册系统<span class="hljs-tag">&lt;/<span class="hljs-title">title</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-title">script</span> <span class="hljs-attribute">type</span>=<span class="hljs-value">"text/javascript"</span>&gt;</span><span class="javascript">
        <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">reg</span><span class="hljs-params">()</span>{</span>
            document.forms[<span class="hljs-number">0</span>].action=<span class="hljs-string">'&lt;c:url value="/RegServlet"/&gt;'</span>;
            document.forms[<span class="hljs-number">0</span>].submit();
        }
        <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">login</span><span class="hljs-params">()</span>{</span>
            document.forms[<span class="hljs-number">0</span>].action=<span class="hljs-string">'&lt;c:url value="/LoginServlet"/&gt;'</span>;
            document.forms[<span class="hljs-number">0</span>].submit();
        }
    </span><span class="hljs-tag">&lt;/<span class="hljs-title">script</span>&gt;</span>
  <span class="hljs-tag">&lt;/<span class="hljs-title">head</span>&gt;</span>

  <span class="hljs-tag">&lt;<span class="hljs-title">body</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-title">c:if</span> <span class="hljs-attribute">test</span>=<span class="hljs-value">"${empty sessionScope.user }"</span> <span class="hljs-attribute">var</span>=<span class="hljs-value">" boo"</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-title">h3</span>&gt;</span>用户注册<span class="hljs-tag">&lt;/<span class="hljs-title">h3</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-title">form</span> <span class="hljs-attribute">action</span>=<span class="hljs-value">""</span> <span class="hljs-attribute">method</span>=<span class="hljs-value">"post"</span> &gt;</span>
            姓名:<span class="hljs-tag">&lt;<span class="hljs-title">input</span> <span class="hljs-attribute">type</span>=<span class="hljs-value">"text"</span> <span class="hljs-attribute">name</span>=<span class="hljs-value">"name"</span> <span class="hljs-attribute">value</span>=<span class="hljs-value">"wang"</span>/&gt;</span><span class="hljs-tag">&lt;<span class="hljs-title">br</span>/&gt;</span>
            密码:<span class="hljs-tag">&lt;<span class="hljs-title">input</span> <span class="hljs-attribute">type</span>=<span class="hljs-value">"text"</span> <span class="hljs-attribute">name</span>=<span class="hljs-value">"pwd"</span> <span class="hljs-attribute">value</span>=<span class="hljs-value">"1234"</span>/&gt;</span><span class="hljs-tag">&lt;<span class="hljs-title">br</span>/&gt;</span>
            邮箱:<span class="hljs-tag">&lt;<span class="hljs-title">input</span> <span class="hljs-attribute">type</span>=<span class="hljs-value">"text"</span> <span class="hljs-attribute">name</span>=<span class="hljs-value">"email"</span> <span class="hljs-attribute">value</span>=<span class="hljs-value">"747205398@qq.com"</span>/&gt;</span> <span class="hljs-tag">&lt;<span class="hljs-title">br</span>/&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-title">input</span> <span class="hljs-attribute">type</span>=<span class="hljs-value">"button"</span>  <span class="hljs-attribute">value</span>=<span class="hljs-value">"注册"</span> <span class="hljs-attribute">onclick</span>=<span class="hljs-value">"reg();"</span>/&gt;</span><span class="hljs-tag">&lt;<span class="hljs-title">br</span>/&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-title">form</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-title">c:if</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-title">body</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-title">html</span>&gt;</span>
</code></pre>

<p>result.jsp</p>



<pre class="prettyprint"><code class=" hljs xml"><span class="vbscript">&lt;%@ page language=<span class="hljs-string">"java"</span> import=<span class="hljs-string">"java.util.*"</span> pageEncoding=<span class="hljs-string">"UTF-8"</span>%&gt;</span>
<span class="vbscript">&lt;%@taglib uri=<span class="hljs-string">"http://java.sun.com/jsp/jstl/core"</span> prefix=<span class="hljs-string">"c"</span>%&gt;</span>

<span class="hljs-doctype">&lt;!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-title">html</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-title">head</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-title">script</span> <span class="hljs-attribute">type</span>=<span class="hljs-value">"text/javascript"</span>&gt;</span><span class="javascript">
        <span class="hljs-keyword">var</span> tm;
        <span class="hljs-keyword">var</span> time=<span class="hljs-number">5</span>;
        <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">start</span><span class="hljs-params">()</span>{</span>
            div1.innerHTML=<span class="hljs-string">"将在"</span>+time+<span class="hljs-string">"秒跳转"</span>;
            time--;
            <span class="hljs-keyword">if</span>(time&lt;=<span class="hljs-number">1</span>){
                window.clearInterval(tm);
                window.location.href=<span class="hljs-string">"&lt;c:url value='/index.jsp'/&gt;"</span>;
            }
        }
        onload=<span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span>{</span>
            tm=window.setInterval(start, <span class="hljs-number">1000</span>);
        };
    </span><span class="hljs-tag">&lt;/<span class="hljs-title">script</span>&gt;</span>
  <span class="hljs-tag">&lt;/<span class="hljs-title">head</span>&gt;</span>

  <span class="hljs-tag">&lt;<span class="hljs-title">body</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-title">c:if</span> <span class="hljs-attribute">test</span>=<span class="hljs-value">"${!empty requestScope.user }"</span> <span class="hljs-attribute">var</span>=<span class="hljs-value">" boo"</span>&gt;</span>
        恭喜注册成功！请登录
        <span class="hljs-tag">&lt;<span class="hljs-title">a</span> <span class="hljs-attribute">href</span>=<span class="hljs-value">'&lt;c:url value="/index.jsp" /&gt;'</span>&gt;</span>登录<span class="hljs-tag">&lt;/<span class="hljs-title">a</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-title">br</span>/&gt;</span><span class="hljs-tag">&lt;<span class="hljs-title">br</span>/&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-title">div</span> <span class="hljs-attribute">id</span> =<span class="hljs-value">"div1"</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-title">div</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-title">c:if</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-title">c:if</span> <span class="hljs-attribute">test</span>=<span class="hljs-value">"${boo}"</span>&gt;</span>
        注册失败，请重新激活
    <span class="hljs-tag">&lt;/<span class="hljs-title">c:if</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-title">body</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-title">html</span>&gt;</span>
</code></pre>

<p>web.xml</p>



<pre class="prettyprint"><code class=" hljs xml"><span class="hljs-pi">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-title">web-app</span> <span class="hljs-attribute">version</span>=<span class="hljs-value">"3.0"</span> 
    <span class="hljs-attribute">xmlns</span>=<span class="hljs-value">"http://java.sun.com/xml/ns/javaee"</span> 
    <span class="hljs-attribute">xmlns:xsi</span>=<span class="hljs-value">"http://www.w3.org/2001/XMLSchema-instance"</span> 
    <span class="hljs-attribute">xsi:schemaLocation</span>=<span class="hljs-value">"http://java.sun.com/xml/ns/javaee 
    http://java.sun.com/xml/ns/javaee/web-app_3_0.xsd"</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-title">display-name</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-title">display-name</span>&gt;</span> 

  <span class="hljs-tag">&lt;<span class="hljs-title">filter</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-title">filter-name</span>&gt;</span>charset<span class="hljs-tag">&lt;/<span class="hljs-title">filter-name</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-title">filter-class</span>&gt;</span>cn.hncu.filter.CharacterFilter<span class="hljs-tag">&lt;/<span class="hljs-title">filter-class</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-title">init-param</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-title">param-name</span>&gt;</span>charset<span class="hljs-tag">&lt;/<span class="hljs-title">param-name</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-title">param-value</span>&gt;</span>utf-8<span class="hljs-tag">&lt;/<span class="hljs-title">param-value</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-title">init-param</span>&gt;</span>
  <span class="hljs-tag">&lt;/<span class="hljs-title">filter</span>&gt;</span>

  <span class="hljs-tag">&lt;<span class="hljs-title">filter-mapping</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-title">filter-name</span>&gt;</span>charset<span class="hljs-tag">&lt;/<span class="hljs-title">filter-name</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-title">url-pattern</span>&gt;</span>/*<span class="hljs-tag">&lt;/<span class="hljs-title">url-pattern</span>&gt;</span>
  <span class="hljs-tag">&lt;/<span class="hljs-title">filter-mapping</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-title">servlet</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-title">description</span>&gt;</span>This is the description of my J2EE component<span class="hljs-tag">&lt;/<span class="hljs-title">description</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-title">display-name</span>&gt;</span>This is the display name of my J2EE component<span class="hljs-tag">&lt;/<span class="hljs-title">display-name</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-title">servlet-name</span>&gt;</span>RegServlet<span class="hljs-tag">&lt;/<span class="hljs-title">servlet-name</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-title">servlet-class</span>&gt;</span>cn.hncu.reg.servlet.RegServlet<span class="hljs-tag">&lt;/<span class="hljs-title">servlet-class</span>&gt;</span>
  <span class="hljs-tag">&lt;/<span class="hljs-title">servlet</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-title">servlet</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-title">description</span>&gt;</span>This is the description of my J2EE component<span class="hljs-tag">&lt;/<span class="hljs-title">description</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-title">display-name</span>&gt;</span>This is the display name of my J2EE component<span class="hljs-tag">&lt;/<span class="hljs-title">display-name</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-title">servlet-name</span>&gt;</span>ActiveServlet<span class="hljs-tag">&lt;/<span class="hljs-title">servlet-name</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-title">servlet-class</span>&gt;</span>cn.hncu.reg.servlet.ActiveServlet<span class="hljs-tag">&lt;/<span class="hljs-title">servlet-class</span>&gt;</span>
  <span class="hljs-tag">&lt;/<span class="hljs-title">servlet</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-title">servlet</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-title">description</span>&gt;</span>This is the description of my J2EE component<span class="hljs-tag">&lt;/<span class="hljs-title">description</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-title">display-name</span>&gt;</span>This is the display name of my J2EE component<span class="hljs-tag">&lt;/<span class="hljs-title">display-name</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-title">servlet-name</span>&gt;</span>LoginServlet<span class="hljs-tag">&lt;/<span class="hljs-title">servlet-name</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-title">servlet-class</span>&gt;</span>cn.hncu.login.LoginServlet<span class="hljs-tag">&lt;/<span class="hljs-title">servlet-class</span>&gt;</span>
  <span class="hljs-tag">&lt;/<span class="hljs-title">servlet</span>&gt;</span>



  <span class="hljs-tag">&lt;<span class="hljs-title">servlet-mapping</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-title">servlet-name</span>&gt;</span>RegServlet<span class="hljs-tag">&lt;/<span class="hljs-title">servlet-name</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-title">url-pattern</span>&gt;</span>/RegServlet<span class="hljs-tag">&lt;/<span class="hljs-title">url-pattern</span>&gt;</span>
  <span class="hljs-tag">&lt;/<span class="hljs-title">servlet-mapping</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-title">servlet-mapping</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-title">servlet-name</span>&gt;</span>ActiveServlet<span class="hljs-tag">&lt;/<span class="hljs-title">servlet-name</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-title">url-pattern</span>&gt;</span>/ActiveServlet<span class="hljs-tag">&lt;/<span class="hljs-title">url-pattern</span>&gt;</span>
  <span class="hljs-tag">&lt;/<span class="hljs-title">servlet-mapping</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-title">servlet-mapping</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-title">servlet-name</span>&gt;</span>LoginServlet<span class="hljs-tag">&lt;/<span class="hljs-title">servlet-name</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-title">url-pattern</span>&gt;</span>/LoginServlet<span class="hljs-tag">&lt;/<span class="hljs-title">url-pattern</span>&gt;</span>
  <span class="hljs-tag">&lt;/<span class="hljs-title">servlet-mapping</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-title">welcome-file-list</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-title">welcome-file</span>&gt;</span>index.jsp<span class="hljs-tag">&lt;/<span class="hljs-title">welcome-file</span>&gt;</span>
  <span class="hljs-tag">&lt;/<span class="hljs-title">welcome-file-list</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-title">web-app</span>&gt;</span></code></pre>

<p>需要的jar包 <br />
c3p0-0.9.1.2.jar <br />
commons-dbutils-1.4.jar <br />
java-mail-1.4.4.jar <br />
mysql-connector-java-5.1.34-bin.jar <br />
myConUtil.jar</p></div>&#13;
        <script type="text/javascript">&#13;
            $(function () {&#13;
                $('pre.prettyprint code').each(function () {&#13;
                    var lines = $(this).text().split('\n').length;&#13;
                    var $numbering = $('&lt;ul/&gt;').addClass('pre-numbering').hide();&#13;
                    $(this).addClass('has-numbering').parent().append($numbering);&#13;
                    for (i = 1; i &lt;= lines; i++) {&#13;
                        $numbering.append($('&lt;li/&gt;').text(i));&#13;
                    };&#13;
                    $numbering.fadeIn(1700);&#13;
                });&#13;
            });&#13;
        </script>&#13;
   &#13;
