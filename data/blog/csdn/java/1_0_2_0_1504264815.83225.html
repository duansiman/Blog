
<p><span style="font-size:14px">缓存的概念</span></p><p><span style="font-family:Calibri; font-size:14px">         </span>计算机领域非常通用的概念。它介于应用程序和永久性数据存储源（如硬盘上的文件或者数据库）之间，其作用是降低应用程序直接读写永久性数据存储源的频率，从而提高应用的运行性能。缓存中的数据是存储源总的数据的拷贝。缓存的物理介质通常是内存。</p><p><span style="font-family:Calibri; font-size:14px"> </span></p><p><span style="font-family:Calibri; font-size:14px">Hibernate</span>中提供了两个级别的缓存</p><p><span style="font-family:Calibri; font-size:14px">         Session</span>级别的缓存</p><p><span style="font-family:Calibri; font-size:14px">         </span>它是属于事务范围的缓存。这一级别的缓存有<span style="font-family:Calibri">Hibernate</span>管理的，一般情况下午需进行干预。</p><p><span style="font-family:Calibri; font-size:14px">         SessionFactory</span>级别的缓存</p><p><span style="font-family:Calibri; font-size:14px">         </span>它是属于进程范围的缓存</p><p><span style="font-family:Calibri; font-size:14px"> </span></p><p><span style="font-size:14px">启用二级缓存的条件</span></p><p><span style="font-size:14px">很少被修改</span></p><p><span style="font-family:Calibri; font-size:14px"> </span></p><p><span style="font-size:14px">很多系统模块都要用到</span></p><p><span style="font-family:Calibri; font-size:14px"> </span></p><p><span style="font-size:14px">不是私有的数据，是共享的</span></p><p><span style="font-family:Calibri; font-size:14px"> </span></p><p><span style="font-size:14px">配置二级缓存</span></p><p><span style="font-family:Calibri; font-size:14px">1、</span>  <span style="font-size:14px">拷贝<span style="font-family:Calibri">ehcache-1.5.0.jar</span>到当前工程的<span style="font-family:Calibri">lib</span>目录下</span></p><p><span style="font-family:Calibri; font-size:14px">2、</span>  <span style="font-size:14px">开启二级缓存</span></p><p><span style="font-family:Calibri; font-size:14px">3、</span>  <span style="font-size:14px">要指定缓存的供应商</span></p><p><span style="font-family:Calibri; font-size:14px">&lt;property name=”hibernate.cache.provider_class”&gt;org.hibernate.cache.EhCacheProvider&lt;/property&gt;</span></p><p><span style="font-family:Calibri; font-size:14px">4、</span>  <span style="font-size:14px">指定使用二级缓存的类</span></p><p><span style="font-size:14px"><strong>方法一<span style="font-family:Calibri">  </span>在使用类的<span style="font-family:Calibri">*.hbm.xml</span>配置</strong></span></p><p><span style="font-size:14px">选择需要使用二级缓存的持久化类，设置它的二级缓存的兵法访问策略，<span style="font-family:Calibri">&lt;class&gt;</span>元素的<span style="font-family:Calibri">cache</span>子元素表明<span style="font-family:Calibri">Hibernate</span>会缓存对象的简单属性，但不会缓存集合属性，若希望缓存集合属性中的元素，必须在<span style="font-family:Calibri">&lt;set&gt;</span>元素中加入<span style="font-family:Calibri">&lt;cache&gt;</span>子元素</span></p><p><span style="font-family:Calibri; font-size:14px">&lt;class name=”cn.itcast.c3p0.Customer” table=”customers” lazy=”false”&gt;</span></p><p><span style="font-family:Calibri; font-size:14px">         &lt;!—</span>配置类级别的二级缓存à</p><p><span style="font-family:Calibri; font-size:14px">         &lt;cache usage=”read-write”/&gt;</span></p><p><span style="font-family:Calibri; font-size:14px">&lt;set name=”orders” table=”orders” inverse=”true” fetch=”select” lazy=”false”&gt;</span></p><p><span style="font-family:Calibri; font-size:14px">         &lt;!—</span>配置集合级别的二级缓存à</p><p><span style="font-family:Calibri; font-size:14px">         &lt;cache usage=”read-write”/&gt;</span></p><p><span style="font-family:Calibri; font-size:14px"> </span></p><p><span style="font-size:14px"><strong>方法二<span style="font-family:Calibri">   </span>在<span style="font-family:Calibri">hibernate.cfg.xml</span>文件中配置<span style="font-family:Calibri">(</span>建议<span style="font-family:Calibri">)</span></strong></span></p><p><span style="font-family:Calibri; font-size:14px">&lt;!—</span>指定使用二级缓存的类，放在<span style="font-family:Calibri">maping</span>下面à</p><p><span style="font-family:Calibri; font-size:14px">&lt;!---</span>配置类级别的二级缓存<span style="font-family:Calibri">--&gt;</span></p><p><span style="font-family:Calibri; font-size:14px">&lt;class-cache class=”cn.itcast.c3p0.Customer” usage=”read-write”/&gt;</span></p><p><span style="font-family:Calibri; font-size:14px">&lt;class-cache class=”cn.itcast.c3p0.Order” usage=”read-write”/&gt;</span></p><p><span style="font-family:Calibri; font-size:14px"> </span></p><p><span style="font-family:Calibri; font-size:14px">&lt;!—</span>配置集合级别的二级缓存à</p><p><span style="font-family:Calibri; font-size:14px">&lt;collection-cache collection=”cn.itcast.c3p0.Customer.orders” usage=”read-write”/&gt;</span></p><p><span style="font-family:Calibri; font-size:14px">&lt;diskStore path=”D:\cache”/&gt;</span></p><p><span style="font-family:Calibri; font-size:14px">&lt;cache name=””</span></p><p><span style="font-family:Calibri; font-size:14px">maxElementsInMemory=”100”</span></p><p><span style="font-family:Calibri; font-size:14px">eternal=”false”</span></p><p><span style="font-family:Calibri; font-size:14px">timeToIdleSeconds=”300”</span></p><p><span style="font-family:Calibri; font-size:14px">timeToLiveSeconds=”600”</span></p><p><span style="font-family:Calibri; font-size:14px">overflowToDisk=”true”</span></p><p><span style="font-family:Calibri; font-size:14px">diskPersistent=”false”/&gt;</span></p><p><span style="font-family:Calibri; font-size:14px">&lt;/ehcache&gt;</span></p><p><span style="font-family:Calibri; font-size:14px"> </span></p><p><span style="font-family:Calibri; font-size:14px">&lt;diskStore path=”C:\\TEMP”/&gt;:</span>如果内存中的数据已经达到所要求存放的最大值的时候。这个时候，其他的数据将会以文件的形式存放到磁盘上。</p><p><span style="font-family:Calibri; font-size:14px"> </span></p><p><span style="font-family:Calibri; font-size:14px">&lt;defaultCache&gt;</span>设置缓存的默认数据过期策略</p><p><span style="font-family:Calibri; font-size:14px"> </span></p><p><span style="font-family:Calibri; font-size:14px">&lt;cache&gt;</span>设定具体的命名缓存的数据过期策略</p><p><span style="font-size:14px">每个命名缓存代表一个缓存区域，每个缓存区域有各自的数据过期策略。命名缓存机制使得用户能够在每个类以及类的每个集合的粒度上设置过期策略。</span></p><p><span style="font-family:Calibri; font-size:14px"> </span></p><p><span style="font-family:Calibri; font-size:14px">cache</span>元素的属性</p><p><span style="font-family:Calibri; font-size:14px">name:</span>设置缓存的名字，它的取值为类的全限定名或类的集合的名字</p><p><span style="font-family:Calibri; font-size:14px">maxElementsInMemory:</span>设置基于内存的缓存中可存放的对象最大数目</p><p><span style="font-family:Calibri; font-size:14px">eternal</span>：设置对象是否为永久的，<span style="font-family:Calibri">true</span>表示永不过期，此时将忽略</p><p><span style="font-family:Calibri; font-size:14px">timeToIdleSeconds:</span>设置对象空闲最长时间，以秒为单位，超过这个时间，对象过期。当对象过期是，<span style="font-family:Calibri">EHCache</span>会把它从缓存中清空。如果此值为<span style="font-family:Calibri">0</span>，表示对象可以无限期地处于空闲状态。</p><p><span style="font-family:Calibri; font-size:14px">TimeToLiveSeconds:</span>设置对象生存最长时间，超过这个时间，对象过期。如果此值为<span style="font-family:Calibri">0</span>，表示对象可以无限期地存在缓存中，该属性必须大于或等于<span style="font-family:Calibri">timeToIdleSeconds</span>属性值。</p><p><span style="font-family:Calibri; font-size:14px">OverflowToDisk:</span>设置基于内在的缓存中的对象数目达到上限后，是否把溢出的对象写到硬盘的缓存中。</p><p><span style="font-family:Calibri; font-size:14px">diskPersistent</span>当<span style="font-family:Calibri">jvm</span>结束时是否持久化对象<span style="font-family:Calibri">true  false</span>默认是<span style="font-family:Calibri">false</span></p><p><span style="font-family:Calibri; font-size:14px">diskExpiryThreadIntervalSeconds</span>指定专门用于清除过期对象的监听线程的轮询时间。</p><p><span style="font-family:Calibri; font-size:14px"></span> </p>   &#13;
