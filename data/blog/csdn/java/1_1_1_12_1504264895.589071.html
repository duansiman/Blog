
        <div class="markdown_views"><p><strong>pom导依赖</strong></p>



<pre class="prettyprint"><code class=" hljs xml"> <span class="hljs-tag">&lt;<span class="hljs-title">properties</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-title">comLog.version</span>&gt;</span>1.1.1<span class="hljs-tag">&lt;/<span class="hljs-title">comLog.version</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-title">properties</span>&gt;</span>

   <span class="hljs-tag">&lt;<span class="hljs-title">dependencies</span>&gt;</span>
       <span class="hljs-tag">&lt;<span class="hljs-title">dependency</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-title">groupId</span>&gt;</span>cn.jpush.api<span class="hljs-tag">&lt;/<span class="hljs-title">groupId</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-title">artifactId</span>&gt;</span>jpush-client<span class="hljs-tag">&lt;/<span class="hljs-title">artifactId</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-title">version</span>&gt;</span>3.2.7<span class="hljs-tag">&lt;/<span class="hljs-title">version</span>&gt;</span>
       <span class="hljs-tag">&lt;/<span class="hljs-title">dependency</span>&gt;</span>
       <span class="hljs-tag">&lt;<span class="hljs-title">dependency</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-title">groupId</span>&gt;</span>cn.jpush.api<span class="hljs-tag">&lt;/<span class="hljs-title">groupId</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-title">artifactId</span>&gt;</span>jiguang-common<span class="hljs-tag">&lt;/<span class="hljs-title">artifactId</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-title">version</span>&gt;</span>1.0.1<span class="hljs-tag">&lt;/<span class="hljs-title">version</span>&gt;</span>
       <span class="hljs-tag">&lt;/<span class="hljs-title">dependency</span>&gt;</span>
       <span class="hljs-tag">&lt;<span class="hljs-title">dependency</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-title">groupId</span>&gt;</span>io.netty<span class="hljs-tag">&lt;/<span class="hljs-title">groupId</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-title">artifactId</span>&gt;</span>netty-all<span class="hljs-tag">&lt;/<span class="hljs-title">artifactId</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-title">version</span>&gt;</span>4.1.6.Final<span class="hljs-tag">&lt;/<span class="hljs-title">version</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-title">scope</span>&gt;</span>compile<span class="hljs-tag">&lt;/<span class="hljs-title">scope</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-title">dependency</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-title">dependency</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-title">groupId</span>&gt;</span>com.google.code.gson<span class="hljs-tag">&lt;/<span class="hljs-title">groupId</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-title">artifactId</span>&gt;</span>gson<span class="hljs-tag">&lt;/<span class="hljs-title">artifactId</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-title">version</span>&gt;</span>2.3<span class="hljs-tag">&lt;/<span class="hljs-title">version</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-title">dependency</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-title">dependency</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-title">groupId</span>&gt;</span>org.slf4j<span class="hljs-tag">&lt;/<span class="hljs-title">groupId</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-title">artifactId</span>&gt;</span>slf4j-api<span class="hljs-tag">&lt;/<span class="hljs-title">artifactId</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-title">version</span>&gt;</span>1.7.7<span class="hljs-tag">&lt;/<span class="hljs-title">version</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-title">dependency</span>&gt;</span>

        <span class="hljs-comment">&lt;!-- For log4j --&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-title">dependency</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-title">groupId</span>&gt;</span>org.slf4j<span class="hljs-tag">&lt;/<span class="hljs-title">groupId</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-title">artifactId</span>&gt;</span>slf4j-log4j12<span class="hljs-tag">&lt;/<span class="hljs-title">artifactId</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-title">version</span>&gt;</span>1.7.7<span class="hljs-tag">&lt;/<span class="hljs-title">version</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-title">dependency</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-title">dependency</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-title">groupId</span>&gt;</span>log4j<span class="hljs-tag">&lt;/<span class="hljs-title">groupId</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-title">artifactId</span>&gt;</span>log4j<span class="hljs-tag">&lt;/<span class="hljs-title">artifactId</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-title">version</span>&gt;</span>1.2.17<span class="hljs-tag">&lt;/<span class="hljs-title">version</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-title">dependency</span>&gt;</span>

        <span class="hljs-tag">&lt;<span class="hljs-title">dependency</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-title">groupId</span>&gt;</span>commons-logging<span class="hljs-tag">&lt;/<span class="hljs-title">groupId</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-title">artifactId</span>&gt;</span>commons-logging<span class="hljs-tag">&lt;/<span class="hljs-title">artifactId</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-title">version</span>&gt;</span>${comLog.version}<span class="hljs-tag">&lt;/<span class="hljs-title">version</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-title">dependency</span>&gt;</span>       
    <span class="hljs-tag">&lt;/<span class="hljs-title">dependencies</span>&gt;</span></code></pre>

<p><strong>编写工具类，比较健全的，一般要用的都写了</strong></p>



<pre class="prettyprint"><code class=" hljs java"><span class="hljs-keyword">package</span> com.lyt.jpush.api;
<span class="hljs-keyword">import</span> java.util.Map;

<span class="hljs-keyword">import</span> org.slf4j.Logger;
<span class="hljs-keyword">import</span> org.slf4j.LoggerFactory;

<span class="hljs-keyword">import</span> cn.jpush.api.JPushClient;
<span class="hljs-keyword">import</span> cn.jpush.api.common.resp.APIConnectionException;
<span class="hljs-keyword">import</span> cn.jpush.api.common.resp.APIRequestException;
<span class="hljs-keyword">import</span> cn.jpush.api.push.PushResult;
<span class="hljs-keyword">import</span> cn.jpush.api.push.model.Message;
<span class="hljs-keyword">import</span> cn.jpush.api.push.model.Options;
<span class="hljs-keyword">import</span> cn.jpush.api.push.model.Platform;
<span class="hljs-keyword">import</span> cn.jpush.api.push.model.PushPayload;
<span class="hljs-keyword">import</span> cn.jpush.api.push.model.PushPayload.Builder;
<span class="hljs-keyword">import</span> cn.jpush.api.push.model.audience.Audience;
<span class="hljs-keyword">import</span> cn.jpush.api.push.model.audience.AudienceTarget;
<span class="hljs-keyword">import</span> cn.jpush.api.push.model.notification.AndroidNotification;
<span class="hljs-keyword">import</span> cn.jpush.api.push.model.notification.IosNotification;
<span class="hljs-keyword">import</span> cn.jpush.api.push.model.notification.Notification;


    <span class="hljs-javadoc">/**
     * 
     *<span class="hljs-javadoctag"> @ClassName</span>: MessagePushUtil
     *<span class="hljs-javadoctag"> @Description</span>: (消息推送工具类)
     *<span class="hljs-javadoctag"> @date</span> 2015年12月22日 下午2:36:45
     *
     */</span>
    <span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">MsgPushUtils</span>{</span>
    <span class="hljs-keyword">protected</span> <span class="hljs-keyword">static</span> Logger LOG = LoggerFactory.getLogger(MsgPushUtils.class);
<span class="hljs-comment">//  private static final String MASTER_SECRET = "XXXXXX";</span>
<span class="hljs-comment">//  private static final String APP_KEY = "XXXXX";</span>
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> String MASTER_SECRET = <span class="hljs-string">"XXXXXX"</span>;
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> String APP_KEY = <span class="hljs-string">"XXXXXXX"</span>;
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> PushPayload pushPayload ;
<span class="hljs-comment">//  private static Builder builder; </span>
<span class="hljs-comment">//  static {</span>
<span class="hljs-comment">//  Builder builder = PushPayload.newBuilder();</span>
<span class="hljs-comment">//  pushPayload = builder</span>
<span class="hljs-comment">//  .setNotification(Notification.alert(""))</span>
<span class="hljs-comment">//  .setAudience(Audience.all())</span>
<span class="hljs-comment">//  .setPlatform(Platform.all())</span>
<span class="hljs-comment">//  .setOptions(Options.newBuilder().setTimeToLive(0L).build())</span>
<span class="hljs-comment">//  .build();</span>
<span class="hljs-comment">//  }</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> String BEEN_CONCERNED_ALERT = <span class="hljs-string">""</span>;

    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> String SOUND = <span class="hljs-string">""</span>;

    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-keyword">int</span> BADGE = <span class="hljs-number">1</span>;
    <span class="hljs-javadoc">/**
     *<span class="hljs-javadoctag"> @throws</span> APIRequestException 
     *<span class="hljs-javadoctag"> @throws</span> APIConnectionException 
    * 
    *<span class="hljs-javadoctag"> @Title</span>: pushMessage 
    *<span class="hljs-javadoctag"> @Description</span>: (推送消息) 
    *<span class="hljs-javadoctag"> @param</span><span class="hljs-javadoctag"> @param</span> json
    *<span class="hljs-javadoctag"> @param</span><span class="hljs-javadoctag"> @return</span>    设定文件 
    *<span class="hljs-javadoctag"> @return</span> HttpResponse    返回类型 
    *<span class="hljs-javadoctag"> @throws</span>
    */</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> PushResult <span class="hljs-title">sendPush</span>(PushPayload payload) <span class="hljs-keyword">throws</span> APIConnectionException, APIRequestException{
    JPushClient jPushClient = <span class="hljs-keyword">new</span> JPushClient(MASTER_SECRET, APP_KEY);
    <span class="hljs-keyword">return</span> jPushClient.sendPush(payload);
    }

    <span class="hljs-javadoc">/**
    *<span class="hljs-javadoctag"> @Title</span>: sendPushTryCatch 
    *<span class="hljs-javadoctag"> @Description</span>: try catch 推送
    *<span class="hljs-javadoctag"> @param</span><span class="hljs-javadoctag"> @param</span> payload
    *<span class="hljs-javadoctag"> @param</span><span class="hljs-javadoctag"> @param</span> logger
    *<span class="hljs-javadoctag"> @param</span><span class="hljs-javadoctag"> @return</span>    设定文件 
    *<span class="hljs-javadoctag"> @return</span> String    返回类型 
    *<span class="hljs-javadoctag"> @throws</span> 
    */</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">sendPushTryCatch</span>(PushPayload payload, Logger logger){
    JPushClient jPushClient = <span class="hljs-keyword">new</span> JPushClient(MASTER_SECRET, APP_KEY);
    <span class="hljs-keyword">try</span> {
    PushResult pushResult = jPushClient.sendPush(payload);
    logger.info(<span class="hljs-string">"返回结果"</span> + pushResult);
    } <span class="hljs-keyword">catch</span> (APIConnectionException e) {
    logger.error(<span class="hljs-string">"连接错误，稍后尝试"</span> + e);
    } <span class="hljs-keyword">catch</span> (APIRequestException e) {
    logger.error(<span class="hljs-string">"极光推送内部错误"</span>, e);
    logger.info(<span class="hljs-string">"网络请求状态"</span> + e.getStatus());
    logger.info(<span class="hljs-string">"错误状态码"</span> + e.getErrorCode());
    logger.info(<span class="hljs-string">"错误信息"</span> + e.getErrorMessage());
    logger.info(<span class="hljs-string">"信息ID"</span> + e.getMsgId());
    logger.info(<span class="hljs-string">"极光推送错误信息:"</span> + e.getErrorMessage());
    }
    }

    <span class="hljs-javadoc">/**
    * 
    *<span class="hljs-javadoctag"> @Title</span>: buildPushObjectAllAllAlert 
    *<span class="hljs-javadoctag"> @Description</span>: (快捷地构建推送对象：所有平台，所有设备，内容为 alert 的通知) 
    *<span class="hljs-javadoctag"> @param</span><span class="hljs-javadoctag"> @param</span> alert
    *<span class="hljs-javadoctag"> @param</span><span class="hljs-javadoctag"> @return</span>    设定文件 
    *<span class="hljs-javadoctag"> @return</span> PushPayload    返回类型 
    *<span class="hljs-javadoctag"> @throws</span>
    */</span>
    <span class="hljs-annotation">@SuppressWarnings</span>(<span class="hljs-string">"static-access"</span>)
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> PushPayload <span class="hljs-title">buildPushObjectAllAllAlert</span>(String alert) {
       <span class="hljs-keyword">return</span> pushPayload.alertAll(alert);
    }

    <span class="hljs-javadoc">/** 
    *<span class="hljs-javadoctag"> @Title</span>: buildPushObjectAliasAlert 
    *<span class="hljs-javadoctag"> @Description</span>: (所有平台，推送目标是别名为 alias，通知内容为 alert) 
    *<span class="hljs-javadoctag"> @param</span><span class="hljs-javadoctag"> @param</span> alert
    *<span class="hljs-javadoctag"> @param</span><span class="hljs-javadoctag"> @param</span> alias
    *<span class="hljs-javadoctag"> @param</span><span class="hljs-javadoctag"> @return</span>    设定文件 
    *<span class="hljs-javadoctag"> @return</span> PushPayload    返回类型 
    *<span class="hljs-javadoctag"> @throws</span> 
    */</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> PushPayload <span class="hljs-title">buildPushObjectAliasAlert</span>(String days,String alert, String... alias) {
    Builder builder = PushPayload.newBuilder();
    <span class="hljs-keyword">return</span> builder
    .setPlatform(Platform.android_ios())
    .setAudience(Audience.alias(alias))
    .setNotification(Notification.newBuilder()
    .setAlert(alert)
    .addPlatformNotification(
    AndroidNotification.newBuilder()
    .addExtra(<span class="hljs-string">"sign"</span>, <span class="hljs-string">"5"</span>)
    .build())
    .addPlatformNotification(IosNotification.newBuilder()
    .addExtra(<span class="hljs-string">"sign"</span>, <span class="hljs-string">"5"</span>)
    .build())
    .build())
    .setOptions(Options.newBuilder()
            .setApnsProduction(<span class="hljs-keyword">false</span>)
            .setTimeToLive(Long.valueOf(Integer.valueOf(days)*<span class="hljs-number">86400</span>))
            .build())
    .build();
    }
    <span class="hljs-javadoc">/**
    * 
    *<span class="hljs-javadoctag"> @Title</span>: buildPushObjectIos 
    *<span class="hljs-javadoctag"> @Description</span>: (iOS推送 badge  sound) 
    *<span class="hljs-javadoctag"> @param</span><span class="hljs-javadoctag"> @param</span> alias
    *<span class="hljs-javadoctag"> @param</span><span class="hljs-javadoctag"> @param</span> alert
    *<span class="hljs-javadoctag"> @param</span><span class="hljs-javadoctag"> @param</span> badge
    *<span class="hljs-javadoctag"> @param</span><span class="hljs-javadoctag"> @return</span>    设定文件 
    *<span class="hljs-javadoctag"> @return</span> PushPayload    返回类型 
    *<span class="hljs-javadoctag"> @throws</span>
    */</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> PushPayload <span class="hljs-title">buildPushObjectIosAndroid</span>(String days,Map&lt;String, String&gt; params,
        String[] alias, String alert, <span class="hljs-keyword">int</span> badge, String sound, String msgContent) {
           Builder builder = PushPayload.newBuilder();
           <span class="hljs-keyword">return</span> builder
                   .setPlatform(Platform.android_ios())
                   .setAudience(Audience.alias(alias))
                   .setNotification(Notification.newBuilder()
                   .addPlatformNotification(IosNotification.newBuilder()
                   .setAlert(alert)
                   .setBadge(badge)
                   .addExtras(params)
                   .setSound(sound)
                   .build())
                   .addPlatformNotification(AndroidNotification.newBuilder()
                   .setAlert(alert)
                   .addExtras(params)
                   .build())
                   .build())
                   .setMessage(Message.newBuilder()
                   .setMsgContent(msgContent)
                   .build())
                   .setOptions(Options.newBuilder()
                            .setApnsProduction(<span class="hljs-keyword">false</span>)
                            .setTimeToLive(Long.valueOf(Integer.valueOf(days)*<span class="hljs-number">86400</span>))
                            .build())
                   .build();
       }

        <span class="hljs-javadoc">/** 
        *<span class="hljs-javadoctag"> @Title</span>: buildPushObjectAllAliasAlert 
        *<span class="hljs-javadoctag"> @Description</span>: (所有平台，推送目标是别名为 alias，通知标题为 title，通知内容为 alert) 
        *<span class="hljs-javadoctag"> @param</span><span class="hljs-javadoctag"> @param</span> params
        *<span class="hljs-javadoctag"> @param</span><span class="hljs-javadoctag"> @param</span> alias
        *<span class="hljs-javadoctag"> @param</span><span class="hljs-javadoctag"> @return</span>    设定文件 
        *<span class="hljs-javadoctag"> @return</span> PushPayload    返回类型 
        *<span class="hljs-javadoctag"> @throws</span> 
        */</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> PushPayload <span class="hljs-title">buildPushObjectAllAliasAlert</span>(String days,Map&lt;String, String&gt; params, String alert, String title,String... alias) {
        Builder builder = PushPayload.newBuilder();
        <span class="hljs-keyword">return</span> builder
                    .setPlatform(Platform.android_ios()) 
                    .setAudience(Audience.alias(alias))  
                    .setNotification(Notification.newBuilder()  
                            .setAlert(alert)
                            .addPlatformNotification(AndroidNotification.newBuilder()  
                                    .setTitle(title)
                                    .addExtras(params)
                                    .build())  
                            .addPlatformNotification(IosNotification.newBuilder()
                            .addExtras(params)
                                    .build())  
                            .build())  
                    .setOptions(Options.newBuilder()
                            .setApnsProduction(<span class="hljs-keyword">false</span>)
                            .setTimeToLive(Long.valueOf(Integer.valueOf(days)*<span class="hljs-number">86400</span>))
                            .build())
                    .build();  
        }


        <span class="hljs-javadoc">/** 
        *<span class="hljs-javadoctag"> @Title</span>: buildPushObjectAndroidTagAlertWithTitle 
        *<span class="hljs-javadoctag"> @Description</span>: (平台是 Android，目标是 tag 为 tag 的设备，内容是 Android 通知 alert，并且标题为 title) 
        *<span class="hljs-javadoctag"> @param</span><span class="hljs-javadoctag"> @param</span> tag
        *<span class="hljs-javadoctag"> @param</span><span class="hljs-javadoctag"> @param</span> alert
        *<span class="hljs-javadoctag"> @param</span><span class="hljs-javadoctag"> @param</span> title
        *<span class="hljs-javadoctag"> @param</span><span class="hljs-javadoctag"> @return</span>    设定文件 
        *<span class="hljs-javadoctag"> @return</span> PushPayload    返回类型 
        *<span class="hljs-javadoctag"> @throws</span> 
        */</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> PushPayload <span class="hljs-title">buildPushObjectAndroidTagAlertWithTitle</span>(String days,String tag, String alert, String title) {
            Builder builder = PushPayload.newBuilder();
            <span class="hljs-keyword">return</span> builder
                    .setPlatform(Platform.android())
                    .setAudience(Audience.tag(tag))
                    .setNotification(Notification.android(alert, title, <span class="hljs-keyword">null</span>))
                    .setOptions(Options.newBuilder()
                            .setApnsProduction(<span class="hljs-keyword">false</span>)
                            .setTimeToLive(Long.valueOf(Integer.valueOf(days)*<span class="hljs-number">86400</span>))
                            .build())
                    .build();
        }

        <span class="hljs-javadoc">/** 
        *<span class="hljs-javadoctag"> @Title</span>: buildPushObjectIosTagAndAlertWithExtrasAndMessage 
        *<span class="hljs-javadoctag"> @Description</span>: (
        * 构建推送对象：平台是 iOS，推送目标是 tag, tagAll 的交集，
        * 推送内容同时包括通知与消息 - 通知信息是 alert，角标数字为 number，
        * 消息内容是 msgContent。
        * 通知是 APNs 推送通道的，消息是 JPush 应用内消息通道的。
        * APNs 的推送环境是“开发”（如果不显式设置的话，Library 会默认指定为开发）
        * true 表示推送生产环境，true 表示要推送开发环境 
        *  )
        *<span class="hljs-javadoctag"> @param</span><span class="hljs-javadoctag"> @param</span> tag
        *<span class="hljs-javadoctag"> @param</span><span class="hljs-javadoctag"> @param</span> tagAll
        *<span class="hljs-javadoctag"> @param</span><span class="hljs-javadoctag"> @param</span> number
        *<span class="hljs-javadoctag"> @param</span><span class="hljs-javadoctag"> @param</span> alert
        *<span class="hljs-javadoctag"> @param</span><span class="hljs-javadoctag"> @param</span> msgContent
        *<span class="hljs-javadoctag"> @param</span><span class="hljs-javadoctag"> @return</span>    设定文件 
        *<span class="hljs-javadoctag"> @return</span> PushPayload    返回类型 
        *<span class="hljs-javadoctag"> @throws</span> 
        */</span>
        <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> PushPayload <span class="hljs-title">buildPushObjectIosTagAndAlertWithExtrasAndMessage</span>(String days,
        String tag, String tagAll, <span class="hljs-keyword">int</span> number, String alert, String msgContent) {
            Builder builder = PushPayload.newBuilder();
            <span class="hljs-keyword">return</span> builder
            .setPlatform(Platform.ios())
                    .setAudience(Audience.tag_and(tag, tagAll))
                    .setNotification(Notification.newBuilder()
                            .addPlatformNotification(IosNotification.newBuilder()
                                    .setAlert(alert)
                                    .setBadge(number)
                                    .build())
                            .build())
                     .setMessage(Message.content(msgContent))
                     .setOptions(Options.newBuilder()
                             .setApnsProduction(<span class="hljs-keyword">false</span>)
                             .setTimeToLive(Long.valueOf(Integer.valueOf(days)*<span class="hljs-number">86400</span>))
                             .build())
                     .build();
        }

        <span class="hljs-javadoc">/** 
         * 构建推送对象：平台是 Andorid 与 iOS，
        * 推送目标是 （tag1 与 tag2 的并集），
        * 推送内容是 - 内容为 msgContent 的消息
        *<span class="hljs-javadoctag"> @Title</span>: buildPushObjectIosAudienceMoreMessageWithExtras 
        *<span class="hljs-javadoctag"> @param</span><span class="hljs-javadoctag"> @param</span> tag1
        *<span class="hljs-javadoctag"> @param</span><span class="hljs-javadoctag"> @param</span> tag2
        *<span class="hljs-javadoctag"> @param</span><span class="hljs-javadoctag"> @param</span> msgContent
        *<span class="hljs-javadoctag"> @param</span><span class="hljs-javadoctag"> @return</span>    设定文件 
        *<span class="hljs-javadoctag"> @return</span> PushPayload    返回类型 
        *<span class="hljs-javadoctag"> @throws</span> 
        */</span>
        <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> PushPayload <span class="hljs-title">buildPushObjectIosAudienceMoreMessageWithExtras</span>(String days,
        String tag1, String tag2, String msgContent) {
            Builder builder = PushPayload.newBuilder();
            <span class="hljs-keyword">return</span> builder
                    .setPlatform(Platform.android_ios())
                    .setAudience(Audience.newBuilder()
                            .addAudienceTarget(AudienceTarget.tag(tag1, tag2))
                            .build())
                    .setMessage(Message.newBuilder()
                            .setMsgContent(msgContent)
                            .build())
                    .setOptions(Options.newBuilder()
                            .setApnsProduction(<span class="hljs-keyword">false</span>)
                            .setTimeToLive(Long.valueOf(Integer.valueOf(days)*<span class="hljs-number">86400</span>))
                            .build())
                    .build();
        }
        <span class="hljs-javadoc">/** 
        *<span class="hljs-javadoctag"> @Title</span>: sendAndroidMessageWithAliasAndExtras 
        *<span class="hljs-javadoctag"> @Description</span>: 用户自定义消息类型,以及传递附属信息,发送给安卓和IOS特定用户 
        *<span class="hljs-javadoctag"> @param</span><span class="hljs-javadoctag"> @param</span> extras
        *<span class="hljs-javadoctag"> @param</span><span class="hljs-javadoctag"> @param</span> title
        *<span class="hljs-javadoctag"> @param</span><span class="hljs-javadoctag"> @param</span> msgContent
        *<span class="hljs-javadoctag"> @param</span><span class="hljs-javadoctag"> @param</span> alias
        *<span class="hljs-javadoctag"> @param</span><span class="hljs-javadoctag"> @return</span>
        *<span class="hljs-javadoctag"> @param</span><span class="hljs-javadoctag"> @throws</span> APIConnectionException
        *<span class="hljs-javadoctag"> @param</span><span class="hljs-javadoctag"> @throws</span> APIRequestException    设定文件 
        *<span class="hljs-javadoctag"> @return</span> PushPayload    返回类型 
        *<span class="hljs-javadoctag"> @throws</span> 
        */</span>
        <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> PushPayload <span class="hljs-title">sendAndroidAndIosMessageWithAliasAndExtras</span>(String days,Map&lt;String, String&gt;extras,String title, String msgContent, String... alias) 
                <span class="hljs-keyword">throws</span> APIConnectionException, APIRequestException {
                  Builder builder = PushPayload.newBuilder();
                    <span class="hljs-keyword">return</span> builder
                            .setPlatform(Platform.android_ios())
                            .setAudience(Audience.alias(alias))
                            .setMessage(Message.newBuilder()
                                    .setTitle(title)
                                    .setMsgContent(msgContent)
                                    .addExtras(extras)
                                    .build())
                            .setOptions(Options.newBuilder()
                                    .setApnsProduction(<span class="hljs-keyword">false</span>)
                                    .setTimeToLive(Long.valueOf(Integer.valueOf(days)*<span class="hljs-number">86400</span>))
                                    .build())
                            .build();
        }

        <span class="hljs-javadoc">/** 
        *<span class="hljs-javadoctag"> @Title</span>: sendAndroidMessageWithAlias 
        *<span class="hljs-javadoctag"> @Description</span>: 用户自定义消息类型，无附加属性信息，发送给安卓和IOS特定用户 
        *<span class="hljs-javadoctag"> @param</span><span class="hljs-javadoctag"> @param</span> title
        *<span class="hljs-javadoctag"> @param</span><span class="hljs-javadoctag"> @param</span> msgContent
        *<span class="hljs-javadoctag"> @param</span><span class="hljs-javadoctag"> @param</span> alias
        *<span class="hljs-javadoctag"> @param</span><span class="hljs-javadoctag"> @return</span>
        *<span class="hljs-javadoctag"> @param</span><span class="hljs-javadoctag"> @throws</span> APIConnectionException
        *<span class="hljs-javadoctag"> @param</span><span class="hljs-javadoctag"> @throws</span> APIRequestException    设定文件 
        *<span class="hljs-javadoctag"> @return</span> PushPayload    返回类型 
        *<span class="hljs-javadoctag"> @throws</span> 
        */</span>
        <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> PushPayload <span class="hljs-title">sendAndroidAndIosMessageWithAlias</span>(String days,Map&lt;String,String&gt; extras,String title, String msgContent, String... alias) 
                <span class="hljs-keyword">throws</span> APIConnectionException, APIRequestException {
                 Builder builder = PushPayload.newBuilder();
                    <span class="hljs-keyword">return</span> builder
                            .setPlatform(Platform.android_ios())
                            .setAudience(Audience.alias(alias))
                            .setMessage(Message.newBuilder()
                                    .setTitle(title)
                                    .setMsgContent(msgContent)
                                    .addExtras(extras)
                                    .build())
                            .setOptions(Options.newBuilder()
                                    .setApnsProduction(<span class="hljs-keyword">false</span>)
                                    .setTimeToLive(Long.valueOf(Integer.valueOf(days)*<span class="hljs-number">86400</span>))
                                    .build())
                            .build();
        }

        <span class="hljs-javadoc">/** 
        *<span class="hljs-javadoctag"> @Title</span>: sendAndroidAndIosMessageAndNotification 
        *<span class="hljs-javadoctag"> @Description</span>: 推送消息和通知，发送给所有安卓和IOS用户 
        *<span class="hljs-javadoctag"> @param</span><span class="hljs-javadoctag"> @param</span> title
        *<span class="hljs-javadoctag"> @param</span><span class="hljs-javadoctag"> @param</span> alert
        *<span class="hljs-javadoctag"> @param</span><span class="hljs-javadoctag"> @return</span>    设定文件 
        *<span class="hljs-javadoctag"> @return</span> PushPayload    返回类型 
        *<span class="hljs-javadoctag"> @throws</span> 
        */</span>
        <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> PushPayload <span class="hljs-title">sendAndroidAndIosMessageAndNotification</span>(String days,String content,String alert){
            Builder builder = PushPayload.newBuilder();
            <span class="hljs-keyword">return</span> builder
                    .setPlatform(Platform.android_ios())
                    .setNotification(Notification.newBuilder()  
                                    .setAlert(alert)
                                    .build()) 
                    .setMessage(Message.newBuilder()
                                    .setTitle(<span class="hljs-string">""</span>)
                                    .setMsgContent(content)
                                    .build())
                    .setOptions(Options.newBuilder()
                            .setApnsProduction(<span class="hljs-keyword">false</span>)
                            .setTimeToLive(Long.valueOf(Integer.valueOf(days)*<span class="hljs-number">86400</span>))
                            .build())
                    .build();
        }

<span class="hljs-comment">//      public static void main(String[] args) {</span>
<span class="hljs-comment">//          try {</span>
<span class="hljs-comment">//              sendPush(sendAndroidAndIosMessageWithAlias("1", null,"超神了哦", "123456"));</span>
<span class="hljs-comment">//          } catch (APIConnectionException e) {</span>
<span class="hljs-comment">//              LOG.error("Connection error. Should retry later. ", e);</span>
<span class="hljs-comment">//          } catch (APIRequestException e) {</span>
<span class="hljs-comment">//              LOG.error("Error response from JPush server. Should review and fix it. ", e);</span>
<span class="hljs-comment">//              LOG.info("HTTP Status: " + e.getStatus());</span>
<span class="hljs-comment">//              LOG.info("Error Code: " + e.getErrorCode());</span>
<span class="hljs-comment">//              LOG.info("Error Message: " + e.getErrorMessage());</span>
<span class="hljs-comment">//          }</span>
<span class="hljs-comment">//          </span>
<span class="hljs-comment">//      }</span>
}
</code></pre>

<p><strong>与项目整合及运用，本人习惯把它整成一个工具类然后打成JAR包放入需要他的项目中</strong></p>



<pre class="prettyprint"><code class=" hljs xml"><span class="hljs-tag">&lt;<span class="hljs-title">dependency</span>&gt;</span>
             <span class="hljs-tag">&lt;<span class="hljs-title">groupId</span>&gt;</span>com.lyt<span class="hljs-tag">&lt;/<span class="hljs-title">groupId</span>&gt;</span>
             <span class="hljs-tag">&lt;<span class="hljs-title">artifactId</span>&gt;</span>lytJPush<span class="hljs-tag">&lt;/<span class="hljs-title">artifactId</span>&gt;</span>
             <span class="hljs-tag">&lt;<span class="hljs-title">version</span>&gt;</span>0.0.1<span class="hljs-tag">&lt;/<span class="hljs-title">version</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-title">dependency</span>&gt;</span></code></pre>



<pre class="prettyprint"><code class=" hljs avrasm">//极光推送自定义消息
        String title = postInfoService<span class="hljs-preprocessor">.getPostById</span>(postReview<span class="hljs-preprocessor">.getPostId</span>())<span class="hljs-preprocessor">.getTitle</span>()<span class="hljs-comment">;</span>
        if(postReview<span class="hljs-preprocessor">.getParentId</span>()!=null){
            String pUserId = postReviewDao<span class="hljs-preprocessor">.select</span>(postReview<span class="hljs-preprocessor">.getParentId</span>())<span class="hljs-preprocessor">.getUserId</span>()<span class="hljs-preprocessor">.toString</span>()<span class="hljs-comment">;</span>
            String userName = Base64Util<span class="hljs-preprocessor">.getFromBase</span>64(userService<span class="hljs-preprocessor">.getUserInfo</span>(postReview<span class="hljs-preprocessor">.getUserId</span>())<span class="hljs-preprocessor">.getNickName</span>())<span class="hljs-comment">;</span>
            String[] alias = {pUserId}<span class="hljs-comment">;</span>
            Map&lt;String,String&gt; parms = new HashMap&lt;&gt;()<span class="hljs-comment">; </span>
            parms<span class="hljs-preprocessor">.put</span>(<span class="hljs-string">"userId"</span>, postReview<span class="hljs-preprocessor">.getUserId</span>()+<span class="hljs-string">""</span>)<span class="hljs-comment">;</span>
            parms<span class="hljs-preprocessor">.put</span>(<span class="hljs-string">"postId"</span>, postReview<span class="hljs-preprocessor">.getPostId</span>()+<span class="hljs-string">""</span>)<span class="hljs-comment">;</span>
            parms<span class="hljs-preprocessor">.put</span>(<span class="hljs-string">"userName"</span>, userName)<span class="hljs-comment">;</span>
            parms<span class="hljs-preprocessor">.put</span>(<span class="hljs-string">"title"</span>, title+<span class="hljs-string">""</span>)<span class="hljs-comment">;</span>
            parms<span class="hljs-preprocessor">.put</span>(<span class="hljs-string">"type"</span>,<span class="hljs-string">"5"</span>)<span class="hljs-comment">;</span>
            try { 
                PushPayload data = MsgPushUtils<span class="hljs-preprocessor">.sendAndroidAndIosMessageWithAliasAndExtras</span>(<span class="hljs-string">"10"</span>,parms,PushConstant<span class="hljs-preprocessor">.getModelReviewReply</span>(title), <span class="hljs-string">"回复了您的评论"</span>, alias)<span class="hljs-comment">;</span>
                MsgPushUtils<span class="hljs-preprocessor">.sendPush</span>(data)<span class="hljs-comment">;</span>
            } catch (APIConnectionException e) {
                log<span class="hljs-preprocessor">.error</span>(<span class="hljs-string">"Connection error. Should retry later. "</span>, e)<span class="hljs-comment">;</span>
            } catch (APIRequestException e) {
                log<span class="hljs-preprocessor">.error</span>(<span class="hljs-string">"Error response from JPush server. Should review and fix it. "</span>, e)<span class="hljs-comment">;</span>
                log<span class="hljs-preprocessor">.info</span>(<span class="hljs-string">"HTTP Status: "</span> + e<span class="hljs-preprocessor">.getStatus</span>())<span class="hljs-comment">;</span>
                log<span class="hljs-preprocessor">.info</span>(<span class="hljs-string">"Error Code: "</span> + e<span class="hljs-preprocessor">.getErrorCode</span>())<span class="hljs-comment">;</span>
                log<span class="hljs-preprocessor">.info</span>(<span class="hljs-string">"Error Message: "</span> + e<span class="hljs-preprocessor">.getErrorMessage</span>())<span class="hljs-comment">;</span>
            }
        }</code></pre>

<p><strong>注意：setApnsProduction(false)</strong></p>

<p>IOS开发者模式的话这个不关闭是搜不到消息的，IOS对应的值    该为YES <br />
至于安卓则没有这方面的限制</p>

<p>还有很多设置提示背景音乐啊什么的这个没深入研究也就没弄。</p></div>&#13;
        <script type="text/javascript">&#13;
            $(function () {&#13;
                $('pre.prettyprint code').each(function () {&#13;
                    var lines = $(this).text().split('\n').length;&#13;
                    var $numbering = $('&lt;ul/&gt;').addClass('pre-numbering').hide();&#13;
                    $(this).addClass('has-numbering').parent().append($numbering);&#13;
                    for (i = 1; i &lt;= lines; i++) {&#13;
                        $numbering.append($('&lt;li/&gt;').text(i));&#13;
                    };&#13;
                    $numbering.fadeIn(1700);&#13;
                });&#13;
            });&#13;
        </script>&#13;
   &#13;
