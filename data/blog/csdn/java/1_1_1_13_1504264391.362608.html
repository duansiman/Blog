
        <div class="markdown_views"><p>前言：mybatis是一个非常优秀的存储过程和高级映射的优秀持久层框架。大大简化了，数据库操作中的常用操作。下面将介绍mybatis的一些概念和在eclipse上的实际项目搭建使用。</p>



<h2 id="一mybatis的概念介绍">一、mybatis的概念介绍</h2>

<p><strong>1.1、背景介绍</strong></p>

<p>MyBatis 是支持普通 SQL查询，存储过程和高级映射的优秀持久层框架。MyBatis 消除了几乎所有的JDBC代码和参数的手工设置以及结果集的检索。MyBatis 使用简单的 XML或注解用于配置和原始映射，将接口和 Java 的POJOs（Plain Old Java Objects，普通的 Java对象）映射成数据库中的记录。</p>

<p>每个MyBatis应用程序主要都是使用SqlSessionFactory实例的，一个SqlSessionFactory实例可以通过SqlSessionFactoryBuilder获得。SqlSessionFactoryBuilder可以从一个xml配置文件或者一个预定义的配置类的实例获得。</p>

<p>用xml文件构建SqlSessionFactory实例是非常简单的事情。推荐在这个配置中使用类路径资源（classpath resource)，但你可以使用任何Reader实例，包括用文件路径或file://开头的url创建的实例。MyBatis有一个实用类—-Resources，它有很多方法，可以方便地从类路径及其它位置加载资源。</p>

<p><strong>1.2、总体流程</strong></p>

<p>(1)加载配置并初始化 <br />
触发条件：加载配置文件 <br />
将SQL的配置信息加载成为一个个MappedStatement对象（包括了传入参数映射配置、执行的SQL语句、结果映射配置），存储在内存中。</p>

<p>(2)接收调用请求 <br />
触发条件：调用Mybatis提供的API <br />
传入参数：为SQL的ID和传入参数对象 <br />
处理过程：将请求传递给下层的请求处理层进行处理。</p>

<p>(3)处理操作请求 触发条件：API接口层传递请求过来 <br />
传入参数：为SQL的ID和传入参数对象 <br />
处理过程： <br />
(A)根据SQL的ID查找对应的MappedStatement对象。 <br />
(B)根据传入参数对象解析MappedStatement对象，得到最终要执行的SQL和执行传入参数。 <br />
(C)获取数据库连接，根据得到的最终SQL语句和执行传入参数到数据库执行，并得到执行结果。 <br />
(D)根据MappedStatement对象中的结果映射配置对得到的执行结果进行转换处理，并得到最终的处理结果。 <br />
(E)释放连接资源。</p>

<p>(4)返回处理结果将最终的处理结果返回。</p>

<p><strong>1.3、功能架构</strong></p>

<p>功能架构讲解： <br />
我们把Mybatis的功能架构分为三层：</p>

<p>(1)API接口层：提供给外部使用的接口API，开发人员通过这些本地API来操纵数据库。接口层一接收到调用请求就会调用数据处理层来完成具体的数据处理。</p>

<p>(2)数据处理层：负责具体的SQL查找、SQL解析、SQL执行和执行结果映射处理等。它主要的目的是根据调用的请求完成一次数据库操作。</p>

<p>(3)基础支撑层：负责最基础的功能支撑，包括连接管理、事务管理、配置加载和缓存处理，这些都是共用的东西，将他们抽取出来作为最基础的组件。为上层的数据处理层提供最基础的支撑。</p>

<p><strong>1.4、框架架构</strong></p>

<p>框架架构讲解：</p>

<p>（1）加载配置：配置来源于两个地方，一处是配置文件，一处是Java代码的注解，将SQL的配置信息加载成为一个MappedStatement对象（包括了传入参数映射配置、执行的SQL语句、结果映射配置），存储在内存中。</p>

<p>（2）SQL解析：当API接口层接收到调用请求时，会接收到传入SQL的ID和传入对象（可以是Map、JavaBean或者基本数据类型），Mybatis会根据SQL的ID找到对应的MappedStatement，然后根据传入参数对象对MappedStatement进行解析，解析后可以得到最终要执行的SQL语句和参数。</p>

<p>（3）SQL执行：将最终得到的SQL和参数拿到数据库进行执行，得到操作数据库的结果。</p>

<p>（4）结果映射：将操作数据库的结果按照映射的配置进行转换，可以转换成HashMap、JavaBean或者基本数据类型，并将最终结果返回。</p>

<p><strong>1.5、动态SQL</strong></p>

<p>MyBatis 最强大的特性之一就是它的动态语句功能。如果您以前有使用JDBC或者类似框架的经历，您就会明白把SQL语句条件连接在一起是多么的痛苦，要确保不能忘记空格或者不要在columns列后面省略一个逗号等。动态语句能够完全解决掉这些痛苦。尽管与动态SQL一起工作不是在开一个party，但是MyBatis确实能通过在任何映射SQL语句中使用强大的动态SQL来改进这些状况。</p>

<p>动态SQL元素对于任何使用过JSTL或者类似于XML之类的文本处理器的人来说，都是非常熟悉的。在上一版本中，需要了解和学习非常多的元素，但在MyBatis 3 中有了许多的改进，现在只剩下差不多二分之一的元素。MyBatis使用了基于强大的OGNL表达式来消除了大部分元素。</p>



<h2 id="二mybatis实例">二、mybatis实例</h2>

<p>接下来的mybatis的实例是在eclipse+maven+mysql的基础上写的，如果猿友们，没有搭建好maven，甚至没有听过maven的，那么请阅读博主的关于maven的文章：<a href="http://blog.csdn.net/u013142781/article/details/50316383">http://blog.csdn.net/u013142781/article/details/50316383</a>（含实例哦） <br />
如果mysql没有搭建好的话，可以阅读博主的另外一篇文章：<a href="http://blog.csdn.net/u013142781/article/details/50300233">http://blog.csdn.net/u013142781/article/details/50300233</a></p>

<p>1、创建表，并插入数据：</p>



<pre class="prettyprint"><code class=" hljs sql"><span class="hljs-operator"><span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">TABLE</span> <span class="hljs-string">`t_user`</span> (
  <span class="hljs-string">`USER_ID`</span> <span class="hljs-keyword">int</span>(<span class="hljs-number">11</span>) <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">NULL</span> AUTO_INCREMENT,
  <span class="hljs-string">`USER_NAME`</span> <span class="hljs-keyword">char</span>(<span class="hljs-number">30</span>) <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">NULL</span>,
  <span class="hljs-string">`USER_PASSWORD`</span> <span class="hljs-keyword">char</span>(<span class="hljs-number">10</span>) <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">NULL</span>,
  <span class="hljs-keyword">PRIMARY</span> <span class="hljs-keyword">KEY</span> (<span class="hljs-string">`USER_ID`</span>),
  <span class="hljs-keyword">KEY</span> <span class="hljs-string">`IDX_NAME`</span> (<span class="hljs-string">`USER_NAME`</span>)
) ENGINE=InnoDB AUTO_INCREMENT=<span class="hljs-number">11</span> <span class="hljs-keyword">DEFAULT</span> CHARSET=utf8</span></code></pre>



<pre class="prettyprint"><code class=" hljs sql"><span class="hljs-operator"><span class="hljs-keyword">INSERT</span> <span class="hljs-keyword">INTO</span> t_user (USER_ID, USER_NAME, USER_PASSWORD) <span class="hljs-keyword">VALUES</span> (<span class="hljs-number">1</span>, <span class="hljs-string">'luoguohui'</span>, <span class="hljs-string">'123456'</span>);</span>
<span class="hljs-operator"><span class="hljs-keyword">INSERT</span> <span class="hljs-keyword">INTO</span> t_user (USER_ID, USER_NAME, USER_PASSWORD) <span class="hljs-keyword">VALUES</span> (<span class="hljs-number">2</span>, <span class="hljs-string">'zhangsan'</span>, <span class="hljs-string">'123456'</span>);</span>
</code></pre>

<p>2、添加包的依赖，我的文章 <a href="http://blog.csdn.net/u013142781/article/details/50316383">Maven之初恋</a>，已经创建好的maven项目，现在只需要添加如下依赖：</p>



<pre class="prettyprint"><code class=" hljs xml"><span class="hljs-tag">&lt;<span class="hljs-title">project</span> <span class="hljs-attribute">xmlns</span>=<span class="hljs-value">"http://maven.apache.org/POM/4.0.0"</span> <span class="hljs-attribute">xmlns:xsi</span>=<span class="hljs-value">"http://www.w3.org/2001/XMLSchema-instance"</span> <span class="hljs-attribute">xsi:schemaLocation</span>=<span class="hljs-value">"http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd"</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-title">modelVersion</span>&gt;</span>4.0.0<span class="hljs-tag">&lt;/<span class="hljs-title">modelVersion</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-title">groupId</span>&gt;</span>com.luo<span class="hljs-tag">&lt;/<span class="hljs-title">groupId</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-title">artifactId</span>&gt;</span>first_maven_project<span class="hljs-tag">&lt;/<span class="hljs-title">artifactId</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-title">version</span>&gt;</span>0.0.1-SNAPSHOT<span class="hljs-tag">&lt;/<span class="hljs-title">version</span>&gt;</span>

  <span class="hljs-tag">&lt;<span class="hljs-title">properties</span>&gt;</span>
        <span class="hljs-comment">&lt;!-- spring版本号 --&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-title">spring.version</span>&gt;</span>3.2.8.RELEASE<span class="hljs-tag">&lt;/<span class="hljs-title">spring.version</span>&gt;</span>
        <span class="hljs-comment">&lt;!-- log4j日志文件管理包版本 --&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-title">slf4j.version</span>&gt;</span>1.6.6<span class="hljs-tag">&lt;/<span class="hljs-title">slf4j.version</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-title">log4j.version</span>&gt;</span>1.2.12<span class="hljs-tag">&lt;/<span class="hljs-title">log4j.version</span>&gt;</span>
        <span class="hljs-comment">&lt;!-- junit版本号 --&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-title">junit.version</span>&gt;</span>4.10<span class="hljs-tag">&lt;/<span class="hljs-title">junit.version</span>&gt;</span>
        <span class="hljs-comment">&lt;!-- mybatis版本号 --&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-title">mybatis.version</span>&gt;</span>3.2.1<span class="hljs-tag">&lt;/<span class="hljs-title">mybatis.version</span>&gt;</span>
  <span class="hljs-tag">&lt;/<span class="hljs-title">properties</span>&gt;</span>

  <span class="hljs-tag">&lt;<span class="hljs-title">dependencies</span>&gt;</span>
        <span class="hljs-comment">&lt;!-- 添加Spring依赖 --&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-title">dependency</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-title">groupId</span>&gt;</span>org.springframework<span class="hljs-tag">&lt;/<span class="hljs-title">groupId</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-title">artifactId</span>&gt;</span>spring-core<span class="hljs-tag">&lt;/<span class="hljs-title">artifactId</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-title">version</span>&gt;</span>${spring.version}<span class="hljs-tag">&lt;/<span class="hljs-title">version</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-title">dependency</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-title">dependency</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-title">groupId</span>&gt;</span>org.springframework<span class="hljs-tag">&lt;/<span class="hljs-title">groupId</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-title">artifactId</span>&gt;</span>spring-webmvc<span class="hljs-tag">&lt;/<span class="hljs-title">artifactId</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-title">version</span>&gt;</span>${spring.version}<span class="hljs-tag">&lt;/<span class="hljs-title">version</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-title">dependency</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-title">dependency</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-title">groupId</span>&gt;</span>org.springframework<span class="hljs-tag">&lt;/<span class="hljs-title">groupId</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-title">artifactId</span>&gt;</span>spring-context<span class="hljs-tag">&lt;/<span class="hljs-title">artifactId</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-title">version</span>&gt;</span>${spring.version}<span class="hljs-tag">&lt;/<span class="hljs-title">version</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-title">dependency</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-title">dependency</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-title">groupId</span>&gt;</span>org.springframework<span class="hljs-tag">&lt;/<span class="hljs-title">groupId</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-title">artifactId</span>&gt;</span>spring-context-support<span class="hljs-tag">&lt;/<span class="hljs-title">artifactId</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-title">version</span>&gt;</span>${spring.version}<span class="hljs-tag">&lt;/<span class="hljs-title">version</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-title">dependency</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-title">dependency</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-title">groupId</span>&gt;</span>org.springframework<span class="hljs-tag">&lt;/<span class="hljs-title">groupId</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-title">artifactId</span>&gt;</span>spring-aop<span class="hljs-tag">&lt;/<span class="hljs-title">artifactId</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-title">version</span>&gt;</span>${spring.version}<span class="hljs-tag">&lt;/<span class="hljs-title">version</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-title">dependency</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-title">dependency</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-title">groupId</span>&gt;</span>org.springframework<span class="hljs-tag">&lt;/<span class="hljs-title">groupId</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-title">artifactId</span>&gt;</span>spring-aspects<span class="hljs-tag">&lt;/<span class="hljs-title">artifactId</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-title">version</span>&gt;</span>${spring.version}<span class="hljs-tag">&lt;/<span class="hljs-title">version</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-title">dependency</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-title">dependency</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-title">groupId</span>&gt;</span>org.springframework<span class="hljs-tag">&lt;/<span class="hljs-title">groupId</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-title">artifactId</span>&gt;</span>spring-tx<span class="hljs-tag">&lt;/<span class="hljs-title">artifactId</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-title">version</span>&gt;</span>${spring.version}<span class="hljs-tag">&lt;/<span class="hljs-title">version</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-title">dependency</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-title">dependency</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-title">groupId</span>&gt;</span>org.springframework<span class="hljs-tag">&lt;/<span class="hljs-title">groupId</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-title">artifactId</span>&gt;</span>spring-jdbc<span class="hljs-tag">&lt;/<span class="hljs-title">artifactId</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-title">version</span>&gt;</span>${spring.version}<span class="hljs-tag">&lt;/<span class="hljs-title">version</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-title">dependency</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-title">dependency</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-title">groupId</span>&gt;</span>org.springframework<span class="hljs-tag">&lt;/<span class="hljs-title">groupId</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-title">artifactId</span>&gt;</span>spring-web<span class="hljs-tag">&lt;/<span class="hljs-title">artifactId</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-title">version</span>&gt;</span>${spring.version}<span class="hljs-tag">&lt;/<span class="hljs-title">version</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-title">dependency</span>&gt;</span>

        <span class="hljs-comment">&lt;!--单元测试依赖 --&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-title">dependency</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-title">groupId</span>&gt;</span>junit<span class="hljs-tag">&lt;/<span class="hljs-title">groupId</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-title">artifactId</span>&gt;</span>junit<span class="hljs-tag">&lt;/<span class="hljs-title">artifactId</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-title">version</span>&gt;</span>${junit.version}<span class="hljs-tag">&lt;/<span class="hljs-title">version</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-title">scope</span>&gt;</span>test<span class="hljs-tag">&lt;/<span class="hljs-title">scope</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-title">dependency</span>&gt;</span>

        <span class="hljs-comment">&lt;!-- 日志文件管理包 --&gt;</span>
        <span class="hljs-comment">&lt;!-- log start --&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-title">dependency</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-title">groupId</span>&gt;</span>log4j<span class="hljs-tag">&lt;/<span class="hljs-title">groupId</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-title">artifactId</span>&gt;</span>log4j<span class="hljs-tag">&lt;/<span class="hljs-title">artifactId</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-title">version</span>&gt;</span>${log4j.version}<span class="hljs-tag">&lt;/<span class="hljs-title">version</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-title">dependency</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-title">dependency</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-title">groupId</span>&gt;</span>org.slf4j<span class="hljs-tag">&lt;/<span class="hljs-title">groupId</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-title">artifactId</span>&gt;</span>slf4j-api<span class="hljs-tag">&lt;/<span class="hljs-title">artifactId</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-title">version</span>&gt;</span>${slf4j.version}<span class="hljs-tag">&lt;/<span class="hljs-title">version</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-title">dependency</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-title">dependency</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-title">groupId</span>&gt;</span>org.slf4j<span class="hljs-tag">&lt;/<span class="hljs-title">groupId</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-title">artifactId</span>&gt;</span>slf4j-log4j12<span class="hljs-tag">&lt;/<span class="hljs-title">artifactId</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-title">version</span>&gt;</span>${slf4j.version}<span class="hljs-tag">&lt;/<span class="hljs-title">version</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-title">dependency</span>&gt;</span>
        <span class="hljs-comment">&lt;!-- log end --&gt;</span>

        <span class="hljs-comment">&lt;!--spring单元测试依赖 --&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-title">dependency</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-title">groupId</span>&gt;</span>org.springframework<span class="hljs-tag">&lt;/<span class="hljs-title">groupId</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-title">artifactId</span>&gt;</span>spring-test<span class="hljs-tag">&lt;/<span class="hljs-title">artifactId</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-title">version</span>&gt;</span>${spring.version}<span class="hljs-tag">&lt;/<span class="hljs-title">version</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-title">scope</span>&gt;</span>test<span class="hljs-tag">&lt;/<span class="hljs-title">scope</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-title">dependency</span>&gt;</span>

        <span class="hljs-comment">&lt;!--mybatis依赖 --&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-title">dependency</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-title">groupId</span>&gt;</span>org.mybatis<span class="hljs-tag">&lt;/<span class="hljs-title">groupId</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-title">artifactId</span>&gt;</span>mybatis<span class="hljs-tag">&lt;/<span class="hljs-title">artifactId</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-title">version</span>&gt;</span>${mybatis.version}<span class="hljs-tag">&lt;/<span class="hljs-title">version</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-title">dependency</span>&gt;</span>

        <span class="hljs-comment">&lt;!-- mybatis/spring包 --&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-title">dependency</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-title">groupId</span>&gt;</span>org.mybatis<span class="hljs-tag">&lt;/<span class="hljs-title">groupId</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-title">artifactId</span>&gt;</span>mybatis-spring<span class="hljs-tag">&lt;/<span class="hljs-title">artifactId</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-title">version</span>&gt;</span>1.2.0<span class="hljs-tag">&lt;/<span class="hljs-title">version</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-title">dependency</span>&gt;</span>

        <span class="hljs-comment">&lt;!-- mysql驱动包 --&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-title">dependency</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-title">groupId</span>&gt;</span>mysql<span class="hljs-tag">&lt;/<span class="hljs-title">groupId</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-title">artifactId</span>&gt;</span>mysql-connector-java<span class="hljs-tag">&lt;/<span class="hljs-title">artifactId</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-title">version</span>&gt;</span>5.1.29<span class="hljs-tag">&lt;/<span class="hljs-title">version</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-title">dependency</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-title">dependencies</span>&gt;</span>

<span class="hljs-tag">&lt;/<span class="hljs-title">project</span>&gt;</span></code></pre>

<p>3、配置文件：</p>

<p><img src="http://img.blog.csdn.net/20151223213727857" alt="这里写图片描述" title="" /></p>

<p>3.1、mybatis包下添加mybatis-config.xml文件（mybatis配置文件）：</p>



<pre class="prettyprint"><code class=" hljs xml"><span class="hljs-pi">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span>  
<span class="hljs-doctype">&lt;!DOCTYPE configuration PUBLIC "-//mybatis.org//DTD Config 3.0//EN"  
"http://mybatis.org/dtd/mybatis-3-config.dtd"&gt;</span>  
<span class="hljs-tag">&lt;<span class="hljs-title">configuration</span>&gt;</span>    
<span class="hljs-tag">&lt;/<span class="hljs-title">configuration</span>&gt;</span></code></pre>

<p>3.2、properties包下添加jdbc.properties文件（数据源配置文件）：</p>



<pre class="prettyprint"><code class=" hljs ini"><span class="hljs-setting">jdbc_driverClassName=<span class="hljs-value">com.mysql.jdbc.Driver</span></span>
<span class="hljs-setting">jdbc_url=<span class="hljs-value">jdbc:mysql://localhost:<span class="hljs-number">3306</span>/luo</span></span>
<span class="hljs-setting">jdbc_username=<span class="hljs-value">root</span></span>
<span class="hljs-setting">jdbc_password=<span class="hljs-value">root</span></span></code></pre>

<p>3.3、mapper包下userMapper.xml配置文件（表映射文件）：</p>



<pre class="prettyprint"><code class=" hljs xml"><span class="hljs-pi">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span>  
<span class="hljs-doctype">&lt;!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"  
"http://mybatis.org/dtd/mybatis-3-mapper.dtd"&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-title">mapper</span> <span class="hljs-attribute">namespace</span>=<span class="hljs-value">"com.luo.dao.UserDao"</span>&gt;</span>
<span class="hljs-comment">&lt;!--设置domain类和数据库中表的字段一一对应，注意数据库字段和domain类中的字段名称不致，此处一定要！--&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-title">resultMap</span> <span class="hljs-attribute">id</span>=<span class="hljs-value">"BaseResultMap"</span> <span class="hljs-attribute">type</span>=<span class="hljs-value">"com.luo.domain.User"</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-title">id</span> <span class="hljs-attribute">column</span>=<span class="hljs-value">"USER_ID"</span> <span class="hljs-attribute">property</span>=<span class="hljs-value">"userId"</span> <span class="hljs-attribute">jdbcType</span>=<span class="hljs-value">"INTEGER"</span> /&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-title">result</span> <span class="hljs-attribute">column</span>=<span class="hljs-value">"USER_NAME"</span> <span class="hljs-attribute">property</span>=<span class="hljs-value">"userName"</span> <span class="hljs-attribute">jdbcType</span>=<span class="hljs-value">"CHAR"</span> /&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-title">result</span> <span class="hljs-attribute">column</span>=<span class="hljs-value">"USER_PASSWORD"</span> <span class="hljs-attribute">property</span>=<span class="hljs-value">"userPassword"</span> <span class="hljs-attribute">jdbcType</span>=<span class="hljs-value">"CHAR"</span> /&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-title">resultMap</span>&gt;</span>
    <span class="hljs-comment">&lt;!-- 查询单条记录 --&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-title">select</span> <span class="hljs-attribute">id</span>=<span class="hljs-value">"selectUserById"</span> <span class="hljs-attribute">parameterType</span>=<span class="hljs-value">"int"</span> <span class="hljs-attribute">resultMap</span>=<span class="hljs-value">"BaseResultMap"</span>&gt;</span>
        SELECT * FROM t_user WHERE USER_ID = #{userId}
    <span class="hljs-tag">&lt;/<span class="hljs-title">select</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-title">mapper</span>&gt;</span></code></pre>

<p>3.4、spring配置文件application.xml：</p>



<pre class="prettyprint"><code class=" hljs xml"><span class="hljs-pi">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-title">beans</span> <span class="hljs-attribute">xmlns</span>=<span class="hljs-value">"http://www.springframework.org/schema/beans"</span>
    <span class="hljs-attribute">xmlns:xsi</span>=<span class="hljs-value">"http://www.w3.org/2001/XMLSchema-instance"</span> <span class="hljs-attribute">xmlns:context</span>=<span class="hljs-value">"http://www.springframework.org/schema/context"</span>
    <span class="hljs-attribute">xmlns:aop</span>=<span class="hljs-value">"http://www.springframework.org/schema/aop"</span>
    <span class="hljs-attribute">xsi:schemaLocation</span>=<span class="hljs-value">"  
           http://www.springframework.org/schema/beans  
           http://www.springframework.org/schema/beans/spring-beans-3.0.xsd  
           http://www.springframework.org/schema/aop  
           http://www.springframework.org/schema/aop/spring-aop-3.0.xsd
           http://www.springframework.org/schema/context  
           http://www.springframework.org/schema/context/spring-context-3.0.xsd"</span>&gt;</span>

     <span class="hljs-comment">&lt;!-- 引入jdbc配置文件 --&gt;</span>  
     <span class="hljs-tag">&lt;<span class="hljs-title">bean</span> <span class="hljs-attribute">id</span>=<span class="hljs-value">"propertyConfigurer"</span> <span class="hljs-attribute">class</span>=<span class="hljs-value">"org.springframework.beans.factory.config.PropertyPlaceholderConfigurer"</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-title">property</span> <span class="hljs-attribute">name</span>=<span class="hljs-value">"locations"</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-title">list</span>&gt;</span>
               <span class="hljs-tag">&lt;<span class="hljs-title">value</span>&gt;</span>classpath:properties/*.properties<span class="hljs-tag">&lt;/<span class="hljs-title">value</span>&gt;</span>
                <span class="hljs-comment">&lt;!--要是有多个配置文件，只需在这里继续添加即可 --&gt;</span>
            <span class="hljs-tag">&lt;/<span class="hljs-title">list</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-title">property</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-title">bean</span>&gt;</span>



    <span class="hljs-comment">&lt;!-- 配置数据源 --&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-title">bean</span> <span class="hljs-attribute">id</span>=<span class="hljs-value">"dataSource"</span>
        <span class="hljs-attribute">class</span>=<span class="hljs-value">"org.springframework.jdbc.datasource.DriverManagerDataSource"</span>&gt;</span>
        <span class="hljs-comment">&lt;!-- 不使用properties来配置 --&gt;</span>
        <span class="hljs-comment">&lt;!-- &lt;property name="driverClassName" value="com.mysql.jdbc.Driver" /&gt; 
            &lt;property name="url" value="jdbc:mysql://localhost:3306/learning" /&gt; 
            &lt;property name="username" value="root" /&gt; 
            &lt;property name="password" value="christmas258@" /&gt; --&gt;</span>
       <span class="hljs-comment">&lt;!-- 使用properties来配置 --&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-title">property</span> <span class="hljs-attribute">name</span>=<span class="hljs-value">"driverClassName"</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-title">value</span>&gt;</span>${jdbc_driverClassName}<span class="hljs-tag">&lt;/<span class="hljs-title">value</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-title">property</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-title">property</span> <span class="hljs-attribute">name</span>=<span class="hljs-value">"url"</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-title">value</span>&gt;</span>${jdbc_url}<span class="hljs-tag">&lt;/<span class="hljs-title">value</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-title">property</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-title">property</span> <span class="hljs-attribute">name</span>=<span class="hljs-value">"username"</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-title">value</span>&gt;</span>${jdbc_username}<span class="hljs-tag">&lt;/<span class="hljs-title">value</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-title">property</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-title">property</span> <span class="hljs-attribute">name</span>=<span class="hljs-value">"password"</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-title">value</span>&gt;</span>${jdbc_password}<span class="hljs-tag">&lt;/<span class="hljs-title">value</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-title">property</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-title">bean</span>&gt;</span>

    <span class="hljs-comment">&lt;!-- 自动扫描了所有的XxxxMapper.xml对应的mapper接口文件，这样就不用一个一个手动配置Mpper的映射了，只要Mapper接口类和Mapper映射文件对应起来就可以了。 --&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-title">bean</span> <span class="hljs-attribute">class</span>=<span class="hljs-value">"org.mybatis.spring.mapper.MapperScannerConfigurer"</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-title">property</span> <span class="hljs-attribute">name</span>=<span class="hljs-value">"basePackage"</span>
            <span class="hljs-attribute">value</span>=<span class="hljs-value">"com.luo.dao"</span> /&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-title">bean</span>&gt;</span>

    <span class="hljs-comment">&lt;!-- 配置Mybatis的文件 ，mapperLocations配置**Mapper.xml文件位置，configLocation配置mybatis-config文件位置--&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-title">bean</span> <span class="hljs-attribute">id</span>=<span class="hljs-value">"sqlSessionFactory"</span> <span class="hljs-attribute">class</span>=<span class="hljs-value">"org.mybatis.spring.SqlSessionFactoryBean"</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-title">property</span> <span class="hljs-attribute">name</span>=<span class="hljs-value">"dataSource"</span> <span class="hljs-attribute">ref</span>=<span class="hljs-value">"dataSource"</span> /&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-title">property</span> <span class="hljs-attribute">name</span>=<span class="hljs-value">"mapperLocations"</span> <span class="hljs-attribute">value</span>=<span class="hljs-value">"classpath:mapper/*.xml"</span>/&gt;</span>  
        <span class="hljs-tag">&lt;<span class="hljs-title">property</span> <span class="hljs-attribute">name</span>=<span class="hljs-value">"configLocation"</span> <span class="hljs-attribute">value</span>=<span class="hljs-value">"classpath:mybatis/mybatis-config.xml"</span> /&gt;</span>
        <span class="hljs-comment">&lt;!-- &lt;property name="typeAliasesPackage" value="com.tiantian.ckeditor.model" 
            /&gt; --&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-title">bean</span>&gt;</span>

    <span class="hljs-comment">&lt;!-- 自动扫描注解的bean --&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-title">context:component-scan</span> <span class="hljs-attribute">base-package</span>=<span class="hljs-value">"com.luo.service"</span> /&gt;</span>

<span class="hljs-tag">&lt;/<span class="hljs-title">beans</span>&gt;</span>
</code></pre>

<p>4、接口和类的配置：</p>

<p><img src="http://img.blog.csdn.net/20151223214301928" alt="这里写图片描述" title="" /></p>

<p>4.1、com.luo.domain下添加User.java文件：</p>



<pre class="prettyprint"><code class=" hljs cs">package com.luo.domain;

<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> User {

    <span class="hljs-keyword">private</span> Integer userId;  
    <span class="hljs-keyword">private</span> String userName;  
    <span class="hljs-keyword">private</span> String userPassword;  


    <span class="hljs-keyword">public</span> Integer <span class="hljs-title">getUserId</span>() {  
        <span class="hljs-keyword">return</span> userId;  
    }  

    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">setUserId</span>(Integer userId) {  
        <span class="hljs-keyword">this</span>.userId = userId;  
    }  

    <span class="hljs-keyword">public</span> String <span class="hljs-title">getUserName</span>() {  
        <span class="hljs-keyword">return</span> userName;  
    }  

    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">setUserName</span>(String userName) {  
        <span class="hljs-keyword">this</span>.userName = userName;  
    }  

    <span class="hljs-keyword">public</span> String <span class="hljs-title">getUserPassword</span>() {  
        <span class="hljs-keyword">return</span> userPassword;  
    }  

    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">setUserPassword</span>(String userPassword) {  
        <span class="hljs-keyword">this</span>.userPassword = userPassword;  
    }  

}
</code></pre>

<p>4.2、com.luo.dao下添加UserDao.java文件：</p>



<pre class="prettyprint"><code class=" hljs java"><span class="hljs-keyword">package</span> com.luo.dao;

<span class="hljs-keyword">import</span> com.luo.domain.User;

<span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">interface</span> <span class="hljs-title">UserDao</span> {</span>

    <span class="hljs-javadoc">/**
     *<span class="hljs-javadoctag"> @param</span> userId
     *<span class="hljs-javadoctag"> @return</span> User
     */</span>
    <span class="hljs-keyword">public</span> User <span class="hljs-title">selectUserById</span>(Integer userId);  

}
</code></pre>

<p>4.3、com.luo.service下添加UserService.java接口和UserServiceImpl实现类：</p>



<pre class="prettyprint"><code class=" hljs avrasm">package <span class="hljs-keyword">com</span><span class="hljs-preprocessor">.luo</span><span class="hljs-preprocessor">.service</span><span class="hljs-comment">;</span>

import <span class="hljs-keyword">com</span><span class="hljs-preprocessor">.luo</span><span class="hljs-preprocessor">.domain</span><span class="hljs-preprocessor">.User</span><span class="hljs-comment">;</span>

public interface UserService {
    User selectUserById(Integer userId)<span class="hljs-comment">;  </span>
}
</code></pre>



<pre class="prettyprint"><code class=" hljs java"><span class="hljs-keyword">package</span> com.luo.service;

<span class="hljs-keyword">import</span> org.springframework.beans.factory.annotation.Autowired;
<span class="hljs-keyword">import</span> org.springframework.stereotype.Service;
<span class="hljs-keyword">import</span> com.luo.dao.UserDao;
<span class="hljs-keyword">import</span> com.luo.domain.User;

<span class="hljs-annotation">@Service</span>  
<span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">UserServiceImpl</span> <span class="hljs-keyword">implements</span> <span class="hljs-title">UserService</span> {</span>

    <span class="hljs-annotation">@Autowired</span>  
    <span class="hljs-keyword">private</span> UserDao userDao;  

    <span class="hljs-keyword">public</span> User <span class="hljs-title">selectUserById</span>(Integer userId) {  
        <span class="hljs-keyword">return</span> userDao.selectUserById(userId);  

    }  
}
</code></pre>

<p>5、单元测试</p>

<p><img src="http://img.blog.csdn.net/20151223214729401" alt="这里写图片描述" title="" /></p>

<p>5.1、com.luo.baseTest下添加SpringTestCase.java：</p>



<pre class="prettyprint"><code class=" hljs java"><span class="hljs-keyword">package</span> com.luo.baseTest;

<span class="hljs-keyword">import</span> org.junit.runner.RunWith;  
<span class="hljs-keyword">import</span> org.springframework.test.context.ContextConfiguration;  
<span class="hljs-keyword">import</span> org.springframework.test.context.junit4.AbstractJUnit4SpringContextTests;  
<span class="hljs-keyword">import</span> org.springframework.test.context.junit4.SpringJUnit4ClassRunner;  

<span class="hljs-comment">//指定bean注入的配置文件  </span>
<span class="hljs-annotation">@ContextConfiguration</span>(locations = { <span class="hljs-string">"classpath:application.xml"</span> })  
<span class="hljs-comment">//使用标准的JUnit @RunWith注释来告诉JUnit使用Spring TestRunner  </span>
<span class="hljs-annotation">@RunWith</span>(SpringJUnit4ClassRunner.class)  
<span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">SpringTestCase</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">AbstractJUnit4SpringContextTests</span> {</span>

}
</code></pre>

<p>5.2、com.luo.service添加UserServiceTest.java：</p>



<pre class="prettyprint"><code class=" hljs java"><span class="hljs-keyword">package</span> com.luo.service;

<span class="hljs-keyword">import</span> org.junit.Test;  
<span class="hljs-keyword">import</span> org.springframework.beans.factory.annotation.Autowired;  
<span class="hljs-keyword">import</span> com.luo.baseTest.SpringTestCase;  
<span class="hljs-keyword">import</span> com.luo.domain.User;

<span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">UserServiceTest</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">SpringTestCase</span> {</span>

    <span class="hljs-annotation">@Autowired</span>  
    <span class="hljs-keyword">private</span> UserService userService; 

    <span class="hljs-annotation">@Test</span>  
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">selectUserByIdTest</span>(){  
        User user = userService.selectUserById(<span class="hljs-number">1</span>);  
        System.out.println(user.getUserName() + <span class="hljs-string">":"</span> + user.getUserPassword());
    }  
}
</code></pre>

<p>5.3、运行单元测试，UserServiceTest右键Run As –&gt;Junit Test，运行结果：</p>

<p><img src="http://img.blog.csdn.net/20151223215633358" alt="这里写图片描述" title="" /></p>

<p>6、实例源码下载</p>

<p><a href="http://download.csdn.net/detail/u013142781/9374560">http://download.csdn.net/detail/u013142781/9374560</a></p></div>&#13;
        <script type="text/javascript">&#13;
            $(function () {&#13;
                $('pre.prettyprint code').each(function () {&#13;
                    var lines = $(this).text().split('\n').length;&#13;
                    var $numbering = $('&lt;ul/&gt;').addClass('pre-numbering').hide();&#13;
                    $(this).addClass('has-numbering').parent().append($numbering);&#13;
                    for (i = 1; i &lt;= lines; i++) {&#13;
                        $numbering.append($('&lt;li/&gt;').text(i));&#13;
                    };&#13;
                    $numbering.fadeIn(1700);&#13;
                });&#13;
            });&#13;
        </script>&#13;
   &#13;
