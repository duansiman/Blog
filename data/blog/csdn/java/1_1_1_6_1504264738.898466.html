

<p><span style="font-family:FangSong_GB2312; font-size:18px">       从开始敲drp到现在的hibernate，中文数据乱码无时无刻不“陪伴”在我的身边：</span></p>&#13;
<p><span style="font-family:FangSong_GB2312; font-size:18px">      <img src="http://img.blog.csdn.net/20150827191655201?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQv/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/Center" alt="" /><br />&#13;
</span></p>&#13;
<p><span style="font-family:FangSong_GB2312; font-size:18px">        </span><span style="font-family:FangSong_GB2312; font-size:14px">图一：在drp的分销商模块，每次修改区域虽然返回修改成功，但是每次读取到的中文数据都是“？？？”的字符串，但数字和字母的数据却不受影响。</span></p>&#13;
<p><span style="font-family:FangSong_GB2312; font-size:18px">      <img src="http://img.blog.csdn.net/20150827192009541?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQv/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/Center" width="536" height="146" alt="" /></span></p>&#13;
<p><span style="font-family:FangSong_GB2312; font-size:18px">     </span><span style="font-family:FangSong_GB2312; font-size:14px">图二：不管是drp还是hibernate项目，通过执行sql或者hql语句插入中文数据的，都会呈现图中的景象，甚是无语。。。。。。</span></p>&#13;
<p><span style="font-family:FangSong_GB2312; font-size:18px">     但被它困扰了这么久，我也算“久病成医”，今天就一起来给Java项目医治一下中文数据乱码的这个大病。</span></p>&#13;
<p><span style="font-family:FangSong_GB2312; font-size:18px">     在哲学上有句话“头痛医头，脚痛医脚”，但这是一个错误的观点。因为头痛不一定只是头出现了问题，这个插入数据乱码也是一样的道理，所以我们不能单单地把问题归结到MySql身上，或者怪罪到Java程序上。下面大家就和我一起踏上探索“数据乱码”的征途：</span></p>&#13;
<h3><span style="font-family:FangSong_GB2312; font-size:18px"><strong><span style="color:#3333ff">♚</span>第一站：开发环境的中文字符集</strong>：</span></h3>&#13;
<p><span style="font-family:FangSong_GB2312; font-size:18px">      在drp的开发过程中，在分销商维护模块中，每次修改分销商信息时，数据可以完美地插入，但是数据库中的中文都是“？？？”这样的字符串，导致读取出来的数据也是乱码。这时我们要进行一步步的排查，先从开发环境下手，打开myeclipse中的window，执行如下操作：</span></p>&#13;
<p><span style="font-family:FangSong_GB2312; font-size:18px"><img src="http://img.blog.csdn.net/20150827191737010?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQv/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/Center" alt="" /><br />&#13;
</span></p>&#13;
<p><span style="font-family:FangSong_GB2312; font-size:18px">      这样就可以保证我们开发环境为GB18030；[PS：GB18030：国家标准，<span style="color:rgb(51,51,51); line-height:24px; text-indent:28px">信息技术 中文编码字符集</span>]</span></p>&#13;
<h3><span style="font-family:FangSong_GB2312; font-size:18px"><span style="color:#3333ff">♚</span> 第二站：将Navicat和开发环境的字符集设置保持一致</span></h3>&#13;
<p><span style="font-family:FangSong_GB2312; font-size:18px">      在上面的图中，我们对开发环境设置了中文编码的字符集，可能会解决一部分人遇到的问题，但是依旧没有解决我的问题。所以我要继续探索！</span></p>&#13;
<p><span style="font-family:FangSong_GB2312; font-size:18px">      使用Navicat软件，打开你要使用的数据库的表，右击--选择”设计表“：</span></p>&#13;
<p><span style="font-family:FangSong_GB2312; font-size:18px">            <img src="http://img.blog.csdn.net/20150827193058571?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQv/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/Center" width="662" height="293" alt="" /></span></p>&#13;
<p><span style="font-family:FangSong_GB2312; font-size:18px">      选中要输入中文数据的字段，对它的属性进行如下设置：</span></p>&#13;
<p><span style="font-family:FangSong_GB2312; font-size:18px">            <img src="http://img.blog.csdn.net/20150827193215067?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQv/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/Center" alt="" /></span></p>&#13;
<p><span style="font-family:FangSong_GB2312; font-size:18px">        将这一步完成，可能是你的解决方案，但还不是我的；怎么办？？凉拌，继续出发向前：</span></p>&#13;
<h3><span style="font-family:FangSong_GB2312; font-size:18px"><span style="color:#3333ff">♚</span> 第三站："method"中get的乱入</span></h3>&#13;
<p><span style="font-family:FangSong_GB2312; font-size:18px">      我们经常会对某个方法的method进行设置，在这里传输数据时使用post可以避免get方式带来的乱码。</span></p>&#13;
<h3><span style="font-family:FangSong_GB2312; font-size:18px"><span style="color:#3333ff">♚</span> 第四站：连接数据库的配置文件中缺少“约束”</span></h3>&#13;
<h3><span style="font-family:FangSong_GB2312; font-size:18px">    （这里有hibernate.cfg.xml和User.properties文件两种）</span></h3>&#13;
<p><span style="font-family:FangSong_GB2312; font-size:18px">      在"沙漠"中经过几站的长途跋涉，我终于看到一眼清泉：通过对配置文件进行少许的更改，便可以一解我的燃眉之急：</span></p>&#13;
<p><span style="font-family:FangSong_GB2312"><span style="font-size:18px">     </span><strong><span style="font-size:24px; color:#000099">方式一</span></strong><span style="font-size:18px">：使用.xml文件对数据库进行配置：</span></span></p>&#13;
<p></p>&#13;
<pre code_snippet_id="1720755" snippet_file_name="blog_20160618_1_1664593" name="code" class="html">&lt;span style="font-family:FangSong_GB2312;font-size:18px;"&gt;&lt;hibernate-configuration&gt;
	&lt;session-factory&gt;
		&lt;property name="hibernate.connection.driver_class"&gt;com.mysql.jdbc.Driver&lt;/property&gt;
		&lt;property name="hibernate.connection.url"&gt;jdbc:mysql://localhost:3306/hibernate_cache&lt;/property&gt;
		&lt;property name="hibernate.connection.username"&gt;root&lt;/property&gt;
		&lt;property name="hibernate.connection.password"&gt;&lt;/property&gt;
		&lt;property name="hibernate.dialect"&gt;org.hibernate.dialect.MySQLDialect&lt;/property&gt;
		&lt;property name="hibernate.show_sql"&gt;true&lt;/property&gt;
&lt;/sessionFactory&gt;&lt;/span&gt;</pre>&#13;
<p></p>&#13;
<p><span style="font-family:FangSong_GB2312; font-size:18px">     在connection.url行只是书写数据库的地址和相应的数据库名称，却没有对中文字符集进行配置，所以要对这行代码进行如下修改：</span></p>&#13;
<p></p>&#13;
<pre code_snippet_id="1720755" snippet_file_name="blog_20160618_2_3889440" name="code" class="html">&lt;span style="font-family:FangSong_GB2312;font-size:18px;"&gt;&lt;property name="hibernate.connection.url"&gt;jdbc:mysql://localhost:3306/hibernate_extends?useUnicode=true&amp;amp;characterEncoding=UTF-8&lt;/property&gt;
&lt;/span&gt;</pre><span style="font-family:FangSong_GB2312; font-size:18px">     我们可以注意到，变化的是数据库名之后跟上的那句用来设置中文字符集的代码，但是这里有几个<span style="color:#ff0000"><strong>注意点</strong></span>：</span>&#13;
<p></p>&#13;
<p><span style="font-family:FangSong_GB2312; font-size:18px">                        <img src="http://img.blog.csdn.net/20150827200733712?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQv/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/Center" width="500" height="600" alt="" /><br />&#13;
</span></p>&#13;
<h5><span style="font-family:FangSong_GB2312; font-size:18px">   1.不要让中文问号“鱼龙混珠”</span></h5>&#13;
<p><span style="font-family:FangSong_GB2312; font-size:18px">      数据库名之后的问号一定是英文状态下的，如果是中文状态的，那么在执行这个配置文件时，中文状态的问号会被myeclipse译成三个问号，就会发出“配置语句错误”的提示；</span></p>&#13;
<h5><span style="font-family:FangSong_GB2312; font-size:18px">   2.一个都不能少</span></h5>&#13;
<p><span style="font-family:FangSong_GB2312; font-size:18px">      useUnicode=true之后跟着的一定是“&amp;amp;"，这五个元素一个都不能少，但是一般情况下，直接在网页中将这五个元素复制粘贴到配置文件中，会只显示一个“&amp;”：这样控制台就会打印：“Encoding应该以分号结束”，这个错误不是要在最后加上分号，而是注意这五个元素的“一个都不能少！”</span></p>&#13;
<p><span style="font-family:FangSong_GB2312; font-size:18px"><br />&#13;
</span></p>&#13;
<p><span style="font-family:FangSong_GB2312"><strong><span style="font-size:24px; color:#3333ff">方式二</span></strong><span style="font-size:18px">：使用.properties文件进行配置：</span></span></p>&#13;
<p></p>&#13;
<pre code_snippet_id="1720755" snippet_file_name="blog_20160618_3_3191329" name="code" class="html">&lt;span style="font-family:FangSong_GB2312;font-size:18px;"&gt;jdbc.driver = com.mysql.jdbc.Driver
jdbc.url = jdbc:mysql:///shop
jdbc.user = root
jdbc.password =123&lt;/span&gt;</pre>&#13;
<p></p>&#13;
<p><span style="font-family:FangSong_GB2312; font-size:18px">      这种情况出现乱码时，就对jdbc.url进行如下更改：</span></p>&#13;
<p></p>&#13;
<pre code_snippet_id="1720755" snippet_file_name="blog_20160618_4_8033114" name="code" class="html">&lt;span style="font-family:FangSong_GB2312;font-size:18px;"&gt;jdbc.url = jdbc:mysql:///shop?useUnicode=true&amp;characterEncoding=UTF-8&lt;/span&gt;</pre><span style="font-family:FangSong_GB2312; font-size:18px"><br />&#13;
     这样我们就完成了每一个环节的中文字符集设置，也就解决了Java程序的“中文乱码问题”这个大弊病了。</span>&#13;
<p></p>&#13;
<p><span style="font-family:FangSong_GB2312; font-size:18px">     到这里，这次的沙漠探索之行就结束了，解决错误不是目的，目的是要在解决错误的过程中进行分析和思考，不被表象所蒙蔽，进而不犯“头痛医头脚痛医脚”的错误，也就是老师经常给我们讲到的全局观----“不谋全局者不足谋一隅，不谋万世者不足谋一时！”</span></p>&#13;
<p><span style="font-family:FangSong_GB2312; font-size:18px"> <img src="http://img.blog.csdn.net/20150827200937896?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQv/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/Center" alt="" /></span></p>&#13;
<p><span style="font-family:FangSong_GB2312; font-size:18px"><br />&#13;
</span></p>&#13;
<p><span style="font-family:FangSong_GB2312; font-size:18px">      </span></p>&#13;
<p><span style="font-family:FangSong_GB2312; font-size:18px"><br />&#13;
</span></p>&#13;
<p><br />&#13;
</p>&#13;
   &#13;
