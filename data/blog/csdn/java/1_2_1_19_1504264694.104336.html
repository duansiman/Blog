

<p><span style="white-space:pre"></span><span style="font-size:18px">Spring 有五种作用域，其中只有三种是<span style="color:rgb(51,51,51); font-family:Helvetica,Tahoma,Arial,sans-serif; line-height:25px">其中有三种只能用在基于web的Spring ApplicationContext，先来看一张图，下图摘自Spring实战；</span></span></p>&#13;
<p><span style="font-size:18px"><span style="color:rgb(51,51,51); font-family:Helvetica,Tahoma,Arial,sans-serif; line-height:25px"><span style="white-space:pre"><img src="http://img.blog.csdn.net/20150514100013952?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvbGlhb2RlaG9uZw==/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/Center" alt="" /></span></span></span></p>&#13;
<p><span style="font-family:Helvetica,Tahoma,Arial,sans-serif; font-size:18px; color:#333333"><span style="line-height:25px">接下来写一个例子来分析一下Spring的内置作用域；</span></span></p>&#13;
<p><span style="font-family:Helvetica,Tahoma,Arial,sans-serif; font-size:18px; color:#ff0000"><span style="line-height:25px">1.singleton作用域：</span></span></p>&#13;
<p><span style="font-family:Helvetica,Tahoma,Arial,sans-serif; font-size:18px; color:#333333"><span style="line-height:25px">上面那张图已经详细的介绍了他的作用范围，即在一个Spring容器中，一个Bean定义只有一个对象实例，而且这也</span></span></p>&#13;
<p><span style="font-family:Helvetica,Tahoma,Arial,sans-serif; font-size:18px; color:#333333"><span style="line-height:25px">是默认的。只要Id与我们请求的Bean一样，就会返回一个Bean的实例，这个实例会被加载到Spring的单例缓存里面，以后我们需要这个Bean的时候，他就会到缓存里面去取。值得注意的是这个单例和我们JAVA的单例设计模式还是有所区别的，因为在Java的ClassLoader里，是不论你通过什么方法都只能取得一个Class的。但是在我们的Bean中，其实可以有多个Bean指向同一个类，这样得到的类必然不是同一个。下面来看一个例子，我首先定义了一个类叫做</span></span></p>&#13;
<p><span style="font-family:Helvetica,Tahoma,Arial,sans-serif; font-size:18px; color:#333333"><span style="line-height:25px">BaseBean；</span></span></p>&#13;
<p><span style="font-family:Helvetica,Tahoma,Arial,sans-serif; font-size:18px; color:#333333"><span style="line-height:25px"><img src="http://img.blog.csdn.net/20150514101255421?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvbGlhb2RlaG9uZw==/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/Center" alt="" /><br />&#13;
</span></span></p>&#13;
<p><span style="font-family:Helvetica,Tahoma,Arial,sans-serif; font-size:18px; color:#333333"><span style="line-height:25px">然后再使用传统配置到XML里面配置一下</span></span></p>&#13;
<p><span style="font-family:Helvetica,Tahoma,Arial,sans-serif; font-size:18px; color:#333333"><span style="line-height:25px"><img src="http://img.blog.csdn.net/20150514101336621?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvbGlhb2RlaG9uZw==/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/Center" alt="" /><br />&#13;
</span></span></p>&#13;
<p><span style="font-family:Helvetica,Tahoma,Arial,sans-serif; font-size:18px; color:#333333"><span style="line-height:25px">在这里我有两个Bean，但是指向的是同一个类，现在来测试一下。</span></span></p>&#13;
<p><span style="font-family:Helvetica,Tahoma,Arial,sans-serif; font-size:18px; color:#333333"><span style="line-height:25px"><img src="http://img.blog.csdn.net/20150514101419583?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvbGlhb2RlaG9uZw==/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/Center" alt="" /><br />&#13;
</span></span></p>&#13;
<p><span style="font-family:Helvetica,Tahoma,Arial,sans-serif; font-size:18px; color:#333333"><span style="line-height:25px">我们可以看到，basebean1和basebean2指向的不是同一个Bean，但是指向的却是同一个类，这里我们没有配</span></span></p>&#13;
<p><span style="font-family:Helvetica,Tahoma,Arial,sans-serif; font-size:18px; color:#333333"><span style="line-height:25px">置他的</span></span><span style="line-height:25px; color:rgb(51,51,51); font-family:Helvetica,Tahoma,Arial,sans-serif; font-size:18px">作用域，因为他默认的就是<span style="color:rgb(255,0,0); font-family:Helvetica,Tahoma,Arial,sans-serif; font-size:18px; line-height:25px">singleton作用域<span style="color:rgb(51,51,51); font-family:Helvetica,Tahoma,Arial,sans-serif; font-size:18px; line-height:25px">,而basebean1和basebean3指向的同一个Bean，自然也就是</span></span></span></p>&#13;
<p><span style="line-height:25px; color:rgb(51,51,51); font-family:Helvetica,Tahoma,Arial,sans-serif; font-size:18px"><span style="color:rgb(255,0,0); font-family:Helvetica,Tahoma,Arial,sans-serif; font-size:18px; line-height:25px"><span style="color:rgb(51,51,51); font-family:Helvetica,Tahoma,Arial,sans-serif; font-size:18px; line-height:25px">同一个类，所以结果就是false，true;</span></span></span></p>&#13;
<p><span style="line-height:25px; color:rgb(51,51,51); font-family:Helvetica,Tahoma,Arial,sans-serif; font-size:18px"><span style="color:rgb(255,0,0); font-family:Helvetica,Tahoma,Arial,sans-serif; font-size:18px; line-height:25px"><span style="color:rgb(51,51,51); font-family:Helvetica,Tahoma,Arial,sans-serif; font-size:18px; line-height:25px"><span style="color:rgb(255,0,0); font-family:Helvetica,Tahoma,Arial,sans-serif; font-size:18px; line-height:25px">2.prototype作用域：</span><br />&#13;
</span></span></span></p>&#13;
<p><span style="line-height:25px; color:rgb(51,51,51); font-family:Helvetica,Tahoma,Arial,sans-serif; font-size:18px"><span style="color:rgb(255,0,0); font-family:Helvetica,Tahoma,Arial,sans-serif; font-size:18px; line-height:25px"><span style="color:rgb(51,51,51); font-family:Helvetica,Tahoma,Arial,sans-serif; font-size:18px; line-height:25px"><span style="color:rgb(255,0,0); font-family:Helvetica,Tahoma,Arial,sans-serif; font-size:18px; line-height:25px"><span style="color:rgb(51,51,51); font-family:Helvetica,Tahoma,Arial,sans-serif; font-size:18px; line-height:25px">他表示Bean的实例可以被任意的实例化，并不会介意你在什么环境下，每次调用都会创建一个实例出来。通常</span></span></span></span></span></p>&#13;
<p><span style="line-height:25px; color:rgb(51,51,51); font-family:Helvetica,Tahoma,Arial,sans-serif; font-size:18px"><span style="color:rgb(255,0,0); font-family:Helvetica,Tahoma,Arial,sans-serif; font-size:18px; line-height:25px"><span style="color:rgb(51,51,51); font-family:Helvetica,Tahoma,Arial,sans-serif; font-size:18px; line-height:25px"><span style="color:rgb(255,0,0); font-family:Helvetica,Tahoma,Arial,sans-serif; font-size:18px; line-height:25px"><span style="color:rgb(51,51,51); font-family:Helvetica,Tahoma,Arial,sans-serif; font-size:18px; line-height:25px">我们会把那些没有什么规定的模板化功能设置为单例的，比如链接数据库，日志操作。而那些具体的功能类，</span></span></span></span></span></p>&#13;
<p><span style="line-height:25px; color:rgb(51,51,51); font-family:Helvetica,Tahoma,Arial,sans-serif; font-size:18px"><span style="color:rgb(255,0,0); font-family:Helvetica,Tahoma,Arial,sans-serif; font-size:18px; line-height:25px"><span style="color:rgb(51,51,51); font-family:Helvetica,Tahoma,Arial,sans-serif; font-size:18px; line-height:25px"><span style="color:rgb(255,0,0); font-family:Helvetica,Tahoma,Arial,sans-serif; font-size:18px; line-height:25px"><span style="color:rgb(51,51,51); font-family:Helvetica,Tahoma,Arial,sans-serif; font-size:18px; line-height:25px">比如我们要买电影票，肯定会创建一个电影票这个类，我们一般不会把他交给Spring去管理，而使用new的方法</span></span></span></span></span></p>&#13;
<p><span style="line-height:25px; color:rgb(51,51,51); font-family:Helvetica,Tahoma,Arial,sans-serif; font-size:18px"><span style="color:rgb(255,0,0); font-family:Helvetica,Tahoma,Arial,sans-serif; font-size:18px; line-height:25px"><span style="color:rgb(51,51,51); font-family:Helvetica,Tahoma,Arial,sans-serif; font-size:18px; line-height:25px"><span style="color:rgb(255,0,0); font-family:Helvetica,Tahoma,Arial,sans-serif; font-size:18px; line-height:25px"><span style="color:rgb(51,51,51); font-family:Helvetica,Tahoma,Arial,sans-serif; font-size:18px; line-height:25px">让他自己去创造很多个电影票的对象，这样电影票就不会重复；先改变一下XML配置<img src="http://img.blog.csdn.net/20150514103842026?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvbGlhb2RlaG9uZw==/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/Center" alt="" /></span></span></span></span></span></p>&#13;
<p><span style="line-height:25px; color:rgb(51,51,51); font-family:Helvetica,Tahoma,Arial,sans-serif; font-size:18px"><span style="color:rgb(255,0,0); font-family:Helvetica,Tahoma,Arial,sans-serif; font-size:18px; line-height:25px"><span style="color:rgb(51,51,51); font-family:Helvetica,Tahoma,Arial,sans-serif; font-size:18px; line-height:25px"><span style="color:rgb(255,0,0); font-family:Helvetica,Tahoma,Arial,sans-serif; font-size:18px; line-height:25px"><span style="color:rgb(51,51,51); font-family:Helvetica,Tahoma,Arial,sans-serif; font-size:18px; line-height:25px">这个时候我们再测试就会有两个不同的实例了。</span></span></span></span></span></p>&#13;
<p><span style="line-height:25px; color:rgb(51,51,51); font-family:Helvetica,Tahoma,Arial,sans-serif"><span style="color:rgb(255,0,0); font-family:Helvetica,Tahoma,Arial,sans-serif; line-height:25px"><span style="color:rgb(51,51,51); font-family:Helvetica,Tahoma,Arial,sans-serif; line-height:25px"><span style="color:rgb(255,0,0); font-family:Helvetica,Tahoma,Arial,sans-serif; line-height:25px"><span style="color:rgb(51,51,51); font-family:Helvetica,Tahoma,Arial,sans-serif; line-height:25px"><span style="color:rgb(51,51,51); font-family:Helvetica,Tahoma,Arial,sans-serif; line-height:25px"><span style="font-size:18px">其他作用域，即request、session以及global&#13;
 session 仅在基于web的应用中使用（不必关心你所采用的是什么web应用框架）。这些作用域仅仅在使用基于web的Spring ApplicationContext实现（如XmlWebApplicationContext）时有用。 如果在普通的Spring IoC容器中，比如像XmlBeanFactory或ClassPathXmlApplicationContext， 尝试使用这些作用域，你将会得到一个IllegalStateException异常（未知的bean作用域）。</span></span><br />&#13;
</span></span></span></span></span></p>&#13;
<p><span style="line-height:25px; color:rgb(51,51,51); font-family:Helvetica,Tahoma,Arial,sans-serif"><span style="color:rgb(255,0,0); font-family:Helvetica,Tahoma,Arial,sans-serif; line-height:25px"><span style="color:rgb(51,51,51); font-family:Helvetica,Tahoma,Arial,sans-serif; line-height:25px"><span style="color:rgb(255,0,0); font-family:Helvetica,Tahoma,Arial,sans-serif; line-height:25px"><span style="color:rgb(51,51,51); font-family:Helvetica,Tahoma,Arial,sans-serif; line-height:25px"><span style="color:rgb(51,51,51); font-family:Helvetica,Tahoma,Arial,sans-serif; line-height:25px"><span style="font-size:18px">这里要结合<a target="_blank" href="http://blog.csdn.net/llbupt/article/details/6601055" style="color:rgb(0,0,0); text-decoration:none; font-family:'Microsoft YaHei'; line-height:30px">ApplicationContext的三种实现方式以及在web.xml配置的两种方式</a>来说明；一下文章摘自</span></span></span></span></span></span></span></p>&#13;
<p><span style="line-height:25px; color:rgb(51,51,51); font-family:Helvetica,Tahoma,Arial,sans-serif"><span style="color:rgb(255,0,0); font-family:Helvetica,Tahoma,Arial,sans-serif; line-height:25px"><span style="color:rgb(51,51,51); font-family:Helvetica,Tahoma,Arial,sans-serif; line-height:25px"><span style="color:rgb(255,0,0); font-family:Helvetica,Tahoma,Arial,sans-serif; line-height:25px"><span style="color:rgb(51,51,51); font-family:Helvetica,Tahoma,Arial,sans-serif; line-height:25px"><span style="color:rgb(51,51,51); font-family:Helvetica,Tahoma,Arial,sans-serif; line-height:25px"><span style="font-size:18px">http://blog.csdn.net/llbupt/article/details/6601055；<br />&#13;
</span></span></span></span></span></span></span></p>&#13;
<p></p>&#13;
<p style="font-family:Arial; line-height:26px; color:rgb(51,51,51)"><span style="font-size:18px"><strong>ApplicationContext 是 BeanFactory 接口的子接口，它增强了 BeanFactory 的功能，处于 context 包下。很多时候， ApplicationContext 允许以声明式方式操作容器，无须手动创建。可利用如 ContextLoader 的支持类，在 Web 应用启动时自动创建&#13;
 ApplicationContext。当然，也可以采用编程方式创建 ApplicationContext。</strong></span></p>&#13;
<p style="font-family:Arial; line-height:26px; color:rgb(51,51,51)"><span style="font-size:18px"><strong>ApplicationContext包括BeanFactory的全部功能，因此建议优先使用ApplicationContext。除非对于某些内存非常关键的应用，才考虑使用 BeanFactory。</strong></span></p>&#13;
<p style="font-family:Arial; line-height:26px; color:rgb(51,51,51)"><span style="font-size:18px"><strong>spring为ApplicationContext提供的3种实现分别为：</strong></span></p>&#13;
<p style="font-family:Arial; line-height:26px; color:rgb(51,51,51)"><span style="font-size:18px"><strong>1、  ClassPathXmlApplicationContext：利用类路径的XML文件来载入Bean定义的信息</strong></span></p>&#13;
<p style="font-family:Arial; line-height:26px; color:rgb(51,51,51)"><span style="font-size:18px"><strong>[1]  ApplicationContext ctx = new ClassPathXmlApplicationContext("bean.xml");</strong></span></p>&#13;
<p style="font-family:Arial; line-height:26px; color:rgb(51,51,51)"><span style="font-size:18px"><strong>[2]  String[] locations = {"bean1.xml", "bean2.xml", "bean3.xml"};</strong></span></p>&#13;
<p style="font-family:Arial; line-height:26px; color:rgb(51,51,51)"><span style="font-size:18px"><strong>ApplicationContext ctx = new ClassPathXmlApplication(locations);</strong></span></p>&#13;
<p style="font-family:Arial; line-height:26px; color:rgb(51,51,51)"><span style="font-size:18px"><strong>2、 FileSystemXmlApplicationContext：利用文件系统中的XMl文件来载入Bean</strong></span></p>&#13;
<p style="font-family:Arial; line-height:26px; color:rgb(51,51,51)"><span style="font-size:18px"><strong>定义的信息</strong></span></p>&#13;
<p style="font-family:Arial; line-height:26px; color:rgb(51,51,51)"><span style="font-size:18px"><strong>[1]  ApplicationContext ctx = new FileSystemXmlApplicationContext("bean.xml"); //加载单个配置文件</strong></span></p>&#13;
<p style="font-family:Arial; line-height:26px; color:rgb(51,51,51)"><span style="font-size:18px"><strong>[2]  String[] locations = {"bean1.xml", "bean2.xml", "bean3.xml"};</strong></span></p>&#13;
<p style="font-family:Arial; line-height:26px; color:rgb(51,51,51)"><span style="font-size:18px"><strong> ApplicationContext ctx = new FileSystemXmlApplicationContext(locations );</strong></span></p>&#13;
<p style="font-family:Arial; line-height:26px; color:rgb(51,51,51)"><span style="font-size:18px"><strong>//加载多个配置文件</strong></span></p>&#13;
<p style="font-family:Arial; line-height:26px; color:rgb(51,51,51)"><span style="font-size:18px"><strong>[3]  ApplicationContext ctx =new FileSystemXmlApplicationContext("D:/project/bean.xml");</strong></span></p>&#13;
<p style="font-family:Arial; line-height:26px; color:rgb(51,51,51)"><span style="font-size:18px"><strong>//根据具体路径加载</strong></span></p>&#13;
<p style="font-family:Arial; line-height:26px; color:rgb(51,51,51)"><span style="font-size:18px"><strong>3、 XmlWebApplicationContext：从Web系统中的XML文件来载入Bean定义的信息。</strong></span></p>&#13;
<p style="font-family:Arial; line-height:26px; color:rgb(51,51,51)"><span style="font-size:18px"><strong> ServletContext servletContext = request.getSession().getServletContext();    </strong></span></p>&#13;
<p style="font-family:Arial; line-height:26px; color:rgb(51,51,51)"><span style="font-size:18px"><strong> ApplicationContext ctx = WebApplicationContextUtils.getWebApplicationContext(servletContext);</strong></span></p>&#13;
<p style="font-family:Arial; line-height:26px; color:rgb(51,51,51)"><span style="font-size:18px"><strong> </strong></span></p>&#13;
<p style="font-family:Arial; line-height:26px; color:rgb(51,51,51)"><span style="font-size:18px"><strong> </strong></span></p>&#13;
<p style="font-family:Arial; line-height:26px; color:rgb(51,51,51)"><span style="font-size:18px"><strong>配置WebApplicationContext的两种方法：</strong></span></p>&#13;
<p style="font-family:Arial; line-height:26px; color:rgb(51,51,51)"><span style="font-size:18px"><strong>（1）        利用Listener接口来实现</strong></span></p>&#13;
<p style="font-family:Arial; line-height:26px; color:rgb(51,51,51)"><span style="font-size:18px"><strong>&lt;listener&gt;</strong></span></p>&#13;
<p style="font-family:Arial; line-height:26px; color:rgb(51,51,51)"><span style="font-size:18px"><strong>       &lt;listener-class&gt;</strong></span></p>&#13;
<p style="font-family:Arial; line-height:26px; color:rgb(51,51,51)"><span style="font-size:18px"><strong>org.springframework.web.context.ContextLoaderListener</strong></span></p>&#13;
<p style="font-family:Arial; line-height:26px; color:rgb(51,51,51)"><span style="font-size:18px"><strong>&lt;/listener-class&gt;</strong></span></p>&#13;
<p style="font-family:Arial; line-height:26px; color:rgb(51,51,51)"><span style="font-size:18px"><strong>&lt;/listener&gt;</strong></span></p>&#13;
<p style="font-family:Arial; line-height:26px; color:rgb(51,51,51)"><span style="font-size:18px"><strong>&lt;context-param&gt;</strong></span></p>&#13;
<p style="font-family:Arial; line-height:26px; color:rgb(51,51,51)"><span style="font-size:18px"><strong>       &lt;param-name&gt;contextConfigLocation&lt;/param-name&gt;</strong></span></p>&#13;
<p style="font-family:Arial; line-height:26px; color:rgb(51,51,51)"><span style="font-size:18px"><strong>       &lt;param-value&gt;classpath:applicationContext&lt;/param-value&gt;</strong></span></p>&#13;
<p style="font-family:Arial; line-height:26px; color:rgb(51,51,51)"><span style="font-size:18px"><strong>&lt;/context-param&gt;</strong></span></p>&#13;
<p style="font-family:Arial; line-height:26px; color:rgb(51,51,51)"><span style="font-size:18px"><strong>（2）        利用Servlet接口来实现</strong></span></p>&#13;
<p style="font-family:Arial; line-height:26px; color:rgb(51,51,51)"><span style="font-size:18px"><strong>&lt;context-param&gt;</strong></span></p>&#13;
<p style="font-family:Arial; line-height:26px; color:rgb(51,51,51)"><span style="font-size:18px"><strong>&lt;param-name&gt;contextConfigLocation&lt;/param-name&gt;</strong></span></p>&#13;
<p style="font-family:Arial; line-height:26px; color:rgb(51,51,51)"><span style="font-size:18px"><strong>&lt;param-value&gt;classpath:applicationContext&lt;/param-value&gt;</strong></span></p>&#13;
<p style="font-family:Arial; line-height:26px; color:rgb(51,51,51)"><span style="font-size:18px"><strong>&lt;/context-param&gt;</strong></span></p>&#13;
<p style="font-family:Arial; line-height:26px; color:rgb(51,51,51)"><span style="font-size:18px"><strong>&lt;Servlet&gt;</strong></span></p>&#13;
<p style="font-family:Arial; line-height:26px; color:rgb(51,51,51)"><span style="font-size:18px"><strong>       &lt;servlet-name&gt;context&lt;/servlet-name&gt;</strong></span></p>&#13;
<p style="font-family:Arial; line-height:26px; color:rgb(51,51,51)"><span style="font-size:18px"><strong>       &lt;servlet-class&gt;</strong></span></p>&#13;
<p style="font-family:Arial; line-height:26px; color:rgb(51,51,51)"><span style="font-size:18px"><strong>           org.springframework.web.context.ContextLoaderServlet</strong></span></p>&#13;
<p style="font-family:Arial; line-height:26px; color:rgb(51,51,51)"><span style="font-size:18px"><strong>       &lt;/servlet-class&gt;</strong></span></p>&#13;
<p style="font-family:Arial; line-height:26px; color:rgb(51,51,51)"><span style="font-size:18px"><strong>&lt;/servlet&gt;</strong></span></p>&#13;
最后总结一下，Spring的Bean的作用域，一般我们用的最多的也就是默认的，至少后面三个基于Web应用的作用域肯定有其独特的作用；他们应该会和&#13;
<p>Servlet的request,session对象而挂钩，会应用到一些特殊的场景，这个在后面再讨论。</p>&#13;
<span style="font-size:18px"></span>&#13;
   &#13;
