
<p><span style="white-space:pre"><span style="color: rgb(86, 90, 95); font-family: 'open sans', 'Helvetica Neue', 'Microsoft Yahei', Helvetica, Arial, sans-serif; font-size: 16px; line-height: 25.6px;">我们在做Web应用的时候，请求处理过程中发生错误是非常常见的情况。Spring Boot提供了一个默认的映射：</span><code style="margin: 0px 2px; padding: 3px 5px; border: 0px; outline: 0px; font-family: 'Source Code Pro', Consolas, Monaco, Menlo, Consolas, monospace; font-size: 16px; vertical-align: baseline; color: rgb(233, 105, 0); border-radius: 2px; line-height: 25.6px; background-color: rgb(248, 248, 248);">/error</code><span style="color: rgb(86, 90, 95); font-family: 'open sans', 'Helvetica Neue', 'Microsoft Yahei', Helvetica, Arial, sans-serif; font-size: 16px; line-height: 25.6px;">，</span></span></p><p><span style="white-space:pre"><span style="color: rgb(86, 90, 95); font-family: 'open sans', 'Helvetica Neue', 'Microsoft Yahei', Helvetica, Arial, sans-serif; font-size: 16px; line-height: 25.6px;">当处理中抛出异常之后，会转到该请求中处理，并且该请求有一个全局的错误页面用来展示异常内容。</span></span><span style="color: rgb(86, 90, 95); font-family: 'open sans', 'Helvetica Neue', 'Microsoft Yahei', Helvetica, Arial, sans-serif; font-size: 16px; line-height: 25.6px; white-space: pre;">下图列出了Spring Boot中跟</span></p><p><span style="color: rgb(86, 90, 95); font-family: 'open sans', 'Helvetica Neue', 'Microsoft Yahei', Helvetica, Arial, sans-serif; font-size: 16px; line-height: 25.6px; white-space: pre;">MVC异常处理相关的类。</span></p><p><span style="color: rgb(86, 90, 95); font-family: 'open sans', 'Helvetica Neue', 'Microsoft Yahei', Helvetica, Arial, sans-serif; font-size: 16px; line-height: 25.6px; white-space: pre;"><span style="white-space:pre">	<img src="http://img.blog.csdn.net/20170808184846770?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvbGlhb2RlaG9uZw==/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/Center" alt="" /></span></span></p><p><span style="font-family:open sans, Helvetica Neue, Microsoft Yahei, Helvetica, Arial, sans-serif;color:#565a5f;"><span style="font-size: 16px; line-height: 25.6px; white-space: pre;">在spring Boot中，我们如果访问一个不存在的URL，就会得到spring boot中内置的页面。</span></span></p><p><span style="font-family:open sans, Helvetica Neue, Microsoft Yahei, Helvetica, Arial, sans-serif;color:#565a5f;"><span style="font-size: 16px; line-height: 25.6px; white-space: pre;"><img src="http://img.blog.csdn.net/20170808185634222?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvbGlhb2RlaG9uZw==/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/Center" alt="" /><br /></span></span></p><p><span style="white-space:pre"><span style="color: rgb(86, 90, 95); font-family: 'open sans', 'Helvetica Neue', 'Microsoft Yahei', Helvetica, Arial, sans-serif; font-size: 16px; line-height: 25.6px;">我们在这里修改一下，以前的内容，直接抛出一个异常看看有什么效果</span></span></p><p><span style="white-space:pre"><span style="color: rgb(86, 90, 95); font-family: 'open sans', 'Helvetica Neue', 'Microsoft Yahei', Helvetica, Arial, sans-serif; font-size: 16px; line-height: 25.6px;"></span></span></p><pre code_snippet_id="2524304" snippet_file_name="blog_20170808_1_9978618" name="code" class="java">  @RequestMapping("/")
    public String index() throws Exception{
    	throw new Exception("error");  
    }</pre><img src="http://img.blog.csdn.net/20170808185857535?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvbGlhb2RlaG9uZw==/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/Center" alt="" /><br /><br /><p></p><p><span style="font-size:18px;">它会把我们抛出的异常信息，打印在下面。那么为什么Spring Boot会打印这些东西啦，是因为Spring Boot在启动过程中会根据当前环境进行AutoConfiguration，其中跟MVC错误处理相关的配置内容，在ErrorMvcAutoConfiguration这个类中。在Servlet容器中添加了一个默认的错误页面</span></p><p><span style="white-space:pre"><span style="color: rgb(86, 90, 95); font-family: 'open sans', 'Helvetica Neue', 'Microsoft Yahei', Helvetica, Arial, sans-serif; font-size: 16px; line-height: 25.6px;">在ErrorMvcAutoConfiguration类实现了EmbeddedServletContainerCustomizer接口，所以可以</span></span></p><p><span style="white-space:pre"><span style="color: rgb(86, 90, 95); font-family: 'open sans', 'Helvetica Neue', 'Microsoft Yahei', Helvetica, Arial, sans-serif; font-size: 16px; line-height: 25.6px;">通过override customize方法来定制Servlet容器<br /></span></span></p><p><span style="white-space:pre"><span style="color: rgb(86, 90, 95); font-family: 'open sans', 'Helvetica Neue', 'Microsoft Yahei', Helvetica, Arial, sans-serif; font-size: 16px; line-height: 25.6px;"></span></span></p><pre code_snippet_id="2524304" snippet_file_name="blog_20170808_2_7393916" name="code" class="java">@Value("${error.path:/error}")
private String errorPath = "/error";

@Override
public void customize(ConfigurableEmbeddedServletContainer container) {
    container.addErrorPages(new ErrorPage(this.properties.getServletPrefix()
        + this.errorPath));
}</pre><p></p><p>可以看到ErrorMvcAutoConfiguration在容器中，添加了一个错误页面/error。因为这项配置的存在，如果Spring MVC在处理过程抛出异常到Servlet容器，</p><p>容器会定向到这个错误页面/error。</p><span style="color: rgb(86, 90, 95); font-family: 'open sans', 'Helvetica Neue', 'Microsoft Yahei', Helvetica, Arial, sans-serif; font-size: 16px; line-height: 25.6px;">虽然，Spring Boot中实现了默认的error映射，但是在实际应用中，上面你的错误页面对用户来说并不够友好，我们通常需要去实现我们自己的异常提示。</span><p><span style="white-space:pre"><span style="color: rgb(86, 90, 95); font-family: 'open sans', 'Helvetica Neue', 'Microsoft Yahei', Helvetica, Arial, sans-serif; font-size: 16px; line-height: 25.6px;"></span></span></p><ul style="margin: 1.6em 20px; padding: 0px; border: 0px; outline: 0px; font-family: 'open sans', 'Helvetica Neue', 'Microsoft Yahei', Helvetica, Arial, sans-serif; font-size: 16px; vertical-align: baseline; line-height: 1.6em; color: rgb(86, 90, 95);"><li style="margin: 0px; padding: 0px; border: 0px; outline: 0px; font-weight: inherit; font-style: inherit; font-family: inherit; vertical-align: baseline;">创建全局异常处理类：通过使用<code style="margin: 0px 2px; padding: 3px 5px; border: 0px; outline: 0px; font-weight: inherit; font-style: inherit; font-family: 'Source Code Pro', Consolas, Monaco, Menlo, Consolas, monospace; font-size: 1em; vertical-align: baseline; color: rgb(233, 105, 0); border-radius: 2px; background-color: rgb(248, 248, 248);">@ControllerAdvice</code>定义统一的异常处理类，而不是在每个Controller中逐个定义。<code style="margin: 0px 2px; padding: 3px 5px; border: 0px; outline: 0px; font-weight: inherit; font-style: inherit; font-family: 'Source Code Pro', Consolas, Monaco, Menlo, Consolas, monospace; font-size: 1em; vertical-align: baseline; color: rgb(233, 105, 0); border-radius: 2px; background-color: rgb(248, 248, 248);">@ExceptionHandler</code>用来定义函数针对的异常类型，</li><li style="margin: 0px; padding: 0px; border: 0px; outline: 0px; font-weight: inherit; font-style: inherit; font-family: inherit; vertical-align: baseline;">最后将Exception对象和请求URL映射到<code style="margin: 0px 2px; padding: 3px 5px; border: 0px; outline: 0px; font-weight: inherit; font-style: inherit; font-family: 'Source Code Pro', Consolas, Monaco, Menlo, Consolas, monospace; font-size: 1em; vertical-align: baseline; color: rgb(233, 105, 0); border-radius: 2px; background-color: rgb(248, 248, 248);">error.html</code>中</li></ul><ul style="margin: 1.6em 20px; padding: 0px; border: 0px; outline: 0px; font-family: 'open sans', 'Helvetica Neue', 'Microsoft Yahei', Helvetica, Arial, sans-serif; font-size: 16px; vertical-align: baseline; line-height: 1.6em; color: rgb(86, 90, 95);"><li style="margin: 0px; padding: 0px; border: 0px; outline: 0px; font-weight: inherit; font-style: inherit; font-family: inherit; vertical-align: baseline;">实现<code style="margin: 0px 2px; padding: 3px 5px; border: 0px; outline: 0px; font-weight: inherit; font-style: inherit; font-family: 'Source Code Pro', Consolas, Monaco, Menlo, Consolas, monospace; font-size: 1em; vertical-align: baseline; color: rgb(233, 105, 0); border-radius: 2px; background-color: rgb(248, 248, 248);">error.html</code>页面展示：在<code style="margin: 0px 2px; padding: 3px 5px; border: 0px; outline: 0px; font-weight: inherit; font-style: inherit; font-family: 'Source Code Pro', Consolas, Monaco, Menlo, Consolas, monospace; font-size: 1em; vertical-align: baseline; color: rgb(233, 105, 0); border-radius: 2px; background-color: rgb(248, 248, 248);">templates</code>目录下创建<code style="margin: 0px 2px; padding: 3px 5px; border: 0px; outline: 0px; font-weight: inherit; font-style: inherit; font-family: 'Source Code Pro', Consolas, Monaco, Menlo, Consolas, monospace; font-size: 1em; vertical-align: baseline; color: rgb(233, 105, 0); border-radius: 2px; background-color: rgb(248, 248, 248);">error.html</code>，将请求的URL和Exception对象的message输出。</li></ul><pre code_snippet_id="2524304" snippet_file_name="blog_20170808_3_283856" name="code" class="java">@ControllerAdvice
public class GlobalExceptionHandler {
	public static final String DEFAULT_ERROR_VIEW = "error";
    @ExceptionHandler(value = Exception.class)
    public ModelAndView defaultErrorHandler(HttpServletRequest req, Exception e) throws Exception {
        ModelAndView mav = new ModelAndView();
        mav.addObject("exception", e);
        mav.addObject("url", req.getRequestURL());
        mav.setViewName(DEFAULT_ERROR_VIEW);
        System.out.println("进来了--------------------");
        return mav;
    }
}</pre><ul style="margin: 1.6em 20px; padding: 0px; border: 0px; outline: 0px; font-family: 'open sans', 'Helvetica Neue', 'Microsoft Yahei', Helvetica, Arial, sans-serif; font-size: 16px; vertical-align: baseline; line-height: 1.6em; color: rgb(86, 90, 95);"><li style="margin: 0px; padding: 0px; border: 0px; outline: 0px; font-weight: inherit; font-style: inherit; font-family: inherit; vertical-align: baseline;">实现<code style="margin: 0px 2px; padding: 3px 5px; border: 0px; outline: 0px; font-weight: inherit; font-style: inherit; font-family: 'Source Code Pro', Consolas, Monaco, Menlo, Consolas, monospace; font-size: 1em; vertical-align: baseline; color: rgb(233, 105, 0); border-radius: 2px; background-color: rgb(248, 248, 248);">error.html</code>页面展示：在<code style="margin: 0px 2px; padding: 3px 5px; border: 0px; outline: 0px; font-weight: inherit; font-style: inherit; font-family: 'Source Code Pro', Consolas, Monaco, Menlo, Consolas, monospace; font-size: 1em; vertical-align: baseline; color: rgb(233, 105, 0); border-radius: 2px; background-color: rgb(248, 248, 248);">templates</code>目录下创建<code style="margin: 0px 2px; padding: 3px 5px; border: 0px; outline: 0px; font-weight: inherit; font-style: inherit; font-family: 'Source Code Pro', Consolas, Monaco, Menlo, Consolas, monospace; font-size: 1em; vertical-align: baseline; color: rgb(233, 105, 0); border-radius: 2px; background-color: rgb(248, 248, 248);">error.html</code>，将请求的URL和Exception对象的message输出。</li></ul><pre code_snippet_id="2524304" snippet_file_name="blog_20170808_4_3522459" name="code" class="html">&lt;html&gt;
&lt;head lang="en"&gt;
    &lt;meta charset="UTF-8" /&gt;
    &lt;title&gt;统一异常处理&lt;/title&gt;
&lt;/head&gt;
&lt;body&gt;
    &lt;h1&gt;Error Handler1&lt;/h1&gt;
    &lt;div th:text="${url}"&gt;&lt;/div&gt;
    &lt;div th:text="${exception.message}"&gt;&lt;/div&gt;
&lt;/body&gt;
&lt;/html&gt;</pre><br />最后访问异常方法可以看到<p></p><p><span style="white-space:pre"><span style="color: rgb(86, 90, 95); font-family: 'open sans', 'Helvetica Neue', 'Microsoft Yahei', Helvetica, Arial, sans-serif; font-size: 16px; line-height: 25.6px;"><img src="http://img.blog.csdn.net/20170808195503621?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvbGlhb2RlaG9uZw==/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/Center" alt="" /><br /></span></span></p><p><span style="white-space:pre"><span style="color: rgb(86, 90, 95); font-family: 'open sans', 'Helvetica Neue', 'Microsoft Yahei', Helvetica, Arial, sans-serif; font-size: 16px; line-height: 25.6px;"><span style="margin: 0px; padding: 0px; border: 0px; outline: 0px; font-family: 'open sans', 'Helvetica Neue', 'Microsoft Yahei', Helvetica, Arial, sans-serif; font-size: 16px; vertical-align: baseline; color: rgb(86, 90, 95); line-height: 25.6px;">通过实现上述内容之后，我们只需要在<code style="margin: 0px 2px; padding: 3px 5px; border: 0px; outline: 0px; font-weight: inherit; font-style: inherit; font-family: 'Source Code Pro', Consolas, Monaco, Menlo, Consolas, monospace; font-size: 1em; vertical-align: baseline; color: rgb(233, 105, 0); border-radius: 2px; background-color: rgb(248, 248, 248);">Controller</code>中抛出<code style="margin: 0px 2px; padding: 3px 5px; border: 0px; outline: 0px; font-weight: inherit; font-style: inherit; font-family: 'Source Code Pro', Consolas, Monaco, Menlo, Consolas, monospace; font-size: 1em; vertical-align: baseline; color: rgb(233, 105, 0); border-radius: 2px; background-color: rgb(248, 248, 248);">Exception</code>，当然我们可能会有多种不同的<code style="margin: 0px 2px; padding: 3px 5px; border: 0px; outline: 0px; font-weight: inherit; font-style: inherit; font-family: 'Source Code Pro', Consolas, Monaco, Menlo, Consolas, monospace; font-size: 1em; vertical-align: baseline; color: rgb(233, 105, 0); border-radius: 2px; background-color: rgb(248, 248, 248);">Exception</code>。</span></span></span></p><p><span style="white-space:pre"><span style="color: rgb(86, 90, 95); font-family: 'open sans', 'Helvetica Neue', 'Microsoft Yahei', Helvetica, Arial, sans-serif; font-size: 16px; line-height: 25.6px;"><span style="margin: 0px; padding: 0px; border: 0px; outline: 0px; font-family: 'open sans', 'Helvetica Neue', 'Microsoft Yahei', Helvetica, Arial, sans-serif; font-size: 16px; vertical-align: baseline; color: rgb(86, 90, 95); line-height: 25.6px;">然后在<code style="margin: 0px 2px; padding: 3px 5px; border: 0px; outline: 0px; font-weight: inherit; font-style: inherit; font-family: 'Source Code Pro', Consolas, Monaco, Menlo, Consolas, monospace; font-size: 1em; vertical-align: baseline; color: rgb(233, 105, 0); border-radius: 2px; background-color: rgb(248, 248, 248);">@ControllerAdvice</code>类中，根据抛出的具体<code style="margin: 0px 2px; padding: 3px 5px; border: 0px; outline: 0px; font-weight: inherit; font-style: inherit; font-family: 'Source Code Pro', Consolas, Monaco, Menlo, Consolas, monospace; font-size: 1em; vertical-align: baseline; color: rgb(233, 105, 0); border-radius: 2px; background-color: rgb(248, 248, 248);">Exception</code>类型匹配<code style="margin: 0px 2px; padding: 3px 5px; border: 0px; outline: 0px; font-weight: inherit; font-style: inherit; font-family: 'Source Code Pro', Consolas, Monaco, Menlo, Consolas, monospace; font-size: 1em; vertical-align: baseline; color: rgb(233, 105, 0); border-radius: 2px; background-color: rgb(248, 248, 248);">@ExceptionHandler</code>中配置的异常类型来匹配错误映射和处理。</span><br /></span></span></p><p><span style="white-space:pre"><span style="color: rgb(86, 90, 95); font-family: 'open sans', 'Helvetica Neue', 'Microsoft Yahei', Helvetica, Arial, sans-serif; font-size: 16px; line-height: 25.6px;"><span style="margin: 0px; padding: 0px; border: 0px; outline: 0px; font-family: 'open sans', 'Helvetica Neue', 'Microsoft Yahei', Helvetica, Arial, sans-serif; font-size: 16px; vertical-align: baseline; color: rgb(86, 90, 95); line-height: 25.6px;"></span></span></span></p><h2 id="&#x8FD4;&#x56DE;JSON&#x683C;&#x5F0F;" style="margin: 1.3em 0px; padding: 0px; border: 0px; outline: 0px; font-family: 'open sans', 'Helvetica Neue', 'Microsoft Yahei', Helvetica, Arial, sans-serif; vertical-align: baseline; line-height: 1.3em; color: rgb(86, 90, 95);">返回JSON格式</h2><p></p><p style="margin-top: 1.6em; margin-bottom: 1.6em; padding-top: 0px; padding-bottom: 0px; border: 0px; outline: 0px; font-family: 'open sans', 'Helvetica Neue', 'Microsoft Yahei', Helvetica, Arial, sans-serif; font-size: 16px; vertical-align: baseline; line-height: 1.6em; color: rgb(86, 90, 95);">在上述例子中，通过<code style="margin: 0px 2px; padding: 3px 5px; border: 0px; outline: 0px; font-weight: inherit; font-style: inherit; font-family: 'Source Code Pro', Consolas, Monaco, Menlo, Consolas, monospace; font-size: 1em; vertical-align: baseline; color: rgb(233, 105, 0); border-radius: 2px; background-color: rgb(248, 248, 248);">@ControllerAdvice</code>统一定义不同Exception映射到不同错误处理页面。而当我们要实现RESTful API时，返回的错误是JSON格式的数据，而不是HTML页面，这时候我们也能轻松支持。</p><p style="margin-top: 1.6em; margin-bottom: 1.6em; padding-top: 0px; padding-bottom: 0px; border: 0px; outline: 0px; font-family: 'open sans', 'Helvetica Neue', 'Microsoft Yahei', Helvetica, Arial, sans-serif; font-size: 16px; vertical-align: baseline; line-height: 1.6em; color: rgb(86, 90, 95);">本质上，只需在<code style="margin: 0px 2px; padding: 3px 5px; border: 0px; outline: 0px; font-weight: inherit; font-style: inherit; font-family: 'Source Code Pro', Consolas, Monaco, Menlo, Consolas, monospace; font-size: 1em; vertical-align: baseline; color: rgb(233, 105, 0); border-radius: 2px; background-color: rgb(248, 248, 248);">@ExceptionHandler</code>之后加入<code style="margin: 0px 2px; padding: 3px 5px; border: 0px; outline: 0px; font-weight: inherit; font-style: inherit; font-family: 'Source Code Pro', Consolas, Monaco, Menlo, Consolas, monospace; font-size: 1em; vertical-align: baseline; color: rgb(233, 105, 0); border-radius: 2px; background-color: rgb(248, 248, 248);">@ResponseBody</code>，就能让处理函数return的内容转换为JSON格式。</p><p style="margin-top: 1.6em; margin-bottom: 1.6em; padding-top: 0px; padding-bottom: 0px; border: 0px; outline: 0px; font-family: 'open sans', 'Helvetica Neue', 'Microsoft Yahei', Helvetica, Arial, sans-serif; font-size: 16px; vertical-align: baseline; line-height: 1.6em; color: rgb(86, 90, 95);">下面以一个具体示例来实现返回JSON格式的异常处理。</p><ul style="margin: 1.6em 20px; padding: 0px; border: 0px; outline: 0px; font-family: 'open sans', 'Helvetica Neue', 'Microsoft Yahei', Helvetica, Arial, sans-serif; font-size: 16px; vertical-align: baseline; line-height: 1.6em; color: rgb(86, 90, 95);"><li style="margin: 0px; padding: 0px; border: 0px; outline: 0px; font-weight: inherit; font-style: inherit; font-family: inherit; vertical-align: baseline;">创建统一的JSON返回对象，code：消息类型，message：消息内容，url：请求的url，data：请求返回的数据</li></ul><div><pre code_snippet_id="2524304" snippet_file_name="blog_20170808_5_872500" name="code" class="java">public class ErrorInfo&lt;T&gt; {
    public static final Integer OK = 0;
    public static final Integer ERROR = 100;
    private Integer code;
    private String message;
    private String url;
    private T data;
    // 省略getter和setter</pre><br /><br /></div><ul style="margin: 1.6em 20px; padding: 0px; border: 0px; outline: 0px; font-family: 'open sans', 'Helvetica Neue', 'Microsoft Yahei', Helvetica, Arial, sans-serif; font-size: 16px; vertical-align: baseline; line-height: 1.6em; color: rgb(86, 90, 95);"><li style="margin: 0px; padding: 0px; border: 0px; outline: 0px; font-weight: inherit; font-style: inherit; font-family: inherit; vertical-align: baseline;">创建一个自定义异常，用来实验捕获该异常，并返回json</li></ul><div><pre code_snippet_id="2524304" snippet_file_name="blog_20170808_6_5714286" name="code" class="java">public class MyException extends Exception {
    public MyException(String message) {
        super(message);
    }
    
}</pre><br /><br /></div><ul style="margin: 1.6em 20px; padding: 0px; border: 0px; outline: 0px; font-family: 'open sans', 'Helvetica Neue', 'Microsoft Yahei', Helvetica, Arial, sans-serif; font-size: 16px; vertical-align: baseline; line-height: 1.6em; color: rgb(86, 90, 95);"><li style="margin: 0px; padding: 0px; border: 0px; outline: 0px; font-weight: inherit; font-style: inherit; font-family: inherit; vertical-align: baseline;"><code style="margin: 0px 2px; padding: 3px 5px; border: 0px; outline: 0px; font-weight: inherit; font-style: inherit; font-family: 'Source Code Pro', Consolas, Monaco, Menlo, Consolas, monospace; font-size: 1em; vertical-align: baseline; color: rgb(233, 105, 0); border-radius: 2px; background-color: rgb(248, 248, 248);">Controller</code>中增加json映射，抛出<code style="margin: 0px 2px; padding: 3px 5px; border: 0px; outline: 0px; font-weight: inherit; font-style: inherit; font-family: 'Source Code Pro', Consolas, Monaco, Menlo, Consolas, monospace; font-size: 1em; vertical-align: baseline; color: rgb(233, 105, 0); border-radius: 2px; background-color: rgb(248, 248, 248);">MyException</code>异常</li></ul><pre code_snippet_id="2524304" snippet_file_name="blog_20170808_7_9476277" name="code" class="java"> @RequestMapping("/json")
    public String json() throws MyException {
        throw new MyException("发生错误2");
    }</pre><br /><ul style="margin: 1.6em 20px; padding: 0px; border: 0px; outline: 0px; font-family: 'open sans', 'Helvetica Neue', 'Microsoft Yahei', Helvetica, Arial, sans-serif; font-size: 16px; vertical-align: baseline; line-height: 1.6em; color: rgb(86, 90, 95);"><li style="margin: 0px; padding: 0px; border: 0px; outline: 0px; font-weight: inherit; font-style: inherit; font-family: inherit; vertical-align: baseline;">为<code style="margin: 0px 2px; padding: 3px 5px; border: 0px; outline: 0px; font-weight: inherit; font-style: inherit; font-family: 'Source Code Pro', Consolas, Monaco, Menlo, Consolas, monospace; font-size: 1em; vertical-align: baseline; color: rgb(233, 105, 0); border-radius: 2px; background-color: rgb(248, 248, 248);">MyException</code>异常创建对应的处理</li></ul><pre code_snippet_id="2524304" snippet_file_name="blog_20170808_8_2714881" name="code" class="java">   @ExceptionHandler(value = MyException.class)
    @ResponseBody
    public ErrorInfo&lt;String&gt; jsonErrorHandler(HttpServletRequest req, MyException e) throws Exception {
        ErrorInfo&lt;String&gt; r = new ErrorInfo&lt;&gt;();
        r.setMessage(e.getMessage());
        r.setCode(ErrorInfo.ERROR);
        r.setData("Some Data");
        r.setUrl(req.getRequestURL().toString());
        return r;
    }</pre><br />我们访问页面就可以得到下面的结果<p><span style="white-space:pre"><span style="color: rgb(86, 90, 95); font-family: 'open sans', 'Helvetica Neue', 'Microsoft Yahei', Helvetica, Arial, sans-serif; font-size: 16px; line-height: 25.6px;"><span style="margin: 0px; padding: 0px; border: 0px; outline: 0px; font-family: 'open sans', 'Helvetica Neue', 'Microsoft Yahei', Helvetica, Arial, sans-serif; font-size: 16px; vertical-align: baseline; color: rgb(86, 90, 95); line-height: 25.6px;"><img src="http://img.blog.csdn.net/20170808200438510?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvbGlhb2RlaG9uZw==/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/Center" alt="" /><br /></span></span></span></p><p><span style="white-space:pre"><span style="color: rgb(86, 90, 95); font-family: 'open sans', 'Helvetica Neue', 'Microsoft Yahei', Helvetica, Arial, sans-serif; font-size: 16px; line-height: 25.6px;"><br /><br /><span style="color: rgb(86, 90, 95); font-family: 'open sans', 'Helvetica Neue', 'Microsoft Yahei', Helvetica, Arial, sans-serif; font-size: 16px; line-height: 25.6px;">至此，已完成在Spring Boot中创建统一的异常处理，实际实现还是依靠Spring MVC的注解。</span><br /></span></span></p><p><span style="white-space:pre"><span style="color: rgb(86, 90, 95); font-family: 'open sans', 'Helvetica Neue', 'Microsoft Yahei', Helvetica, Arial, sans-serif; font-size: 16px; line-height: 25.6px;"><span style="color: rgb(86, 90, 95); font-family: 'open sans', 'Helvetica Neue', 'Microsoft Yahei', Helvetica, Arial, sans-serif; font-size: 16px; line-height: 25.6px;"></span></span></span></p><h4 id="&#x8865;&#x5145;&#x5982;&#x679C;&#x5168;&#x90E8;&#x5F02;&#x5E38;&#x5904;&#x7406;&#x8FD4;&#x56DE;json&#x90A3;&#x4E48;&#x53EF;&#x4EE5;&#x4F7F;&#x7528;-restcontrolleradvice-&#x4EE3;&#x66FF;-controlleradvice-&#x8FD9;&#x6837;&#x5728;&#x65B9;&#x6CD5;&#x4E0A;&#x5C31;&#x53EF;&#x4EE5;&#x4E0D;&#x9700;&#x8981;&#x6DFB;&#x52A0;-responsebody">补充：如果全部异常处理返回json，那么可以使用 @RestControllerAdvice 代替 @ControllerAdvice ，</h4><h4 id="&#x8865;&#x5145;&#x5982;&#x679C;&#x5168;&#x90E8;&#x5F02;&#x5E38;&#x5904;&#x7406;&#x8FD4;&#x56DE;json&#x90A3;&#x4E48;&#x53EF;&#x4EE5;&#x4F7F;&#x7528;-restcontrolleradvice-&#x4EE3;&#x66FF;-controlleradvice-&#x8FD9;&#x6837;&#x5728;&#x65B9;&#x6CD5;&#x4E0A;&#x5C31;&#x53EF;&#x4EE5;&#x4E0D;&#x9700;&#x8981;&#x6DFB;&#x52A0;-responsebody">这样在方法上就可以不需要添加 @ResponseBody。</h4><br /><p></p>   &#13;
