
                
<p><strong><span style="font-family:Comic Sans MS; font-size:12px; color:#0066; background:rgb(255,255,255)">一、Redis集群操作</span></strong></p>&#13;
<p><span style="font-family:Comic Sans MS; font-size:12px; color:#ff00">1、开启Redis集群</span></p>&#13;
<p><span style="font-family:Comic Sans MS; font-size:12px; color:#000000; background:rgb(255,255,255)">1）执行上文中编写好的shell脚本，先将redis服务全部开启</span></p>&#13;
<p><span style="font-family:Comic Sans MS; font-size:12px; color:#000000; background:rgb(255,255,255)">2）执行redis01/redis-cli -h 192.168.132.128 -p 7005 -c启动01节点客户端连接集群</span></p>&#13;
<p><span style="font-family:Comic Sans MS; font-size:12px; color:#ff00">2、查看Redis集群节点进程</span></p>&#13;
<p align="justify"><span style="font-family:Comic Sans MS; font-size:12px; color:#ff00"> <img src="http://img.blog.csdn.net/20160524211419689?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQv/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/Center" alt=""/></span></p>&#13;
<p><span style="font-family:Comic Sans MS; font-size:12px; color:#ff00">3、关闭Redis集群</span></p>&#13;
<p><span style="font-family:Comic Sans MS; font-size:12px; color:#000000; background:rgb(255,255,255)">1)单机中，直接cd到redis/bin下，执行redis-cli连接到服务器， 然后shutdown即可。</span></p>&#13;
<p><span style="font-family:Comic Sans MS; font-size:12px; color:#000000; background:rgb(255,255,255)">2）或者指定redis节点端口号shut down ，统一编写成shell脚本如下：</span></p>&#13;
<p><span style="font-family:Comic Sans MS; font-size:12px"><img src="http://img.blog.csdn.net/20160524211628659?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQv/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/Center" alt=""/></span></p>&#13;
<p><span style="font-family:Comic Sans MS; font-size:12px">3)执行shell脚本,关闭redis集群</span></p>&#13;
<p><span style="font-family:Comic Sans MS; font-size:12px"><img src="http://img.blog.csdn.net/20160524211530330?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQv/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/Center" alt=""/></span></p>&#13;
<p><strong><span style="font-family:Comic Sans MS; font-size:12px; color:#0066; background:rgb(255,255,255)">二、Redis客户端连接集群</span></strong></p>&#13;
<p><span style="font-family:Comic Sans MS; font-size:12px; color:#ff00">1、自带的redis-cli命令</span></p>&#13;
<p><span style="font-family:Comic Sans MS; font-size:12px; color:#ff00">2、RedisManager 可视化工具</span></p>&#13;
<p><span style="font-family:Comic Sans MS; font-size:12px; color:#ff00"> <img src="http://img.blog.csdn.net/20160524211755442?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQv/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/Center" width="799" height="570" alt=""/></span></p>&#13;
<p><span style="font-family:Comic Sans MS; font-size:12px">     这个工具可用于连接单个redis节点，支持执行linux命令，例如在01中set了一个a，转跳到03中进行保存，进入03便可看到0号数据库下的key为a的value。另外Redis默认的是有16个数据库，从0号数据库开始，集群环境下默认操作0号数据库。可也对redis.conf对默认数据库数量进行修改</span></p>&#13;
<p><span style="font-family:Comic Sans MS; font-size:12px"><img src="http://img.blog.csdn.net/20160524212238192?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQv/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/Center" alt=""/></span></p>&#13;
<p><span style="font-family:Comic Sans MS; font-size:12px; color:#ff00">3、Jedis客户端jar</span></p>&#13;
<p><span style="font-family:Comic Sans MS"><span style="font-size:12px"><span style="color:#000000; background:rgb(255,255,255)">Jedis是</span><span style="color:#000000; background:rgb(255,255,255)">R</span><span style="color:#000000; background:rgb(255,255,255)">edis的java版本的客户端实现</span><span style="color:#000000; background:rgb(255,255,255)">，封装了java操作Redis的一套实现</span><span style="color:#000000; background:rgb(255,255,255)">。</span><span style="color:#000000; background:rgb(255,255,255)">用于在java中对Redis进行数据操作。</span></span></span></p>&#13;
<p><span style="font-family:Comic Sans MS; font-size:12px; color:#000000; background:rgb(255,255,255)">1）首先引入Jedis jar包。</span></p>&#13;
<p><span style="font-family:Comic Sans MS; font-size:12px">2）使用Jedis封装的API和对象对Redis节点进行数据操作。下面是几种连接方式的测试方法</span></p>&#13;
<p><span style="font-family:Comic Sans MS; font-size:12px">使用单个Jedis对象创建连接</span></p>&#13;
<span style="font-family:Comic Sans MS"/><pre code_snippet_id="1695491" snippet_file_name="blog_20160524_1_475541" class="html" name="code">&lt;span style="font-size:12px;"&gt;	public void single() {&#13;
		// 创建一个jedis对象&#13;
		Jedis jedis = new Jedis("192.168.132.128", 6379);&#13;
		// 调用方法，方法名和redis的命令一样&#13;
		jedis.set("key1", "jedis-test");&#13;
		String string = jedis.get("key1");&#13;
		System.out.println(string);&#13;
		jedis.close();&#13;
	}&lt;/span&gt;</pre>&#13;
<p><span style="font-size:12px">使用Jedis数据连接池创建连接</span></p>&#13;
<pre code_snippet_id="1695491" snippet_file_name="blog_20160524_2_3888084" class="html" name="code">&lt;span style="font-size:12px;"&gt;	public void Pool() {&#13;
		// 创建一个jedis连接池对象&#13;
		JedisPool pool = new JedisPool("192.168.132.128", 6379);&#13;
		// 从连接池中获取jedis对象&#13;
		Jedis jedis = pool.getResource();&#13;
		String string = jedis.get("key1");&#13;
		System.out.println(string);&#13;
		// 注意每次使用完毕都需要关闭jedis连接，否则连接池很容易就到达最大连接数，溢出了。&#13;
		jedis.close();&#13;
	}&lt;/span&gt;</pre>&#13;
<p><span style="font-family:Comic Sans MS; font-size:12px">连接Redis集群</span></p>&#13;
<span style="font-family:Comic Sans MS"/><pre code_snippet_id="1695491" snippet_file_name="blog_20160524_3_5698228" class="html" name="code">&lt;span style="font-size:12px;"&gt;public void Cluster() {&#13;
		// 创建一个hashset、用于存放所有的节点信息&#13;
		HashSet&lt;HostAndPort&gt; nodes = new HashSet&lt;&gt;();&#13;
		nodes.add(new HostAndPort("192.168.132.128", 7001));&#13;
		nodes.add(new HostAndPort("192.168.132.128", 7002));&#13;
		nodes.add(new HostAndPort("192.168.132.128", 7003));&#13;
		nodes.add(new HostAndPort("192.168.132.128", 7004));&#13;
		nodes.add(new HostAndPort("192.168.132.128", 7005));&#13;
		nodes.add(new HostAndPort("192.168.132.128", 7006));&#13;
		// 创建一个集群&#13;
		JedisCluster cluster = new JedisCluster(nodes);&#13;
		cluster.set("key", "cluster-connection-success");&#13;
		String string = cluster.get("key");&#13;
		System.out.println(string);&#13;
&#13;
		cluster.close();&#13;
&#13;
	}&lt;/span&gt;</pre>&#13;
<p><span style="font-size:12px">注意：每次建立连接后处理完执行关闭连接操作，以免连接数超过最大连接数导致node 宕掉。</span></p>&#13;
<p> </p>&#13;
<link rel="stylesheet" href="http://static.blog.csdn.net/public/res-min/markdown_views.css?v=1.0"/>&#13;
            