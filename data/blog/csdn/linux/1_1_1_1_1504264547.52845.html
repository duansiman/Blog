
<p><strong><span style="font-size:24px;">这一章的标题是 “信号” ，所以本文将对信号的各个方面进行介绍，由于Linux中的信号机制远比想象的要复杂，所以，本文不会讲的很全面。。。</span></strong></p><p><strong><span style="font-size:18px; font-family: Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif; line-height: 18px;">信号机制是进程之间相互传递消息的一种方法，信号全称为软中断信号，也有人称作软中断。从它的命名可以看出，它的实质和使用很象中断。所以，信号可以说是进程控制的一部分。 </span><br style="font-family: Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif; line-height: 18px;" /><br style="font-family: Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif; line-height: 18px;" /><span style="font-family: Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif; line-height: 18px; background-color: rgb(255, 255, 0);"><span style="font-size:24px;"><img alt="微笑" src="http://static.blog.csdn.net/xheditor/xheditor_emot/default/smile.gif" />一、信号的基本概念 </span></span><br style="font-family: Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif; line-height: 18px;" /><br style="font-family: Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif; line-height: 18px;" /><span style="font-size:18px; font-family: Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif; line-height: 18px;">本节先介绍信号的一些基本概念，然后给出一些基本的信号类型和信号对应的事件。基本概念对于理解和使用信号，对于理解信号机制都特别重要。下面就来看看什么是信号。 </span><br style="font-family: Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif; line-height: 18px;" /><br style="font-family: Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif; line-height: 18px;" /><span style="font-size:18px; font-family: Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif; line-height: 18px;">1、基本概念 </span><br style="font-family: Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif; line-height: 18px;" /><br style="font-family: Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif; line-height: 18px;" /><span style="font-size:18px; font-family: Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif; line-height: 18px;">软中断信号（signal，又简称为信号）用来通知进程发生了异步事件。进程之间可以互相通过系统调用kill发送软中断信号。内核也可以因为内部事件而给进程发送信号，通知进程发生了某个事件。注意，信号只是用来通知某进程发生了什么事件，并不给该进程传递任何数据。 </span><br style="font-family: Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif; line-height: 18px;" /><br style="font-family: Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif; line-height: 18px;" /><span style="font-size:18px; font-family: Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif; line-height: 18px;">收 到信号的进程对各种信号有不同的处理方法。处理方法可以分为三类：第一种是类似中断的处理程序，对于需要处理的信号，进程可以指定处理函数，由该函数来处 理。第二种方法是，忽略某个信号，对该信号不做任何处理，就象未发生过一样。第三种方法是，对该信号的处理保留系统的默认值，这种缺省操作，对大部分的信 号的缺省操作是使得进程终止。进程通过系统调用signal来指定进程对某个信号的处理行为。 </span><br style="font-family: Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif; line-height: 18px;" /><br style="font-family: Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif; line-height: 18px;" /><span style="font-size:18px; font-family: Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif; line-height: 18px;">在进程表的表项中有一个软中断信号域，该域中每一位对应一个信号，当有信号发送给进程时，对应位置位。由此可以看出，进程对不同的信号可以同时保留，但对于同一个信号，进程并不知道在处理之前来过多少个。 </span><br style="font-family: Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif; line-height: 18px;" /><br style="font-family: Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif; line-height: 18px;" /><span style="font-size:18px; font-family: Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif; line-height: 18px;">2、信号的类型 </span><br style="font-family: Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif; line-height: 18px;" /><br style="font-family: Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif; line-height: 18px;" /><span style="font-size:18px; font-family: Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif; line-height: 18px;">发出信号的原因很多，这里按发出信号的原因简单分类，以了解各种信号： </span><br style="font-family: Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif; line-height: 18px;" /><br style="font-family: Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif; line-height: 18px;" /><span style="font-size:18px; font-family: Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif; line-height: 18px;">（1） 与进程终止相关的信号。当进程退出，或者子进程终止时，发出这类信号。</span></strong></p><p><strong><span style="font-size:18px; font-family: Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif; line-height: 18px;"> </span><br style="font-family: Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif; line-height: 18px;" /><span style="font-size:18px; font-family: Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif; line-height: 18px;">（2） 与进程例外事件相关的信号。如进程越界，或企图写一个只读的内存区域（如程序正文区），或执行一个特权指令及其他各种硬件错误。</span></strong></p><p><strong><span style="font-size:18px; font-family: Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif; line-height: 18px;"> </span><br style="font-family: Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif; line-height: 18px;" /><span style="font-size:18px; font-family: Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif; line-height: 18px;">（3） 与在系统调用期间遇到不可恢复条件相关的信号。如执行系统调用exec时，原有资源已经释放，而目前系统资源又已经耗尽。</span></strong></p><p><strong><span style="font-size:18px; font-family: Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif; line-height: 18px;"> </span><br style="font-family: Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif; line-height: 18px;" /><span style="font-size:18px; font-family: Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif; line-height: 18px;">（4） 与执行系统调用时遇到非预测错误条件相关的信号。如执行一个并不存在的系统调用。 </span></strong></p><p><strong><span style="font-size:18px;"><br style="font-family: Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif; line-height: 18px;" /></span><span style="font-size:18px; font-family: Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif; line-height: 18px;">（5） 在用户态下的进程发出的信号。如进程调用系统调用kill向其他进程发送信号。 </span></strong></p><p><strong><span style="font-size:18px;"><br style="font-family: Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif; line-height: 18px;" /></span><span style="font-size:18px; font-family: Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif; line-height: 18px;">（6） 与终端交互相关的信号。如用户关闭一个终端，或按下break键等情况。</span></strong></p><p><strong><span style="font-size:18px; font-family: Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif; line-height: 18px;"> </span><br style="font-family: Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif; line-height: 18px;" /><span style="font-size:18px; font-family: Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif; line-height: 18px;">（7） 跟踪进程执行的信号。</span></strong></p><p><strong><span style="font-size:18px; font-family: Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif; line-height: 18px;"> </span><br /></strong></p><p><span style="font-family: Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif; line-height: 18px;"><span style="font-family: Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif; line-height: 18px;"><span style="font-size:18px;"><strong>Linux支持的信号列表如下。很多信号是与机器的体系结构相关的</strong></span></span><br /></span></p><p><span style="font-family: Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif; line-height: 18px;"><span style="font-family: Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif; line-height: 18px;"></span></span></p><pre name="code" class="cpp">SIGHUP 1 A 终端挂起或者控制进程终止 
SIGINT 2 A 键盘中断（如break键被按下） 
SIGQUIT 3 C 键盘的退出键被按下 
SIGILL 4 C 非法指令 
SIGABRT 6 C 由abort(3)发出的退出指令 
SIGFPE 8 C 浮点异常 
SIGKILL 9 AEF Kill信号 
SIGSEGV 11 C 无效的内存引用 
SIGPIPE 13 A 管道破裂: 写一个没有读端口的管道 
SIGALRM 14 A 由alarm(2)发出的信号 
SIGTERM 15 A 终止信号 
SIGUSR1 30,10,16 A 用户自定义信号1 
SIGUSR2 31,12,17 A 用户自定义信号2 
SIGCHLD 20,17,18 B 子进程结束信号 
SIGCONT 19,18,25 进程继续（曾被停止的进程） 
SIGSTOP 17,19,23 DEF 终止进程 
SIGTSTP 18,20,24 D 控制终端（tty）上按下停止键 
SIGTTIN 21,21,26 D 后台进程企图从控制终端读 
SIGTTOU 22,22,27 D 后台进程企图从控制终端写 
SIGIOT 6 C IO捕获指令，与SIGABRT同义 
SIGEMT 7,-,7 
SIGSTKFLT -,16,- A 协处理器堆栈错误 
SIGIO 23,29,22 A 某I/O操作现在可以进行了(4.2 BSD) 
SIGCLD -,-,18 A 与SIGCHLD同义 
SIGPWR 29,30,19 A 电源故障(System V) 
SIGINFO 29,-,- A 与SIGPWR同义 
SIGLOST -,-,- A 文件锁丢失 
SIGWINCH 28,28,20 B 窗口大小改变(4.3 BSD, Sun) 
SIGUNUSED -,31,- A 未使用的信号(will be SIGSYS) </pre><br /><pre name="code" class="cpp">处理动作一项中的字母含义如下 
A 缺省的动作是终止进程 
B 缺省的动作是忽略此信号 
C 缺省的动作是终止进程并进行内核映像转储（dump core） 
D 缺省的动作是停止进程 
E 信号不能被捕获 
F 信号不能被忽略 </pre><br /><span style="font-family: Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif; line-height: 18px; background-color: rgb(255, 255, 0);"><span style="font-size:24px;"><strong><img alt="微笑" src="http://static.blog.csdn.net/xheditor/xheditor_emot/default/smile.gif" />二、信 号 机 制 </strong></span></span><br style="font-family: Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif; line-height: 18px;" /><br style="font-family: Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif; line-height: 18px;" /><span style="font-size:18px;"><strong><span style="font-family: Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif; line-height: 18px;">介绍内核如何实现信号机制。即内核如何向一个进程发送信号、进程如何接收一个信号、进程怎样控制自己对信 号的反应、内核在什么时机处理和怎样处理进程收到的信号。</span><br style="font-family: Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif; line-height: 18px;" /><br style="font-family: Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif; line-height: 18px;" /><span style="font-family: Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif; line-height: 18px;">内核对信号的基本处理方法 </span><br style="font-family: Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif; line-height: 18px;" /><br style="font-family: Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif; line-height: 18px;" /><span style="font-family: Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif; line-height: 18px;">内 核给一个进程发送软中断信号的方法，是在进程所在的进程表项的信号域设置对应于该信号的位。这里要补充的是，如果信号发送给一个正在睡眠的进程，那么要看 该进程进入睡眠的优先级，如果进程睡眠在可被中断的优先级上，则唤醒进程；否则仅设置进程表中信号域相应的位，而不唤醒进程。这一点比较重要，因为进程检 查是否收到信号的时机是：一个进程在即将从内核态返回到用户态时；或者，在一个进程要进入或离开一个适当的低调度优先级睡眠状态时。 </span><br style="font-family: Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif; line-height: 18px;" /><br style="font-family: Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif; line-height: 18px;" /><span style="font-family: Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif; line-height: 18px;">内核处理一个进程收到的信号的时机是在一个进程从内核态返回用户态时。所以，当一个进程在内核态下运行时，软中断信号并不立即起作用，要等到将返回用户态时才处理。进程只有处理完信号才会返回用户态，进程在用户态下不会有未处理完的信号。 </span><br style="font-family: Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif; line-height: 18px;" /><br style="font-family: Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif; line-height: 18px;" /><span style="font-family: Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif; line-height: 18px;">内 核处理一个进程收到的软中断信号是在该进程的上下文中，因此，进程必须处于运行状态。前面介绍概念的时候讲过，处理信号有三种类型：进程接收到信号后退 出；进程忽略该信号；进程收到信号后执行用户设定用系统调用signal的函数。当进程接收到一个它忽略的信号时，进程丢弃该信号，就象没有收到该信号似 的继续运行。如果进程收到一个要捕捉的信号，那么进程从内核态返回用户态时执行用户定义的函数。而且执行用户定义的函数的方法很巧妙，内核是在用户栈上创 建一个新的层，该层中将返回地址的值设置成用户定义的处理函数的地址，这样进程从内核返回弹出栈顶时就返回到用户定义的函数处，从函数返回再弹出栈顶时， 才返回原先进入内核的地方。这样做的原因是用户定义的处理函数不能且不允许在内核态下执行（如果用户定义的函数在内核态下运行的话，用户就可以获得任何权 限）。 </span><br style="font-family: Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif; line-height: 18px;" /><br style="font-family: Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif; line-height: 18px;" /><span style="font-family: Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif; line-height: 18px;">在信号的处理方法中有几点特别要引起注意。第一，在一些系统中，当一个进程处理完中断信号返回用户态之前，内核清除用户区中设 定的对该信号的处理例程的地址，即下一次进程对该信号的处理方法又改为默认值，除非在下一次信号到来之前再次使用signal系统调用。这可能会使得进程 在调用signal之前又得到该信号而导致退出。在BSD中，内核不再清除该地址。但不清除该地址可能使得进程因为过多过快的得到某个信号而导致堆栈溢 出。为了避免出现上述情况。在BSD系统中，内核模拟了对硬件中断的处理方法，即在处理某个中断时，阻止接收新的该类中断。 </span><br style="font-family: Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif; line-height: 18px;" /><br style="font-family: Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif; line-height: 18px;" /><span style="font-family: Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif; line-height: 18px;">第二个要 引起注意的是，如果要捕捉的信号发生于进程正在一个系统调用中时，并且该进程睡眠在可中断的优先级上，这时该信号引起进程作一次longjmp，跳出睡眠 状态，返回用户态并执行信号处理例程。当从信号处理例程返回时，进程就象从系统调用返回一样，但返回了一个错误代码，指出该次系统调用曾经被中断。这要注 意的是，BSD系统中内核可以自动地重新开始系统调用。 </span><br style="font-family: Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif; line-height: 18px;" /><br style="font-family: Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif; line-height: 18px;" /><span style="font-family: Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif; line-height: 18px;">第三个要注意的地方：若进程睡眠在可中断的优先级上，则当它收到一个要忽略的信号时，该进程被唤醒，但不做longjmp，一般是继续睡眠。但用户感觉不到进程曾经被唤醒，而是象没有发生过该信号一样。 </span><br style="font-family: Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif; line-height: 18px;" /><br style="font-family: Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif; line-height: 18px;" /><span style="font-family: Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif; line-height: 18px;">第 四个要注意的地方：内核对子进程终止（SIGCLD）信号的处理方法与其他信号有所区别。当进程检查出收到了一个子进程终止的信号时，缺省情况下，该进程 就象没有收到该信号似的，如果父进程执行了系统调用wait，进程将从系统调用wait中醒来并返回wait调用，执行一系列wait调用的后续操作（找 出僵死的子进程，释放子进程的进程表项），然后从wait中返回。SIGCLD信号的作用是唤醒一个睡眠在可被中断优先级上的进程。如果该进程捕捉了这个 信号，就象普通信号处理一样转到处理例程。如果进程忽略该信号，那么系统调用wait的动作就有所不同，因为SIGCLD的作用仅仅是唤醒一个睡眠在可被 中断优先级上的进程，那么执行wait调用的父进程被唤醒继续执行wait调用的后续操作，然后等待其他的子进程。 </span><br style="font-family: Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif; line-height: 18px;" /><br style="font-family: Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif; line-height: 18px;" /><span style="font-family: Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif; line-height: 18px;">如果一个进程调用signal系统调用，并设置了SIGCLD的处理方法，并且该进程有子进程处于僵死状态，则内核将向该进程发一个SIGCLD信号。 </span></strong></span><br /><p></p><p><span style="font-family: Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif; line-height: 18px;"><span style="font-family: Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif; line-height: 18px;"><span style="font-family: Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif; line-height: 18px;"><br /></span></span></span></p><p><span style="font-family: Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif; line-height: 18px;"><span style="font-family: Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif; line-height: 18px;"><span style="font-family: Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif; line-height: 18px;"><span style="font-family: Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif; line-height: 18px; background-color: rgb(255, 255, 0);"><span style="font-size:24px;"><strong><img alt="微笑" src="http://static.blog.csdn.net/xheditor/xheditor_emot/default/smile.gif" />三、有关信号的系统调用 </strong></span></span><br style="font-family: Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif; line-height: 18px;" /><br style="font-family: Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif; line-height: 18px;" /><span style="font-size:18px;"><strong><span style="font-family: Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif; line-height: 18px;">前面两节已经介绍了有关信号的大部分知 识。这一节我们来了解一下这些系统调用。其中，系统调用signal是进程用来设定某个信号的处理方法，系统调用kill是用来发送信号给指定进程的。这 两个调用可以形成信号的基本操作。后两个调用pause和alarm是通过信号实现的进程暂停和定时器，调用alarm是通过信号通知进程定时器到时。所 以在这里，我们还要介绍这两个调用。 </span><br style="font-family: Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif; line-height: 18px;" /><br style="font-family: Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif; line-height: 18px;" /><span style="font-family: Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif; line-height: 18px;">1、signal 系统调用 </span><br style="font-family: Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif; line-height: 18px;" /><br style="font-family: Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif; line-height: 18px;" /><span style="font-family: Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif; line-height: 18px;">系统调用signal用来设定某个信号的处理方法。该调用声明的格式如下： </span></strong></span><br /></span></span></span></p><p><span style="font-family: Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif; line-height: 18px;"><span style="font-family: Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif; line-height: 18px;"><span style="font-family: Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif; line-height: 18px;"><span style="font-family: Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif; line-height: 18px;"></span></span></span></span></p><pre name="code" class="cpp">void (*signal(int signum, void (*handler)(int)))(int); 
在使用该调用的进程中加入以下头文件： 
#include &lt;signal.h&gt; </pre><br /><span style="font-family: Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif; line-height: 18px;"><span style="font-size:18px;"><strong>上述声明格式比较复杂，如果不清楚如何使用，也可以通过下面这种类型定义的格式来使用（POSIX的定义）： </strong></span></span><br /><p></p><p><span style="font-family: Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif; line-height: 18px;"><span style="font-family: Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif; line-height: 18px;"><span style="font-family: Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif; line-height: 18px;"><span style="font-family: Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif; line-height: 18px;"><span style="font-family: Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif; line-height: 18px;"></span></span></span></span></span></p><pre name="code" class="cpp">typedef void (*sighandler_t)(int); 
sighandler_t signal(int signum, sighandler_t handler); </pre><br /><span style="font-size:18px;"><strong><span style="font-family: Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif; line-height: 18px;">在调用中，参数signum指出要设置处理方法的信号。第二个参数handler是一个处理函数，或者是 </span><br style="font-family: Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif; line-height: 18px;" /><span style="font-family: Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif; line-height: 18px;">SIG_IGN：忽略参数signum所指的信号。 </span><br style="font-family: Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif; line-height: 18px;" /><span style="font-family: Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif; line-height: 18px;">SIG_DFL：恢复参数signum所指信号的处理方法为默认值。 </span><br style="font-family: Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif; line-height: 18px;" /><br style="font-family: Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif; line-height: 18px;" /><span style="font-family: Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif; line-height: 18px;">传递给信号处理例程的整数参数是信号值，这样可以使得一个信号处理例程处理多个信号。系统调用signal返回值是指定信号signum前一次的处理例程或者错误时返回错误代码SIG_ERR。下面来看一个简单的例子： </span></strong></span><br style="font-family: Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif; line-height: 18px;" /><pre name="code" class="cpp">#include &lt;signal.h&gt; 
#include &lt;unistd.h&gt; 
#include &lt;stdio.h&gt; 
void sigroutine(int dunno) { /* 信号处理例程，其中dunno将会得到信号的值 */ 
switch (dunno) { 
case 1: 
printf("Get a signal -- SIGHUP "); 
break; 
case 2: 
printf("Get a signal -- SIGINT "); 
break; 
case 3: 
printf("Get a signal -- SIGQUIT "); 
break; 
} 
return; 
} 

int main() { 
printf("process id is %d ",getpid()); 
signal(SIGHUP, sigroutine); //* 下面设置三个信号的处理方法 
signal(SIGINT, sigroutine); 
signal(SIGQUIT, sigroutine); 
for (;;) ; 
} </pre><br /><span style="font-size:18px;"><strong><span style="font-family: Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif; line-height: 18px;">其中信号SIGINT由按下Ctrl-C发出，信号SIGQUIT由按下Ctrl-发出。</span><br /></strong></span><p></p><p><span style="font-family: Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif; line-height: 18px;"><span style="font-family: Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif; line-height: 18px;"><span style="font-family: Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif; line-height: 18px;"><span style="font-family: Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif; line-height: 18px;"><span style="font-family: Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif; line-height: 18px;"><span style="font-family: Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif; line-height: 18px;"><span style="font-size:18px;"><strong><br /></strong></span></span></span></span></span></span></span></p><p><span style="font-family: Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif; line-height: 18px;"><span style="font-family: Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif; line-height: 18px;"><span style="font-family: Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif; line-height: 18px;"><span style="font-family: Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif; line-height: 18px;"><span style="font-family: Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif; line-height: 18px;"><span style="font-family: Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif; line-height: 18px;"><span style="font-size:18px;"><strong><span style="font-family: Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif; line-height: 18px;">2、kill 系统调用 </span><br style="font-family: Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif; line-height: 18px;" /><br style="font-family: Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif; line-height: 18px;" /><span style="font-family: Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif; line-height: 18px;">系统调用kill用来向进程发送一个信号。该调用声明的格式如下： </span></strong></span><br /></span></span></span></span></span></span></p><p><span style="font-family: Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif; line-height: 18px;"><span style="font-family: Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif; line-height: 18px;"><span style="font-family: Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif; line-height: 18px;"><span style="font-family: Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif; line-height: 18px;"><span style="font-family: Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif; line-height: 18px;"><span style="font-family: Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif; line-height: 18px;"><span style="font-family: Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif; line-height: 18px;"></span></span></span></span></span></span></span></p><pre name="code" class="cpp">nt kill(pid_t pid, int sig); 
在使用该调用的进程中加入以下头文件： 
#include &lt;sys/types.h&gt; 
#include &lt;signal.h&gt; </pre><br /><span style="font-size:18px;"><strong><span style="font-family: Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif; line-height: 18px;">该 系统调用可以用来向任何进程或进程组发送任何信号。如果参数pid是正数，那么该调用将信号sig发送到进程号为pid的进程。如果pid等于0，那么信 号sig将发送给当前进程所属进程组里的所有进程。如果参数pid等于-1，信号sig将发送给除了进程1和自身以外的所有进程。如果参数pid小于- 1，信号sig将发送给属于进程组-pid的所有进程。如果参数sig为0，将不发送信号。该调用执行成功时，返回值为0；错误时，返回-1，并设置相应 的错误代码errno。下面是一些可能返回的错误代码： </span><br style="font-family: Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif; line-height: 18px;" /><span style="font-family: Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif; line-height: 18px;">EINVAL：指定的信号sig无效。 </span><br style="font-family: Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif; line-height: 18px;" /><span style="font-family: Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif; line-height: 18px;">ESRCH：参数pid指定的进程或进程组不存在。注意，在进程表项中存在的进程，可能是一个还没有被wait收回，但已经终止执行的僵死进程。 </span><br style="font-family: Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif; line-height: 18px;" /><span style="font-family: Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif; line-height: 18px;">EPERM： 进程没有权力将这个信号发送到指定接收信号的进程。因为，一个进程被允许将信号发送到进程pid时，必须拥有root权力，或者是发出调用的进程的UID 或EUID与指定接收的进程的UID或保存用户ID（savedset-user-ID）相同。如果参数pid小于-1，即该信号发送给一个组，则该错误 表示组中有成员进程不能接收该信号。 </span><br /></strong></span><p></p><p><span style="font-family: Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif; line-height: 18px;"><span style="font-family: Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif; line-height: 18px;"><span style="font-family: Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif; line-height: 18px;"><span style="font-family: Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif; line-height: 18px;"><span style="font-family: Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif; line-height: 18px;"><span style="font-family: Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif; line-height: 18px;"><span style="font-family: Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif; line-height: 18px;"><span style="font-family: Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif; line-height: 18px;"><span style="font-size:18px;"><strong><br /></strong></span></span></span></span></span></span></span></span></span></p><p><span style="font-family: Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif; line-height: 18px;"><span style="font-family: Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif; line-height: 18px;"><span style="font-family: Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif; line-height: 18px;"><span style="font-family: Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif; line-height: 18px;"><span style="font-family: Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif; line-height: 18px;"><span style="font-family: Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif; line-height: 18px;"><span style="font-family: Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif; line-height: 18px;"><span style="font-family: Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif; line-height: 18px;"><span style="font-size:18px;"><strong><span style="font-family: Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif; line-height: 18px;">3、pause系统调用 </span><br style="font-family: Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif; line-height: 18px;" /><br style="font-family: Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif; line-height: 18px;" /><span style="font-family: Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif; line-height: 18px;">系统调用pause的作用是等待一个信号。该调用的声明格式如下： </span></strong></span><br /></span></span></span></span></span></span></span></span></p><p><span style="font-family: Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif; line-height: 18px;"><span style="font-family: Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif; line-height: 18px;"><span style="font-family: Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif; line-height: 18px;"><span style="font-family: Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif; line-height: 18px;"><span style="font-family: Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif; line-height: 18px;"><span style="font-family: Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif; line-height: 18px;"><span style="font-family: Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif; line-height: 18px;"><span style="font-family: Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif; line-height: 18px;"><span style="font-family: Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif; line-height: 18px;"></span></span></span></span></span></span></span></span></span></p><pre name="code" class="cpp">int pause(void); 
在使用该调用的进程中加入以下头文件： 
#include &lt;unistd.h&gt; </pre><br /><span style="font-size:18px;"><strong><span style="font-family: Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif; line-height: 18px;">该调用使得发出调用的进程进入睡眠，直到接收到一个信号为止。该调用总是返回-1，并设置错误代码为EINTR（接收到一个信号）。下面是一个简单的范例： </span><br style="font-family: Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif; line-height: 18px;" /></strong></span><pre name="code" class="cpp">#include &lt;unistd.h&gt; 
#include &lt;stdio.h&gt; 
#include &lt;signal.h&gt; 
void sigroutine(int unused) { 
printf("Catch a signal SIGINT "); 
} 

int main() { 
signal(SIGINT, sigroutine); 
pause(); 
printf("receive a signal "); 
} </pre><br /><span style="font-size:18px;"><strong><span style="font-family: Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif; line-height: 18px;">在这个例子中，程序开始执行，就象进入了死循环一样，这是因为进程正在等待信号，当我们按下Ctrl-C时，信号被捕捉，并且使得pause退出等待状态。 </span><br style="font-family: Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif; line-height: 18px;" /></strong></span><br /><p></p><p><span style="font-family: Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif; line-height: 18px;"><span style="font-family: Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif; line-height: 18px;"><span style="font-family: Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif; line-height: 18px;"><span style="font-family: Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif; line-height: 18px;"><span style="font-family: Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif; line-height: 18px;"><span style="font-family: Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif; line-height: 18px;"><span style="font-family: Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif; line-height: 18px;"><span style="font-family: Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif; line-height: 18px;"><span style="font-family: Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif; line-height: 18px;"></span></span></span></span></span></span></span></span></span></p><pre name="code" class="cpp">raise（） 
#include &lt;signal.h&gt; 
int raise(int signo) </pre><br /><span style="font-size:18px;"><strong><span style="font-family: arial, nsimsun, sans-serif;">向进程本身发送信号，参数为即将发送的信号值。调用成功返回 0；否则，返回 -1。</span><br /></strong></span><p></p><p><span style="font-family: Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif; line-height: 18px;"><span style="font-family: Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif; line-height: 18px;"><span style="font-family: Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif; line-height: 18px;"><span style="font-family: Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif; line-height: 18px;"><span style="font-family: Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif; line-height: 18px;"><span style="font-family: Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif; line-height: 18px;"><span style="font-family: Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif; line-height: 18px;"><span style="font-family: Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif; line-height: 18px;"><span style="font-family: Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif; line-height: 18px;"><span style="font-family: arial, nsimsun, sans-serif;"><span style="font-size:18px;"><strong><br /></strong></span></span></span></span></span></span></span></span></span></span></span></p><p><span style="font-family: Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif; line-height: 18px;"><span style="font-family: Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif; line-height: 18px;"><span style="font-family: Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif; line-height: 18px;"><span style="font-family: Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif; line-height: 18px;"><span style="font-family: Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif; line-height: 18px;"><span style="font-family: Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif; line-height: 18px;"><span style="font-family: Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif; line-height: 18px;"><span style="font-family: Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif; line-height: 18px;"><span style="font-family: Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif; line-height: 18px;"><span style="font-family: arial, nsimsun, sans-serif;"><span style="font-size:18px;"><strong>以PAYLOAD 送出信号</strong></span></span></span></span></span></span></span></span></span></span></span></p><p><span style="font-family: Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif; line-height: 18px;"><span style="font-family: Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif; line-height: 18px;"><span style="font-family: Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif; line-height: 18px;"><span style="font-family: Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif; line-height: 18px;"><span style="font-family: Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif; line-height: 18px;"><span style="font-family: Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif; line-height: 18px;"><span style="font-family: Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif; line-height: 18px;"><span style="font-family: Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif; line-height: 18px;"><span style="font-family: Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif; line-height: 18px;"><span style="font-family: arial, nsimsun, sans-serif;"></span></span></span></span></span></span></span></span></span></span></p><pre name="code" class="cpp">sigqueue（） 
#include &lt;sys/types.h&gt; 
#include &lt;signal.h&gt; 
int sigqueue(pid_t pid, int sig, const union sigval val) </pre><br /><p></p><p style="font-family: arial, nsimsun, sans-serif; margin-top: 0px; margin-bottom: 0px; padding: 0.3em 5px 0.7em;"><span style="font-size:18px;"><strong>调用成功返回 0；否则，返回 -1。</strong></span></p><p style="font-family: arial, nsimsun, sans-serif; margin-top: 0px; margin-bottom: 0px; padding: 0.3em 5px 0.7em;"><span style="font-size:18px;"><strong>sigqueue()是比较新的发送信号系统调用，主要是针对实时信号提出的（当然也支持前32种），支持信号带有参数，与函数sigaction()配合使用。</strong></span></p><p style="font-family: arial, nsimsun, sans-serif; margin-top: 0px; margin-bottom: 0px; padding: 0.3em 5px 0.7em;"><span style="font-size:18px;"><strong>sigqueue的第一个参数是指定接收信号的进程ID，第二个参数确定即将发送的信号，第三个参数是一个联合数据结构union sigval，指定了信号传递的参数，即通常所说的4字节值。</strong></span></p><pre name="code" class="cpp">typedef union sigval {
 		int  sival_int;
 		void *sival_ptr;
 	}sigval_t;</pre><br /><p style="font-family: arial, nsimsun, sans-serif; margin-top: 0px; margin-bottom: 0px; padding: 0.3em 5px 0.7em;"><span style="font-size:18px;"><strong>sigqueue()比kill()传递了更多的附加信息，但sigqueue()只能向一个进程发送信号，而不能发送信号给一个进程组。如果signo=0，将会执行错误检查，但实际上不发送任何信号，0值信号可用于检查pid的有效性以及当前进程是否有权限向目标进程发送信号。</strong></span></p><p style="font-family: arial, nsimsun, sans-serif; margin-top: 0px; margin-bottom: 0px; padding: 0.3em 5px 0.7em;"><span style="font-size:18px;"><strong>在调用sigqueue时，sigval_t指定的信息会拷贝到3参数信号处理函数（3参数信号处理函数指的是信号处理函数由sigaction安装，并设定了sa_sigaction指针，稍后将阐述）的siginfo_t结构中，这样信号处理函数就可以处理这些信息了。由于sigqueue系统调用支持发送带参数信号，所以比kill()系统调用的功能要灵活和强大得多。</strong></span></p><p style="font-family: arial, nsimsun, sans-serif; margin-top: 0px; margin-bottom: 0px; padding: 0.3em 5px 0.7em;"><span style="font-size:18px;"><strong>注：sigqueue（）发送非实时信号时，第三个参数包含的信息仍然能够传递给信号处理函数； sigqueue（）发送非实时信号时，仍然不支持排队，即在信号处理函数执行过程中到来的所有相同信号，都被合并为一个信号。</strong></span></p><span style="font-size:18px;"><strong><br /></strong></span><p><span style="font-family: Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif; line-height: 18px;"><span style="font-family: Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif; line-height: 18px;"><span style="font-family: Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif; line-height: 18px;"><span style="font-family: Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif; line-height: 18px;"><span style="font-family: Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif; line-height: 18px;"><span style="font-family: Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif; line-height: 18px;"><span style="font-family: Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif; line-height: 18px;"><span style="font-family: Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif; line-height: 18px;"><span style="font-family: Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif; line-height: 18px;"><span style="font-family: arial, nsimsun, sans-serif; background-color: rgb(255, 255, 0);"><strong><span style="font-size:24px;"><img alt="微笑" src="http://static.blog.csdn.net/xheditor/xheditor_emot/default/smile.gif" />四.信号集操作函数</span></strong></span></span></span></span></span></span></span></span></span></span></p><p><span style="font-family: Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif; line-height: 18px;"><span style="font-family: Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif; line-height: 18px;"><span style="font-family: Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif; line-height: 18px;"><span style="font-family: Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif; line-height: 18px;"><span style="font-family: Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif; line-height: 18px;"><span style="font-family: Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif; line-height: 18px;"><span style="font-family: Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif; line-height: 18px;"><span style="font-family: Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif; line-height: 18px;"><span style="font-family: Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif; line-height: 18px;"><span style="font-family: arial, nsimsun, sans-serif;"><span style="font-size:18px;"><strong><span style="font-family: arial, nsimsun, sans-serif;">信号集被定义为一种数据类型：</span><br /></strong></span></span></span></span></span></span></span></span></span></span></span></p><p><span style="font-family: Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif; line-height: 18px;"><span style="font-family: Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif; line-height: 18px;"><span style="font-family: Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif; line-height: 18px;"><span style="font-family: Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif; line-height: 18px;"><span style="font-family: Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif; line-height: 18px;"><span style="font-family: Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif; line-height: 18px;"><span style="font-family: Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif; line-height: 18px;"><span style="font-family: Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif; line-height: 18px;"><span style="font-family: Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif; line-height: 18px;"><span style="font-family: arial, nsimsun, sans-serif;"><span style="font-size:18px;"><span style="font-family: arial, nsimsun, sans-serif;"></span></span></span></span></span></span></span></span></span></span></span></span></p><pre name="code" class="cpp" style="font-weight: bold;">typedef struct {
			unsigned long sig[_NSIG_WORDS]；
			} sigset_t</pre><br /><span style="font-family: arial, nsimsun, sans-serif;"><strong>信号集用来描述信号的集合，linux所支持的所有信号可以全部或部分的出现在信号集中，主要与信号阻塞相关函数配合使用。下面是为信号集操作定义的相关函数：</strong></span><br /><p></p><p><span style="font-family: Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif; line-height: 18px;"><span style="font-family: Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif; line-height: 18px;"><span style="font-family: Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif; line-height: 18px;"><span style="font-family: Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif; line-height: 18px;"><span style="font-family: Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif; line-height: 18px;"><span style="font-family: Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif; line-height: 18px;"><span style="font-family: Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif; line-height: 18px;"><span style="font-family: Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif; line-height: 18px;"><span style="font-family: Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif; line-height: 18px;"><span style="font-family: arial, nsimsun, sans-serif;"><span style="font-size:18px;"><strong><span style="font-family: arial, nsimsun, sans-serif;"><span style="font-family: arial, nsimsun, sans-serif;"></span></span></strong></span></span></span></span></span></span></span></span></span></span></span></p><pre name="code" class="cpp">#include &lt;signal.h&gt;
int sigemptyset(sigset_t *set)；
int sigfillset(sigset_t *set)；
int sigaddset(sigset_t *set, int signum)
int sigdelset(sigset_t *set, int signum)；
int sigismember(const sigset_t *set, int signum)；
sigemptyset(sigset_t *set)初始化由set指定的信号集，信号集里面的所有信号被清空；
sigfillset(sigset_t *set)调用该函数后，set指向的信号集中将包含linux支持的64种信号；
sigaddset(sigset_t *set, int signum)在set指向的信号集中加入signum信号；
sigdelset(sigset_t *set, int signum)在set指向的信号集中删除signum信号；
sigismember(const sigset_t *set, int signum)判定信号signum是否在set指向的信号集中。</pre><br /><br /><p></p><p><span style="font-family: Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif; line-height: 18px;"><span style="font-family: Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif; line-height: 18px;"><span style="font-family: Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif; line-height: 18px;"><span style="font-family: Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif; line-height: 18px;"><span style="font-family: Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif; line-height: 18px;"><span style="font-family: Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif; line-height: 18px;"><span style="font-family: Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif; line-height: 18px;"><span style="font-family: Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif; line-height: 18px;"><span style="font-family: Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif; line-height: 18px;"><span style="font-family: arial, nsimsun, sans-serif;"><span style="font-family: arial, nsimsun, sans-serif;"><span style="font-family: arial, nsimsun, sans-serif;"><span style="font-size:24px;"><span style="background-color: rgb(255, 255, 0);"><img alt="微笑" src="http://static.blog.csdn.net/xheditor/xheditor_emot/default/smile.gif" />五.<a href="http://blog.chinaunix.net/uid-14198351-id-2827469.html" style="word-wrap: break-word; text-decoration: none; font-family: 微软雅黑, 黑体, Verdana;">子进程对信号的继承</a></span></span></span></span></span></span></span></span></span></span></span></span></span></span></p><p><span style="font-family: Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif; line-height: 18px;"><span style="font-family: Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif; line-height: 18px;"><span style="font-family: Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif; line-height: 18px;"><span style="font-family: Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif; line-height: 18px;"><span style="font-family: Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif; line-height: 18px;"><span style="font-family: Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif; line-height: 18px;"><span style="font-family: Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif; line-height: 18px;"><span style="font-family: Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif; line-height: 18px;"><span style="font-family: Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif; line-height: 18px;"><span style="font-family: arial, nsimsun, sans-serif;"><span style="font-size:18px;"><span style="font-family: arial, nsimsun, sans-serif;"></span></span></span></span></span></span></span></span></span></span></span></span></p><pre name="code" class="cpp" style="font-weight: bold;">#include &lt;signal.h&gt;
#include &lt;sys/types.h&gt;
#include &lt;unistd.h&gt;
void new_op(int,siginfo_t*,void*);
int main(int argc,char**argv)
{
   struct sigaction act;
    int sig;
    pid_t pid;        
    
    pid=getpid();
    sig=atoi(argv[1]);    
    
    sigemptyset(&amp;act.sa_mask);
    act.sa_sigaction=new_op;
    act.sa_flags=SA_SIGINFO;

    if(sigaction(sig,&amp;act,NULL)&lt;0)//安装信号
    {
        printf("install sigal error\n");
    }
    if(fork()==0)//创建子进程
    {
        union sigval sv;
        sv.sival_int = 66;
        printf("child pid is %d\n", getpid());
        while(1)
        {
        sleep(1);
        sigqueue(getpid(), sig, sv);//子进程向自己发信号
        }
    }
    while(1)
    {
        sleep(2);
        printf("wait for the signal\n");
    }

}
void new_op(int signum,siginfo_t *info,void *myact)//信号处理函数
{
    printf("pid is %d the int value is %d \n", getpid(), info-&gt;si_int);
} </pre><br /><span style="font-family: &#x5B8B;&#x4F53;, Arial; line-height: 26px;"><strong>输出：</strong></span><br /><p></p><p><span style="font-family: Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif; line-height: 18px;"><span style="font-family: Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif; line-height: 18px;"><span style="font-family: Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif; line-height: 18px;"><span style="font-family: Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif; line-height: 18px;"><span style="font-family: Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif; line-height: 18px;"><span style="font-family: Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif; line-height: 18px;"><span style="font-family: Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif; line-height: 18px;"><span style="font-family: Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif; line-height: 18px;"><span style="font-family: Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif; line-height: 18px;"><span style="font-family: arial, nsimsun, sans-serif;"><span style="font-size:18px;"><span style="font-family: arial, nsimsun, sans-serif;"><span style="font-family: 宋体, Arial; line-height: 26px;"></span></span></span></span></span></span></span></span></span></span></span></span></span></p><pre name="code" class="cpp" style="color: rgb(102, 102, 102); font-weight: bold;">child pid is 21309
pid is 21309 the int value is 66
wait for the signal
pid is 21309 the int value is 66
pid is 21309 the int value is 66
wait for the signal
pid is 21309 the int value is 66
pid is 21309 the int value is 66
wait for the signal
pid is 21309 the int value is 66
pid is 21309 the int value is 66
信号处理函数中打印的进程号和子进程是一致的，子进程继承了父进程对信号的处理。
</pre><br /><p></p><p style="color: rgb(102, 102, 102); font-weight: bold; font-family: arial, nsimsun, sans-serif; margin-top: 0px; margin-bottom: 0px; padding: 0.3em 5px 0.7em; font-size: 0.76em;"><a name="N10146" id="N10146"><span class="smalltitle" style="font-size: 1.2em; font-weight: bold;">sigwait</span></a></p><p style="font-family: arial, nsimsun, sans-serif; margin-top: 0px; margin-bottom: 0px; padding: 0.3em 5px 0.7em;"><strong><code>sigwait()</code> 提供了一种等待信号的到来，以串行的方式从信号队列中取出信号进行处理的机制。<code>sigwait（</code>）只等待函数参数中指定的信号集，即如果新产生的信号不在指定的信号集内，则<code> sigwait（）</code>继续等待。对于一个稳定可靠的程序，我们一般会有一些疑问：</strong></p><ul style="margin-top: 0px; margin-bottom: 0px; padding-top: 0px; padding-right: 5px; padding-bottom: 5px; font-family: Simsun;"><li style="font-family: arial, nsimsun, sans-serif; margin-top: 0px; margin-bottom: 0px; padding-top: 0px; padding-right: 5px; padding-bottom: 3px;"><strong>多个相同的信号可不可以在信号队列中排队？</strong></li></ul><ul style="margin-top: 0px; margin-bottom: 0px; padding-top: 0px; padding-right: 5px; padding-bottom: 5px; font-family: Simsun;"><li style="font-family: arial, nsimsun, sans-serif; margin-top: 0px; margin-bottom: 0px; padding-top: 0px; padding-right: 5px; padding-bottom: 3px;"><strong>如果信号队列中有多个信号在等待，在信号处理时有没有优先级规则？</strong></li><li style="font-family: arial, nsimsun, sans-serif; margin-top: 0px; margin-bottom: 0px; padding-top: 0px; padding-right: 5px; padding-bottom: 3px;"><strong>实时信号和非实时信号在处理时有没有什么区别？</strong></li></ul><strong>实例程序：</strong><p><span style="font-family: Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif; line-height: 18px;"><span style="font-family: Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif; line-height: 18px;"><span style="font-family: Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif; line-height: 18px;"><span style="font-family: Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif; line-height: 18px;"><span style="font-family: Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif; line-height: 18px;"><span style="font-family: Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif; line-height: 18px;"><span style="font-family: Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif; line-height: 18px;"><span style="font-family: Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif; line-height: 18px;"><span style="font-family: Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif; line-height: 18px;"><span style="font-family: arial, nsimsun, sans-serif;"><span style="font-size:18px;"><span style="font-family: arial, nsimsun, sans-serif;"><span style="font-family: 宋体, Arial; line-height: 26px;"></span></span></span></span></span></span></span></span></span></span></span></span></span></p><pre name="code" class="cpp" style="color: rgb(102, 102, 102); font-weight: bold;">#include &lt;signal.h&gt;
#include &lt;errno.h&gt;
#include &lt;pthread.h&gt;
#include &lt;unistd.h&gt;
#include &lt;sys/types.h&gt;

void sig_handler(int signum)
{
    printf("Receive signal. %d\n", signum);
}

void* sigmgr_thread()
{
    sigset_t   waitset, oset;
    int        sig;
    int        rc;
    pthread_t  ppid = pthread_self();

    pthread_detach(ppid);

    sigemptyset(&amp;waitset);
    sigaddset(&amp;waitset, SIGRTMIN);
    sigaddset(&amp;waitset, SIGRTMIN+2);
    sigaddset(&amp;waitset, SIGRTMAX);
    sigaddset(&amp;waitset, SIGUSR1);
    sigaddset(&amp;waitset, SIGUSR2);

    while (1)  {
        rc = sigwait(&amp;waitset, &amp;sig);
        if (rc != -1) {
            sig_handler(sig);
        } else {
            printf("sigwaitinfo() returned err: %d; %s\n", errno, strerror(errno));
        }
    }
}


int main()
{
    sigset_t bset, oset;
    int             i;
    pid_t           pid = getpid();
    pthread_t       ppid;

    sigemptyset(&amp;bset);
    sigaddset(&amp;bset, SIGRTMIN);
    sigaddset(&amp;bset, SIGRTMIN+2);
    sigaddset(&amp;bset, SIGRTMAX);
    sigaddset(&amp;bset, SIGUSR1);
    sigaddset(&amp;bset, SIGUSR2);

    if (pthread_sigmask(SIG_BLOCK, &amp;bset, &amp;oset) != 0)
        printf("!! Set pthread mask failed\n");

    kill(pid, SIGRTMAX);
    kill(pid, SIGRTMAX);
    kill(pid, SIGRTMIN+2);
    kill(pid, SIGRTMIN);
    kill(pid, SIGRTMIN+2);
    kill(pid, SIGRTMIN);
    kill(pid, SIGUSR2);
    kill(pid, SIGUSR2);
    kill(pid, SIGUSR1);
kill(pid, SIGUSR1);

    // Create the dedicated thread sigmgr_thread() which will handle signals synchronously
    pthread_create(&amp;ppid, NULL, sigmgr_thread, NULL);

    sleep(10);

    exit (0);
}</pre><br /><p></p><p style="font-family: arial, nsimsun, sans-serif; margin-top: 0px; margin-bottom: 0px; padding: 0.3em 5px 0.7em;">程序编译运行在 Ubuntu 的结果如下：</p><br style="font-family: Simsun;font-size:14px;" /><a name="N1017B" style="color: rgb(102, 102, 102); font-weight: bold; font-family: Simsun;font-size:14px;" id="N1017B"><span style="font-size: 0.76em; padding: 0.3em 5px 0.7em; font-family: arial, sans-serif;">图 1. sigwait 测试程序执行结果</span></a><br style="font-family: Simsun;font-size:14px;" /><span style="color: rgb(102, 102, 102); padding-top: 0.3em; padding-bottom: 0.7em;"><strong><img alt="sigwait 测试程序执行结果" height="159" src="http://www.ibm.com/developerworks/cn/linux/l-cn-signalsec/images/image001.jpg" width="580" style="border: 0px; padding: 0.3em 5px 0.7em; font-family: Simsun;font-size:14px;" /></strong></span><span style="color: rgb(102, 102, 102);  font-family: Simsun;font-size:14px;"><strong> </strong></span><br style="font-family: Simsun;font-size:14px;" /><p style="font-family: arial, nsimsun, sans-serif; margin-top: 0px; margin-bottom: 0px; padding: 0.3em 5px 0.7em;"><strong>从以上测试程序发现以下规则：</strong></p><ul style="margin-top: 0px; margin-bottom: 0px; padding-top: 0px; padding-right: 5px; padding-bottom: 5px; font-family: Simsun;"><li style="font-family: arial, nsimsun, sans-serif; margin-top: 0px; margin-bottom: 0px; padding-top: 0px; padding-right: 5px; padding-bottom: 3px;"><strong>对于非实时信号，相同信号不能在信号队列中排队；对于实时信号，相同信号可以在信号队列中排队。</strong></li></ul><ul style="margin-top: 0px; margin-bottom: 0px; padding-top: 0px; padding-right: 5px; padding-bottom: 5px; font-family: Simsun;"><li style="font-family: arial, nsimsun, sans-serif; margin-top: 0px; margin-bottom: 0px; padding-top: 0px; padding-right: 5px; padding-bottom: 3px;"><strong>如果信号队列中有多个实时以及非实时信号排队，实时信号并不会先于非实时信号被取出，信号数字小的会先被取出：如 SIGUSR1（10）会先于 SIGUSR2 (12)，SIGRTMIN（34）会先于 SIGRTMAX (64)， 非实时信号因为其信号数字小而先于实时信号被取出。</strong></li></ul><br /><p><span style="font-family: Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif; line-height: 18px;"><span style="font-family: Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif; line-height: 18px;"><span style="font-family: Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif; line-height: 18px;"><span style="font-family: Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif; line-height: 18px;"><span style="font-family: Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif; line-height: 18px;"><span style="font-family: Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif; line-height: 18px;"><span style="font-family: Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif; line-height: 18px;"><span style="font-family: Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif; line-height: 18px;"><span style="font-family: Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif; line-height: 18px;"><span style="font-family: arial, nsimsun, sans-serif;"><span style="font-family: arial, nsimsun, sans-serif;"><span style="font-family: 宋体, Arial; line-height: 26px; background-color: rgb(255, 255, 0);"><span style="font-size:24px;"><strong><img alt="微笑" src="http://static.blog.csdn.net/xheditor/xheditor_emot/default/smile.gif" />六.信号未决与信号阻塞</strong></span></span></span></span></span></span></span></span></span></span></span></span></span></p><p><span style="font-family: Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif; line-height: 18px;"><span style="font-family: Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif; line-height: 18px;"><span style="font-family: Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif; line-height: 18px;"><span style="font-family: Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif; line-height: 18px;"><span style="font-family: Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif; line-height: 18px;"><span style="font-family: Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif; line-height: 18px;"><span style="font-family: Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif; line-height: 18px;"><span style="font-family: Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif; line-height: 18px;"><span style="font-family: Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif; line-height: 18px;"><span style="font-family: arial, nsimsun, sans-serif;"><span style="font-size:18px;"><span style="font-family: arial, nsimsun, sans-serif;"><span style="font-family: 宋体, Arial; line-height: 26px;"><span style="font-family: arial, nsimsun, sans-serif;"><strong>每个进程都有一个用来描述哪些信号递送到进程时将被阻塞的信号集，该信号集中的所有信号在递送到进程后都将被阻塞。下面是与信号阻塞相关的几个函数：</strong></span><br /></span></span></span></span></span></span></span></span></span></span></span></span></span></p><p><span style="font-family: Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif; line-height: 18px;"><span style="font-family: Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif; line-height: 18px;"><span style="font-family: Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif; line-height: 18px;"><span style="font-family: Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif; line-height: 18px;"><span style="font-family: Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif; line-height: 18px;"><span style="font-family: Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif; line-height: 18px;"><span style="font-family: Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif; line-height: 18px;"><span style="font-family: Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif; line-height: 18px;"><span style="font-family: Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif; line-height: 18px;"><span style="font-family: arial, nsimsun, sans-serif;"><span style="font-size:18px;"><span style="font-family: arial, nsimsun, sans-serif;"><span style="font-family: 宋体, Arial; line-height: 26px;"><span style="font-family: arial, nsimsun, sans-serif;"></span></span></span></span></span></span></span></span></span></span></span></span></span></span></p><pre name="code" class="cpp" style="color: rgb(102, 102, 102); font-weight: bold;">#include &lt;signal.h&gt;
int  sigprocmask(int  how,  const  sigset_t *set, sigset_t *oldset))；
int sigpending(sigset_t *set));
int sigsuspend(const sigset_t *mask))；</pre><br /><p></p><p style="font-family: arial, nsimsun, sans-serif; margin-top: 0px; margin-bottom: 0px; padding: 0.3em 5px 0.7em;"><strong>sigprocmask()函数能够根据参数how来实现对信号集的操作，操作主要有三种：</strong></p><table border="0" class="ibm-data-table  " width="70%" style="border-width: 0px 1px 1px; border-right-style: solid; border-bottom-style: solid; border-left-style: solid; border-right-color: rgb(204, 204, 204); border-bottom-color: rgb(204, 204, 204); border-left-color: rgb(204, 204, 204); width: 708px; font-family: Simsun;"><tbody><tr><td style="font-family: arial, nsimsun, sans-serif; border-top-color: rgb(204, 204, 204); border-top-style: solid; border-top-width: 1px; padding: 8px 5px; vertical-align: top;"><span style="font-size:18px;"><strong>参数how</strong></span></td><td style="font-family: arial, nsimsun, sans-serif; border-top-color: rgb(204, 204, 204); border-top-style: solid; border-top-width: 1px; padding: 8px 5px; vertical-align: top;"><span style="font-size:18px;"><strong>进程当前信号集</strong></span></td></tr><tr><td style="font-family: arial, nsimsun, sans-serif; border-top-color: rgb(204, 204, 204); border-top-style: solid; border-top-width: 1px; padding: 8px 5px; vertical-align: top;"><span style="font-size:18px;"><strong>SIG_BLOCK</strong></span></td><td style="font-family: arial, nsimsun, sans-serif; border-top-color: rgb(204, 204, 204); border-top-style: solid; border-top-width: 1px; padding: 8px 5px; vertical-align: top;"><span style="font-size:18px;"><strong>在进程当前阻塞信号集中添加set指向信号集中的信号</strong></span></td></tr><tr><td style="font-family: arial, nsimsun, sans-serif; border-top-color: rgb(204, 204, 204); border-top-style: solid; border-top-width: 1px; padding: 8px 5px; vertical-align: top;"><span style="font-size:18px;"><strong>SIG_UNBLOCK</strong></span></td><td style="font-family: arial, nsimsun, sans-serif; border-top-color: rgb(204, 204, 204); border-top-style: solid; border-top-width: 1px; padding: 8px 5px; vertical-align: top;"><span style="font-size:18px;"><strong>如果进程阻塞信号集中包含set指向信号集中的信号，则解除对该信号的阻塞</strong></span></td></tr><tr><td style="font-family: arial, nsimsun, sans-serif; border-top-color: rgb(204, 204, 204); border-top-style: solid; border-top-width: 1px; padding: 8px 5px; vertical-align: top;"><span style="font-size:18px;"><strong>SIG_SETMASK</strong></span></td><td style="font-family: arial, nsimsun, sans-serif; border-top-color: rgb(204, 204, 204); border-top-style: solid; border-top-width: 1px; padding: 8px 5px; vertical-align: top;"><span style="font-size:18px;"><strong>更新进程阻塞信号集为set指向的信号集</strong></span></td></tr></tbody></table><p style="font-family: arial, nsimsun, sans-serif; margin-top: 0px; margin-bottom: 0px; padding: 0.3em 5px 0.7em;"><strong>sigpending(sigset_t *set))获得当前已递送到进程，却被阻塞的所有信号，在set指向的信号集中返回结果。</strong></p><p style="font-family: arial, nsimsun, sans-serif; margin-top: 0px; margin-bottom: 0px; padding: 0.3em 5px 0.7em;"><strong>sigsuspend(const sigset_t *mask))用于在接收到某个信号之前, 临时用mask替换进程的信号掩码, 并暂停进程执行，直到收到信号为止。sigsuspend 返回后将恢复调用之前的信号掩码。信号处理函数完成后，进程将继续执行。该系统调用始终返回-1，并将errno设置为EINTR。</strong></p><br /><p><span style="font-family: Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif; line-height: 18px;"><span style="font-family: Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif; line-height: 18px;"><span style="font-family: Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif; line-height: 18px;"><span style="font-family: Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif; line-height: 18px;"><span style="font-family: Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif; line-height: 18px;"><span style="font-family: Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif; line-height: 18px;"><span style="font-family: Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif; line-height: 18px;"><span style="font-family: Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif; line-height: 18px;"><span style="font-family: Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif; line-height: 18px;"><span style="font-family: arial, nsimsun, sans-serif;"><span style="font-family: arial, nsimsun, sans-serif;"><span style="font-family: 宋体, Arial; line-height: 26px;"><span style="font-family: arial, nsimsun, sans-serif; background-color: rgb(255, 255, 0);"><span style="font-size:24px;"><strong><img alt="微笑" src="http://static.blog.csdn.net/xheditor/xheditor_emot/default/smile.gif" />七.信号使用实例</strong></span></span></span></span></span></span></span></span></span></span></span></span></span></span></p><p><span style="font-family: Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif; line-height: 18px;"><span style="font-family: Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif; line-height: 18px;"><span style="font-family: Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif; line-height: 18px;"><span style="font-family: Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif; line-height: 18px;"><span style="font-family: Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif; line-height: 18px;"><span style="font-family: Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif; line-height: 18px;"><span style="font-family: Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif; line-height: 18px;"><span style="font-family: Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif; line-height: 18px;"><span style="font-family: Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif; line-height: 18px;"><span style="font-family: arial, nsimsun, sans-serif;"><span style="font-size:18px;"><span style="font-family: arial, nsimsun, sans-serif;"><span style="font-family: 宋体, Arial; line-height: 26px;"><span style="font-family: arial, nsimsun, sans-serif;"><strong><span style="font-family: arial, nsimsun, sans-serif;">实例一：信号发送及处理</span><span style="font-family: arial, nsimsun, sans-serif;"> </span><br style="font-family: arial, nsimsun, sans-serif;" /><span style="font-family: arial, nsimsun, sans-serif;">实现一个信号接收程序sigreceive（其中信号安装由sigaction（））。</span></strong><br /></span></span></span></span></span></span></span></span></span></span></span></span></span></span></p><p><span style="font-family: Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif; line-height: 18px;"><span style="font-family: Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif; line-height: 18px;"><span style="font-family: Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif; line-height: 18px;"><span style="font-family: Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif; line-height: 18px;"><span style="font-family: Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif; line-height: 18px;"><span style="font-family: Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif; line-height: 18px;"><span style="font-family: Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif; line-height: 18px;"><span style="font-family: Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif; line-height: 18px;"><span style="font-family: Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif; line-height: 18px;"><span style="font-family: arial, nsimsun, sans-serif;"><span style="font-size:18px;"><span style="font-family: arial, nsimsun, sans-serif;"><span style="font-family: 宋体, Arial; line-height: 26px;"><span style="font-family: arial, nsimsun, sans-serif;"><span style="font-family: arial, nsimsun, sans-serif;"></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></p><pre name="code" class="cpp" style="color: rgb(102, 102, 102); font-weight: bold;">#include &lt;signal.h&gt;
#include &lt;sys/types.h&gt;
#include &lt;unistd.h&gt;
void new_op(int,siginfo_t*,void*);
int main(int argc,char**argv)
{
	struct sigaction act;	
	int sig;
	sig=atoi(argv[1]);
	
	sigemptyset(&amp;act.sa_mask);
	act.sa_flags=SA_SIGINFO;
	act.sa_sigaction=new_op;
	
	if(sigaction(sig,&amp;act,NULL) &lt; 0)
	{
		printf("install sigal error\n");
	}
	
	while(1)
	{
		sleep(2);
		printf("wait for the signal\n");
	}
}
void new_op(int signum,siginfo_t *info,void *myact)
{
	printf("receive signal %d", signum);
	sleep(5);
}</pre><br /><strong><span style="font-family: arial, nsimsun, sans-serif;">说明，命令行参数为信号值，后台运行sigreceive signo &amp;，可获得该进程的ID，假设为pid，然后再另一终端上运行kill -s signo pid验证信号的发送接收及处理。同时，可验证信号的排队问题。 </span><br style="font-family: arial, nsimsun, sans-serif;" /><span style="font-family: arial, nsimsun, sans-serif;">注：</span><span style="font-family: arial, nsimsun, sans-serif;">可以用sigqueue实现一个命令行信号发送程序sigqueuesend</span><br /></strong><p></p><p><span style="font-family: Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif; line-height: 18px;"><span style="font-family: Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif; line-height: 18px;"><span style="font-family: Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif; line-height: 18px;"><span style="font-family: Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif; line-height: 18px;"><span style="font-family: Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif; line-height: 18px;"><span style="font-family: Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif; line-height: 18px;"><span style="font-family: Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif; line-height: 18px;"><span style="font-family: Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif; line-height: 18px;"><span style="font-family: Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif; line-height: 18px;"><span style="font-family: arial, nsimsun, sans-serif;"><span style="font-size:18px;"><span style="font-family: arial, nsimsun, sans-serif;"><span style="font-family: 宋体, Arial; line-height: 26px;"><span style="font-family: arial, nsimsun, sans-serif;"><span style="font-family: arial, nsimsun, sans-serif;"><span style="font-family: arial, nsimsun, sans-serif;"><strong><br /></strong></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></p><p><span style="font-family: Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif; line-height: 18px;"><span style="font-family: Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif; line-height: 18px;"><span style="font-family: Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif; line-height: 18px;"><span style="font-family: Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif; line-height: 18px;"><span style="font-family: Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif; line-height: 18px;"><span style="font-family: Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif; line-height: 18px;"><span style="font-family: Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif; line-height: 18px;"><span style="font-family: Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif; line-height: 18px;"><span style="font-family: Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif; line-height: 18px;"><span style="font-family: arial, nsimsun, sans-serif;"><span style="font-size:18px;"><span style="font-family: arial, nsimsun, sans-serif;"><span style="font-family: 宋体, Arial; line-height: 26px;"><span style="font-family: arial, nsimsun, sans-serif;"><span style="font-family: arial, nsimsun, sans-serif;"><span style="font-family: arial, nsimsun, sans-serif;"></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></p><p style="font-family: arial, nsimsun, sans-serif; margin-top: 0px; margin-bottom: 0px; padding: 0.3em 5px 0.7em;"><strong>实例二：信号传递附加信息 <br />主要包括两个实例：</strong></p><ol style="margin-top: 0px; margin-bottom: 0px; padding-top: 0px; padding-right: 5px; padding-bottom: 5px; font-family: Simsun;"><li style="font-family: arial, nsimsun, sans-serif; margin-top: 0px; margin-bottom: 0px; padding-top: 5px; padding-right: 5px; padding-bottom: 3px;"><strong>向进程本身发送信号，并传递指针参数；</strong></li></ol><pre name="code" class="cpp" style="color: rgb(102, 102, 102); font-weight: bold;">#include &lt;signal.h&gt;
#include &lt;sys/types.h&gt;
#include &lt;unistd.h&gt;
void new_op(int,siginfo_t*,void*);
int main(int argc,char**argv)
{
	struct sigaction act;	
	union sigval mysigval;
	int i;
	int sig;
	pid_t pid;		
	char data[10];
	memset(data,0,sizeof(data));
	for(i=0;i &lt; 5;i++)
		data[i]='2';
	mysigval.sival_ptr=data;
	
	sig=atoi(argv[1]);
	pid=getpid();
	
	sigemptyset(&amp;act.sa_mask);
	act.sa_sigaction=new_op;//三参数信号处理函数
	act.sa_flags=SA_SIGINFO;//信息传递开关
	if(sigaction(sig,&amp;act,NULL) &lt; 0)
	{
		printf("install sigal error\n");
	}
	while(1)
	{
		sleep(2);
		printf("wait for the signal\n");
		sigqueue(pid,sig,mysigval);//向本进程发送信号，并传递附加信息
	}
}
void new_op(int signum,siginfo_t *info,void *myact)//三参数信号处理函数的实现
{
	int i;
	for(i=0;i&lt;10;i++)
	{
		printf("%c\n ",(*( (char*)((*info).si_ptr)+i)));
	}
	printf("handle signal %d over;",signum);
}</pre><br /><ol style="margin-top: 0px; margin-bottom: 0px; padding-top: 0px; padding-right: 5px; padding-bottom: 5px; font-family: Simsun;"><li style="font-family: arial, nsimsun, sans-serif; margin-top: 0px; margin-bottom: 0px; padding-top: 5px; padding-right: 5px; padding-bottom: 3px;"><p style="margin-top: 0px; margin-bottom: 0px; padding-top: 0.3em; padding-right: 5px; padding-bottom: 0px;"><strong>这个例子中，信号实现了附加信息的传递，信号究竟如何对这些信息进行处理则取决于具体的应用。</strong></p></li><li style="font-family: arial, nsimsun, sans-serif; margin-top: 0px; margin-bottom: 0px; padding-top: 5px; padding-right: 5px; padding-bottom: 3px;"><strong>2、	不同进程间传递整型参数：把1中的信号发送和接收放在两个程序中，并且在发送过程中传递整型参数。 <br />信号接收程序：</strong></li></ol><pre name="code" class="cpp" style="color: rgb(102, 102, 102); font-weight: bold;">#include &lt;signal.h&gt;
#include &lt;sys/types.h&gt;
#include &lt;unistd.h&gt;
void new_op(int,siginfo_t*,void*);
int main(int argc,char**argv)
{
	struct sigaction act;
	int sig;
	pid_t pid;		
	
	pid=getpid();
	sig=atoi(argv[1]);	
	
	sigemptyset(&amp;act.sa_mask);
	act.sa_sigaction=new_op;
	act.sa_flags=SA_SIGINFO;
	if(sigaction(sig,&amp;act,NULL)&lt;0)
	{
		printf("install sigal error\n");
	}
	while(1)
	{
		sleep(2);
		printf("wait for the signal\n");
	}
}
void new_op(int signum,siginfo_t *info,void *myact)
{
	printf("the int value is %d \n",info-&gt;si_int);
}</pre><br /><strong><span style="font-family: arial, nsimsun, sans-serif;">信号发送程序：命令行第二个参数为信号值，第三个参数为接收进程ID。</span><br /></strong><p><span style="font-family: Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif; line-height: 18px;"><span style="font-family: Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif; line-height: 18px;"><span style="font-family: Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif; line-height: 18px;"><span style="font-family: Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif; line-height: 18px;"><span style="font-family: Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif; line-height: 18px;"><span style="font-family: Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif; line-height: 18px;"><span style="font-family: Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif; line-height: 18px;"><span style="font-family: Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif; line-height: 18px;"><span style="font-family: Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif; line-height: 18px;"><span style="font-family: arial, nsimsun, sans-serif;"><span style="font-size:18px;"><span style="font-family: arial, nsimsun, sans-serif;"><span style="font-family: 宋体, Arial; line-height: 26px;"><span style="font-family: arial, nsimsun, sans-serif;"><span style="font-family: arial, nsimsun, sans-serif;"><span style="font-family: arial, nsimsun, sans-serif;"><span style="font-family: arial, nsimsun, sans-serif;"></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></p><pre name="code" class="cpp">#include &lt;signal.h&gt;
#include &lt;sys/time.h&gt;
#include &lt;unistd.h&gt;
#include &lt;sys/types.h&gt;
main(int argc,char**argv)
{
	pid_t pid;
	int signum;
	union sigval mysigval;
	signum=atoi(argv[1]);
	pid=(pid_t)atoi(argv[2]);
	mysigval.sival_int=8;//不代表具体含义，只用于说明问题
	if(sigqueue(pid,signum,mysigval)==-1)
		printf("send error\n");
	sleep(2);
}</pre><br /><strong><span style="font-family: arial, nsimsun, sans-serif;">注：</span><span style="font-family: arial, nsimsun, sans-serif;">实例2的两个例子侧重点在于用信号来传递信息</span><br /></strong><p></p><p><span style="font-family: Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif; line-height: 18px;"><span style="font-family: Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif; line-height: 18px;"><span style="font-family: Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif; line-height: 18px;"><span style="font-family: Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif; line-height: 18px;"><span style="font-family: Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif; line-height: 18px;"><span style="font-family: Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif; line-height: 18px;"><span style="font-family: Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif; line-height: 18px;"><span style="font-family: Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif; line-height: 18px;"><span style="font-family: Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif; line-height: 18px;"><span style="font-family: arial, nsimsun, sans-serif;"><span style="font-size:18px;"><span style="font-family: arial, nsimsun, sans-serif;"><span style="font-family: 宋体, Arial; line-height: 26px;"><span style="font-family: arial, nsimsun, sans-serif;"><span style="font-family: arial, nsimsun, sans-serif;"><span style="font-family: arial, nsimsun, sans-serif;"><span style="font-family: arial, nsimsun, sans-serif;"><span style="font-family: arial, nsimsun, sans-serif;"><strong><br /></strong></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></p><p><span style="font-family: Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif; line-height: 18px;"><span style="font-family: Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif; line-height: 18px;"><span style="font-family: Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif; line-height: 18px;"><span style="font-family: Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif; line-height: 18px;"><span style="font-family: Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif; line-height: 18px;"><span style="font-family: Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif; line-height: 18px;"><span style="font-family: Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif; line-height: 18px;"><span style="font-family: Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif; line-height: 18px;"><span style="font-family: Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif; line-height: 18px;"><span style="font-family: arial, nsimsun, sans-serif;"><span style="font-size:18px;"><span style="font-family: arial, nsimsun, sans-serif;"><span style="font-family: 宋体, Arial; line-height: 26px;"><span style="font-family: arial, nsimsun, sans-serif;"><span style="font-family: arial, nsimsun, sans-serif;"><span style="font-family: arial, nsimsun, sans-serif;"><span style="font-family: arial, nsimsun, sans-serif;"><span style="font-family: arial, nsimsun, sans-serif;"><span style="font-family: arial, nsimsun, sans-serif;"><strong>实例三：信号阻塞及信号集操作</strong></span><br /></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></p><p><span style="font-family: Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif; line-height: 18px;"><span style="font-family: Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif; line-height: 18px;"><span style="font-family: Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif; line-height: 18px;"><span style="font-family: Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif; line-height: 18px;"><span style="font-family: Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif; line-height: 18px;"><span style="font-family: Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif; line-height: 18px;"><span style="font-family: Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif; line-height: 18px;"><span style="font-family: Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif; line-height: 18px;"><span style="font-family: Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif; line-height: 18px;"><span style="font-family: arial, nsimsun, sans-serif;"><span style="font-size:18px;"><span style="font-family: arial, nsimsun, sans-serif;"><span style="font-family: 宋体, Arial; line-height: 26px;"><span style="font-family: arial, nsimsun, sans-serif;"><span style="font-family: arial, nsimsun, sans-serif;"><span style="font-family: arial, nsimsun, sans-serif;"><span style="font-family: arial, nsimsun, sans-serif;"><span style="font-family: arial, nsimsun, sans-serif;"><span style="font-family: arial, nsimsun, sans-serif;"></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></p><pre name="code" class="cpp" style="color: rgb(102, 102, 102); font-weight: bold;">#include "signal.h"
#include "unistd.h"
static void my_op(int);
main()
{
	sigset_t new_mask,old_mask,pending_mask;
	struct sigaction act;
	sigemptyset(&amp;act.sa_mask);
	act.sa_flags=SA_SIGINFO;
	act.sa_sigaction=(void*)my_op;
	if(sigaction(SIGRTMIN+10,&amp;act,NULL))
		printf("install signal SIGRTMIN+10 error\n");
	sigemptyset(&amp;new_mask);
	sigaddset(&amp;new_mask,SIGRTMIN+10);
	if(sigprocmask(SIG_BLOCK, &amp;new_mask,&amp;old_mask))
		printf("block signal SIGRTMIN+10 error\n");
	sleep(10);	
	printf("now begin to get pending mask and unblock SIGRTMIN+10\n");
	if(sigpending(&amp;pending_mask)&lt;0)
		printf("get pending mask error\n");
	if(sigismember(&amp;pending_mask,SIGRTMIN+10))
		printf("signal SIGRTMIN+10 is pending\n");
	if(sigprocmask(SIG_SETMASK,&amp;old_mask,NULL)&lt;0)
		printf("unblock signal error\n");
	printf("signal unblocked\n");
	sleep(10);
}
static void my_op(int signum)
{
	printf("receive signal %d \n",signum);
}</pre><br /><p></p><p style="font-family: arial, nsimsun, sans-serif; margin-top: 0px; margin-bottom: 0px; padding: 0.3em 5px 0.7em;"><strong>编译该程序，并以后台方式运行。在另一终端向该进程发送信号(运行kill -s 42 pid，SIGRTMIN+10为42)，查看结果可以看出几个关键函数的运行机制，信号集相关操作比较简单。</strong></p><p style="font-family: arial, nsimsun, sans-serif; margin-top: 0px; margin-bottom: 0px; padding: 0.3em 5px 0.7em;"><strong>注：在上面几个实例中，使用了printf()函数，只是作为诊断工具，pringf()函数是不可重入的，不应在信号处理函数中使用。</strong></p><div class="ibm-alternate-rule" style="clear: both; background-image: url(http://1.www.s81c.com/i/solid.gif); height: 1px; font-family: Simsun;"></div><strong><br /></strong><p><span style="font-family: Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif; line-height: 18px;"><span style="font-family: Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif; line-height: 18px;"><span style="font-family: Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif; line-height: 18px;"><span style="font-family: Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif; line-height: 18px;"><span style="font-family: Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif; line-height: 18px;"><span style="font-family: Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif; line-height: 18px;"><span style="font-family: Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif; line-height: 18px;"><span style="font-family: Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif; line-height: 18px;"><span style="font-family: Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif; line-height: 18px;"><span style="font-family: arial, nsimsun, sans-serif;"><span style="font-size:18px;"><span style="font-family: arial, nsimsun, sans-serif;"><span style="font-family: 宋体, Arial; line-height: 26px;"><span style="font-family: arial, nsimsun, sans-serif;"><span style="font-family: arial, nsimsun, sans-serif;"><span style="font-family: arial, nsimsun, sans-serif;"><span style="font-family: arial, nsimsun, sans-serif;"><span style="font-family: arial, nsimsun, sans-serif;"><span style="font-family: arial, nsimsun, sans-serif;"><span style="font-family: arial, nsimsun, sans-serif;"><strong>用sigqueue实现的命令行信号发送程序sigqueuesend，命令行第二个参数是发送的信号值，第三个参数是接收该信号的进程ID，可以配合实例一使用：</strong></span><br /></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></p><p><span style="font-family: Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif; line-height: 18px;"><span style="font-family: Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif; line-height: 18px;"><span style="font-family: Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif; line-height: 18px;"><span style="font-family: Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif; line-height: 18px;"><span style="font-family: Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif; line-height: 18px;"><span style="font-family: Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif; line-height: 18px;"><span style="font-family: Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif; line-height: 18px;"><span style="font-family: Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif; line-height: 18px;"><span style="font-family: Verdana, 'Lucida Grande', Arial, Helvetica, sans-serif; line-height: 18px;"><span style="font-family: arial, nsimsun, sans-serif;"><span style="font-size:18px;"><span style="font-weight: bold;"><span style="font-family: arial, nsimsun, sans-serif;"><span style="color: rgb(102, 102, 102); font-family: 宋体, Arial; line-height: 26px;"><span style="font-family: arial, nsimsun, sans-serif;"><span style="font-family: arial, nsimsun, sans-serif;"><span style="font-family: arial, nsimsun, sans-serif;"><span style="font-family: arial, nsimsun, sans-serif;"><span style="font-family: arial, nsimsun, sans-serif;"><span style="font-family: arial, nsimsun, sans-serif;"><span style="font-family: arial, nsimsun, sans-serif;"></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></p><pre name="code" class="cpp">#include &lt;signal.h&gt;
#include &lt;sys/types.h&gt;
#include &lt;unistd.h&gt;
int main(int argc,char**argv)
{
	pid_t pid;
	int sig;
	sig=atoi(argv[1]);
	pid=atoi(argv[2]);
	sigqueue(pid,sig,NULL);
	sleep(2);
}</pre><br /><br /><p></p>   &#13;
