

<p><img src="https://mmbiz.qlogo.cn/mmbiz/iaHL5mQLicPYMJ2wm96MIiaianoqxrGB0wQ1U9P1MFia2sNMbdXTicBIaUgBpe3Yc835CuyJ64D56KIyYQyibibwnWbtMQ/0?wx_fmt=jpeg" alt="" /><br />&#13;
</p>&#13;
<p style="white-space:normal"><span style="font-size:18px; color:#ff00; padding:0px; margin:0px"><strong style="padding:0px; margin:0px"></strong></span></p>&#13;
<hr style="white-space:normal" />&#13;
<p style="white-space:normal"><span style="font-size:18px; color:#ff00; padding:0px; margin:0px"><strong style="padding:0px; margin:0px"></strong></span></p>&#13;
<h2 style=""><strong><span style="font-size:18px">内容简介</span></strong></h2>&#13;
<p style="white-space:normal"><strong><span style="color:#ff00">1</span><span style="font-size:18px; color:#ff00; padding:0px; margin:0px">、</span><span style="padding:0px; margin:0px; color:rgb(255,0,0); font-size:18px"><span style="padding:0px; margin:0px"><span style="padding:0px; margin:0px"><span style="padding:0px; margin:0px"><span style="padding:0px; margin:0px"><span style="padding:0px; margin:0px"><span style="padding:0px; margin:0px"><span style="padding:0px; margin:0px"><span style="padding:0px; margin:0px">第四部分第二课：SSH连接，安全快捷<strong style="white-space:normal"><span style="font-size:18px; color:#ff00; padding:0px; margin:0px"><span style="padding:0px; margin:0px"></span></span></strong></span></span></span></span></span></span></span></span></span></strong></p>&#13;
<p style="white-space:normal"><strong><span style="font-size:18px; color:#ff00; padding:0px; margin:0px">2、<strong><span style="padding:0px; margin:0px">第四部分第三课：文件传输，潇洒同步</span></strong></span></strong></p>&#13;
<p style="white-space:normal"><br />&#13;
</p>&#13;
<hr style="white-space:normal" />&#13;
<h2 style=""><span style="font-size:18px">SSH连接，安全快捷</span></h2>&#13;
<p style="white-space:normal"><br />&#13;
</p>&#13;
<p style="white-space:normal">这一课的内容肯定会让你大呼过瘾，也许是《Linux探索之旅》中到目前为止最有意思的课之一。</p>&#13;
<p style="white-space:normal"><br />&#13;
</p>&#13;
<p style="white-space:normal">我们会聊很多内容，会学习如何连接到远程的一台安装有Linux的机器。</p>&#13;
<p style="white-space:normal"><br />&#13;
</p>&#13;
<p style="white-space:normal">在本课程的开头，我们略微提到过：可以配置安装Linux的机器，只要机器开着，就可以远程连接到它。</p>&#13;
<p style="white-space:normal"><br />&#13;
</p>&#13;
<p style="white-space:normal">我们不仅仅会学习如何远程连接到Linux，还会学习其原理。</p>&#13;
<p style="white-space:normal"><br />&#13;
</p>&#13;
<p style="white-space:normal">而且也会学习SSH协议，以及数据如何通过SSH加密。以及如何用SSH连接到远程电脑。</p>&#13;
<p style="white-space:normal"><br />&#13;
</p>&#13;
<p style="white-space:normal">因此，我们可以一窥网络和安全（密码学）的奇幻世界。</p>&#13;
<p style="white-space:normal"><br />&#13;
</p>&#13;
<p style="white-space:normal">设想一下：你家里的电脑安装了Linux系统，处于开机状态，你在工作的时候想起来要用家里的电脑进行某项下载任务或者提取某个文件。此时，你可以远程连接到家里的Linux系统，打开一个终端，就好像你坐在家里的电脑面前一样。我们到目前为止所学关于终端的所有操作，你都可以在远程连接到的机器上实现，哪怕这台机器是在世界的另一个角落。</p>&#13;
<p style="white-space:normal"><br />&#13;
</p>&#13;
<p style="white-space:normal">这一课对各位站长（小编也是其中一员，我们程序员联盟有网站和论坛：http://coderunity.com/和http://coderunity.com/bbs/）特别有用，因为我们可以远程连接到自己网站的服务器。</p>&#13;
<p style="white-space:normal"><br />&#13;
</p>&#13;
<p style="white-space:normal">现在越来越多的人购买了服务器，在服务器上可以架设自己的网站，或提供服务（比如游戏服务器）。</p>&#13;
<p style="white-space:normal"><br />&#13;
</p>&#13;
<p style="white-space:normal">一般来说，对服务器的操作都需要远程连接（因为我们一般都是租用服务器提供商的远端电脑，除非你有钱“任性”，那你可以买几台电脑来做服务器），用终端来进行，而且基本都是用SSH协议来连接。<br />&#13;
</p>&#13;
<p style="white-space:normal"><br />&#13;
</p>&#13;
<p style="white-space:normal">关于服务器的知识，可以参看小编另一个已完结的系列教程《<a target="_blank" href="http://mp.weixin.qq.com/s?__biz=MzAxMTE3MDkyMA==&amp;mid=400575249&amp;idx=5&amp;sn=94ca4257ab2bbd29009c6bcae9aed079&amp;scene=21#wechat_redirect">Web探索之旅</a>》：http://blog.csdn.net/column/details/webexplore.html</p>&#13;
<p style="white-space:normal"><br />&#13;
</p>&#13;
<hr style="white-space:normal" />&#13;
<p style="white-space:normal"><span style="color:#ffffff; background-color:rgb(0,176,80)">连接到远程终端</span></p>&#13;
<p style="white-space:normal"><br />&#13;
</p>&#13;
<p style="white-space:normal">到目前为止，我们本课程中所学的Linux的操作，都是我们本人坐在电脑前去操作自己面前的电脑。可能与我们原先还没学编程，使用Windows电脑玩Dota时没什么区别：端坐在电脑前，按下开机键，电脑开机，然后... gg对战平台，网易对战平台，五人黑呀，好happy呀...</p>&#13;
<p style="white-space:normal"><br />&#13;
</p>&#13;
<p style="white-space:normal">怎奈我们不甘寂寞（“一生有一种大海的气魄，岁月一页页无情翻过。那乾坤留在我心中的一刻，就已经注定我不甘寂寞... ” 小编你可以了），在一个地方待久了，总想去外面闯闯看看。</p>&#13;
<p style="white-space:normal"><br />&#13;
</p>&#13;
<p style="white-space:normal">Linux的一个强大之处就是可以很方便地操作很远之处的另一台安装有Linux的电脑。这个功能早在Unix时代就已经有了。</p>&#13;
<p style="white-space:normal"><br />&#13;
</p>&#13;
<p style="white-space:normal">当然了，Windows系统也可以远程连接到另一个Windows系统，我们也可以从Linux系统连接到Windows系统、Mac系统，或者从Windows连接到Linux，Mac。等等。只不过使用起来没有Linux下那么顺手。</p>&#13;
<p style="white-space:normal"><br />&#13;
</p>&#13;
<p style="white-space:normal">今天，比如我住在法国巴黎，我可以很方便地远程连接到位于美国纽约的一台电脑。也可以连接到日本东京的一台电脑。我也可以操作美国的那台电脑给日本东京的电脑发送文件。<br />&#13;
</p>&#13;
<p style="white-space:normal"><br />&#13;
</p>&#13;
<p style="white-space:normal">因为Internet（互联网或英特网）的出现，这样的事情在今天看来已经很平常了。</p>&#13;
<p style="white-space:normal"><br />&#13;
</p>&#13;
<p style="white-space:normal">远程连接技术大大节约了时间和精力。假如没有这个技术，专门负责维护远程服务器的技术人员（通常称为System Administrator，系统管理员）要给东京机房的电脑安装一个软件，那还得买飞机票去东京...<br />&#13;
</p>&#13;
<p style="white-space:normal"><br />&#13;
</p>&#13;
<p style="white-space:normal">服务器，英语是server。一般是指7天24小时不关机的电脑，这些电脑和你家里的电脑类似，但又不一样（通常更强劲，噪音更大 :P）：也有一个处理器，一个或多个硬盘，等等。服务器的主要特色是保持开机，始终连接Internet，提供服务。比如程序员联盟的网站的服务器是租用的阿里云的服务器，它也会不分日夜地殷勤为您传送需要的网页。</p>&#13;
<p style="white-space:normal"><br />&#13;
</p>&#13;
<p style="white-space:normal">我们把连接到服务器的机器称为客户机，英语是client，我们本课之后的图片中也会像下图这样来表述：</p>&#13;
<p style="white-space:normal"><br />&#13;
</p>&#13;
<p style="white-space:normal"><img src="https://mmbiz.qlogo.cn/mmbiz/iaHL5mQLicPYOXriaELSf89aSCfYlcKLvJRPDzgjrpT0Xjp4tGBfGibmDKyVLTZF3YwePIVMuAMtNSVbeyCGNSkh9A/0?wx_fmt=jpeg" alt="" /><br />&#13;
</p>&#13;
<p style="white-space:normal"><br />&#13;
</p>&#13;
<p style="white-space:normal">目前，你家里的电脑应该还不能被称为一台服务器。当然，如果你愿意，你也可以将其“变为”一台服务器，只需要安装一些软件，做一些配置。</p>&#13;
<p style="white-space:normal"><br />&#13;
</p>&#13;
<p style="white-space:normal">还有就是：不关机。</p>&#13;
<p style="white-space:normal"><br />&#13;
</p>&#13;
<p style="white-space:normal">因为一台关机的服务器，就不是《服务》的机器了。作为服务器必须 任劳任怨，随叫随到；宕机重启，永不言弃。</p>&#13;
<p style="white-space:normal"><br />&#13;
</p>&#13;
<p style="white-space:normal">接下来，我们就有请今天的主角：SSH 上场。<br />&#13;
</p>&#13;
<p style="white-space:normal"><br />&#13;
</p>&#13;
<p style="white-space:normal">不过我们也会讲很多其他的相关知识点，前方知识点密集高能预警。准备好了吗？我们将会以下面的顺序来介绍SSH：</p>&#13;
<p style="white-space:normal"><br />&#13;
</p>&#13;
<ol class=" list-paddingleft-2" style="list-style-type:decimal">&#13;
<li>&#13;
<p style="white-space:normal">为什么要保护网络通信？</p>&#13;
</li><li>&#13;
<p style="white-space:normal">SSH又是如何保护网络通信的？</p>&#13;
</li><li>&#13;
<p style="white-space:normal">SSH的具体使用方法。</p>&#13;
</li></ol>&#13;
<p style="white-space:normal"><br />&#13;
</p>&#13;
<hr style="white-space:normal" />&#13;
<p style="white-space:normal"><span style="color:#ffffff; background-color:rgb(0,176,80)">从Telnet协议到SSH协议</span></p>&#13;
<p style="white-space:normal"><br />&#13;
</p>&#13;
<p style="white-space:normal"><strong><span style="color:#0b050">协议</span></strong></p>&#13;
<p style="white-space:normal"><br />&#13;
</p>&#13;
<p style="white-space:normal">两台机器在互联网上通信的时候，需要遵循相同的协议。这不难理解，生活中，两家公司要合作，要协商，也需要拟定一份协议，双方都同意，并且签署，遵守。一旦违反协议，交流合作即会结束。比如之前习大大访问英国，和英国签署了一系列商业协议，只有双方都遵循此协议，合作交流才能继续。</p>&#13;
<p style="white-space:normal"><br />&#13;
</p>&#13;
<p style="white-space:normal">同样地，对于我们的互联网（Internet），要在其上相互通信，需要一定的协议。互联网毕竟是人创立的嘛，那肯定引入了人的惯有思维。</p>&#13;
<p style="white-space:normal"><br />&#13;
</p>&#13;
<p style="white-space:normal">或者我们也可以把互联网协议（有时也称为网络协议。参看百度百科：http://baike.baidu.com/view/16603.htm）比作一种语言，只有都说英语或都说中文才能相互交流。<br />&#13;
</p>&#13;
<p style="white-space:normal"><br />&#13;
</p>&#13;
<p style="white-space:normal">互联网协议有很多，就不一一列举了，可以看上面百度百科链接里的列表。因此，两台机器之间可以有不少种方式相互通信（每种协议对应一种通信方式）。<br />&#13;
</p>&#13;
<p style="white-space:normal"><br />&#13;
</p>&#13;
<p style="white-space:normal">身为读者的您肯定已经见过其中的一种协议了，那就是HTTP协议，只要你上网浏览网页，那么你其实一直在使用这种协议，还记得我们程序员联盟的网址吗？</p>&#13;
<p style="white-space:normal"><br />&#13;
</p>&#13;
<p style="white-space:normal">http://coderunity.com</p>&#13;
<p style="white-space:normal"><br />&#13;
</p>&#13;
<p style="white-space:normal">看到最前面的http四个英文字母了吗？这就说明它遵循的是HTTP协议。因此，你的电脑能看到程序员联盟的官方网站，是因为你的电脑和程序员联盟的服务器之间使用了HTTP协议来互相通信。</p>&#13;
<p style="white-space:normal"><br />&#13;
</p>&#13;
<p style="white-space:normal">HTTP是英语Hyper Text Transfer Protocol的缩写，表示《超文本传输协议》。protocol就是英语《协议》的意思。HTTP协议是Web（Web可以简单翻译为《网络》）最常用的传输网页的协议。<br />&#13;
</p>&#13;
<p style="white-space:normal"><br />&#13;
</p>&#13;
<p style="white-space:normal">其他常见的网络协议有FTP，是英语File Transfer Protocol的简称，表示《文件传输协议》。一般站长常用FTP，因为需要把文件（比如网站的源代码）传输到远程的网站服务器上。以前在大学时代，学校也会有公共的FTP站点，供学生们下载需要的学习资料。<br />&#13;
</p>&#13;
<p style="white-space:normal"><br />&#13;
</p>&#13;
<p style="white-space:normal">还有我们每天使用邮箱所需要遵循的协议，常见的有IMAP和POP3。IMAP是Internet Message Access Protocol（互联网消息访问协议）的缩写，POP3是Post Office Protocol Version 3（邮局协议第三版）的缩写。一般我们使用Office Outlook，Thunderbird，Gmail，163邮箱，QQ邮箱等。都需要遵循相应的邮件协议。</p>&#13;
<p style="white-space:normal"><br />&#13;
</p>&#13;
<p style="white-space:normal"><strong><span style="color:#0b050">Telnet协议：简单易用危险多</span></strong><br />&#13;
</p>&#13;
<p style="white-space:normal"><br />&#13;
</p>&#13;
<p style="white-space:normal">既然我们这课的重点是讲远程连接，那么我们就来谈谈远程连接的协议好了。首先，介绍一个老古董：Telnet。</p>&#13;
<p style="white-space:normal"><br />&#13;
</p>&#13;
<p style="white-space:normal">这个协议简单，易用，在20世纪80年代就被创立了。它的功用就是在机器间传输简单信息。<br />&#13;
</p>&#13;
<p style="white-space:normal"><br />&#13;
</p>&#13;
<p style="white-space:normal">理论上，我们就可以使用Telnet来与远端机器通信啦，比如与我们的服务器通信。</p>&#13;
<p style="white-space:normal"><br />&#13;
</p>&#13;
<p style="white-space:normal">但是这个协议有什么缺点呢？那就是它太简单太基础了，因此传输的信息并没有经过加密，而是明文传输。</p>&#13;
<p style="white-space:normal"><br />&#13;
</p>&#13;
<p style="white-space:normal">在密码学中，明文（英语是：Plaintext或Cleartext）是指传送方想要接收方获得的可读信息（比如《我爱你》）。 明文经过加密所产生的信息被称为密文，而密文经过解密而还原得来的信息被称为明文。</p>&#13;
<p style="white-space:normal"><br />&#13;
</p>&#13;
<p style="white-space:normal">如果在互联网上传输明文，那是很危险的。假设以下场景：一台军方的客户端电脑请求军方的服务器发射导弹的密码（可能是核弹，吓死宝宝了...），服务器用明文将密码传输给客户端。</p>&#13;
<p style="white-space:normal"><br />&#13;
</p>&#13;
<p style="white-space:normal">如下图所示：</p>&#13;
<p style="white-space:normal"><br />&#13;
</p>&#13;
<p style="white-space:normal"><img src="https://mmbiz.qlogo.cn/mmbiz/iaHL5mQLicPYO6MNn4dS1X0H2IrtUGy0ibMleMv8RrKqcQ58p73VpGbRvHyC7wko13QbNGH4aKFfohWMf7VqCdJqA/0?wx_fmt=jpeg" alt="" /><br />&#13;
</p>&#13;
<p style="white-space:normal"><br />&#13;
</p>&#13;
<p style="white-space:normal">从上图看来，并没有什么风险不是吗？因为信息只传递给了请求的客户机。<br />&#13;
</p>&#13;
<p style="white-space:normal"><br />&#13;
</p>&#13;
<p style="white-space:normal">但是，很有可能一个不怀好意的黑客，监听了上面两者通信的信息，就可以截取军方服务器发给军方客户机的明文信息了。如下图所示：</p>&#13;
<p style="white-space:normal"><br />&#13;
</p>&#13;
<p style="white-space:normal"><img src="https://mmbiz.qlogo.cn/mmbiz/iaHL5mQLicPYO6MNn4dS1X0H2IrtUGy0ibMswImjiciaVtP0B4fpbNlVB9PLXiaicWMhbj5em26R7tnDJ2QbslYRNWPBA/0?wx_fmt=jpeg" alt="" /><br />&#13;
</p>&#13;
<p style="white-space:normal">要阻止这样的黑客行为是很难的。虽说拦截数据这样的操作本身有难度，但是有水平的黑客是可以轻易做到的。</p>&#13;
<p style="white-space:normal"><br />&#13;
</p>&#13;
<p style="white-space:normal">比如, 像Wireshark这样的软件就可以用于监听网络（尤其是本地网络），可以截获数据。如下图所示：</p>&#13;
<p style="white-space:normal"><br />&#13;
</p>&#13;
<p style="white-space:normal"><img src="https://mmbiz.qlogo.cn/mmbiz/iaHL5mQLicPYNZU0s1VmmwaWeaDHoX0d8BibcLahMavAJ1mahD0eEksKuFk5ySicja2Iyiaax8cPcjtDiaiaShibjdwmLw/0?wx_fmt=jpeg" alt="" /><br />&#13;
</p>&#13;
<p style="white-space:normal"><br />&#13;
</p>&#13;
<p style="white-space:normal">你也许会说：“呃... 等等。我只是想远程连接到我的电脑或服务器以便访问终端控制台。我可不会共享核弹密码！况且我在电脑上只是运行grep之类的命令，被人知道也不妨啊。”</p>&#13;
<p style="white-space:normal"><br />&#13;
</p>&#13;
<p style="white-space:normal">你的意思是你并不介意别人窥探你的电脑咯？好吧，你赢了。</p>&#13;
<p style="white-space:normal"><br />&#13;
</p>&#13;
<p style="white-space:normal">但是当你连接到服务器时，你需要提供你的登录名和密码，假如被人窃取就麻烦了。</p>&#13;
<p style="white-space:normal"><br />&#13;
</p>&#13;
<p style="white-space:normal">所以，必须加密网络间传输的信息，你应该不希望自己的密码被人知道吧。</p>&#13;
<p style="white-space:normal"><br />&#13;
</p>&#13;
<p style="white-space:normal"><strong><span style="color:#0b050">SSH协议：保护信息的好方法</span></strong></p>&#13;
<p style="white-space:normal"><br />&#13;
</p>&#13;
<p style="white-space:normal">既然我们并不能阻止心怀不轨的人试图截取Internet上传输的信息，那么我们就要采取一些措施，使客户机和服务器之间以安全的方式通信。加密技术就是专门替我们做这等差事的：假如黑客获取了加密后的密码，他便不能做什么。<br />&#13;
</p>&#13;
<p style="white-space:normal"><br />&#13;
</p>&#13;
<p style="white-space:normal">但是怎么加密数据呢？客官莫急，待我把主角SSH请上来~</p>&#13;
<p style="white-space:normal"><br />&#13;
</p>&#13;
<hr style="white-space:normal" />&#13;
<p style="white-space:normal"><span style="color:#ffffff; background-color:rgb(0,176,80)">使用SSH的信息交换是如何加密的</span></p>&#13;
<p style="white-space:normal"><br />&#13;
</p>&#13;
<p>SSH是英语Secure SHell的缩写，直译过来就是“安全的Shell”，shell是“壳”的意思。</p>&#13;
<p><br />&#13;
</p>&#13;
<p>在计算机科学中，Shell俗称壳（用来区别于核），是指“提供使用者使用界面”的软件（命令解析器）。它类似于DOS下的command和后来的cmd.exe。它接收用户命令，然后调用相应的应用程序。Linux下有Bash等Shell程序，之后我们有专门的一大部分会讲Shell程序，不要担心。</p>&#13;
<p><br />&#13;
</p>&#13;
<p>不可讳言，SSH协议本身比较复杂，但是如果能对其大致原理有所了解，岂不快哉？</p>&#13;
<p style="white-space:normal"><br />&#13;
</p>&#13;
<p style="white-space:normal">如果知其所以然，那使用的时候也不会那么盲目了。所以我们从以下两条主线来了解SSH：</p>&#13;
<p style="white-space:normal"><br />&#13;
</p>&#13;
<ol class=" list-paddingleft-2" style="list-style-type:decimal">&#13;
<li>&#13;
<p style="white-space:normal">有哪些不同的加密方法</p>&#13;
</li><li>&#13;
<p style="white-space:normal">SSH又是如何运用加密方法来保护数据的</p>&#13;
</li></ol>&#13;
<p style="white-space:normal"><br />&#13;
</p>&#13;
<p style="white-space:normal"><strong><span style="color:#0b050">不同的加密方法</span></strong></p>&#13;
<p style="white-space:normal"><br />&#13;
</p>&#13;
<p>说到加密方法，就要涉及到相应的算法了。什么是算法呢？</p>&#13;
<p style="white-space:normal"><br />&#13;
</p>&#13;
<p style="white-space:normal">============</p>&#13;
<p style="white-space:normal">百度百科的解释：</p>&#13;
<p style="white-space:normal"><br />&#13;
</p>&#13;
<p style="white-space:normal">算法（Algorithm）是指解题方案的准确而完整的描述，是一系列解决问题的清晰指令，算法代表着用系统的方法描述解决问题的策略机制。<br />&#13;
</p>&#13;
<p style="white-space:normal">============</p>&#13;
<p style="white-space:normal"><br />&#13;
</p>&#13;
<p style="white-space:normal">所以下面我们就直接用“加密算法”这个词了。</p>&#13;
<p style="white-space:normal"><br />&#13;
</p>&#13;
<p style="white-space:normal">要说不同的加密算法，那实在是三天三夜讲不完啊，所以小编就不在这给大家“一千零一夜”了。</p>&#13;
<p style="white-space:normal"><br />&#13;
</p>&#13;
<p style="white-space:normal">虽说我们不能了解所有的加密算法（也没那个必要），但是我们需要知道加密算法大致分两类：</p>&#13;
<p style="white-space:normal"><br />&#13;
</p>&#13;
<ol class=" list-paddingleft-2" style="list-style-type:decimal">&#13;
<li>&#13;
<p style="white-space:normal">对称加密</p>&#13;
</li><li>&#13;
<p style="white-space:normal">非对称加密</p>&#13;
</li></ol>&#13;
<p style="white-space:normal"><br />&#13;
</p>&#13;
<p style="white-space:normal"><strong>对称加密</strong><br />&#13;
</p>&#13;
<p style="white-space:normal"><br />&#13;
</p>&#13;
<p style="white-space:normal">对称加密是比较简单的加密算法，但简单并不意味着不保险（有很安全的对称加密算法）。简单意味着功能比较好理解。对称加密算法用一个密钥（英文称为Key，是在明文转换为密文或将密文转换为明文的算法中输入的参数）来加密信息。举个例子，假如此密钥叫superkey，而需要被加密的信息是message，那么加密过程如下图所示：</p>&#13;
<p style="white-space:normal"><br />&#13;
</p>&#13;
<p style="white-space:normal"><img src="https://mmbiz.qlogo.cn/mmbiz/iaHL5mQLicPYNibfThUAgdf9Z0icBULOzdeKiaBwns6NCwUrqPrEJAeEnIRpkQmynLCBe7LB1CffcFYzLKwHweshhRA/0?wx_fmt=jpeg" alt="" /><br />&#13;
上图是对称加密的加密过程的简单演示。传输方用superkey这个密钥将message这个明文信息进行加密，成为P7&amp;(jk2%这样的密文。</p>&#13;
<p style="white-space:normal"><br />&#13;
</p>&#13;
<p style="white-space:normal">之后，接收方用同样的密钥superkey，对P7&amp;(jk2%这个密文进行解密，就重新得到了明文message。解密的过程如下图所示：</p>&#13;
<p style="white-space:normal"><br />&#13;
</p>&#13;
<p style="white-space:normal"><img src="https://mmbiz.qlogo.cn/mmbiz/iaHL5mQLicPYNibfThUAgdf9Z0icBULOzdeK3DaP3r0icCpx21cHTmteGX78K2UsGUS02GljLzahu83AWEIp12cINag/0?wx_fmt=jpeg" alt="" /></p>&#13;
<p style="white-space:normal"><br />&#13;
上图就是对称加密中用同样的密钥superkey进行解密的过程。</p>&#13;
<p style="white-space:normal"><br />&#13;
</p>&#13;
<p style="white-space:normal">因此，对称的意思就是指加密和解密使用的是同一个密钥。因此加密方和解密方都须要知道这个密钥。</p>&#13;
<p style="white-space:normal"><br />&#13;
</p>&#13;
<p style="white-space:normal">这样，假如黑客截获了P7&amp;(jk2%这个传输的密文，他没有解密的密钥superkey，他就不知道究竟是什么明文信息了。如下图所示：</p>&#13;
<p style="white-space:normal"><br />&#13;
</p>&#13;
<p style="white-space:normal"><img src="https://mmbiz.qlogo.cn/mmbiz/iaHL5mQLicPYNibfThUAgdf9Z0icBULOzdeKtxic1OG3UN5v4lRpNY1Tks6anlt8tiaPDH3j98hGvJibXBUHWRvEo9Sqg/0?wx_fmt=jpeg" alt="" /><br />&#13;
</p>&#13;
<p style="white-space:normal"><br />&#13;
</p>&#13;
<p style="white-space:normal">你会说：这样很不错啊。</p>&#13;
<p style="white-space:normal"><br />&#13;
</p>&#13;
<p style="white-space:normal">但是，客户机和服务器都须要知道这个密钥。因此客户机首先要把这个密钥传给服务器，为了让服务器可以解密那些加密过的信息。<br />&#13;
</p>&#13;
<p style="white-space:normal"><br />&#13;
</p>&#13;
<p style="white-space:normal">实际上，为了达到上图的目的，客户机和服务器必须事先传递那个密钥superkey。但是他们怎么传递呢？假如他们传递密钥用的是明文，那么黑客照样可以截获密钥，接下来就可以解密任何传递的加密信息了，不是吗？如下图所示：</p>&#13;
<p style="white-space:normal"><br />&#13;
</p>&#13;
<p style="white-space:normal"><img src="https://mmbiz.qlogo.cn/mmbiz/iaHL5mQLicPYMqaQlPrdiaZiae4kGGSbY4FjlYZWSib0w0ib7GJSHlicWMpHOVibiazibQd325DB7BPZxlQibDRysUHyII7pA/0?wx_fmt=jpeg" alt="" /><br />&#13;
</p>&#13;
<p style="white-space:normal"><br />&#13;
</p>&#13;
因此，对称加密虽然强大，但是有一个致命的缺陷：必须谨慎地传递密钥。但这几乎是不可能的：因为首先得传递密钥。<br />&#13;
<br />&#13;
<p>你也许会问：为什么我们不干脆把传递的密钥也加密呢？</p>&#13;
<p><br />&#13;
</p>&#13;
<p>好问题，你的想法也是对的。Bravo<br />&#13;
</p>&#13;
<p><br />&#13;
</p>&#13;
<p>为了加密对称加密的密钥（是不是很绕），我们将用另一种方法：</p>&#13;
<p>非对称加密。只要用了这个方法，我们就不用担心密钥被黑客获取了。<strong><br />&#13;
</strong></p>&#13;
<p><strong><br />&#13;
</strong></p>&#13;
<p><strong>非对称加密</strong><br />&#13;
</p>&#13;
<p><br />&#13;
</p>&#13;
<p>对称加密方法中，我们只用一个密钥来进行加密和解密。</p>&#13;
<p>非对称加密方法中，我们用一个密钥来进行加密，用另一个密钥来解密。<br />&#13;
</p>&#13;
<p><br />&#13;
</p>&#13;
<p>因此，非对称加密有两个密钥：</p>&#13;
<ul class=" list-paddingleft-2" style="list-style-type:disc">&#13;
<li>&#13;
<p>一个是"公钥"（Public Key），用于加密</p>&#13;
</li><li>&#13;
<p>一个是"私钥"（Private Key），用于解密<br />&#13;
</p>&#13;
</li></ul>&#13;
<p><br />&#13;
</p>&#13;
<p>公钥只用来加密。因此，用非对称加密的算法，我们就只能用私钥来解密咯。<br />&#13;
</p>&#13;
<p><br />&#13;
</p>&#13;
<p>我们请求电脑为我们生成这一对密钥：一个私钥和一个公钥。它们总是成对出现。<br />&#13;
</p>&#13;
<p><br />&#13;
</p>&#13;
<p>但是您不要问我生成这一对密钥的原理，也不要问我为什么它们总是成对出现。因为“我不想说，我很亲切；我不想说，我很纯洁。可是我不能拒绝心中的感觉...”。 不好意思，跑题了（想起了杨钰莹）。</p>&#13;
<p><br />&#13;
</p>&#13;
<p>其实是因为原理很复杂，我们只要知道怎么用就好了。<br />&#13;
</p>&#13;
<p><br />&#13;
</p>&#13;
<p>假设我们有如下一对密钥：</p>&#13;
<ul class=" list-paddingleft-2" style="list-style-type:disc">&#13;
<li>&#13;
<p>公钥：<strong>37ab47pK</strong></p>&#13;
</li><li>&#13;
<p>私钥：<strong>1Tv314C</strong><br />&#13;
</p>&#13;
</li></ul>&#13;
<p><br />&#13;
</p>&#13;
<p>为了加密，我们要用到公钥，如下图所示：<br />&#13;
</p>&#13;
<p><br />&#13;
</p>&#13;
<p><img src="https://mmbiz.qlogo.cn/mmbiz/iaHL5mQLicPYMqaQlPrdiaZiae4kGGSbY4FjEDsZia2bMIxU6dHiaiadaSZ4dUAoaF80f1j3VR6QiadTCuicweW4ekKKEBQ/0?wx_fmt=jpeg" alt="" /><br />&#13;
</p>&#13;
<p>而解密呢，公钥就派不上用场了。必须用私钥才行。公私分明，方为大德嘛。如下图所示：</p>&#13;
<p><br />&#13;
</p>&#13;
<p><img src="https://mmbiz.qlogo.cn/mmbiz/iaHL5mQLicPYMqaQlPrdiaZiae4kGGSbY4FjuCv1vIKlkESCufI3Wx77WGEbpdFicpRBOsDzajKHapxsW9xRX11yzmA/0?wx_fmt=jpeg" alt="" /><br />&#13;
</p>&#13;
<p><br />&#13;
</p>&#13;
<p>这就是为什么我们称这种方法为非对称的原因：需要两个不同的密钥。其中一个用于加密，另一个用于解密。<br />&#13;
</p>&#13;
<p><br />&#13;
</p>&#13;
<p>公钥可以在网络上以明文传输，毕竟是公开的密钥嘛（Public就是英语"公开的，公共的"的意思）。即使公钥被不怀好意的黑客截获也无所谓。但是，私钥（private是英语"私人的，私有的"的意思），用于解密的，却不能被公开传输，需要保管好。<br />&#13;
</p>&#13;
<p><br />&#13;
</p>&#13;
<p>当然了，非对称算法绝不止一种，在这个大家族中，最有名的要数RSA算法了。</p>&#13;
<p><br />&#13;
</p>&#13;
<p>1977年，三位数学家Rivest、Shamir 和Adleman 设计了一种算法，可以实现非对称加密。这种算法用他们三个人的名字的首字母命名，叫做RSA算法。</p>&#13;
<p><br />&#13;
</p>&#13;
<p><strong><span style="color:#0b050">用SSH创建一个安全的通信管道<strong><span style="color:#0b050"></span></strong></span></strong></p>&#13;
<p><br />&#13;
</p>&#13;
<p><strong>SSH结合使用非对称加密和对称加密两种方法</strong></p>&#13;
<p><br />&#13;
</p>&#13;
<p>SSH以如下顺序使用两种加密方法：非对称加密和对称加密</p>&#13;
<p><br />&#13;
</p>&#13;
<ol class=" list-paddingleft-2" style="list-style-type:decimal">&#13;
<li>&#13;
<p>首先，使用非对称加密来安全传输对称加密的密钥</p>&#13;
</li><li>&#13;
<p>之后，就一直使用对称加密的密钥来作为加密和解密的手段<br />&#13;
</p>&#13;
</li></ol>&#13;
<p><br />&#13;
</p>&#13;
<p>聪明如你一定会好奇：那为什么不只用非对称加密呢？</p>&#13;
<p><br />&#13;
</p>&#13;
<p>当然可以只用非对称加密，但是也有一个缺陷：非对称加密太消耗电脑资源了。非对称加密比对称加密要慢大概100~1000倍。</p>&#13;
<p><br />&#13;
</p>&#13;
<p>因此，两台电脑之间交换对称加密的密钥（用非对称加密的方式），之后就可以用对称加密来通信了，会更快捷。</p>&#13;
<p><br />&#13;
</p>&#13;
<p class="hoveredCourseElement">非对称加密只是在通信之初用于交换对称加密的密钥。</p>&#13;
<p class="hoveredCourseElement"><br />&#13;
</p>&#13;
<p class="hoveredCourseElement">让我们用图解的方式来解释一下SSH是如何创建一个安全的通信管道的：</p>&#13;
<p class="hoveredCourseElement"><br />&#13;
</p>&#13;
<p class="hoveredCourseElement">首先，我们要交换一个对称加密的密钥，但是我们又不能以明文方式传输这个密钥，不然黑客截获之后就可以用其来解密了。因此，我们要用非对称加密的方式来加密对称加密的密钥（希望你还没晕）。<br />&#13;
</p>&#13;
<p class="hoveredCourseElement"><br />&#13;
</p>&#13;
<p>服务器将非对称加密的公钥以明文方式传输给客户机，使客户机可以用公钥来加密。如下图：</p>&#13;
<p><br />&#13;
</p>&#13;
<p><img src="https://mmbiz.qlogo.cn/mmbiz/iaHL5mQLicPYMqaQlPrdiaZiae4kGGSbY4Fjn79m5GuSTs8hc2xzTGCp28UeLJMhhLus9yY0ibUNyNjb8t9L2eefBkw/0?wx_fmt=jpeg" alt="" /><br />&#13;
客户机收到服务器传给它的公钥之后，就会用公钥来加密自己的对称加密的密钥，假设是superkey。如下图所示：</p>&#13;
<p><br />&#13;
</p>&#13;
<p><img src="https://mmbiz.qlogo.cn/mmbiz/iaHL5mQLicPYMqaQlPrdiaZiae4kGGSbY4FjZjQTsG1qnLAGl1R9ic6moBmr18xTEPKqeX9SiaxzJurgFHMSre9rXhqg/0?wx_fmt=jpeg" alt="" /><br />&#13;
</p>&#13;
<p><br />&#13;
</p>&#13;
<p>然后，客户机将用公钥加密后的对称加密密钥传给服务器。黑客可以截获这个加密后的密钥，但是他没办法解密，因为他没有用于解密的私钥，这个私钥只有服务器知道。如下图所示：</p>&#13;
<p><br />&#13;
</p>&#13;
<p><img src="https://mmbiz.qlogo.cn/mmbiz/iaHL5mQLicPYMqaQlPrdiaZiae4kGGSbY4FjyBUAGfBJdovROfedBhiaBkXojYjnHK8AbXjEAS53uANWU73U3n8WN3w/0?wx_fmt=jpeg" alt="" /></p>&#13;
<p><br />&#13;
</p>&#13;
<p>服务器接收到客户机传来的密钥，使用自己的私钥来解密，就得到了对称加密的密钥。如下图所示：</p>&#13;
<p><br />&#13;
</p>&#13;
<p><img src="https://mmbiz.qlogo.cn/mmbiz/iaHL5mQLicPYMqaQlPrdiaZiae4kGGSbY4FjIJ5GabXuNVBaJ7bM4P8Vm9Lp3hdgMaicPhGe94Q6fwd22GAG7HubDOA/0?wx_fmt=jpeg" alt="" /><br />&#13;
</p>&#13;
<p><br />&#13;
</p>&#13;
<p>现在，客户机和服务器都知道了对称加密的密钥是superkey，而他们从没在网络间以明文传递过这个密钥。</p>&#13;
<p><br />&#13;
</p>&#13;
<p>因此，从现在开始他们可以以对称加密的方式互相发送加密的信息（用superkey来加密和解密），不用再担心被黑客获取信息了。如下图所示：</p>&#13;
<p><br />&#13;
</p>&#13;
<p><img src="https://mmbiz.qlogo.cn/mmbiz/iaHL5mQLicPYMqaQlPrdiaZiae4kGGSbY4FjtQdWKq0El5bsa3jFTZmGyO9EnGJxE3rNutfJ23TFDuWPHes3SiaYSYw/0?wx_fmt=jpeg" alt="" /><br />&#13;
</p>&#13;
<p>好了，以上就是SSH的工作原理了。是不是很巧妙地创建了一条安全通信的管道呢，设计这些的前辈真的非常机智，智商高达250呢~</p>&#13;
<p><br />&#13;
</p>&#13;
<p>现在既然客户机和服务器已经有了安全的通信方式了，客户机就可以放心地将自己的登录名和密码传输给服务器以连接服务器了。如下图：</p>&#13;
<p><br />&#13;
</p>&#13;
<p><img src="https://mmbiz.qlogo.cn/mmbiz/iaHL5mQLicPYMqaQlPrdiaZiae4kGGSbY4FjjBdgGRY6HT7FNzicWbWmFw8ib3ruy9CwbibPsibSBEJlQ3TFLyseddalSw/0?wx_fmt=jpeg" alt="" /><br />&#13;
</p>&#13;
<p>那么，须要知道以上这些原理才能使用SSH吗？</p>&#13;
<p><br />&#13;
</p>&#13;
<p>当然不是啦。以上这些都是自动完成的。为了连接远程电脑，你要做的只是输入登录名和密码就好了。</p>&#13;
<p><br />&#13;
</p>&#13;
<p>现在全球都在使用SSH，几乎没有人再用Telnet了。<br />&#13;
</p>&#13;
<p><br />&#13;
</p>&#13;
<hr style="white-space:normal" />&#13;
<p style="white-space:normal"><span style="color:#ffffff; background-color:rgb(0,176,80)">用SSH进行连接</span></p>&#13;
<p style="white-space:normal"><br />&#13;
</p>&#13;
<p style="white-space:normal">注：我们接下来的命令都是以Debian系列（Ubuntu为代表）来演示的，其他Linux发行版的命令格式类似。<br />&#13;
</p>&#13;
<p style="white-space:normal"><br />&#13;
</p>&#13;
<p style="white-space:normal">好了，理论谈得够多了，该实战了。你会发现其实使用SSH很简单，因为电脑替我们做了大部分工作。</p>&#13;
<p style="white-space:normal"><br />&#13;
</p>&#13;
<p style="white-space:normal">接下来我们分为两种情况：</p>&#13;
<p style="white-space:normal"><br />&#13;
</p>&#13;
<ol class=" list-paddingleft-2" style="list-style-type:decimal">&#13;
<li>&#13;
<p style="white-space:normal">你已经租用了一台服务器（例如阿里云），那这台服务器因为已经配置好了作为SSH服务器，所以你什么也不需要做。估计站长大多是这种情况吧。</p>&#13;
</li><li>&#13;
<p style="white-space:normal">你没有租用一台服务器（大多数人的情况），我们就来看看怎么把你自己的电脑配置成SSH服务器。</p>&#13;
</li></ol>&#13;
<p style="white-space:normal"><br />&#13;
</p>&#13;
<p style="white-space:normal"><strong><span style="color:#0b050">将你的电脑配置成SSH服务器</span></strong></p>&#13;
<p style="white-space:normal"><br />&#13;
</p>&#13;
<p style="white-space:normal">假如你要将自己的电脑配置成SSH服务器，以便自己或别人以后可以远程用SSH登录你的电脑，你可以这么做：</p>&#13;
<p style="white-space:normal"><br />&#13;
</p>&#13;
<p style="white-space:normal">首先，安装openssh</p>&#13;
<p style="white-space:normal"><br />&#13;
</p>&#13;
<pre class="brush:bash;toolbar:false">sudo apt-get install openssh-server</pre>&#13;
<p style="white-space:normal"><br />&#13;
</p>&#13;
<p style="white-space:normal">安装完成后，它会自动开启sshd这个精灵进程。</p>&#13;
<p style="white-space:normal"><br />&#13;
</p>&#13;
<p style="white-space:normal">你也可以手动开启：</p>&#13;
<p style="white-space:normal"><br />&#13;
</p>&#13;
<p>// Ubuntu系统<br />&#13;
</p>&#13;
<pre class="brush:bash;toolbar:false">sudo service ssh start</pre>&#13;
<p><br />&#13;
</p>&#13;
<p>// Debian系统<br />&#13;
</p>&#13;
<pre class="brush:bash;toolbar:false">sudo /etc/init.d/ssh start</pre>&#13;
<p><br />&#13;
</p>&#13;
<p>要停止的话：</p>&#13;
<p><br />&#13;
</p>&#13;
<p>// Ubuntu系统<br />&#13;
</p>&#13;
<pre class="brush:bash;toolbar:false">sudo service ssh stop</pre>&#13;
<p><br />&#13;
</p>&#13;
<p>// Debian系统<br />&#13;
</p>&#13;
<pre class="brush:bash;toolbar:false">sudo /etc/init.d/ssh stop</pre>&#13;
<p><br />&#13;
</p>&#13;
<p>如果你要对SSH的配置做修改，可以修改/etc/ssh/ssh_config，然后运行sudo /etc/init.d/ssh reload或sudo service ssh reload来使修改生效。<br />&#13;
</p>&#13;
<p style="white-space:normal"><br />&#13;
</p>&#13;
<p><strong><span style="color:#0b050">从一台Linux电脑上通过SSH连接（Mac电脑类似）</span></strong></p>&#13;
<p style="white-space:normal"><br />&#13;
</p>&#13;
<p style="white-space:normal">假定你要以用户名user，登录远程服务器host，只要一条简单命令就可以了：</p>&#13;
<p style="white-space:normal"><br />&#13;
</p>&#13;
<pre class="brush:bash;toolbar:false">ssh user@host</pre>&#13;
<p style="white-space:normal"><br />&#13;
</p>&#13;
<p style="white-space:normal">如果本地用户名与远程用户名一致，登录时可以省略用户名：</p>&#13;
<p style="white-space:normal"><br />&#13;
</p>&#13;
<pre class="brush:bash;toolbar:false">ssh host</pre>&#13;
<p style="white-space:normal"><br />&#13;
</p>&#13;
<p style="white-space:normal">SSH的默认端口是22，也就是说，你的登录请求会送进远程服务器的22端口。使用p参数，可以修改这个端口：</p>&#13;
<p style="white-space:normal"><br />&#13;
</p>&#13;
<pre class="brush:bash;toolbar:false">ssh -p 250 user@host</pre>&#13;
<p style="white-space:normal"><br />&#13;
</p>&#13;
<p style="white-space:normal">上面这条命令表示，ssh直接连接远程服务器的250端口。</p>&#13;
<p style="white-space:normal"><br />&#13;
</p>&#13;
<p style="white-space:normal">如果你是第一次登录远程服务器，系统会出现类似下面的提示：</p>&#13;
<p style="white-space:normal"><br />&#13;
</p>&#13;
<p>The authenticity of host 'host (12.18.429.21)' can't be established.</p>&#13;
<p>RSA key fingerprint is 98:2e:d7:e0:de:9f:ac:67:28:c2:42:2d:37:16:58:4d.</p>&#13;
<p>Are you sure you want to continue connecting (yes/no)?</p>&#13;
<p><br />&#13;
</p>&#13;
<p>这段话的意思是，无法确认host服务器的真实性，只知道它的公钥指纹，问你还想继续连接吗？</p>&#13;
<p><br />&#13;
</p>&#13;
<p>所谓"公钥指纹"，是指公钥长度较长（这里采用RSA算法，长达1024位），很难比对，所以对其进行MD5计算，将它变成一个128位的指纹。上例中是98:2e:d7:e0:de:9f:ac:67:28:c2:42:2d:37:16:58:4d，再进行比较，就容易多了。</p>&#13;
<p><br />&#13;
</p>&#13;
<p>很自然的一个问题就是：用户怎么知道远程服务器的公钥指纹应该是多少？回答是没有好办法，远程服务器必须在自己的网站上贴出公钥指纹，以便用户自行核对。</p>&#13;
<p><br />&#13;
</p>&#13;
<p>假定经过风险衡量以后，用户决定接受这个远程服务器的公钥（输入yes，回车）：</p>&#13;
<p><br />&#13;
</p>&#13;
<p>Are you sure you want to continue connecting (yes/no)? yes</p>&#13;
<p><br />&#13;
</p>&#13;
<p>系统会出现一句提示，表示host主机已经得到认可：</p>&#13;
<p><br />&#13;
</p>&#13;
<p>Warning: Permanently added 'host,12.18.429.21' (RSA) to the list of known hosts.</p>&#13;
<p><br />&#13;
</p>&#13;
<p>然后，会要求输入密码：</p>&#13;
<p><br />&#13;
</p>&#13;
<p>Password: (enter password)</p>&#13;
<p><br />&#13;
</p>&#13;
<p>如果密码正确，就可以登录了。</p>&#13;
<p><br />&#13;
</p>&#13;
<p>当远程服务器的公钥被接受以后，它就会被保存在文件$HOME/.ssh/known_hosts之中。下次再连接这台服务器，系统就会认出它的公钥已经保存在本地了，从而跳过警告部分，直接提示输入密码。</p>&#13;
<p><br />&#13;
</p>&#13;
<p>每个SSH用户都有自己的known_hosts文件，此外系统也有一个这样的文件，通常是/etc/ssh/ssh_known_hosts，保存一些对所有用户都可信赖的远程服务器的公钥。</p>&#13;
<p style="white-space:normal"><br />&#13;
</p>&#13;
<p><strong><span style="color:#0b050">从一台Windows电脑上通过SSH连接</span></strong><br />&#13;
</p>&#13;
<p><br />&#13;
</p>&#13;
<p>从Windows电脑要连接到远程的SSH服务器，有不少软件可以帮助我们。不过一般常用的是PuTTY这个软件。</p>&#13;
<p><br />&#13;
</p>&#13;
<p>PuTTY这个软件可以从它的官网（www.putty.org，尽量不要去第三方软件网站下载，以防有内置恶意程序）下载可直接运行的可执行程序putty.exe，也可以下载安装程序（例如 putty-0.66-installer.exe）：</p>&#13;
<p><br />&#13;
</p>&#13;
<p>下载或安装完毕后双击软件图标打开软件。</p>&#13;
<p><br />&#13;
</p>&#13;
<p><img src="https://mmbiz.qlogo.cn/mmbiz/iaHL5mQLicPYMqaQlPrdiaZiae4kGGSbY4FjFJ32QCFRpzw4Qg3DADicagKMBErZt9skoTjx9zick5GufDfOXr0UcBuw/0?wx_fmt=jpeg" alt="" /></p>&#13;
<p><br />&#13;
</p>&#13;
<p>打开PuTTY后，可以看到如下窗口</p>&#13;
<p><br />&#13;
</p>&#13;
<p><img src="https://mmbiz.qlogo.cn/mmbiz/iaHL5mQLicPYMqaQlPrdiaZiae4kGGSbY4FjInRwhMs9fIAdAMP5fS2f1NibHVyOLVQC3v7qSAicAwfnFVn2W6L7WrZA/0?wx_fmt=jpeg" alt="" /><br />&#13;
</p>&#13;
<p><br />&#13;
</p>&#13;
<p>在红色方框处填入要连接的服务器的IP地址，然后点击Open按钮，如果是首次连接，会弹出以下窗口，点击“是”即可：</p>&#13;
<p><br />&#13;
</p>&#13;
<p><img src="https://mmbiz.qlogo.cn/mmbiz/iaHL5mQLicPYMqaQlPrdiaZiae4kGGSbY4FjWfC7axLwLxxLUU13XPnM4SprHbbcZ9MuHQ2bic6ur2BsyTopWuSJh9A/0?wx_fmt=jpeg" alt="" /></p>&#13;
<p><br />&#13;
</p>&#13;
<p>在弹出的命令行窗口中依次输入用户名和密码。注意Linux系统下输入的所有密码都是不可见的（也不会用星号表示），所以你不要以为是键盘坏了或者输入不起作用，其实已经输入了：</p>&#13;
<p><br />&#13;
</p>&#13;
<p><img src="https://mmbiz.qlogo.cn/mmbiz/iaHL5mQLicPYMqaQlPrdiaZiae4kGGSbY4FjiaTy0O4icm5tQVlgFvRgEPc5syXjMQRuMnHLoXicOhA2gKy4EMz1IzfAg/0?wx_fmt=jpeg" alt="" /><br />&#13;
</p>&#13;
<p style="white-space:normal"><br />&#13;
</p>&#13;
<hr style="white-space:normal" />&#13;
<p style="white-space:normal"><span style="color:#ffffff; background-color:rgb(0,176,80)">用密钥实现自动身份验证</span></p>&#13;
<p style="white-space:normal"><br />&#13;
</p>&#13;
<p>使用密码登录，每次都必须输入密码，非常麻烦。幸亏SSH还提供了公钥登录，可以省去输入密码的步骤。</p>&#13;
<p><br />&#13;
</p>&#13;
<p>所谓"公钥登录"，原理很简单，就是用户将自己的公钥储存在远程服务器上。登录的时候，远程服务器会向用户发送一段随机字符串，用户用自己的私钥加密后，再发回来。远程服务器用事先储存的公钥进行解密，如果成功，就证明用户是可信的，直接允许登录shell，不再要求密码。</p>&#13;
<p><br />&#13;
</p>&#13;
<p>这种方法要求用户必须提供自己的公钥。如果没有现成的，可以直接用ssh-keygen生成一个：</p>&#13;
<p><br />&#13;
</p>&#13;
<pre class="brush:bash;toolbar:false">ssh-keygen</pre>&#13;
<p><br />&#13;
</p>&#13;
<p>运行上面的命令以后，系统会出现一系列提示，可以一路回车。其中有一个问题是，要不要对私钥设置口令（passphrase），如果担心私钥的安全，这里可以设置一个。一般都不设置。</p>&#13;
<p><br />&#13;
</p>&#13;
<p>运行结束以后，在$HOME/.ssh/目录下，会新生成两个文件：id_rsa.pub和id_rsa。前者是你的公钥，后者是你的私钥。</p>&#13;
<p><br />&#13;
</p>&#13;
<p>这时再输入下面的命令，将公钥传送到远程服务器host上面：</p>&#13;
<p><br />&#13;
</p>&#13;
<pre class="brush:bash;toolbar:false">ssh-copy-id user@host</pre>&#13;
<p><br />&#13;
</p>&#13;
<p>好了，从此你再登录，就不需要输入密码了。</p>&#13;
<p><br />&#13;
</p>&#13;
<p>如果还是不行，就打开远程服务器的/etc/ssh/sshd_config这个文件，检查下面几行前面"#"注释是否取掉。</p>&#13;
<p><br />&#13;
</p>&#13;
<pre class="brush:bash;toolbar:false">RSAAuthentication yes
PubkeyAuthentication yes
AuthorizedKeysFile .ssh/authorized_keys</pre>&#13;
<p><br />&#13;
</p>&#13;
<p>然后，重启远程服务器的ssh服务：</p>&#13;
<p><br />&#13;
</p>&#13;
<p>// Ubuntu系统<br />&#13;
</p>&#13;
<pre class="brush:bash;toolbar:false">sudo service ssh restart</pre>&#13;
<p><br />&#13;
</p>&#13;
<p>// Debian系统<br />&#13;
</p>&#13;
<pre class="brush:bash;toolbar:false">sudo /etc/init.d/ssh restart</pre>&#13;
<p style="white-space:normal"><br />&#13;
</p>&#13;
<hr style="white-space:normal" />&#13;
<p style="white-space:normal"><span style="color:#ffffff; background-color:rgb(0,176,80)">总结</span></p>&#13;
<p style="white-space:normal"><br />&#13;
</p>&#13;
<ol class=" list-paddingleft-2" style="list-style-type:decimal">&#13;
<li>&#13;
<p style="white-space:normal">我们可以远程连接到Linux系统，进入它的终端。我们一般都是这样操作远程服务器的。</p>&#13;
</li><li>&#13;
<p style="white-space:normal">连接到远程Linux服务器的电脑我们一般称为client，就是客户。我们可以从多种操作系统远程连接到Linux的终端，比如从Windows，Linux，Mac系统。</p>&#13;
</li><li>&#13;
<p style="white-space:normal">在Windows下，为了远程连接到远程的Linux系统，一般我们会用PuTTY这个软件。</p>&#13;
</li><li>&#13;
<p style="white-space:normal">在Linux和Mac下，为了远程连接到Linux系统，我们可以用ssh命令，为它指定在远程Linux机器上的登录名（login）和远程Linux机器的IP地址。例如： ssh oscar@79.27.172.59</p>&#13;
</li><li>&#13;
<p style="white-space:normal">通过SSH协议， 两台机器之间传递的信息会被加密，这样就保证了传输信息的安全性。</p>&#13;
</li><li>&#13;
<p style="white-space:normal">为了免去每次用SSH协议连接远程机器都要输入用户密码的麻烦，我们可以创建一个用于验证身份的密钥对（公钥和私钥）。公钥需要传输并储存到远程机器上，私钥则存在我们自己的电脑里。之后，我们的SSH连接就不需要输入密码了。</p>&#13;
</li></ol>&#13;
<p style="white-space:normal"><br />&#13;
</p>&#13;
<hr style="white-space:normal" />&#13;
<h2 style=""><span style="font-size:18px">第四部分第三课预告</span></h2>&#13;
<p style="white-space:normal"><br />&#13;
</p>&#13;
<p style="white-space:normal">今天的课就到这里，一起加油吧！</p>&#13;
<p style="white-space:normal">下一课我们学习：<strong><span style="color:#0b050">文件传输，潇洒同步</span></strong></p>&#13;
   &#13;
