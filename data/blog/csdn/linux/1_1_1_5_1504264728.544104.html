

<span style="font-size:16px; font-weight:bold">这是一个简单的UDP的实例而已～<br />&#13;
<br />&#13;
//!&gt; server<br />&#13;
//!&gt; server.c</span><br />&#13;
<br />&#13;
<br />&#13;
<br />&#13;
<br />&#13;
#include &lt;stdio.h&gt;<br />&#13;
#include &lt;stdlib.h&gt;<br />&#13;
#include &lt;string.h&gt;<br />&#13;
#include &lt;errno.h&gt;<br />&#13;
#include &lt;unistd.h&gt;<br />&#13;
#include &lt;sys/types.h&gt;<br />&#13;
#include &lt;netinet/in.h&gt;<br />&#13;
<br />&#13;
#define  &#13;
<div id="sina_keyword_ad_area2" class="articalContent  "><wbr> <wbr> <wbr>SERV_PORT <wbr> <wbr> <wbr>6000<br />&#13;
#define <wbr> <wbr> <wbr>MAXLINE <wbr> <wbr> <wbr> <wbr> <wbr> <wbr> 1024<br />&#13;
<br />&#13;
int main( int argc, char ** argv )<br />&#13;
{<br />&#13;
 <wbr> <wbr> <wbr> char <wbr> <wbr> <wbr>recv[MAXLINE];<br />&#13;
 <wbr> <wbr> <wbr> int <wbr> <wbr> <wbr> <wbr> <wbr> <wbr> listenfd,connfd;<br />&#13;
 <wbr> <wbr> <wbr> int <wbr> <wbr> <wbr> <wbr> <wbr> <wbr> chilen, len,i;<br />&#13;
 <wbr> <wbr> <wbr> int <wbr> <wbr> <wbr> <wbr> <wbr> <wbr> nread;<br />&#13;
 <wbr> <wbr> <wbr> structsockaddr_in servaddr, chiaddr;<br />&#13;
 <wbr> <wbr> <wbr><br />&#13;
 <wbr> <wbr> <wbr>//!&gt; establish the socket<br />&#13;
 <wbr> <wbr> <wbr>//!&gt;<br />&#13;
 <wbr> <wbr> <wbr> if( (listenfd = socket( <wbr> AF_INET, SOCK_DGRAM,0 <wbr> ) ) == -1 )<br />&#13;
 <wbr> <wbr> <wbr> {<br />&#13;
 <wbr> <wbr> <wbr> <wbr> <wbr> <wbr>printf("Socket error.. %d\n", errno);<br />&#13;
 <wbr> <wbr> <wbr> <wbr> <wbr> <wbr> exit(EXIT_FAILURE );<br />&#13;
 <wbr> <wbr> <wbr> }<br />&#13;
 <wbr> <wbr> <wbr><br />&#13;
 <wbr> <wbr> <wbr>//!&gt;<br />&#13;
 <wbr> <wbr> <wbr>//!&gt; write info<br />&#13;
 <wbr> <wbr> <wbr> bzero(&amp;servaddr, sizeof( servaddr ) );<br />&#13;
 <wbr> <wbr> <wbr>servaddr.sin_family = AF_INET;<br />&#13;
 <wbr> <wbr> <wbr>servaddr.sin_addr.s_addr <wbr> =htonl( INADDR_ANY);<br />&#13;
 <wbr> <wbr> <wbr>servaddr.sin_port = htons( SERV_PORT );<br />&#13;
 <wbr> <wbr> <wbr><br />&#13;
 <wbr> <wbr> <wbr>//!&gt;<br />&#13;
 <wbr> <wbr> <wbr>//!&gt; bind<br />&#13;
 <wbr> <wbr> <wbr> if( bind(listenfd, ( struct sockaddr * )&amp;servaddr, sizeof(servaddr ) ) == -1 )<br />&#13;
 <wbr> <wbr> <wbr> {<br />&#13;
 <wbr> <wbr> <wbr> <wbr> <wbr> <wbr> printf("Binderror... %d\n", errno);<br />&#13;
 <wbr> <wbr> <wbr> <wbr> <wbr> <wbr> exit(EXIT_FAILURE );<br />&#13;
 <wbr> <wbr> <wbr> }<br />&#13;
 <wbr> <wbr> <wbr><br />&#13;
 <wbr> <wbr> <wbr> while( 1)<br />&#13;
 <wbr> <wbr> <wbr>{ <wbr> <wbr> <wbr><br />&#13;
 <wbr> <wbr> <wbr> <wbr> <wbr> <wbr> chilen =sizeof( chiaddr );<br />&#13;
 <wbr> <wbr> <wbr> <wbr> <wbr> <wbr> <wbr><br />&#13;
 <wbr> <wbr> <wbr> <wbr> <wbr> <wbr> <wbr>memset( recv, 0, sizeof( recv ) );<br />&#13;
 <wbr> <wbr> <wbr> <wbr> <wbr> <wbr> <wbr> nread =recvfrom(connfd,recv, MAXLINE, 0, (struct sockaddr*)&amp;chiaddr, &amp;chilen);//read(connfd, recv, MAXLINE );<br />&#13;
 <wbr> <wbr> <wbr> <wbr> <wbr> <wbr> <wbr> <wbr> <wbr> <wbr> <wbr> <wbr> <wbr> <wbr> <wbr> <wbr> <wbr> <wbr> <wbr> <wbr> <wbr> <wbr> <wbr> <wbr> <wbr> <wbr> <wbr> <wbr> <wbr> <wbr> <wbr> <wbr> <wbr> <wbr> <wbr> <wbr> <wbr> <wbr> <wbr> <wbr> <wbr> <wbr> <wbr> <wbr> <wbr> <wbr> <wbr> <wbr> <wbr> <wbr> <wbr> <wbr> <wbr> <wbr> <wbr> <wbr> <wbr> <wbr> <wbr> <wbr> <wbr> <wbr> <wbr>//!&gt;&#13;
 记住：一般都用它<br />&#13;
 <wbr> <wbr> <wbr> <wbr> <wbr> <wbr> if( nread ==-1 )<br />&#13;
 <wbr> <wbr> <wbr> <wbr> <wbr> <wbr></wbr></wbr></wbr></wbr></wbr></wbr></wbr></wbr></wbr></wbr></wbr></wbr></wbr></wbr></wbr></wbr></wbr></wbr></wbr></wbr></wbr></wbr></wbr></wbr></wbr></wbr></wbr></wbr></wbr></wbr></wbr></wbr></wbr></wbr></wbr></wbr></wbr></wbr></wbr></wbr></wbr></wbr></wbr></wbr></wbr></wbr></wbr></wbr></wbr></wbr></wbr></wbr></wbr></wbr></wbr></wbr></wbr></wbr></wbr></wbr></wbr></wbr></wbr></wbr></wbr></wbr></wbr></wbr></wbr></wbr></wbr></wbr></wbr></wbr></wbr></wbr></wbr></wbr></wbr></wbr></wbr></wbr></wbr></wbr></wbr></wbr></wbr></wbr></wbr></wbr></wbr></wbr></wbr></wbr></wbr></wbr></wbr></wbr></wbr></wbr></wbr></wbr></wbr></wbr></wbr></wbr></wbr></wbr></wbr></wbr></wbr></wbr></wbr></wbr></wbr></wbr></wbr></wbr></wbr></wbr></wbr></wbr></wbr></wbr></wbr></wbr></wbr></wbr></wbr></wbr></wbr></wbr></wbr></wbr></wbr></wbr></wbr></wbr></wbr></wbr></wbr></wbr></wbr></wbr></wbr></wbr></wbr></wbr></wbr></wbr></wbr></wbr></wbr></wbr></wbr></wbr></wbr></wbr></wbr></wbr></wbr></wbr></wbr></wbr></wbr></wbr></wbr></wbr></wbr></wbr></wbr></wbr></wbr></wbr></wbr></wbr></wbr></wbr></wbr></wbr></wbr></wbr></wbr></wbr></wbr></wbr></wbr></wbr></wbr></wbr></wbr></wbr></wbr></wbr></wbr></wbr></wbr></wbr></wbr></wbr></wbr></wbr></wbr></wbr></wbr></wbr></wbr></wbr></wbr></wbr></wbr></wbr></wbr></wbr></wbr></wbr></wbr></wbr></wbr></wbr></wbr></wbr></wbr></wbr></wbr></wbr></wbr></wbr></wbr></wbr></wbr></wbr></wbr></wbr></wbr></wbr></wbr></wbr></wbr></wbr></wbr></wbr></wbr></wbr></wbr></wbr></wbr></wbr></wbr></div>