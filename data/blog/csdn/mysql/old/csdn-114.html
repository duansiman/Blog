\n\n<p>  下面是项目中按照男女年龄段统计的核心sql代码：</p>&#13;\n<pre code_snippet_id="282517" snippet_file_name="blog_20140409_1_4211819" class="sql" name="code"> COUNT(tr.id)AS '体检总人数',\n\t\tSUM(CASE WHEN s.sex=1 THEN 1 ELSE 0 END) AS '男体检总数',\n\t\tSUM(CASE WHEN s.sex=0 THEN 1 ELSE 0 END) AS '女体检总数',\n\t\t\n\t\tSUM(CASE WHEN s.sex=1 AND tr.age &gt;=18 AND tr.age &lt;=29 THEN 1 ELSE 0 END) AS '男18--29岁',\n\t\tSUM(CASE WHEN s.sex=0 AND tr.age &gt;=18 AND tr.age&lt;=29 THEN 1 ELSE 0 END) AS '女18--29岁',\n\t\t\n\t\tSUM(CASE WHEN s.sex=1 AND tr.age &lt;=45 AND tr.age&gt;=30 THEN 1 ELSE 0 END) AS '男30--39岁',\n\t\tSUM(CASE WHEN s.sex=0 AND tr.age&lt;=45 AND tr.age&gt;=30 THEN 1 ELSE 0 END) AS '女30--39岁',\n\t\t\n\t\tSUM(CASE WHEN s.sex=1 AND tr.age &lt;=50 AND tr.age&gt;=46 THEN 1 ELSE 0 END) AS '男40--49岁',\n\t\tSUM(CASE WHEN s.sex=0 AND tr.age&lt;=50 AND tr.age&gt;=46 THEN 1 ELSE 0 END) AS '女40--49岁',\n\t\t\n\t\tSUM(CASE WHEN s.sex=1 AND tr.age &lt;=60 AND tr.age&gt;50 THEN 1 ELSE 0 END) AS '男50--59岁',\n\t\tSUM(CASE WHEN s.sex=0 AND tr.age&lt;=60 AND tr.age&gt;50 THEN 1 ELSE 0 END) AS '女50--59岁',\n\t\t\n\t\tSUM(CASE WHEN s.sex=1 AND tr.age &lt;=70 AND tr.age&gt;60 THEN 1 ELSE 0 END) AS '男60--69岁',\n\t\tSUM(CASE WHEN s.sex=0 AND tr.age&lt;=70 AND tr.age&gt;60 THEN 1 ELSE 0 END) AS '女60--69岁',\n\t\t\n\t\tSUM(CASE WHEN s.sex=1 AND tr.age &lt;=80 AND tr.age&gt;70 THEN 1 ELSE 0 END) AS '男70--79岁',\n\t\tSUM(CASE WHEN s.sex=0 AND tr.age&lt;=80 AND tr.age&gt;70 THEN 1 ELSE 0 END) AS '女70--79岁',\n\t\t\n\t\tSUM(CASE WHEN s.sex=1 AND tr.age &gt;80 THEN 1 ELSE 0 END) AS '男80岁以上',\n\t\tSUM(CASE WHEN s.sex=0 AND tr.age&gt;80 THEN 1 ELSE 0 END) AS '女80岁以上'</pre>&#13;\n<p>我拿其中一句解释一下</p>&#13;\n<p> SUM(CASE WHEN s.sex=1 AND tr.age &gt;=18 AND tr.age &lt;=29 THEN 1 ELSE 0 END) AS '男18--29岁',</p>&#13;\n<p><br />&#13;\n</p>&#13;\n<p>先看sum的括号里面的部分</p>&#13;\n<p> case when sex = 1 and age&gt;=18 and age &lt;=29 then 1 else 0 end </p>&#13;\n<p><br />&#13;\n</p>&#13;\n<p>它表示的含义是：如果性别为1（也就是男），并且年龄在18-29岁之间成立为1，不成立为0.</p>&#13;\n<p><br />&#13;\n</p>&#13;\n<p>case和end 是一个关键字你可以理解为语句的开始和结束。</p>&#13;\n<p>when相当于if做判断，then就是判断之后显示的结果。如果成立显示为1，不成立显示为0</p>&#13;\n<p>sum就是将各个值相加。形如：1+1+0+1+0+1+1+0+1+1</p>&#13;\n<p>项目最后统计的结果截图形如：</p>&#13;\n<p><img src="http://img.blog.csdn.net/20140409111802640" alt="" /><br />&#13;\n</p>&#13;\n<p><br />&#13;\n</p>&#13;\n<div style="top:7px">﻿﻿</div>&#13;\n &#13;\n
