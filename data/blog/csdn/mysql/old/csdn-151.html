\n <div class="markdown_views"><h1 id="视图">视图</h1>\n\n<p>以前大学的时候有学过数据库这门课，对视图两个字有点印象，感觉是一个比较难的一个东西，今天刚好跟到了《MySQL必知必会》这个书的第22章视图这一节，于是还是来学习下，在写这篇博文前，花了点时间看了下，反正没有怎么看懂，总是感觉视图这个东西怪怪的。但是我们还是得必须学习它嘛。</p>\n\n<p>听从我们黄杉大师的建议，从这节开始我就不在黑窗口鼓捣了，借助于SQLyog工具来进行数据库的学习，效率可能要高点，这里对黄杉大师的建议表示感谢。下面是黄杉大师的博客地址：<a href="http://blog.csdn.net/mchdba">http://blog.csdn.net/mchdba</a>；有兴趣的可以看看。</p>\n\n<p>废话不多说了，下面我们开始学习视图这一章。</p>\n\n\n\n<h2 id="视图-1">视图</h2>\n\n<p>什么视图？</p>\n\n<p>视图不是实实在在的表，它只是一个虚拟的表，与包含数据的表不一样，视图只包含使用时动态检索数据的查询。</p>\n\n<p>可能看到上面这句话还不是怎么懂什么是视图，个人理解：<font color="red" size="5">视图不是表，是一个查询语句的别名。但是我们可以向操作表一样来操作视图</font></p>\n\n<p>为方便理解视图，看下面这个例子：</p>\n\n<p>在联结表那一节我们有如下的语句</p>\n\n\n\n<pre class="prettyprint"><code class=" hljs sql"><span class="hljs-operator"><span class="hljs-keyword">select</span> cust_name ,cust_tel <span class="hljs-keyword">from</span> customers,orders,ordersitems \n <span class="hljs-keyword">where</span> customers.cust_id=orders.cust_id \n <span class="hljs-keyword">and</span> orders.order_id=ordersitems.order_id \n <span class="hljs-keyword">and</span> ordersitems.content=<span class="hljs-string">'apple'</span>;</span>//查处订单内容中包括apple的客户信息。</code></pre>\n\n<p>如果我们现在想查 订单内容是egg的客户信息，如果没有视图，我们只能更改上面的where 子句的条件。可能如下：</p>\n\n\n\n<pre class="prettyprint"><code class=" hljs sql"><span class="hljs-operator"><span class="hljs-keyword">select</span> cust_name ,cust_tel <span class="hljs-keyword">from</span> customers,orders,ordersitems \n <span class="hljs-keyword">where</span> customers.cust_id=orders.cust_id \n <span class="hljs-keyword">and</span> orders.order_id=ordersitems.order_id \n <span class="hljs-keyword">and</span> ordersitems.content=<span class="hljs-string">'aegg'</span>;</span>//查处订单内容中包括egg的客户信息。</code></pre>\n\n<p>如果我们又想查其它产品的数据，可能还得继续修改，我相信对于这种修改，一是比较容易出错，二是比较繁琐。</p>\n\n<p>有了视图，你就可以看到它在这种情况下所带来的好处了。</p>\n\n<h2 id="创建视图">创建视图</h2>\n\n<p>创建视图的语法为：create view viewName …;</p>\n\n<p>为上面的例子创建一个视图，如下：</p>\n\n\n\n<pre class="prettyprint"><code class=" hljs sql"><span class="hljs-operator"><span class="hljs-keyword">create</span> <span class="hljs-keyword">view</span> cust_informationView\n <span class="hljs-keyword">as</span>\n (<span class="hljs-keyword">select</span> cust_name,cust_tel,content <span class="hljs-keyword">from</span> customers,orders,ordersitems \n <span class="hljs-keyword">where</span> customers.cust_id=orders.cust_id \n <span class="hljs-keyword">and</span> orders.order_id=ordersitem.order_id);</span>//创建视图</code></pre>\n\n<p>创建如上的视图之后，如果我们想查看订单内容中包括apple中的客户信息，则用如下语句就可以完成：</p>\n\n\n\n<pre class="prettyprint"><code class=" hljs sql"><span class="hljs-operator"><span class="hljs-keyword">select</span> cust_name,cust_tel <span class="hljs-keyword">from</span> cust_informationView <span class="hljs-keyword">where</span> content=<span class="hljs-string">'apple'</span>;</span></code></pre>\n\n<p>当我们需要想查看其它内容时，书写就方便了许多，只是需要上面语句的where条件就ok了。而不用每次都像最上面联结表查询语句那样写那么长的查询语句了。</p>\n\n<p>这里我遇到的一个问题就是：</p>\n\n<p>如果在创建视图的时候没有将content 加入到视图中，则使用</p>\n\n\n\n<pre class="prettyprint"><code class=" hljs sql"><span class="hljs-operator"><span class="hljs-keyword">select</span> cust_name,cust_tel <span class="hljs-keyword">from</span> cust_informationView <span class="hljs-keyword">where</span> content=<span class="hljs-string">'apple'</span>;</span></code></pre>\n\n<p>查询是会报错的，报错如下: <br />\n<img src="http://7xknzt.com1.z0.glb.clouddn.com/MySQL_view_v1.PNG" alt="" title="" /></p>\n\n<p>而必须是下面这面创建视图(即加上content)才行：</p>\n\n<p><img src="http://7xknzt.com1.z0.glb.clouddn.com/MySQL_view_v2.PNG" alt="" title="" /></p>\n\n<p>从这个例子可以看出，使用视图有如下好处：</p>\n\n<p>1、重用SQL语句。不需要每次都写非常长的查询语句。</p>\n\n<p>2、简化复杂的SQL操作。在编写查询后，可以方便地重用它而不必知道它的基本查询细节。</p>\n\n<p>3、使用表的组成部分而不是整个表。</p>\n\n<p><strong>在视图创建之后，可以用与表基本相同的方式操作它们。可以对视图执行select操作，过滤和排序数据等等。</strong></p>\n\n<p><font color="red">重要的是知道视图仅仅是用来查看存储在别处的数据的一种措施。视图本身不包含数据，因此它们返回的数据是从其他表中检索出来的。在添加啊或更改这些表中的数据时，视图将返回改变过的数据。</font></p>\n\n<h2 id="视图的其它方面">视图的其它方面</h2>\n\n<p>上面说了创建视图是用 create view语句来实现。而查看视图、删除视图，更新视图的语法如下：</p>\n\n<p>1、使用 show create view viewName;来查看创建视图的语句。</p>\n\n<p>2、使用drop 来删除视图，语法为drop view viewname;</p>\n\n<p>3、要更新视图时，可以先用drop再用create，也可以直接用create or replace view。如果要更新的视图不存在，则第二条更新语句会创建一个视图。如果要更新的视图存在，则第二条语句更新语句会替换原有的视图。</p>\n\n\n\n<h2 id="小结">小结</h2>\n\n<p>关于视图基本就是以上这样的，总的来说就是为了简化操作，使复杂的查询语句 得以简化重用。</p></div>&#13;\n <script type="text/javascript">&#13;\n $(function () {&#13;\n $('pre.prettyprint code').each(function () {&#13;\n var lines = $(this).text().split('\\n').length;&#13;\n var $numbering = $('&lt;ul/&gt;').addClass('pre-numbering').hide();&#13;\n $(this).addClass('has-numbering').parent().append($numbering);&#13;\n for (i = 1; i &lt;= lines; i++) {&#13;\n $numbering.append($('&lt;li/&gt;').text(i));&#13;\n };&#13;\n $numbering.fadeIn(1700);&#13;\n });&#13;\n });&#13;\n </script>&#13;\n &#13;\n
