\n <div class="markdown_views"><h1 id="权限管理">权限管理</h1>\n\n<p>MySQL权限系统通过下面两个阶段进行认证：</p>\n\n<ul>\n<li>对连接的用户进行身份认证，合法的用户通过认证，不合法的用户拒绝连接。</li>\n<li><p>对通过认证的合法用户授予相应的权限，用户可以通过再这些权限范围内对数据库做相应的操作。 <br />\n在权限存取过程中，主要涉及到mysql数据库下user表和db表。user表的数据结构如下： <br />\n<img src="http://img.blog.csdn.net/20160420100600604" alt="这里写图片描述" title="" /> <br />\ndb表数据结构如下： <br />\n<img src="http://img.blog.csdn.net/20160420111648648" alt="这里写图片描述" title="" /> <br />\n表的说明：其中包含用户列、权限列、安全列和资源控制列。用的最频繁的是用户列和权限列，权限分为普通权限和管理权限。普通权限用户数据库的操作如select_priv、insert_priv等。管理权限主要用来对数据库进行管理的操作，比如process_priv、super_priv等。 <br />\n用户进行连接的时候，权限表的存取过程：</p></li>\n<li><p>先从user表中的host、user和password这三个字段中判断连接的ip、用户名以及密码是否存在表中，如果存在，则通过验证，否则拒绝连接。</p></li>\n<li>通过身份验证之后，按照以下权限表的顺序得到数据库权限：user-&gt;db-&gt;tables-&gt;priv-&gt;columns_priv。全局权限，覆盖局部权限。比如一个用户在user表中拥有选择权限，那么他将对所有数据中的所有表所有的列都有选择权限。 <br />\n<img src="http://img.blog.csdn.net/20160420113134216" alt="这里写图片描述" title="" /> <br />\n权限查找详细描述：当用户通过权限认证之后，进行权限分配时候，按照user-&gt;db-&gt;tables_priv-&gt;columns_priv的顺序进行权限分配，即先检查权限表user，如果user表中对应的权限为Y，此时用户对应所有的数据库权限为Y,将不再检查db、tables_priv、columns_priv;如果为N，则到db表中进行查找用户对于具体数据库权限，如果得到db中的Y权限，则不在查找，否则检查tables_priv,看该数据库对应的具体表权限，如果为Y，则不在查找，否则检查columns_priv表，查看对应的具体列权限。这一点对于我们授予用户权限很重要。</li>\n</ul>\n\n\n\n<h1 id="账号管理">账号管理</h1>\n\n\n\n<h2 id="创建用户">创建用户</h2>\n\n<p>创建用户，可以使用grant语法创建或者直接操作user表。 <br />\n方法一： <br />\n直接操作use表 <br />\ninsert into user(<code>Host</code>,<code>User</code>,<code>Password</code>) values(“127.0.0.1”,”test”,password(“51testit”)); <br />\n方法二： <br />\n格式 CREATE USER ‘username’@’host’ IDENTIFIED BY ‘password’; <br />\neg:CREATE USER ‘test’@’127.0.0.1’ IDENTIFIED BY ‘51testit’; <br />\n<img src="http://img.blog.csdn.net/20160420093944800" alt="这里写图片描述" title="" /> <br />\n创建之后，登录如下： <br />\n<img src="http://img.blog.csdn.net/20160420093934722" alt="这里写图片描述" title="" /> <br />\nMySQL加密方式： MYSQL323加密中生成的是16位字符串，而在MySQLSHA1中生存的是41位字符串，其中<em>是不加入实际的密码运算中，通过观察在很多用户中都携带了”</em>“，在实际破解过程中去掉”*”，也就是说MySQLSHA1加密的密码的实际位数是40位。 <br />\nHost字段描述</p>\n\n<ul>\n<li>Host值可以是主机名或者IP号，或者locahost代表本地主机。</li>\n<li>可以再host列值前面使用通配符”%”和”_”，”%”代表匹配任何主机，空的Host值等于”%”。如”%.myweb.com”,匹配所有mysql.com域的所有主机。案例如下：</li>\n</ul>\n\n<table>\n<thead>\n<tr>\n <th>Host</th>\n <th align="center">User</th>\n <th align="right">解析</th>\n</tr>\n</thead>\n<tbody><tr>\n <td>myweb.wang</td>\n <td align="center">pps</td>\n <td align="right">pps，从myweb.wang连接</td>\n</tr>\n<tr>\n <td>%</td>\n <td align="center">pps</td>\n <td align="right">pps，从任何主机连接</td>\n</tr>\n<tr>\n <td>%</td>\n <td align="center">”</td>\n <td align="right">任何用户，从任何主机连接</td>\n</tr>\n<tr>\n <td>122.164.35.127</td>\n <td align="center">pps</td>\n <td align="right">pps，从122.164.35.127连接</td>\n</tr>\n<tr>\n <td>122.164.35.%</td>\n <td align="center">pps</td>\n <td align="right">pps，从122.164.35.类型子网的任何主机连接</td>\n</tr>\n</tbody></table>\n\n\n\n\n<h2 id="查看用户权限">查看用户权限</h2>\n\n<p>对于上面创建的test，我没有进行任何授权操作，当我使用test用户去操作数据库时候，发现： <br />\n<img src="http://img.blog.csdn.net/20160420094343087" alt="这里写图片描述" title="" /> <br />\n没有数据库操作权限，怎样才能查看用户拥有的权限呢？ <br />\n查看权限 <br />\n方法一： <br />\nshow grants for test@127.0.0.1; <br />\n方法二： <br />\n查看user表中记录的权限。 <br />\nselect csdn-100.html csdn-101.html csdn-102.html csdn-103.html csdn-104.html csdn-105.html csdn-106.html csdn-107.html csdn-108.html csdn-109.html csdn-10.html csdn-110.html csdn-111.html csdn-112.html csdn-113.html csdn-114.html csdn-115.html csdn-116.html csdn-117.html csdn-118.html csdn-119.html csdn-11.html csdn-120.html csdn-121.html csdn-122.html csdn-123.html csdn-124.html csdn-125.html csdn-126.html csdn-127.html csdn-128.html csdn-129.html csdn-12.html csdn-130.html csdn-131.html csdn-132.html csdn-133.html csdn-134.html csdn-135.html csdn-136.html csdn-137.html csdn-138.html csdn-139.html csdn-13.html csdn-140.html csdn-141.html csdn-142.html csdn-143.html csdn-144.html csdn-145.html csdn-146.html csdn-147.html csdn-148.html csdn-149.html csdn-14.html csdn-150.html csdn-151.html csdn-152.html csdn-153.html csdn-154.html csdn-15.html csdn-16.html csdn-17.html csdn-18.html csdn-19.html csdn-1.html csdn-20.html csdn-21.html csdn-22.html csdn-23.html csdn-24.html csdn-25.html csdn-26.html csdn-27.html csdn-28.html csdn-29.html csdn-2.html csdn-30.html csdn-31.html csdn-32.html csdn-33.html csdn-34.html csdn-35.html csdn-36.html csdn-37.html csdn-38.html csdn-39.html csdn-3.html csdn-40.html csdn-41.html csdn-42.html csdn-43.html csdn-44.html csdn-45.html csdn-46.html csdn-47.html csdn-48.html csdn-49.html csdn-4.html csdn-50.html csdn-51.html csdn-52.html csdn-53.html csdn-54.html csdn-55.html csdn-56.html csdn-57.html csdn-58.html csdn-59.html csdn-5.html csdn-60.html csdn-61.html csdn-62.html csdn-63.html csdn-64.html csdn-65.html csdn-66.html csdn-67.html csdn-68.html csdn-69.html csdn-6.html csdn-70.html csdn-71.html csdn-72.html csdn-73.html csdn-74.html csdn-75.html csdn-76.html csdn-77.html csdn-78.html csdn-79.html csdn-7.html csdn-80.html csdn-81.html csdn-82.html csdn-83.html csdn-84.html csdn-85.html csdn-86.html csdn-87.html csdn-88.html csdn-89.html csdn-8.html csdn-90.html csdn-91.html csdn-92.html csdn-93.html csdn-94.html csdn-95.html csdn-96.html csdn-97.html csdn-98.html csdn-99.html csdn-9.html mysql.sh from mysql.user where user=’test’ and host=’127.0.0.1’ \\G; <br />\n<img src="http://img.blog.csdn.net/20160420095239644" alt="这里写图片描述" title="" /></p>\n\n\n\n<h2 id="授予权限">授予权限</h2>\n\n<p>语法格式如下： <br />\ngrant [privilege1|privilege2|all privileges] on dbName|<em>.tableName 或</em> to user@hostName ; <br />\n当给test用户授予xxpt选择权限时候： <br />\ngrant select On xxpt.* to test.127.0.0.1; <br />\ndb表发生了变化，新增加一条记录。但是user表并没有改变。如下： <br />\n<img src="http://img.blog.csdn.net/20160420101637913" alt="这里写图片描述" title="" /> <br />\n此时，可以使用test用户进行数据查询操作，但是不能进行增、删、改。于是授予其关于xxpt数据库的所有权限。 <br />\ngrant all privileges on xxpt.* to test@127.0.0.1; <br />\n用户test权限如下： <br />\n<img src="http://img.blog.csdn.net/20160420102035433" alt="这里写图片描述" title="" /> <br />\n此时可以更新数据 <br />\n<img src="http://img.blog.csdn.net/20160420102402267" alt="这里写图片描述" title="" /> <br />\n管理权限sueper、process、file授予 <br />\ngrant sueper,process,file On <em>.</em> to ‘test’@’127.0.0.1’; <br />\n语句中on后面只能是<em>.</em> <br />\n备注：usage 权限用于登录，不能进行任何操作。</p>\n\n\n\n<h2 id="删除权限">删除权限</h2>\n\n<p>使用grant新增权限，使用revoke进行权限回收。当然回收权限，也可以直接对user、db、tables_priv和columns_priv表进行操作。但是usage权限是没法收回的。 <br />\n如回收test对所有数据库的读写权限： <br />\nrevoke select ,insert on <em>.</em> from test@127.0.0.1;</p>\n\n\n\n<h2 id="修改密码">修改密码</h2>\n\n<p>1.使用mysqladmin <br />\n2.使用set password for test@127.0.0.1 =password(‘isayhello’); <br />\n3.通过grant usage <br />\ngrant usage on <em>.</em> to ‘test’@’127.0.0.1’ identified by ‘isayhello’; <br />\n4.直接修改user表 <br />\nupdate user set Password=password(“newpassword”) where <strong><em>***</em></strong>;</p>\n\n\n\n<h1 id="补充mysql中权限">补充mysql中权限</h1>\n\n<table border="1" cellpadding="0">\n <tbody>\n <tr>\n <td>\n <p align="left">\n <strong>权限</strong>\n </p>\n </td>\n <td>\n <p align="left">\n <strong>权限级别</strong>\n </p>\n </td>\n <td valign="top">\n <p align="left">\n <strong>权限说明</strong>\n </p>\n </td>\n </tr>\n <tr>\n <td>\n <p align="left">\n CREATE\n </p>\n </td>\n <td>\n <p align="left">\n 数据库、表或索引\n </p>\n </td>\n <td valign="top">\n <p align="left">\n 创建数据库、表或索引权限\n </p>\n </td>\n </tr>\n <tr>\n <td>\n <p align="left">\n DROP\n </p>\n </td>\n <td>\n <p align="left">\n 数据库或表\n </p>\n </td>\n <td valign="top">\n <p align="left">\n 删除数据库或表权限\n </p>\n </td>\n </tr>\n <tr>\n <td>\n <p align="left">\n GRANT OPTION\n </p>\n </td>\n <td>\n <p align="left">\n 数据库、表或保存的程序\n </p>\n </td>\n <td valign="top">\n <p align="left">\n 赋予权限选项\n </p>\n </td>\n </tr>\n <tr>\n <td>\n <p align="left">\n REFERENCES\n </p>\n </td>\n <td>\n <p align="left">\n 数据库或表\n </p>\n </td>\n <td valign="top">\n <p align="left">\n  \n </p>\n </td>\n </tr>\n <tr>\n <td>\n <p align="left">\n ALTER\n </p>\n </td>\n <td>\n <p align="left">\n 表\n </p>\n </td>\n <td valign="top">\n <p align="left">\n 更改表，比如添加字段、索引等\n </p>\n </td>\n </tr>\n <tr>\n <td>\n <p align="left">\n DELETE\n </p>\n </td>\n <td>\n <p align="left">\n 表\n </p>\n </td>\n <td valign="top">\n <p align="left">\n 删除数据权限\n </p>\n </td>\n </tr>\n <tr>\n <td>\n <p align="left">\n INDEX\n </p>\n </td>\n <td valign="top">\n <p align="left">\n 表\n </p>\n </td>\n <td valign="top">\n <p align="left">\n 索引权限\n </p>\n </td>\n </tr>\n <tr>\n <td>\n <p align="left">\n INSERT\n </p>\n </td>\n <td valign="top">\n <p align="left">\n 表\n </p>\n </td>\n <td valign="top">\n <p align="left">\n 插入权限\n </p>\n </td>\n </tr>\n <tr>\n <td>\n <p align="left">\n SELECT\n </p>\n </td>\n <td valign="top">\n <p align="left">\n 表\n </p>\n </td>\n <td valign="top">\n <p align="left">\n 查询权限\n </p>\n </td>\n </tr>\n <tr>\n <td>\n <p align="left">\n UPDATE\n </p>\n </td>\n <td valign="top">\n <p align="left">\n 表\n </p>\n </td>\n <td valign="top">\n <p align="left">\n 更新权限\n </p>\n </td>\n </tr>\n <tr>\n <td>\n <p align="left">\n CREATE VIEW\n </p>\n </td>\n <td>\n <p align="left">\n 视图\n </p>\n </td>\n <td valign="top">\n <p align="left">\n 创建视图权限\n </p>\n </td>\n </tr>\n <tr>\n <td>\n <p align="left">\n SHOW VIEW\n </p>\n </td>\n <td>\n <p align="left">\n 视图\n </p>\n </td>\n <td valign="top">\n <p align="left">\n 查看视图权限\n </p>\n </td>\n </tr>\n <tr>\n <td>\n <p align="left">\n ALTER ROUTINE\n </p>\n </td>\n <td valign="top">\n <p align="left">\n 存储过程\n </p>\n </td>\n <td valign="top">\n <p align="left">\n 更改存储过程权限\n </p>\n </td>\n </tr>\n <tr>\n <td>\n <p align="left">\n CREATE ROUTINE\n </p>\n </td>\n <td valign="top">\n <p align="left">\n 存储过程\n </p>\n </td>\n <td valign="top">\n <p align="left">\n 创建存储过程权限\n </p>\n </td>\n </tr>\n <tr>\n <td>\n <p align="left">\n EXECUTE\n </p>\n </td>\n <td valign="top">\n <p align="left">\n 存储过程\n </p>\n </td>\n <td valign="top">\n <p align="left">\n 执行存储过程权限\n </p>\n </td>\n </tr>\n <tr>\n <td>\n <p align="left">\n FILE\n </p>\n </td>\n <td>\n <p align="left">\n 服务器主机上的文件访问\n </p>\n </td>\n <td valign="top">\n <p align="left">\n 文件访问权限\n </p>\n </td>\n </tr>\n <tr>\n <td>\n <p align="left">\n CREATE TEMPORARY TABLES\n </p>\n </td>\n <td>\n <p align="left">\n 服务器管理\n </p>\n </td>\n <td valign="top">\n <p align="left">\n 创建临时表权限\n </p>\n </td>\n </tr>\n <tr>\n <td>\n <p align="left">\n LOCK TABLES\n </p>\n </td>\n <td valign="top">\n <p align="left">\n 服务器管理\n </p>\n </td>\n <td valign="top">\n <p align="left">\n 锁表权限\n </p>\n </td>\n </tr>\n <tr>\n <td>\n <p align="left">\n CREATE USER\n </p>\n </td>\n <td valign="top">\n <p align="left">\n 服务器管理\n </p>\n </td>\n <td valign="top">\n <p align="left">\n 创建用户权限\n </p>\n </td>\n </tr>\n <tr>\n <td>\n <p align="left">\n PROCESS\n </p>\n </td>\n <td valign="top">\n <p align="left">\n 服务器管理\n </p>\n </td>\n <td valign="top">\n <p align="left">\n 查看进程权限\n </p>\n </td>\n </tr>\n <tr>\n <td>\n <p align="left">\n RELOAD\n </p>\n </td>\n <td valign="top">\n <p align="left">\n  \n </p>\n <p align="left">\n  \n </p>\n <p align="left">\n 服务器管理\n </p>\n </td>\n <td valign="top">\n <p>\n 执行flush-hosts, flush-logs, flush-privileges, flush-status, flush-tables, flush-threads, refresh, reload等命令的权限\n </p>\n </td>\n </tr>\n <tr>\n <td>\n <p align="left">\n REPLICATION CLIENT\n </p>\n </td>\n <td valign="top">\n <p align="left">\n 服务器管理\n </p>\n </td>\n <td valign="top">\n <p align="left">\n 复制权限\n </p>\n </td>\n </tr>\n <tr>\n <td>\n <p align="left">\n REPLICATION SLAVE\n </p>\n </td>\n <td valign="top">\n <p align="left">\n 服务器管理\n </p>\n </td>\n <td valign="top">\n <p align="left">\n 复制权限\n </p>\n </td>\n </tr>\n <tr>\n <td>\n <p align="left">\n SHOW DATABASES\n </p>\n </td>\n <td valign="top">\n <p align="left">\n 服务器管理\n </p>\n </td>\n <td valign="top">\n <p align="left">\n 查看数据库权限\n </p>\n </td>\n </tr>\n <tr>\n <td>\n <p align="left">\n SHUTDOWN\n </p>\n </td>\n <td valign="top">\n <p align="left">\n 服务器管理\n </p>\n </td>\n <td valign="top">\n <p align="left">\n 关闭数据库权限\n </p>\n </td>\n </tr>\n <tr>\n <td>\n <p align="left">\n SUPER\n </p>\n </td>\n <td valign="top">\n <p align="left">\n 服务器管理\n </p>\n </td>\n <td valign="top">\n <p align="left">\n 执行kill线程权限\n </p>\n </td>\n </tr>\n </tbody>\n</table>\n\n<p>\n  \n</p>\n\n<p>\n MYSQL的权限如何分布，就是针对表可以设置什么权限，针对列可以设置什么权限等等，这个可以从官方文档中的一个表来说明：\n</p>\n\n<table border="1" cellpadding="0" width="480">\n <tbody>\n <tr>\n <td>\n <p align="left">\n 权限分布\n </p>\n </td>\n <td>\n <p align="left">\n 可能的设置的权限\n </p>\n </td>\n </tr>\n <tr>\n <td>\n <p align="left">\n 表权限\n </p>\n </td>\n <td>\n <p align="left">\n ‘Select’, ‘Insert’, ‘Update’, ‘Delete’, ‘Create’, ‘Drop’, ‘Grant’, ‘References’, ‘Index’, ‘Alter’\n </p>\n </td>\n </tr>\n <tr>\n <td>\n <p align="left">\n 列权限\n </p>\n </td>\n <td>\n <p align="left">\n ‘Select’, ‘Insert’, ‘Update’, ‘References’\n </p>\n </td>\n </tr>\n <tr>\n <td>\n <p align="left">\n 过程权限\n </p>\n </td>\n <td>\n <p align="left">\n ‘Execute’, ‘Alter Routine’, ‘Grant’\n </p>\n <div>\n <br />\n\n </div>\n </td>\n </tr>\n </tbody>\n</table></div>&#13;\n <script type="text/javascript">&#13;\n $(function () {&#13;\n $('pre.prettyprint code').each(function () {&#13;\n var lines = $(this).text().split('\\n').length;&#13;\n var $numbering = $('&lt;ul/&gt;').addClass('pre-numbering').hide();&#13;\n $(this).addClass('has-numbering').parent().append($numbering);&#13;\n for (i = 1; i &lt;= lines; i++) {&#13;\n $numbering.append($('&lt;li/&gt;').text(i));&#13;\n };&#13;\n $numbering.fadeIn(1700);&#13;\n });&#13;\n });&#13;\n </script>&#13;\n &#13;\n
