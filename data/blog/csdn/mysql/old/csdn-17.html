\n\n<pre name="code" class="sql">/*\n存储过程：带有逻辑的sql语句，普通的sql没有条件判断，没有循环，存储过程带上流程控制语句（if while）\n存储过程特点：\n\t1）执行效率非常快！存储过程是在数据库的服务器端执行的！！！\n\t2）移植性很差！不同数据库的存储过程是不能移植。\n*/\nUSE mydb;\n-- *******************存储过程*******************\n-- ***创建存储过程\nDELIMITER $ -- 声明存储过程的结束符，这里的结束符可以是任意符号，一般是$\nCREATE PROCEDURE pro_test() -- 存储过程名称(参数列表)\nBEGIN -- 开始\n\tSELECT csdn-10.html csdn-11.html csdn-12.html csdn-13.html csdn-14.html csdn-15.html csdn-16.html csdn-1.html csdn-2.html csdn-3.html csdn-4.html csdn-5.html csdn-6.html csdn-7.html csdn-8.html csdn-9.html mysql.sh FROM emp; -- 可以写多个sql语句+流程控制\nEND $ -- 结束符\n-- ***执行存储过程\nCALL pro_test(); -- call 存储过程名称(参数列表)\n/*\n*******参数列表*******\n\tIN：表示输入参数，可以携带一些数据存储到过程中\n\tOUT：表示输出参数，可以从存储过程中返回结果\n\tINOUT：表示输入输出参数，既有输入功能，也有输出功能\n*/\n-- ***1.带有存储输入参数的存储过程\n-- 需求：传入一个员工的id，查询员工信息\nDELIMITER $\nCREATE PROCEDURE pro_findById(IN eid INT ) -- 存储过程名称(IN 参数名 参数类型)\nBEGIN\n\tSELECT csdn-10.html csdn-11.html csdn-12.html csdn-13.html csdn-14.html csdn-15.html csdn-16.html csdn-1.html csdn-2.html csdn-3.html csdn-4.html csdn-5.html csdn-6.html csdn-7.html csdn-8.html csdn-9.html mysql.sh FROM emp WHERE id=eid;\nEND $\n-- 调用\nCALL pro_findById(2); -- 传入实参\n-- ***2.带有输出参数的存储过程\nDELIMITER $\nCREATE PROCEDURE pro_testOut(OUT str VARCHAR(20)) -- 存储过程名称(OUT 参数名 参数类型)\nBEGIN\n\t-- 给参数赋值\n\tSET str = "这是一个输出参数";\nEND $\n-- 调用存储过程。获取返回值。\n-- 定义一个会话变量\nCALL pro_testOut(@outStr);-- 直接定义一个会话变量outStr，并把返回值赋给这个会话变量\n-- 查看返回值\nSELECT @outStr;\n/*\n*******MySQL的变量*******\n***全局变量（内置变量）：MySQL数据库内置的变量。（所有连接中都起作用）\n\t查看MySQL所有全局变量：SHOW VARIABLES;\n\t查看某个全局变量：select @@变量名;\n\t修改全局变量：set 变量名=新值;\n***会话变量：只存在于当前的客户端与数据库服务器端的一次连接当中，如果连接断开，那么会话变量全部丢失。\n\t定义会话变量：set @变量=值;\n\t查看会话变量：select @变量;\n***局部变量：在存储过程中使用的变量就叫局部变量。只要存储过程执行完毕，局部变量就丢失。\n\t定义局部变量：declare 变量名 变量类型 default 默认值;\n\t设置局部变量值：set 变量=值;\n\t查看局部变量：select 变量;\n*/\nSET @NAME = "木丁西";\nSELECT @NAME;\n-- ***4.删除存储过程\nDROP PROCEDURE pro_testOut;\n-- ***5.带有输入输出参数的存储过程\nDELIMITER $\nCREATE PROCEDURE pro_testInOut(INOUT para INT) -- INOUT 输入输出参数\t\nBEGIN\n\t-- 查看局部变量\n\tSELECT para; -- 注意：这里para是局部变量，不再是定义的会话变量了。\n\t-- 设置局部变量\n\tSET para = 200;\nEND $ \n-- 调用输入输出参数的存储过程\nSET @para = 10; -- 定义会话变量\nCALL pro_testInout(@para); -- 结果：10\nSELECT @para; -- 结果：200\n-- 删除存储过程\nDROP PROCEDURE pro_testInOut;\n-- ***6.带有条件判断的存储过程 -- if elseif end if 注意：elseif连写\n-- 需求：输入一个整数，如果1，则返回“星期一”， 若果2，返回“星期二”，若果3，返回“星期三”， 其它数字，返回“错误输入”\nDELIMITER $\nCREATE PROCEDURE pro_testIf(IN num INT, OUT str VARCHAR(20))\nBEGIN\n\tIF num=1 THEN\n\t\tSET str = "星期一";\n\tELSEIF num=2 THEN\n\t\tSET str = "星期二";\n\tELSEIF num=3 THEN\n\t\tSET str = "星期三";\n\tELSE \n\t\tSET str = "输入错误";\n\tEND IF;\t\nEND $\n-- 调用带有条件判断的存储过程\nCALL pro_testIf(4, @str);\n-- 查看返回值\nSELECT @str;\n-- ***6.带有循环功能的存储过程 \n-- 需求：输入一个整数，求和。例如：输入100，统计1-100的和。\nDELIMITER $\nCREATE PROCEDURE pro_testWhile(IN num INT, OUT result INT)\nBEGIN\n\t-- 定义一个局部变量\n\tDECLARE i INT DEFAULT 1;\n\tDECLARE isum INT DEFAULT 0;\n\tWHILE i&lt;=num DO\n\t\tSET isum = isum+i;\n\t\tSET i = i+1;\n\tEND WHILE; -- 结束循环\n\tSET result = isum;\nEND $\n-- 调用带有循环功能的存储过程 \nCALL pro_testWhile(100, @result);\nSELECT @result;\n-- ***7.使用查询的结果作为返回值。（查询的值 into 返回值变量）\nDELIMITER $\nCREATE PROCEDURE pro_findById(IN eid INT, OUT ename VARCHAR(20))\nBEGIN\n\tSELECT emp.empName INTO ename FROM emp WHERE emp.id = eid;\nEND $\n-- 调用\nCALL pro_findById(2, @ename);\nSELECT @ename;\nDROP PROCEDURE pro_findById;\nSELECT csdn-10.html csdn-11.html csdn-12.html csdn-13.html csdn-14.html csdn-15.html csdn-16.html csdn-1.html csdn-2.html csdn-3.html csdn-4.html csdn-5.html csdn-6.html csdn-7.html csdn-8.html csdn-9.html mysql.sh FROM emp;\n-- *****************存储过程案例*******************************\n/*\n编写一个存储过程 \n\t如果学生的英语平均分小于等于70分，则输出'一般'\n\t如果学生的英语平均分大于70分，且小于等于90分，则输出‘良好’\n\t如果学生的英语平均分大于90分，则输出‘优秀’\n*/\nDELIMITER $\nCREATE PROCEDURE pro_testStuAvg(OUT result VARCHAR(20))\nBEGIN\n\t-- 定义局部变量，接受平均分\n\tDECLARE savg DOUBLE;\n\tSELECT AVG(english) INTO savg FROM student;\n\tIF savg&lt;=70 THEN\n\t\tSET result = "一般";\n\tELSEIF savg&gt;70 AND savg&lt;=90 THEN\n\t\tSET result = "良好";\n\tELSE\n\t\tSET result = "优秀";\n\tEND IF;\nEND $\n-- 调用\nCALL pro_testStuAvg(@result);\nSELECT @result;\nDROP PROCEDURE pro_testStuAvg;\nSELECT csdn-10.html csdn-11.html csdn-12.html csdn-13.html csdn-14.html csdn-15.html csdn-16.html csdn-1.html csdn-2.html csdn-3.html csdn-4.html csdn-5.html csdn-6.html csdn-7.html csdn-8.html csdn-9.html mysql.sh FROM student;\n</pre><br />&#13;\n &#13;\n
