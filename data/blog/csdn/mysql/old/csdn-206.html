\n\n<span id="ArticleContent1_ArticleContent1_lblContent">Mysql 学习笔记<br />&#13;\n1、安装 环境：<br />&#13;\n     Windows 7<br />&#13;\n     Mysql 5.5 从 <a target="_blank" href="http://www.mysql.com/">&#13;\nhttp://www.mysql.com</a>下载<br />&#13;\n     EMS Mysql Query 1.6.0.1<br />&#13;\n     本机IP：172.5.1.183<br />&#13;\n2、安装Mysql，采用默认安装即可<br />&#13;\n   目录选择在c:\\mysql，不要修改默认目录<br />&#13;\n3、启动Mysql<br />&#13;\n   安装为服务：c:\\mysql\\bin\\mysqld --install<br />&#13;\n   启动Mysql: net start mysql<br />&#13;\n   停止Mysql: net stop mysql<br />&#13;\n4、 系统创建的数据库有mysql,test<br />&#13;\n   mysql保存系统数据<br />&#13;\n   test数据库用来测试<br />&#13;\n5、默认登陆方式<br />&#13;\n   在本机<br />&#13;\n     c:\\mysql\\bin\\mysql -uroot <br />&#13;\n     c:\\mysql\\bin\\mysql<br />&#13;\n   远程<br />&#13;\n     mysql -h 172.5.1.183 -uroot<br />&#13;\n   <br />&#13;\n   这些是在mysql.user表中，系统默认存在4条数据<br />&#13;\n        use mysql<br />&#13;\n        select host,user,password from user;<br />&#13;\n        +-----------+------+----------+<br />&#13;\n | host      | user | password |<br />&#13;\n +-----------+------+----------+<br />&#13;\n | localhost | root |          |<br />&#13;\n | %         | root |          |<br />&#13;\n | localhost |      |          |<br />&#13;\n | %         |      |          |<br />&#13;\n +-----------+------+----------+<br />&#13;\n   <br />&#13;\n   这些数据代表的意义：<br />&#13;\n     用户名为root，密码为空的用户可以从本机和任何远程主机登陆<br />&#13;\n     任何用户名，密码为空的用户可以从本机登陆<br />&#13;\n     用户名为空，密码为空的用户不可以从远程登陆 （user中后面的字段为N，所以无法登陆）<br />&#13;\n   修改root密码<br />&#13;\n     mysql -uroot <br />&#13;\n     use mysql<br />&#13;\n     update user set password=PASSWORD("root") where user='root' and host='localhost'<br />&#13;\n   下次就需要用mysql -uroot -proot才可以登陆<br />&#13;\n   在远程或本机可以使用 mysql -h 172.5.1.183 -uroot 登陆，这个根据第二行的策略确定 <br />&#13;\n   权限修改生效：<br />&#13;\n</span><pre code_snippet_id="618457" snippet_file_name="blog_20150313_1_3173471" name="code" class="sql"> 1)net stop mysql\n net start mysql\n 2)c:\\mysql\\bin\\mysqladmin flush-privileges</pre>      3)登陆mysql后，用flush privileges语句<br />&#13;\n6、创建数据库staffer<br />&#13;\n   create database staffer;<br />&#13;\n7、下面的语句在mysql环境在执行<br />&#13;\n   显示用户拥有权限的数据库       show databases;<br />&#13;\n   切换到staffer数据库       use staffer;<br />&#13;\n   显示当前数据库中有权限的表 show tables;<br />&#13;\n   显示表staffer的结构   desc staffer;<br />&#13;\n8、创建测试环境<br />&#13;\n   1)创建数据库staffer<br />&#13;\n     mysql&gt; create database staffer<br />&#13;\n   2)创建表staffer,department,position,depart_pos<br />&#13;\n    <pre code_snippet_id="618457" snippet_file_name="blog_20150313_2_1617860" name="code" class="sql"> create table s_position\n (\n id int not null auto_increment,\n name varchar(20) not null default '经理', #设定默认值\n description varchar(100),\n primary key PK_positon (id) #设定主键\n ); \n create table department\n (\n id int not null auto_increment,\n name varchar(20) not null default '系统部', #设定默认值\n description varchar(100),\n primary key PK_department (id) #设定主键\n );\n create table depart_pos\n (\n department_id int not null,\n position_id int not null,\n primary key PK_depart_pos (department_id,position_id) #设定复和主键\n );\n create table staffer\n (\n id int not null auto_increment primary key, #设定主键\n name varchar(20) not null default '无名氏', #设定默认值\n department_id int not null,\n position_id int not null,\n unique (department_id,position_id) #设定唯一值\n );</pre><br />&#13;\n   3)删除<br />&#13;\n     mysql&gt;<br />&#13;\n        drop table depart_pos;<br />&#13;\n        drop table department;<br />&#13;\n        drop table s_position;<br />&#13;\n        drop table staffer;<br />&#13;\n        drop database staffer;<br />&#13;\n9、修改结构<br />&#13;\n   mysql&gt;<br />&#13;\n   #表position增加列test<br />&#13;\n   alter table position add(test char(10)); <br />&#13;\n   #表position修改列test<br />&#13;\n   alter table position modify test char(20) not null;<br />&#13;\n   #表position修改列test默认值<br />&#13;\n   alter table position alter test set default 'system';<br />&#13;\n   #表position去掉test默认值<br />&#13;\n   alter table position alter test drop default;<br />&#13;\n   #表position去掉列test<br />&#13;\n   alter table position drop column test;<br />&#13;\n   #表depart_pos删除主键<br />&#13;\n   alter table depart_pos drop primary key;<br />&#13;\n   #表depart_pos增加主键<br />&#13;\n   alter table depart_pos add primary key PK_depart_pos (department_id,position_id);<br />&#13;\n10、操作数据<br />&#13;\n   #插入表department<br />&#13;\n   insert into department(name,description) values('系统部','系统部');<br />&#13;\n   insert into department(name,description) values('公关部','公关部');<br />&#13;\n   insert into department(name,description) values('客服部','客服部');<br />&#13;\n   insert into department(name,description) values('财务部','财务部');<br />&#13;\n   insert into department(name,description) values('测试部','测试部');<br />&#13;\n   #插入表s_position<br />&#13;\n   insert into s_position(name,description) values('总监','总监');<br />&#13;\n   insert into s_position(name,description) values('经理','经理');<br />&#13;\n   insert into s_position(name,description) values('普通员工','普通员工');<br />&#13;\n   #插入表depart_pos<br />&#13;\n   insert into depart_pos(department_id,position_id)<br />&#13;\n   select a.id department_id,b.id postion_id<br />&#13;\n   from department a,s_position b;<br />&#13;\n   #插入表staffer<br />&#13;\n   insert into staffer(name,department_id,position_id) values('陈达治',1,1);<br />&#13;\n   insert into staffer(name,department_id,position_id) values('李文宾',1,2);<br />&#13;\n   insert into staffer(name,department_id,position_id) values('马佳',1,3);<br />&#13;\n   insert into staffer(name,department_id,position_id) values('亢志强',5,1);<br />&#13;\n   insert into staffer(name,department_id,position_id) values('杨玉茹',4,1);<br />&#13;\n11、 查询及删除操作<br />&#13;\n   #显示系统部的人员和职位<br />&#13;\n   select a.name,b.name department_name,c.name position_name<br />&#13;\n   from staffer a,department b,s_position c<br />&#13;\n   where a.department_id=b.id and a.position_id=c.id and b.name='系统部';<br />&#13;\n   #显示系统部的人数<br />&#13;\n   select count(*) from staffer a,department b<br />&#13;\n   where a.department_id=b.id and b.name='系统部'<br />&#13;\n   #显示各部门的人数<br />&#13;\n   select count(*) cou,b.name<br />&#13;\n   from staffer a,department b<br />&#13;\n   where a.department_id=b.id<br />&#13;\n   group by b.name;<br />&#13;\n   #删除客服部<br />&#13;\n   delete from department where name='客服部';<br />&#13;\n   #将财务部修改为财务一部<br />&#13;\n   update department set name='财务一部' where name='财务部';<br />&#13;\n12、 备份和恢复 <br />&#13;\n    备份数据库staffer<br />&#13;\n     c:\\mysql\\bin\\mysqldump -uroot -proot staffer&gt;e:\\staffer.sql<br />&#13;\n     得到的staffer.sql是一个sql脚本，不包括建库的语句，所以你需要手工<br />&#13;\n     创建数据库才可以导入<br />&#13;\n    恢复数据库staffer,需要创建一个空库staffer<br />&#13;\n     c:\\mysql\\bin\\mysql -uroot -proot staffer&lt;staffer.sql<br />&#13;\n     如果不希望后来手工创建staffer,可以<br />&#13;\n     c:\\mysql\\bin\\mysqldump -uroot -proot --databases staffer&gt;e:\\staffer.sql<br />&#13;\n     mysql -uroot -proot &gt;e:\\staffer.sql<br />&#13;\n     但这样的话系统种就不能存在staffer库，且无法导入其他名字的数据库，<br />&#13;\n     当然你可以手工修改staffer.sql文件<br />&#13;\n13、 从文本向数据库导入数据<br />&#13;\n    1)使用工具c:\\mysql\\bin\\mysqlimport<br />&#13;\n    这个工具的作用是将文件导入到和去掉文件扩展名名字相同的表里，如<br />&#13;\n    staffer.txt,staffer都是导入到staffer表中<br />&#13;\n    常用选项及功能如下 <br />&#13;\n -d or --delete 新数据导入数据表中之前删除数据数据表中的所有信息 <br />&#13;\n -f or --force 不管是否遇到错误，mysqlimport将强制继续插入数据 <br />&#13;\n -i or --ignore mysqlimport跳过或者忽略那些有相同唯一 <br />&#13;\n 关键字的行， 导入文件中的数据将被忽略。 <br />&#13;\n -l or -lock-tables 数据被插入之前锁住表，这样就防止了， <br />&#13;\n 你在更新数据库时，用户的查询和更新受到影响。 <br />&#13;\n -r or -replace 这个选项与－i选项的作用相反；此选项将替代 <br />&#13;\n 表中有相同唯一关键字的记录。 <br />&#13;\n --fields-enclosed- by= char <br />&#13;\n 指定文本文件中数据的记录时以什么括起的， 很多情况下 <br />&#13;\n 数据以双引号括起。 默认的情况下数据是没有被字符括起的。 <br />&#13;\n --fields-terminated- by=char <br />&#13;\n 指定各个数据的值之间的分隔 符，在句号分隔的文件中， <br />&#13;\n 分隔符是句号。您可以用此选项指定数据之间的分隔符。 <br />&#13;\n 默认的分隔符是跳格符（Tab） <br />&#13;\n --lines-terminated- by=str <br />&#13;\n 此选项指定文本文件中行与行之间数据的分隔字符串 <br />&#13;\n 或者字符。 默认的情况下mysqlimport以newline为行分隔符。 <br />&#13;\n 您可以选择用一个字符串来替代一个单个的字符： <br />&#13;\n 一个新行或者一 个回车。 <br />&#13;\n mysqlimport命令常用的选项还有-v 显示版本（version）， <br />&#13;\n            -p 提示输入密码（password）等。<br />&#13;\n   这个工具有个问题，无法忽略某些列，这样对我们的数据导入有很大的麻烦，虽然<br />&#13;\n   可以手工设置这个字段，但会出现莫名其妙的结果，我们做一个简单的示例<br />&#13;\n   我们定义如下的depart_no.txt，保存在e盘，间隔为制表符\\t<br />&#13;\n 10 10<br />&#13;\n 11 11<br />&#13;\n 12 24 <br />&#13;\n 执 行如下命令<br />&#13;\n    c:\\mysql\\bin\\mysqlimport -uroot -proot staffer e:\\depart_pos.txt<br />&#13;\n    在这里没有使用列的包围符号，分割采用默认的\\t，因为采用别的符号会有问题，<br />&#13;\n    不知道是不是windows的原因<br />&#13;\n    2)Load Data INFILE file_name into table_name(column1_name,column2_name)<br />&#13;\n      这个命令在mysql&gt;提示符下使用，优点是可以指定列导入，示例如下<br />&#13;\n      c:\\mysql\\bin\\mysql -uroot -proot staffer<br />&#13;\n      mysql&gt;load data infile "e:/depart_no.txt" into depart_no(department_id,position_id);<br />&#13;\n    <br />&#13;\n    这两个工具在Windows下使用都有问题，不知道是Windows的原因还是中文的问题，<br />&#13;\n    而且不指定的列它产生了空值，这显然不是我们想要的，所以谨慎使用这些工具&#13;\n &#13;\n
