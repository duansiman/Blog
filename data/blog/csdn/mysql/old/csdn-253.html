\n\n<p><a target="_blank" href="http://blog.csdn.net/l1028386804/article/details/52602682">转载请注明出处：http://blog.csdn.net/l1028386804/article/details/52602682</a><br />&#13;\n</p>&#13;\n<p>今天，一位原公司的同事，打电话来问我说误操作了数据库数据，如何恢复。他原本的想法是<span style="color:#000000">登录数据库update一个记录，结果忘了加where，于是悲剧发生了</span>。今天，我们不讲如何恢复误操作的数据，我们讲讲如何从源头上避免这样的问题，这才是避免类似问题的根本措施。好了。我们直接进入主题：</p>&#13;\n<h4>1、MySQL帮助说明</h4>&#13;\n<p></p>&#13;\n<pre code_snippet_id="1890624" snippet_file_name="blog_20160921_1_8526122" name="code" class="sql">[root@liuyazhuang151 ~]# mysql --help|grep dummy \n -U, --i-am-a-dummy Synonym for option --safe-updates, -U.\ni-am-a-dummy FALSE</pre><span style="color:#000000">在mysql命令加上选项-U后，当发出没有WHERE或LIMIT关键字的UPDATE或DELETE时，mysql程序就会拒绝执行</span>&#13;\n<p></p>&#13;\n<h4><strong><span style="color:#000000">2、指定-U登录测试</span></strong><br />&#13;\n</h4>&#13;\n<p></p>&#13;\n<pre code_snippet_id="1890624" snippet_file_name="blog_20160921_2_19840" name="code" class="plain">[root@liuyazhuang151 ~]# mysql -uroot -proot -S /data/3306/mysql.sock -U\nWelcome to the MySQL monitor. Commands end with ; or \\g.\nYour MySQL connection id is 14\nServer version: 5.5.32-log MySQL Community Server (GPL)\nCopyright (c) 2000, 2013, Oracle and/or its affiliates. All rights reserved.\nOracle is a registered trademark of Oracle Corporation and/or its\naffiliates. Other names may be trademarks of their respective\nowners.\nType 'help;' or '\\h' for help. Type '\\c' to clear the current input statement.\nmysql&gt; delete from oldboy.student;\nERROR 1175 (HY000): You are using safe update mode and you tried to update a table without a WHERE that uses a KEY column\nmysql&gt; quit\nBye</pre><span style="color:#000000">提示：不加条件无法删除，目的达到。</span><br />&#13;\n<p></p>&#13;\n<h4><strong><span style="color:#000000">3、做成别名防止他人和DBA误操作</span></strong><br />&#13;\n</h4>&#13;\n<p></p>&#13;\n<pre code_snippet_id="1890624" snippet_file_name="blog_20160921_3_4338238" name="code" class="sql">[root@liuyazhuang151 ~]# alias mysql='mysql -U'\n[root@liuyazhuang151 ~]# mysql -uroot -poldboy123 -S /data/3306/mysql.sock\nWelcome to the MySQL monitor. Commands end with ; or \\g.\nYour MySQL connection id is 15\nServer version: 5.5.32-log MySQL Community Server (GPL)\nType 'help;' or '\\h' for help. Type '\\c' to clear the current input statement.\nmysql&gt; delete from oldboy.student;\nERROR 1175 (HY000): You are using safe update mode and you tried to update a table without a WHERE that uses a KEY column\nmysql&gt; delete from oldboy.student where Sno=5;\nQuery OK, 1 row affected (0.02 sec)\nmysql&gt; quit\nBye\n[root@liuyazhuang151 ~]# echo "alias mysql='mysql -U'" &gt;&gt;/etc/profile\n[root@liuyazhuang151 ~]# . /etc/profile\n[root@liuyazhuang151 ~]# tail -1 /etc/profile\nalias mysql='mysql -U'</pre>&#13;\n<p></p>&#13;\n<h4><strong><span style="color:#000000">4、结论：</span></strong></h4>&#13;\n<p><span style="color:#000000">在mysql命令加上选项-U后，当发出没有WHERE或LIMIT关键字的UPDATE或DELETE时，mysql程序拒绝执行</span><br />&#13;\n<br />&#13;\n</p>&#13;\n &#13;\n
