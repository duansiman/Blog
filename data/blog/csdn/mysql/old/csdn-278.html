\n <div class="markdown_views"><h1 id="mysql数据备份">MySQL数据备份</h1>\n\n<p>在mySQL里面，有逻辑备份和物理备份。逻辑备份最大优点是对于各种存储引擎，都可以使用同样的方法来备份。而物理备份则不同，不同的存储引擎有着不同的备份方法。</p>\n\n<h2 id="逻辑备份与恢复">逻辑备份与恢复</h2>\n\n\n\n<h3 id="备份">备份</h3>\n\n<p>在MySQL中逻辑备份是使用mysqldump将数据库中的数据备份为一个文本文件，备份的文件可以被查看和编辑。按照备份范围，可以将备份分为以下三种备份。</p>\n\n<ul>\n<li>备份指定的一个数据库或者该数据库中的某些表 <br />\nmysqldump [options] 数据库名 [表名] &gt; data.sql</li>\n<li>备份指定的多个数据库 <br />\nmysqldump [options] –database &gt; data.sql 数据库1名 数据库2名 数据库3名…</li>\n<li>备份所有的数据库 <br />\nmysqldump [options] –all-database &gt; data.sql <br />\n解析：[options] 备份时候，需要的权限信息等。mysqldump的选项很多，具体可以通过mysqldump –help来查看。 为了保证数据备份一致性，MySQL存储引擎在北方时候，需要加上-l 参数，表示将所有表加上读锁，在备份期间，所有的表将只能读，而不能写。但是对于InnoDB引擎来说，可以采用–single-transaction。data.sql备份的数据文件 <br />\n参数： <br />\nl:代表给所有表加锁 <br />\nf:代表生成一个新的日子文件</li>\n</ul>\n\n<p>实例将xxpt数据库中所有表备份到dequan.sql表中。命令如下： <br />\nmysqldump -uroot -p xxpt &gt;dequan.sql <br />\n<img src="http://img.blog.csdn.net/20160418162853839" alt="这里写图片描述" title="" /> <br />\n因为上面我没有指定备份路径，默认情况下，会备份到当前路径，所以备份到D:\\wamp\\bin\\mysql\\mysql5.6.17\\bin路径下了。</p>\n\n\n\n<h3 id="恢复">恢复</h3>\n\n<h4 id="完全恢复">完全恢复</h4>\n\n<p>mysqldump的恢复也很简单，将备份作为输入执行即可。结果如下： <br />\nmysql -uroot -p dbname</p>\n\n<h4 id="不完全恢复">不完全恢复</h4>\n\n<p>不完全恢复包含基于时间点的恢复和基于位置的恢复。时间点与位置是相对应二进制日志（binlog日志）里面的时间点和位置。 <br />\n<img src="http://img.blog.csdn.net/20160418172810334" alt="这里写图片描述" title="" /></p>\n\n<h5 id="基于时间点">基于时间点</h5>\n\n<p>将设下午4:00到下午5:00之前的数据室错误的，恢复时候，需要跳过。首先我们来看一下binlog日志。如下午4点多更新数据是错误的，恢复时候需要跳过，下午5点多删除数据是正确的，需要保留。 <br />\n<img src="http://img.blog.csdn.net/20160418170529529" alt="这里写图片描述" title="" /> <br />\n1.通过mysql -uroot -p dbname</p>\n\n<h5 id="基于位置的恢复">基于位置的恢复</h5>\n\n<p>使用位置恢复时候，我们需要先查看binlog日志文件，确定位置编号，然后使用如下命令进行恢复： <br />\nmysqlbinlog D:\\wamp\\bin\\mysql\\mysql5.6.17\\data\\mybinlog.000012 –stop-position=716406|mysql -uroot -p <br />\n恢复5点之后的操作 <br />\nD:\\wamp\\bin\\mysql\\mysql5.6.17\\data\\mybinlog.000012 –start-position=723613|mysql -uroot -p <br />\n<img src="http://img.blog.csdn.net/20160418173324033" alt="这里写图片描述" title="" /></p>\n\n<h2 id="物理备份与恢复">物理备份与恢复</h2>\n\n<p>物理备份分为冷备份和热备份。和逻辑备份相比，它的最大优点是备份和恢复的速度快。因为物理备份的原理都是基于文件的cp。</p>\n\n<h3 id="冷备份与恢复">冷备份与恢复</h3>\n\n<p>冷备份其实就是将停掉数据库服务，复制数据文件的方法。这种方法对MyISAM和InnoDB都适合。 <br />\n恢复：首先停掉Mysql服务，在操作系统级别恢复MySQL的数据文件，然后重启Mysql服务，使用Mysqlbinlog工具恢复备份以来的所有binlog。</p>\n\n\n\n<h3 id="热备份">热备份</h3>\n\n<p>在mysql中不同存储引擎的热备份时不相同的。</p>\n\n<h4 id="myisam存储引擎">MyISAM存储引擎</h4>\n\n<p>MyISAM存储引擎备份原理就是将要备份的表加读锁，然后在cp数据文件到备份目录。常用方法</p>\n\n<ul>\n<li>方法一:使用mysqlhotcop <br />\nmysqlhotcop db_name [目录]</li>\n<li>方法二:手工锁表copy <br />\n首先给数据库中所有表加读锁，然后cp数据。 <br />\n锁定所有表flush tables with read lock; <br />\n<img src="http://img.blog.csdn.net/20160418174930561" alt="这里写图片描述" title="" /></li>\n</ul>\n\n<h3 id="innodb存储引擎">InnoDB存储引擎</h3>\n\n<p>正在学习中···</p>\n\n\n\n<h1 id="表的导入与导出">表的导入与导出</h1>\n\n\n\n<h2 id="导出">导出</h2>\n\n<ul>\n<li>使用SELECT …INTO OUTFILE …+[options]命令实现 <br />\n关于options参数如下 <br />\n<img src="http://img.blog.csdn.net/20160418175846598" alt="这里写图片描述" title="" /> <br />\n默认路径为该数据对应的路径下： <br />\n<img src="http://img.blog.csdn.net/20160418175540688" alt="这里写图片描述" title="" /> <br />\n<img src="http://img.blog.csdn.net/20160418175727782" alt="这里写图片描述" title="" /></li>\n<li>使用mysqldump <br />\nmysqldump -u username -T targetDir dbname tableName[options] <br />\n比如： <br />\nmysqldump -uroot -p -T D:/wamp/bin/mysql/mysql5.6.17/ xxpt t1 <br />\n生成了两个文件，如下图： <br />\n<img src="http://img.blog.csdn.net/20160418193339712" alt="这里写图片描述" title="" /> <br />\nt1.txt中保存中数据信息，t1.sql文件内容如下</li>\n</ul>\n\n<pre class="prettyprint"><code class=" hljs sql"><span class="hljs-comment">-- MySQL dump 10.13 Distrib 5.6.17, for Win32 (x86)</span>\n<span class="hljs-comment">--</span>\n<span class="hljs-comment">-- Host: localhost Database: xxpt</span>\n<span class="hljs-comment">-- ------------------------------------------------------</span>\n<span class="hljs-comment">-- Server version 5.6.17-log</span>\n\n<span class="hljs-comment">/*!40101 SET @OLD_CHARACTER_SET_CLIENT=@@CHARACTER_SET_CLIENT */</span>;\n<span class="hljs-comment">/*!40101 SET @OLD_CHARACTER_SET_RESULTS=@@CHARACTER_SET_RESULTS */</span>;\n<span class="hljs-comment">/*!40101 SET @OLD_COLLATION_CONNECTION=@@COLLATION_CONNECTION */</span>;\n<span class="hljs-comment">/*!40101 SET NAMES utf8 */</span>;\n<span class="hljs-comment">/*!40103 SET @OLD_TIME_ZONE=@@TIME_ZONE */</span>;\n<span class="hljs-comment">/*!40103 SET TIME_ZONE='+00:00' */</span>;\n<span class="hljs-comment">/*!40101 SET @OLD_SQL_MODE=@@SQL_MODE, SQL_MODE='' */</span>;\n<span class="hljs-comment">/*!40111 SET @OLD_SQL_NOTES=@@SQL_NOTES, SQL_NOTES=0 */</span>;\n\n<span class="hljs-comment">--</span>\n<span class="hljs-comment">-- Table structure for table `t1`</span>\n<span class="hljs-comment">--</span>\n\n<span class="hljs-operator"><span class="hljs-keyword">DROP</span> <span class="hljs-keyword">TABLE</span> <span class="hljs-keyword">IF</span> <span class="hljs-keyword">EXISTS</span> <span class="hljs-string">`t1`</span>;</span>\n<span class="hljs-comment">/*!40101 SET @saved_cs_client = @@character_set_client */</span>;\n<span class="hljs-comment">/*!40101 SET character_set_client = utf8 */</span>;\n<span class="hljs-operator"><span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">TABLE</span> <span class="hljs-string">`t1`</span> (\n <span class="hljs-string">`id1`</span> <span class="hljs-keyword">int</span>(<span class="hljs-number">11</span>) <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">NULL</span> <span class="hljs-keyword">DEFAULT</span> <span class="hljs-string">'0'</span>,\n <span class="hljs-string">`id2`</span> <span class="hljs-keyword">int</span>(<span class="hljs-number">3</span>) unsigned zerofill <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">NULL</span> <span class="hljs-keyword">DEFAULT</span> <span class="hljs-string">'000'</span>\n) ENGINE=InnoDB <span class="hljs-keyword">DEFAULT</span> CHARSET=utf8;</span>\n<span class="hljs-comment">/*!40101 SET character_set_client = @saved_cs_client */</span>;\n\n<span class="hljs-comment">/*!40103 SET TIME_ZONE=@OLD_TIME_ZONE */</span>;\n\n<span class="hljs-comment">/*!40101 SET SQL_MODE=@OLD_SQL_MODE */</span>;\n<span class="hljs-comment">/*!40101 SET CHARACTER_SET_CLIENT=@OLD_CHARACTER_SET_CLIENT */</span>;\n<span class="hljs-comment">/*!40101 SET CHARACTER_SET_RESULTS=@OLD_CHARACTER_SET_RESULTS */</span>;\n<span class="hljs-comment">/*!40101 SET COLLATION_CONNECTION=@OLD_COLLATION_CONNECTION */</span>;\n<span class="hljs-comment">/*!40111 SET SQL_NOTES=@OLD_SQL_NOTES */</span>;\n<span class="hljs-comment">-- Dump completed on 2016-04-18 19:30:51</span></code></pre>\n\n<h2 id="导入">导入</h2>\n\n<p>方法一： <br />\nload data infile <br />\neg： <br />\nload data infile ‘D:/wamp/bin/mysql/mysql5.6.17/t1.txt’ into table t1; <br />\n<img src="http://img.blog.csdn.net/20160418194002874" alt="这里写图片描述" title="" /> <br />\n方法二：使用mysqlinport</p></div>&#13;\n <script type="text/javascript">&#13;\n $(function () {&#13;\n $('pre.prettyprint code').each(function () {&#13;\n var lines = $(this).text().split('\\n').length;&#13;\n var $numbering = $('&lt;ul/&gt;').addClass('pre-numbering').hide();&#13;\n $(this).addClass('has-numbering').parent().append($numbering);&#13;\n for (i = 1; i &lt;= lines; i++) {&#13;\n $numbering.append($('&lt;li/&gt;').text(i));&#13;\n };&#13;\n $numbering.fadeIn(1700);&#13;\n });&#13;\n });&#13;\n </script>&#13;\n &#13;\n
