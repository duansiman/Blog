\n\n<h1 align="center" style="margin:0px; padding:0px; color:rgb(85,85,85); font-family:'microsoft yahei'; line-height:35px">&#13;\n谈谈数据库的ACID</h1>&#13;\n<p align="left" style="margin-top:0px; margin-bottom:0px; padding-top:0px; padding-bottom:0px; color:rgb(85,85,85); font-family:'microsoft yahei'; font-size:15px; line-height:35px">&#13;\n                                                                                                                                                                  帅宏军</p>&#13;\n<p align="left" style="margin-top:0px; margin-bottom:0px; padding-top:0px; padding-bottom:0px; color:rgb(85,85,85); font-family:'microsoft yahei'; font-size:15px; line-height:35px">&#13;\n<strong>一.事务</strong></p>&#13;\n<p style="margin-top:0px; margin-bottom:0px; padding-top:0px; padding-bottom:0px; color:rgb(85,85,85); font-family:'microsoft yahei'; font-size:15px; line-height:35px">&#13;\n<span style="color:rgb(67,73,80)">       </span><span style="color:rgb(67,73,80)">定义：所谓事务，它是一个操作序列，这些操作要么都执行，要么都不执行，它是一个不可分割的工作单位。</span></p>&#13;\n<p style="margin-top:0px; margin-bottom:0px; padding-top:0px; padding-bottom:0px; color:rgb(85,85,85); font-family:'microsoft yahei'; font-size:15px; line-height:35px">&#13;\n<span style="color:rgb(67,73,80)">       </span><span style="color:rgb(67,73,80)">准备工作：为了说明事务的</span><span style="color:rgb(67,73,80)">ACID</span><span style="color:rgb(67,73,80)">原理，我们使用银行账户及资金管理的案例进行分析。</span></p>&#13;\n<p style="margin-top:0px; margin-bottom:0px; padding-top:0px; padding-bottom:0px; color:rgb(85,85,85); font-family:'microsoft yahei'; font-size:15px; line-height:35px">&#13;\n<span style="color:rgb(67,73,80)"> </span></p>&#13;\n<p style="margin-top:0px; margin-bottom:0px; padding-top:0px; padding-bottom:0px; color:rgb(85,85,85); font-family:'microsoft yahei'; font-size:15px; line-height:35px">&#13;\n<span style="color:rgb(67,73,80)">       </span></p>&#13;\n<div class="dp-highlighter bg_sql" style="font-family:Consolas,'Courier New',Courier,mono,serif; width:938.516px; overflow:hidden; padding-top:1px; position:relative; border-color:rgb(204,204,204); color:rgb(85,85,85); line-height:35px; margin:18px 0px!important">&#13;\n<div class="bar" style="padding-left:45px">&#13;\n<div class="tools" style="padding:3px 8px 10px 10px; font-size:9px; line-height:normal; font-family:Verdana,Geneva,Arial,Helvetica,sans-serif; color:silver; border-left-width:3px; border-left-style:solid; border-left-color:rgb(108,226,108)">&#13;\n<strong>[sql]</strong> <a target="_blank" href="http://blog.csdn.net/shuaihj/article/details/14163713" class="ViewSource" title="view plain" style="text-decoration:none; border:none; padding:0px; margin:0px 10px 0px 0px; font-size:9px; color:rgb(12,137,207); background-color:inherit">view&#13;\n plain</a><span> <a target="_blank" href="http://blog.csdn.net/shuaihj/article/details/14163713" class="CopyToClipboard" title="copy" style="text-decoration:none; border:none; padding:0px; margin:0px 10px 0px 0px; font-size:9px; color:rgb(12,137,207); background-color:inherit">copy</a></span>&#13;\n<div style="position:absolute; left:508px; top:752px; width:29px; height:14px; z-index:99">&#13;\n</div>&#13;\n<span> <a target="_blank" href="http://blog.csdn.net/shuaihj/article/details/14163713" class="PrintSource" title="print" style="text-decoration:none; border:none; padding:0px; margin:0px 10px 0px 0px; font-size:9px; color:rgb(12,137,207); background-color:inherit">print</a></span><a target="_blank" href="http://blog.csdn.net/shuaihj/article/details/14163713" class="About" title="?" style="text-decoration:none; border:none; padding:0px; margin:0px 10px 0px 0px; font-size:9px; color:rgb(12,137,207); background-color:inherit">?</a></div>&#13;\n</div>&#13;\n<ol start="1" class="dp-sql" style="padding:0px; border:none; position:relative; color:rgb(92,92,92); margin:0px 0px 1px 45px!important">&#13;\n<li class="alt" style="margin:0px!important; padding:0px 3px 0px 10px!important; border-style:none none none solid; border-left-width:3px; border-left-color:rgb(108,226,108); list-style:decimal-leading-zero outside; color:inherit; line-height:18px">&#13;\n<span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">// 创建数据库  </span></li><li style="border-style:none none none solid; border-left-width:3px; border-left-color:rgb(108,226,108); list-style:decimal-leading-zero outside; line-height:18px; margin:0px!important; padding:0px 3px 0px 10px!important">&#13;\n<span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit"><span class="keyword" style="margin:0px; padding:0px; border:none; color:rgb(0,102,153); font-weight:bold; background-color:inherit">create</span><span style="margin:0px; padding:0px; border:none; background-color:inherit"> </span><span class="keyword" style="margin:0px; padding:0px; border:none; color:rgb(0,102,153); font-weight:bold; background-color:inherit">table</span><span style="margin:0px; padding:0px; border:none; background-color:inherit"> account(  </span></span></li><li class="alt" style="margin:0px!important; padding:0px 3px 0px 10px!important; border-style:none none none solid; border-left-width:3px; border-left-color:rgb(108,226,108); list-style:decimal-leading-zero outside; color:inherit; line-height:18px">&#13;\n<span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">   idint <span class="keyword" style="margin:0px; padding:0px; border:none; color:rgb(0,102,153); font-weight:bold; background-color:inherit">primary</span><span style="margin:0px; padding:0px; border:none; background-color:inherit"> </span><span class="keyword" style="margin:0px; padding:0px; border:none; color:rgb(0,102,153); font-weight:bold; background-color:inherit">key</span><span style="margin:0px; padding:0px; border:none; background-color:inherit"> </span><span class="op" style="margin:0px; padding:0px; border:none; color:rgb(128,128,128); background-color:inherit">not</span><span style="margin:0px; padding:0px; border:none; background-color:inherit"> </span><span class="op" style="margin:0px; padding:0px; border:none; color:rgb(128,128,128); background-color:inherit">null</span><span style="margin:0px; padding:0px; border:none; background-color:inherit">,  </span></span></li><li style="border-style:none none none solid; border-left-width:3px; border-left-color:rgb(108,226,108); list-style:decimal-leading-zero outside; line-height:18px; margin:0px!important; padding:0px 3px 0px 10px!important">&#13;\n<span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">   namevarchar(40),  </span></li><li class="alt" style="margin:0px!important; padding:0px 3px 0px 10px!important; border-style:none none none solid; border-left-width:3px; border-left-color:rgb(108,226,108); list-style:decimal-leading-zero outside; color:inherit; line-height:18px">&#13;\n<span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">   moneydouble  </span></li><li style="border-style:none none none solid; border-left-width:3px; border-left-color:rgb(108,226,108); list-style:decimal-leading-zero outside; line-height:18px; margin:0px!important; padding:0px 3px 0px 10px!important">&#13;\n<span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">);  </span></li><li class="alt" style="margin:0px!important; padding:0px 3px 0px 10px!important; border-style:none none none solid; border-left-width:3px; border-left-color:rgb(108,226,108); list-style:decimal-leading-zero outside; color:inherit; line-height:18px">&#13;\n<span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">  </span></li><li style="border-style:none none none solid; border-left-width:3px; border-left-color:rgb(108,226,108); list-style:decimal-leading-zero outside; line-height:18px; margin:0px!important; padding:0px 3px 0px 10px!important">&#13;\n<span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">// 有两个人开户并存钱  </span></li><li class="alt" style="margin:0px!important; padding:0px 3px 0px 10px!important; border-style:none none none solid; border-left-width:3px; border-left-color:rgb(108,226,108); list-style:decimal-leading-zero outside; color:inherit; line-height:18px">&#13;\n<span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit"><span class="keyword" style="margin:0px; padding:0px; border:none; color:rgb(0,102,153); font-weight:bold; background-color:inherit">insert</span><span style="margin:0px; padding:0px; border:none; background-color:inherit"> </span><span class="keyword" style="margin:0px; padding:0px; border:none; color:rgb(0,102,153); font-weight:bold; background-color:inherit">into</span><span style="margin:0px; padding:0px; border:none; background-color:inherit"> account </span><span class="keyword" style="margin:0px; padding:0px; border:none; color:rgb(0,102,153); font-weight:bold; background-color:inherit">values</span><span style="margin:0px; padding:0px; border:none; background-color:inherit">(1,</span><span class="string" style="margin:0px; padding:0px; border:none; color:blue; background-color:inherit">'A'</span><span style="margin:0px; padding:0px; border:none; background-color:inherit">,1000);  </span></span></li><li style="border-style:none none none solid; border-left-width:3px; border-left-color:rgb(108,226,108); list-style:decimal-leading-zero outside; line-height:18px; margin:0px!important; padding:0px 3px 0px 10px!important">&#13;\n<span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit"><span class="keyword" style="margin:0px; padding:0px; border:none; color:rgb(0,102,153); font-weight:bold; background-color:inherit">insert</span><span style="margin:0px; padding:0px; border:none; background-color:inherit"> </span><span class="keyword" style="margin:0px; padding:0px; border:none; color:rgb(0,102,153); font-weight:bold; background-color:inherit">into</span><span style="margin:0px; padding:0px; border:none; background-color:inherit"> account </span><span class="keyword" style="margin:0px; padding:0px; border:none; color:rgb(0,102,153); font-weight:bold; background-color:inherit">values</span><span style="margin:0px; padding:0px; border:none; background-color:inherit">(2,</span><span class="string" style="margin:0px; padding:0px; border:none; color:blue; background-color:inherit">'B'</span><span style="margin:0px; padding:0px; border:none; background-color:inherit">,1000);  </span></span></li></ol>&#13;\n</div>&#13;\n<br style="color:rgb(85,85,85); font-family:'microsoft yahei'; font-size:15px; line-height:35px" />&#13;\n<p style="margin-top:0px; margin-bottom:0px; padding-top:0px; padding-bottom:0px; color:rgb(85,85,85); font-family:'microsoft yahei'; font-size:15px; line-height:35px">&#13;\n</p>&#13;\n<p style="margin-top:0px; margin-bottom:0px; padding-top:0px; padding-bottom:0px; color:rgb(85,85,85); font-family:'microsoft yahei'; font-size:15px; line-height:35px">&#13;\n<span style="color:rgb(67,73,80)"><br />&#13;\n</span></p>&#13;\n<p align="left" style="margin-top:0px; margin-bottom:0px; padding-top:0px; padding-bottom:0px; color:rgb(85,85,85); font-family:'microsoft yahei'; font-size:15px; line-height:35px">&#13;\n<strong>二.ACID</strong></p>&#13;\n<p style="margin-top:0px; margin-bottom:0px; padding-top:0px; padding-bottom:0px; color:rgb(85,85,85); font-family:'microsoft yahei'; font-size:15px; line-height:35px">&#13;\n<span style="color:rgb(67,73,80)">       ACID</span><span style="color:rgb(67,73,80)">，是指在可靠<a target="_blank" href="http://lib.csdn.net/base/mysql" class="replace_word" title="MySQL知识库" style="text-decoration:none; color:rgb(223,52,52); font-weight:bold">数据库</a>管理系统（</span><span style="color:rgb(67,73,80)">DBMS</span><span style="color:rgb(67,73,80)">）中，事务</span><span style="color:rgb(67,73,80)">(transaction)</span><span style="color:rgb(67,73,80)">所应该具有的四个特性：原子性（</span><span style="color:rgb(67,73,80)">Atomicity</span><span style="color:rgb(67,73,80)">）、一致性（</span><span style="color:rgb(67,73,80)">Consistency</span><span style="color:rgb(67,73,80)">）、隔离性（</span><span style="color:rgb(67,73,80)">Isolation</span><span style="color:rgb(67,73,80)">）、持久性（</span><span style="color:rgb(67,73,80)">Durability</span><span style="color:rgb(67,73,80)">）</span><span style="color:rgb(67,73,80)">.</span><span style="color:rgb(67,73,80)">这是可靠数据库所应具备的几个特性</span><span style="color:rgb(67,73,80)">.</span><span style="color:rgb(67,73,80)">下面针对这几个特性进行逐个讲解</span><span style="color:rgb(67,73,80)">.</span></p>&#13;\n<p style="margin-top:0px; margin-bottom:0px; padding-top:0px; padding-bottom:0px; color:rgb(85,85,85); font-family:'microsoft yahei'; font-size:15px; line-height:35px">&#13;\n<span style="color:rgb(67,73,80)"><br />&#13;\n</span></p>&#13;\n<p align="left" style="margin-top:0px; margin-bottom:0px; padding-top:0px; padding-bottom:0px; color:rgb(85,85,85); font-family:'microsoft yahei'; font-size:15px; line-height:35px">&#13;\n<strong>三.原子性</strong></p>&#13;\n<p style="margin-top:0px; margin-bottom:0px; padding-top:0px; padding-bottom:0px; color:rgb(85,85,85); font-family:'microsoft yahei'; font-size:15px; line-height:35px">&#13;\n<span style="color:rgb(67,73,80)">       </span><span style="color:rgb(67,73,80)">原子性是指事务是一个不可再分割的工作单位，事务中的操作要么都发生，要么都不发生。</span></p>&#13;\n<p style="margin-top:0px; margin-bottom:0px; padding-top:0px; padding-bottom:0px; color:rgb(85,85,85); font-family:'microsoft yahei'; font-size:15px; line-height:35px">&#13;\n<strong><span style="color:rgb(67,73,80)">       1.</span><span style="color:rgb(67,73,80)">案例</span></strong></p>&#13;\n<p style="margin-top:0px; margin-bottom:0px; padding-top:0px; padding-bottom:0px; color:rgb(85,85,85); font-family:'microsoft yahei'; font-size:15px; line-height:35px">&#13;\n<span style="color:rgb(67,73,80)">              A</span><span style="color:rgb(67,73,80)">给</span><span style="color:rgb(67,73,80)">B</span><span style="color:rgb(67,73,80)">转帐</span><span style="color:rgb(67,73,80)">100</span><span style="color:rgb(67,73,80)">元钱</span></p>&#13;\n<p align="center" style="margin-top:0px; margin-bottom:0px; padding-top:0px; padding-bottom:0px; color:rgb(85,85,85); font-family:'microsoft yahei'; font-size:15px; line-height:35px">&#13;\n<span style="color:rgb(67,73,80)"><img src="http://img.blog.csdn.net/20131105115813406?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvc2h1YWloag==/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/Center" alt="" style="border:none" /> </span></p>&#13;\n<p style="margin-top:0px; margin-bottom:0px; padding-top:0px; padding-bottom:0px; color:rgb(85,85,85); font-family:'microsoft yahei'; font-size:15px; line-height:35px">&#13;\n<span style="color:rgb(67,73,80)">       </span></p>&#13;\n<div class="dp-highlighter bg_sql" style="font-family:Consolas,'Courier New',Courier,mono,serif; width:938.516px; overflow:hidden; padding-top:1px; position:relative; border-color:rgb(204,204,204); color:rgb(85,85,85); line-height:35px; margin:18px 0px!important">&#13;\n<div class="bar" style="padding-left:45px">&#13;\n<div class="tools" style="padding:3px 8px 10px 10px; font-size:9px; line-height:normal; font-family:Verdana,Geneva,Arial,Helvetica,sans-serif; color:silver; border-left-width:3px; border-left-style:solid; border-left-color:rgb(108,226,108)">&#13;\n<strong>[sql]</strong> <a target="_blank" href="http://blog.csdn.net/shuaihj/article/details/14163713" class="ViewSource" title="view plain" style="text-decoration:none; border:none; padding:0px; margin:0px 10px 0px 0px; font-size:9px; color:rgb(12,137,207); background-color:inherit">view&#13;\n plain</a><span> <a target="_blank" href="http://blog.csdn.net/shuaihj/article/details/14163713" class="CopyToClipboard" title="copy" style="text-decoration:none; border:none; padding:0px; margin:0px 10px 0px 0px; font-size:9px; color:rgb(12,137,207); background-color:inherit">copy</a></span>&#13;\n<div style="position:absolute; left:508px; top:1749px; width:29px; height:14px; z-index:99">&#13;\n</div>&#13;\n<span> <a target="_blank" href="http://blog.csdn.net/shuaihj/article/details/14163713" class="PrintSource" title="print" style="text-decoration:none; border:none; padding:0px; margin:0px 10px 0px 0px; font-size:9px; color:rgb(12,137,207); background-color:inherit">print</a></span><a target="_blank" href="http://blog.csdn.net/shuaihj/article/details/14163713" class="About" title="?" style="text-decoration:none; border:none; padding:0px; margin:0px 10px 0px 0px; font-size:9px; color:rgb(12,137,207); background-color:inherit">?</a></div>&#13;\n</div>&#13;\n<ol start="1" class="dp-sql" style="padding:0px; border:none; position:relative; color:rgb(92,92,92); margin:0px 0px 1px 45px!important">&#13;\n<li class="alt" style="margin:0px!important; padding:0px 3px 0px 10px!important; border-style:none none none solid; border-left-width:3px; border-left-color:rgb(108,226,108); list-style:decimal-leading-zero outside; color:inherit; line-height:18px">&#13;\n<span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit"><span class="keyword" style="margin:0px; padding:0px; border:none; color:rgb(0,102,153); font-weight:bold; background-color:inherit">begin</span><span style="margin:0px; padding:0px; border:none; background-color:inherit"> </span><span class="keyword" style="margin:0px; padding:0px; border:none; color:rgb(0,102,153); font-weight:bold; background-color:inherit">transaction</span><span style="margin:0px; padding:0px; border:none; background-color:inherit">  </span></span></li><li style="border-style:none none none solid; border-left-width:3px; border-left-color:rgb(108,226,108); list-style:decimal-leading-zero outside; line-height:18px; margin:0px!important; padding:0px 3px 0px 10px!important">&#13;\n<span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit"><span class="keyword" style="margin:0px; padding:0px; border:none; color:rgb(0,102,153); font-weight:bold; background-color:inherit">update</span><span style="margin:0px; padding:0px; border:none; background-color:inherit"> account </span><span class="keyword" style="margin:0px; padding:0px; border:none; color:rgb(0,102,153); font-weight:bold; background-color:inherit">set</span><span style="margin:0px; padding:0px; border:none; background-color:inherit"> money= money - 100where </span><span class="keyword" style="margin:0px; padding:0px; border:none; color:rgb(0,102,153); font-weight:bold; background-color:inherit">name</span><span style="margin:0px; padding:0px; border:none; background-color:inherit">=</span><span class="string" style="margin:0px; padding:0px; border:none; color:blue; background-color:inherit">'A'</span><span style="margin:0px; padding:0px; border:none; background-color:inherit">;  </span></span></li><li class="alt" style="margin:0px!important; padding:0px 3px 0px 10px!important; border-style:none none none solid; border-left-width:3px; border-left-color:rgb(108,226,108); list-style:decimal-leading-zero outside; color:inherit; line-height:18px">&#13;\n<span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit"><span class="keyword" style="margin:0px; padding:0px; border:none; color:rgb(0,102,153); font-weight:bold; background-color:inherit">update</span><span style="margin:0px; padding:0px; border:none; background-color:inherit"> account </span><span class="keyword" style="margin:0px; padding:0px; border:none; color:rgb(0,102,153); font-weight:bold; background-color:inherit">set</span><span style="margin:0px; padding:0px; border:none; background-color:inherit"> money= money +100where </span><span class="keyword" style="margin:0px; padding:0px; border:none; color:rgb(0,102,153); font-weight:bold; background-color:inherit">name</span><span style="margin:0px; padding:0px; border:none; background-color:inherit">=</span><span class="string" style="margin:0px; padding:0px; border:none; color:blue; background-color:inherit">'B'</span><span style="margin:0px; padding:0px; border:none; background-color:inherit">;  </span></span></li><li style="border-style:none none none solid; border-left-width:3px; border-left-color:rgb(108,226,108); list-style:decimal-leading-zero outside; line-height:18px; margin:0px!important; padding:0px 3px 0px 10px!important">&#13;\n<span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">if Error <span class="keyword" style="margin:0px; padding:0px; border:none; color:rgb(0,102,153); font-weight:bold; background-color:inherit">then</span><span style="margin:0px; padding:0px; border:none; background-color:inherit">  </span></span></li><li class="alt" style="margin:0px!important; padding:0px 3px 0px 10px!important; border-style:none none none solid; border-left-width:3px; border-left-color:rgb(108,226,108); list-style:decimal-leading-zero outside; color:inherit; line-height:18px">&#13;\n<span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">       <span class="keyword" style="margin:0px; padding:0px; border:none; color:rgb(0,102,153); font-weight:bold; background-color:inherit">rollback</span><span style="margin:0px; padding:0px; border:none; background-color:inherit">  </span></span></li><li style="border-style:none none none solid; border-left-width:3px; border-left-color:rgb(108,226,108); list-style:decimal-leading-zero outside; line-height:18px; margin:0px!important; padding:0px 3px 0px 10px!important">&#13;\n<span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit"><span class="keyword" style="margin:0px; padding:0px; border:none; color:rgb(0,102,153); font-weight:bold; background-color:inherit">else</span><span style="margin:0px; padding:0px; border:none; background-color:inherit">  </span></span></li><li class="alt" style="margin:0px!important; padding:0px 3px 0px 10px!important; border-style:none none none solid; border-left-width:3px; border-left-color:rgb(108,226,108); list-style:decimal-leading-zero outside; color:inherit; line-height:18px">&#13;\n<span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">       <span class="keyword" style="margin:0px; padding:0px; border:none; color:rgb(0,102,153); font-weight:bold; background-color:inherit">commit</span><span style="margin:0px; padding:0px; border:none; background-color:inherit">  </span></span></li></ol>&#13;\n</div>&#13;\n<br style="color:rgb(85,85,85); font-family:'microsoft yahei'; font-size:15px; line-height:35px" />&#13;\n<p style="margin-top:0px; margin-bottom:0px; padding-top:0px; padding-bottom:0px; color:rgb(85,85,85); font-family:'microsoft yahei'; font-size:15px; line-height:35px">&#13;\n</p>&#13;\n<p style="margin-top:0px; margin-bottom:0px; padding-top:0px; padding-bottom:0px; color:rgb(85,85,85); font-family:'microsoft yahei'; font-size:15px; line-height:35px">&#13;\n<span style="color:rgb(67,73,80)"> </span></p>&#13;\n<p style="margin-top:0px; margin-bottom:0px; padding-top:0px; padding-bottom:0px; color:rgb(85,85,85); font-family:'microsoft yahei'; font-size:15px; line-height:35px">&#13;\n<strong><span style="color:rgb(67,73,80)">       2.</span><span style="color:rgb(67,73,80)">分析</span><span style="color:rgb(67,73,80)"> </span></strong></p>&#13;\n<p style="margin-top:0px; margin-bottom:0px; padding-top:0px; padding-bottom:0px; color:rgb(85,85,85); font-family:'microsoft yahei'; font-size:15px; line-height:35px">&#13;\n<span style="color:rgb(67,73,80)">       </span><span style="color:rgb(67,73,80)">在事务中的扣款和加款两条语句，要么都执行，要么就都不执行。否则如果只执行了扣款语句，就提交了，此时如果突然断电，</span><span style="color:rgb(67,73,80)">A</span><span style="color:rgb(67,73,80)">账号已经发生了扣款，</span><span style="color:rgb(67,73,80)">B</span><span style="color:rgb(67,73,80)">账号却没收到加款，在生活中就会引起纠纷。</span></p>&#13;\n<p style="margin-top:0px; margin-bottom:0px; padding-top:0px; padding-bottom:0px; color:rgb(85,85,85); font-family:'microsoft yahei'; font-size:15px; line-height:35px">&#13;\n<span style="color:rgb(67,73,80)"> </span></p>&#13;\n<p style="margin-top:0px; margin-bottom:0px; padding-top:0px; padding-bottom:0px; color:rgb(85,85,85); font-family:'microsoft yahei'; font-size:15px; line-height:35px">&#13;\n<strong><span style="color:rgb(67,73,80)">       3.</span><span style="color:rgb(67,73,80)">解决方法</span></strong></p>&#13;\n<p style="margin-top:0px; margin-bottom:0px; padding-top:0px; padding-bottom:0px; color:rgb(85,85,85); font-family:'microsoft yahei'; font-size:15px; line-height:35px">&#13;\n<span style="color:rgb(67,73,80)">       </span><span style="color:rgb(67,73,80)">在数据库管理系统（</span><span style="color:rgb(67,73,80)">DBMS</span><span style="color:rgb(67,73,80)">）中，默认情况下</span><span style="color:rgb(67,73,80)">一条</span><span style="color:rgb(67,73,80)">SQL</span><span style="color:rgb(67,73,80)">就是一个单独事务，事务是自动提交的。只有显式的使用</span><span style="color:rgb(67,73,80)">start&#13;\n transaction</span><span style="color:rgb(67,73,80)">开启一个事务，才能将一个代码块放在事务中执行。保障事务的原子性是数据库管理系统的责任，为此许多数据源采用日志机制。例如，</span><span style="color:rgb(67,73,80)">SQL Server</span><span style="color:rgb(67,73,80)">使用一个预写事务日志，在将数据提交到实际数据页面前，先写在事务日志上。</span></p>&#13;\n<p style="margin-top:0px; margin-bottom:0px; padding-top:0px; padding-bottom:0px; color:rgb(85,85,85); font-family:'microsoft yahei'; font-size:15px; line-height:35px">&#13;\n<span style="color:rgb(67,73,80)"><br />&#13;\n</span></p>&#13;\n<p align="left" style="margin-top:0px; margin-bottom:0px; padding-top:0px; padding-bottom:0px; color:rgb(85,85,85); font-family:'microsoft yahei'; font-size:15px; line-height:35px">&#13;\n<strong>四.一致性</strong></p>&#13;\n<p style="margin-top:0px; margin-bottom:0px; padding-top:0px; padding-bottom:0px; color:rgb(85,85,85); font-family:'microsoft yahei'; font-size:15px; line-height:35px">&#13;\n<span style="color:rgb(67,73,80)">       </span><span style="color:rgb(67,73,80)">一致性是指在事务开始之前和事务结束以后，数据库的完整性约束没有被破坏。这是说数据库事务不能破坏关系数据的完整性以及业务逻辑上的一致性。</span></p>&#13;\n<p style="margin-top:0px; margin-bottom:0px; padding-top:0px; padding-bottom:0px; color:rgb(85,85,85); font-family:'microsoft yahei'; font-size:15px; line-height:35px">&#13;\n<strong><span style="color:rgb(67,73,80)">       1.</span><span style="color:rgb(67,73,80)">案例</span></strong></p>&#13;\n<p style="margin-top:0px; margin-bottom:0px; padding-top:0px; padding-bottom:0px; color:rgb(85,85,85); font-family:'microsoft yahei'; font-size:15px; line-height:35px">&#13;\n<span style="color:rgb(67,73,80)">       </span><span style="color:rgb(67,73,80)">对银行转帐事务，不管事务成功还是失败，应该保证事务结束后</span><span style="color:rgb(67,73,80)">ACCOUNT</span><span style="color:rgb(67,73,80)">表中</span><span style="color:rgb(67,73,80)">aaa</span><span style="color:rgb(67,73,80)">和</span><span style="color:rgb(67,73,80)">bbb</span><span style="color:rgb(67,73,80)">的存款总额为</span><span style="color:rgb(67,73,80)">2000</span><span style="color:rgb(67,73,80)">元。</span></p>&#13;\n<p style="margin-top:0px; margin-bottom:0px; padding-top:0px; padding-bottom:0px; color:rgb(85,85,85); font-family:'microsoft yahei'; font-size:15px; line-height:35px">&#13;\n<span style="color:rgb(67,73,80)"> </span></p>&#13;\n<p style="margin-top:0px; margin-bottom:0px; padding-top:0px; padding-bottom:0px; color:rgb(85,85,85); font-family:'microsoft yahei'; font-size:15px; line-height:35px">&#13;\n<strong><span style="color:rgb(67,73,80)">       2.</span><span style="color:rgb(67,73,80)">解决方法</span></strong></p>&#13;\n<p style="margin-top:0px; margin-bottom:0px; padding-top:0px; padding-bottom:0px; color:rgb(85,85,85); font-family:'microsoft yahei'; font-size:15px; line-height:35px">&#13;\n<span style="color:rgb(67,73,80)">保障事务的一致性，可以从以下两个层面入手</span></p>&#13;\n<p style="margin-top:0px; margin-bottom:0px; padding-top:0px; padding-bottom:0px; color:rgb(85,85,85); font-family:'microsoft yahei'; font-size:15px; line-height:35px">&#13;\n<span style="color:rgb(67,73,80)">       2.1</span><span style="color:rgb(67,73,80)">数据库机制层面</span></p>&#13;\n<p style="margin-top:0px; margin-bottom:0px; padding-top:0px; padding-bottom:0px; color:rgb(85,85,85); font-family:'microsoft yahei'; font-size:15px; line-height:35px">&#13;\n<span style="color:rgb(67,73,80)">       </span><span style="color:rgb(67,73,80)">数据库层面的一致性是，在一个事务执行之前和之后，数据会符合你设置的约束（唯一约束，外键约束</span><span style="color:rgb(67,73,80)">,Check</span><span style="color:rgb(67,73,80)">约束等</span><span style="color:rgb(67,73,80)">)</span><span style="color:rgb(67,73,80)">和触发器设置。这一点是由</span><span style="color:rgb(67,73,80)">SQL&#13;\n SERVER</span><span style="color:rgb(67,73,80)">进行保证的。比如转账，则可以使用</span><span style="color:rgb(67,73,80)">CHECK</span><span style="color:rgb(67,73,80)">约束两个账户之和等于</span><span style="color:rgb(67,73,80)">2000</span><span style="color:rgb(67,73,80)">来达到一致性目的</span></p>&#13;\n<p style="margin-top:0px; margin-bottom:0px; padding-top:0px; padding-bottom:0px; color:rgb(85,85,85); font-family:'microsoft yahei'; font-size:15px; line-height:35px">&#13;\n<span style="color:rgb(67,73,80)">       2.2</span><span style="color:rgb(67,73,80)">业务层面</span></p>&#13;\n<p style="margin-top:0px; margin-bottom:0px; padding-top:0px; padding-bottom:0px; color:rgb(85,85,85); font-family:'microsoft yahei'; font-size:15px; line-height:35px">&#13;\n<span style="color:rgb(67,73,80)">   </span><span style="color:rgb(67,73,80)">对于业务层面来说，一致性是保持业务的一致性。这个业务一致性需要由开发人员进行保证。当然，很多业务方面的一致性，也可以通过转移到数据库机制层面进行保证。</span></p>&#13;\n<p style="margin-top:0px; margin-bottom:0px; padding-top:0px; padding-bottom:0px; color:rgb(85,85,85); font-family:'microsoft yahei'; font-size:15px; line-height:35px">&#13;\n<span style="color:rgb(67,73,80)"><br />&#13;\n</span></p>&#13;\n<p align="left" style="margin-top:0px; margin-bottom:0px; padding-top:0px; padding-bottom:0px; color:rgb(85,85,85); font-family:'microsoft yahei'; font-size:15px; line-height:35px">&#13;\n<strong>五.隔离性</strong></p>&#13;\n<p style="margin-top:0px; margin-bottom:0px; padding-top:0px; padding-bottom:0px; color:rgb(85,85,85); font-family:'microsoft yahei'; font-size:15px; line-height:35px">&#13;\n<span style="color:rgb(67,73,80)">       </span><span style="color:rgb(67,73,80)">多个事务并发访问时，事务之间是隔离的，一个事务不应该影响其它事务运行效果。</span></p>&#13;\n<p style="margin-top:0px; margin-bottom:0px; padding-top:0px; padding-bottom:0px; color:rgb(85,85,85); font-family:'microsoft yahei'; font-size:15px; line-height:35px">&#13;\n<span style="color:rgb(67,73,80)">       </span><span style="color:rgb(67,73,80)">这指的是在并发环境中，当不同的事务同时操纵相同的数据时，每个事务都有各自的完整数据空间。由并发事务所做的修改必须与任何其他并发事务所做的修改隔离。事务查看数据更新时，数据所处的状态要么是另一事务修改它之前的状态，要么是另一事务修改它之后的状态，事务不会查看到中间状态的数据。</span></p>&#13;\n<p style="margin-top:0px; margin-bottom:0px; padding-top:0px; padding-bottom:0px; color:rgb(85,85,85); font-family:'microsoft yahei'; font-size:15px; line-height:35px">&#13;\n<span style="color:rgb(67,73,80)">       </span><span style="color:rgb(67,73,80)">在</span><span style="color:rgb(67,73,80)">Windows</span><span style="color:rgb(67,73,80)">中，如果多个进程对同一个文件进行修改是不允许的，</span><span style="color:rgb(67,73,80)">Windows</span><span style="color:rgb(67,73,80)">通过这种方式来保证不同进程的隔离性</span><span style="color:rgb(67,73,80)">:</span></p>&#13;\n<p align="center" style="margin-top:0px; margin-bottom:0px; padding-top:0px; padding-bottom:0px; color:rgb(85,85,85); font-family:'microsoft yahei'; font-size:15px; line-height:35px">&#13;\n<img src="http://img.blog.csdn.net/20131105115817609?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvc2h1YWloag==/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/Center" alt="" style="border:none; max-width:602px; height:auto" />   </p>&#13;\n<p style="margin-top:0px; margin-bottom:0px; padding-top:0px; padding-bottom:0px; color:rgb(85,85,85); font-family:'microsoft yahei'; font-size:15px; line-height:35px">&#13;\n<span style="color:rgb(67,73,80)">       </span><span style="color:rgb(67,73,80)">企业开发中，事务最复杂问题都是由事务隔离性引起的。当多个事务并发时，</span><span style="color:rgb(67,73,80)">SQL Server</span><span style="color:rgb(67,73,80)">利用加锁和阻塞来保证事务之间不同等级的隔离性。一般情况下，完全的隔离性是不现实的，完全的隔离性要求数据库同一时间只执行一条事务，这样会严重影响性能。想要理解</span><span style="color:rgb(67,73,80)">SQL&#13;\n Server</span><span style="color:rgb(67,73,80)">中对于隔离性的保障，首先要了解并发事务之间是如何干扰的</span><span style="color:rgb(67,73,80)">.</span></p>&#13;\n<p style="margin-top:0px; margin-bottom:0px; padding-top:0px; padding-bottom:0px; color:rgb(85,85,85); font-family:'microsoft yahei'; font-size:15px; line-height:35px">&#13;\n<strong><span style="color:rgb(67,73,80)">       1.</span><span style="color:rgb(67,73,80)">事务之间的相互影响</span></strong></p>&#13;\n<p style="margin-top:0px; margin-bottom:0px; padding-top:0px; padding-bottom:0px; color:rgb(85,85,85); font-family:'microsoft yahei'; font-size:15px; line-height:35px">&#13;\n<span style="color:rgb(67,73,80)">       </span><span style="color:rgb(67,73,80)">事务之间的相互影响分为几种，分别为：脏读，不可重复读，幻读，丢失更新</span></p>&#13;\n<p style="margin-top:0px; margin-bottom:0px; padding-top:0px; padding-bottom:0px; color:rgb(85,85,85); font-family:'microsoft yahei'; font-size:15px; line-height:35px">&#13;\n<span style="color:rgb(67,73,80)"> </span></p>&#13;\n<p style="margin-top:0px; margin-bottom:0px; padding-top:0px; padding-bottom:0px; color:rgb(85,85,85); font-family:'microsoft yahei'; font-size:15px; line-height:35px">&#13;\n<strong><span style="color:rgb(67,73,80)">       1.1</span><span style="color:rgb(67,73,80)">脏读</span></strong></p>&#13;\n<p style="margin-top:0px; margin-bottom:0px; padding-top:0px; padding-bottom:0px; color:rgb(85,85,85); font-family:'microsoft yahei'; font-size:15px; line-height:35px">&#13;\n<span style="color:rgb(67,73,80)">       </span><span style="color:rgb(67,73,80)">脏读意味着一个事务读取了另一个事务未提交的数据，而这个数据是有可能回滚的；如下案例，此时如果事务</span><span style="color:rgb(67,73,80)">1</span><span style="color:rgb(67,73,80)">回滚，则</span><span style="color:rgb(67,73,80)">B</span><span style="color:rgb(67,73,80)">账户必将有损失。</span></p>&#13;\n<p align="center" style="margin-top:0px; margin-bottom:0px; padding-top:0px; padding-bottom:0px; color:rgb(85,85,85); font-family:'microsoft yahei'; font-size:15px; line-height:35px">&#13;\n     </p>&#13;\n<p align="center" style="margin-top:0px; margin-bottom:0px; padding-top:0px; padding-bottom:0px; color:rgb(85,85,85); font-family:'microsoft yahei'; font-size:15px; line-height:35px">&#13;\n <img src="http://img.blog.csdn.net/20131105115822218?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvc2h1YWloag==/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/Center" alt="" style="border:none; max-width:602px; height:auto" /></p>&#13;\n<p style="margin-top:0px; margin-bottom:0px; padding-top:0px; padding-bottom:0px; color:rgb(85,85,85); font-family:'microsoft yahei'; font-size:15px; line-height:35px">&#13;\n<strong><span style="color:rgb(67,73,80)">       1.2</span><span style="color:rgb(67,73,80)">不可重复读</span></strong></p>&#13;\n<p style="margin-top:0px; margin-bottom:0px; padding-top:0px; padding-bottom:0px; color:rgb(85,85,85); font-family:'microsoft yahei'; font-size:15px; line-height:35px">&#13;\n<span style="color:rgb(67,73,80)">    </span><span style="color:rgb(67,73,80)">不可重复读意味着，在数据库访问中，一个事务范围内两个相同的查询却返回了不同数据。这是由于查询时系统中其他事务修改的提交而引起的。如下案例，事务</span><span style="color:rgb(67,73,80)">1</span><span style="color:rgb(67,73,80)">必然会变得糊涂，不知道发生了什么。</span></p>&#13;\n<p align="center" style="margin-top:0px; margin-bottom:0px; padding-top:0px; padding-bottom:0px; color:rgb(85,85,85); font-family:'microsoft yahei'; font-size:15px; line-height:35px">&#13;\n</p>&#13;\n<p align="center" style="margin-top:0px; margin-bottom:0px; padding-top:0px; padding-bottom:0px; color:rgb(85,85,85); font-family:'microsoft yahei'; font-size:15px; line-height:35px">&#13;\n <img src="http://img.blog.csdn.net/20131105115826281?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvc2h1YWloag==/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/Center" alt="" style="border:none; max-width:602px; height:auto" /></p>&#13;\n<p style="margin-top:0px; margin-bottom:0px; padding-top:0px; padding-bottom:0px; color:rgb(85,85,85); font-family:'microsoft yahei'; font-size:15px; line-height:35px">&#13;\n<strong><span style="color:rgb(67,73,80)">       1.3</span><span style="color:rgb(67,73,80)">幻读（虚读）</span></strong></p>&#13;\n<p style="margin-top:0px; margin-bottom:0px; padding-top:0px; padding-bottom:0px; color:rgb(85,85,85); font-family:'microsoft yahei'; font-size:15px; line-height:35px">&#13;\n<span style="color:rgb(67,73,80)">    </span><span style="color:rgb(67,73,80)">幻读，是指当事务不是独立执行时发生的一种现象，例如第一个事务对一个表中的数据进行了修改，这种修改涉及到表中的全部数据行。同时，第二个事务也修改这个表中的数据，这种修改是向表中插入一行新数据。那么，以后就会发生操作第一个事务的用户发现表中还有没有修改的数据行，就好象发生了幻觉一样</span><span style="color:rgb(67,73,80)">.</span></p>&#13;\n<p align="center" style="margin-top:0px; margin-bottom:0px; padding-top:0px; padding-bottom:0px; color:rgb(85,85,85); font-family:'microsoft yahei'; font-size:15px; line-height:35px">&#13;\n  </p>&#13;\n<p align="center" style="margin-top:0px; margin-bottom:0px; padding-top:0px; padding-bottom:0px; color:rgb(85,85,85); font-family:'microsoft yahei'; font-size:15px; line-height:35px">&#13;\n <img src="http://img.blog.csdn.net/20131105115830531?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvc2h1YWloag==/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/Center" alt="" style="border:none; max-width:602px; height:auto" /></p>&#13;\n<p style="margin-top:0px; margin-bottom:0px; padding-top:0px; padding-bottom:0px; color:rgb(85,85,85); font-family:'microsoft yahei'; font-size:15px; line-height:35px">&#13;\n<strong><span style="color:rgb(67,73,80)">       1.4</span><span style="color:rgb(67,73,80)">丢失更新</span></strong></p>&#13;\n<p style="margin-top:0px; margin-bottom:0px; padding-top:0px; padding-bottom:0px; color:rgb(85,85,85); font-family:'microsoft yahei'; font-size:15px; line-height:35px">&#13;\n<span style="color:rgb(67,73,80)">       </span><span style="color:rgb(67,73,80)">两个事务同时读取同一条记录，</span><span style="color:rgb(67,73,80)">A</span><span style="color:rgb(67,73,80)">先修改记录，</span><span style="color:rgb(67,73,80)">B</span><span style="color:rgb(67,73,80)">也修改记录（</span><span style="color:rgb(67,73,80)">B</span><span style="color:rgb(67,73,80)">是不知道</span><span style="color:rgb(67,73,80)">A</span><span style="color:rgb(67,73,80)">修改过），</span><span style="color:rgb(67,73,80)">B</span><span style="color:rgb(67,73,80)">提交数据后</span><span style="color:rgb(67,73,80)">B</span><span style="color:rgb(67,73,80)">的修改结果覆盖了</span><span style="color:rgb(67,73,80)">A</span><span style="color:rgb(67,73,80)">的修改结果。</span></p>&#13;\n<p style="margin-top:0px; margin-bottom:0px; padding-top:0px; padding-bottom:0px; color:rgb(85,85,85); font-family:'microsoft yahei'; font-size:15px; line-height:35px">&#13;\n<span style="color:rgb(67,73,80)"> </span></p>&#13;\n<p style="margin-top:0px; margin-bottom:0px; padding-top:0px; padding-bottom:0px; color:rgb(85,85,85); font-family:'microsoft yahei'; font-size:15px; line-height:35px">&#13;\n<strong><span style="color:rgb(67,73,80)">       2.</span><span style="color:rgb(67,73,80)">理解</span><span style="color:rgb(67,73,80)">SQL SERVER</span><span style="color:rgb(67,73,80)">中的隔离级别</span></strong></p>&#13;\n<p style="margin-top:0px; margin-bottom:0px; padding-top:0px; padding-bottom:0px; color:rgb(85,85,85); font-family:'microsoft yahei'; font-size:15px; line-height:35px">&#13;\n<span style="color:rgb(67,73,80)">       </span><span style="color:rgb(67,73,80)">数据库的事务隔离级别（</span><span style="color:rgb(67,73,80)">TRANSACTION ISOLATION LEVEL</span><span style="color:rgb(67,73,80)">）是一个数据库上很基本的一个概念。为什么会有事务隔离级别，</span><span style="color:rgb(67,73,80)">SQL&#13;\n Server</span><span style="color:rgb(67,73,80)">上实现了哪些事务隔离级别？事务隔离级别的前提是一个多用户、多进程、多线程的并发系统，在这个系统中为了保证数据的一致性和完整性，我们引入了事务隔离级别这个概念，对一个单用户、单线程的应用来说则不存在这个问题。</span></p>&#13;\n<p style="margin-top:0px; margin-bottom:0px; padding-top:0px; padding-bottom:0px; color:rgb(85,85,85); font-family:'microsoft yahei'; font-size:15px; line-height:35px">&#13;\n<span style="color:rgb(67,73,80)">    </span><span style="color:rgb(67,73,80)">为了避免上述几种事务之间的影响，</span><span style="color:rgb(67,73,80)">SQL Server</span><span style="color:rgb(67,73,80)">通过设置不同的隔离级别来进行不同程度的避免。因为高的隔离等级意味着更多的锁，从而牺牲性能。所以这个选项开放给了用户根据具体的需求进行设置。不过默认的隔离级别</span><span style="color:rgb(67,73,80)">Read&#13;\n Commited</span><span style="color:rgb(67,73,80)">符合了多数的实际需求</span><span style="color:rgb(67,73,80)">.</span></p>&#13;\n<p style="margin-top:0px; margin-bottom:0px; padding-top:0px; padding-bottom:0px; color:rgb(85,85,85); font-family:'microsoft yahei'; font-size:15px; line-height:35px">&#13;\n<span style="color:rgb(67,73,80)"> </span></p>&#13;\n<table border="1" cellspacing="0" cellpadding="0" style="color:rgb(85,85,85); font-family:'microsoft yahei'; font-size:15px; line-height:35px">&#13;\n<tbody>&#13;\n<tr>&#13;\n<td valign="top">&#13;\n<p style="margin-top:0px; margin-bottom:0px; padding-top:0px; padding-bottom:0px">&#13;\n<strong>隔离级别</strong></p>&#13;\n</td>&#13;\n<td valign="top">&#13;\n<p style="margin-top:0px; margin-bottom:0px; padding-top:0px; padding-bottom:0px">&#13;\n<strong>脏读</strong></p>&#13;\n</td>&#13;\n<td valign="top">&#13;\n<p style="margin-top:0px; margin-bottom:0px; padding-top:0px; padding-bottom:0px">&#13;\n<strong>丢失更新</strong></p>&#13;\n</td>&#13;\n<td valign="top">&#13;\n<p style="margin-top:0px; margin-bottom:0px; padding-top:0px; padding-bottom:0px">&#13;\n<strong>不可重复读</strong></p>&#13;\n</td>&#13;\n<td valign="top">&#13;\n<p style="margin-top:0px; margin-bottom:0px; padding-top:0px; padding-bottom:0px">&#13;\n<strong>幻读</strong></p>&#13;\n</td>&#13;\n<td valign="top">&#13;\n<p style="margin-top:0px; margin-bottom:0px; padding-top:0px; padding-bottom:0px">&#13;\n<strong>并发模型</strong></p>&#13;\n</td>&#13;\n<td valign="top">&#13;\n<p style="margin-top:0px; margin-bottom:0px; padding-top:0px; padding-bottom:0px">&#13;\n<strong>更新冲突检测</strong></p>&#13;\n</td>&#13;\n</tr>&#13;\n<tr>&#13;\n<td valign="top">&#13;\n<p style="margin-top:0px; margin-bottom:0px; padding-top:0px; padding-bottom:0px">&#13;\n<span style="color:rgb(67,73,80)">未提交读：</span><span style="color:rgb(67,73,80)">Read Uncommited</span></p>&#13;\n</td>&#13;\n<td valign="top">&#13;\n<p style="margin-top:0px; margin-bottom:0px; padding-top:0px; padding-bottom:0px">&#13;\n<span style="color:rgb(67,73,80)">是</span></p>&#13;\n</td>&#13;\n<td valign="top">&#13;\n<p style="margin-top:0px; margin-bottom:0px; padding-top:0px; padding-bottom:0px">&#13;\n<span style="color:rgb(67,73,80)">是</span></p>&#13;\n</td>&#13;\n<td valign="top">&#13;\n<p style="margin-top:0px; margin-bottom:0px; padding-top:0px; padding-bottom:0px">&#13;\n<span style="color:rgb(67,73,80)">是</span></p>&#13;\n</td>&#13;\n<td valign="top">&#13;\n<p style="margin-top:0px; margin-bottom:0px; padding-top:0px; padding-bottom:0px">&#13;\n<span style="color:rgb(67,73,80)">是</span></p>&#13;\n</td>&#13;\n<td valign="top">&#13;\n<p style="margin-top:0px; margin-bottom:0px; padding-top:0px; padding-bottom:0px">&#13;\n<span style="color:rgb(67,73,80)">悲观</span></p>&#13;\n</td>&#13;\n<td valign="top">&#13;\n<p style="margin-top:0px; margin-bottom:0px; padding-top:0px; padding-bottom:0px">&#13;\n<span style="color:rgb(67,73,80)">否</span></p>&#13;\n</td>&#13;\n</tr>&#13;\n<tr>&#13;\n<td valign="top">&#13;\n<p style="margin-top:0px; margin-bottom:0px; padding-top:0px; padding-bottom:0px">&#13;\n<span style="color:rgb(67,73,80)">已提交读：</span><span style="color:rgb(67,73,80)">Read commited</span></p>&#13;\n</td>&#13;\n<td valign="top">&#13;\n<p style="margin-top:0px; margin-bottom:0px; padding-top:0px; padding-bottom:0px">&#13;\n<span style="color:rgb(67,73,80)">否</span></p>&#13;\n</td>&#13;\n<td valign="top">&#13;\n<p style="margin-top:0px; margin-bottom:0px; padding-top:0px; padding-bottom:0px">&#13;\n<span style="color:rgb(67,73,80)">是</span></p>&#13;\n</td>&#13;\n<td valign="top">&#13;\n<p style="margin-top:0px; margin-bottom:0px; padding-top:0px; padding-bottom:0px">&#13;\n<span style="color:rgb(67,73,80)">是</span></p>&#13;\n</td>&#13;\n<td valign="top">&#13;\n<p style="margin-top:0px; margin-bottom:0px; padding-top:0px; padding-bottom:0px">&#13;\n<span style="color:rgb(67,73,80)">是</span></p>&#13;\n</td>&#13;\n<td valign="top">&#13;\n<p style="margin-top:0px; margin-bottom:0px; padding-top:0px; padding-bottom:0px">&#13;\n<span style="color:rgb(67,73,80)">悲观</span></p>&#13;\n</td>&#13;\n<td valign="top">&#13;\n<p style="margin-top:0px; margin-bottom:0px; padding-top:0px; padding-bottom:0px">&#13;\n<span style="color:rgb(67,73,80)">否</span></p>&#13;\n</td>&#13;\n</tr>&#13;\n<tr>&#13;\n<td valign="top">&#13;\n<p style="margin-top:0px; margin-bottom:0px; padding-top:0px; padding-bottom:0px">&#13;\n<span style="color:rgb(67,73,80)">可重复读：</span><span style="color:rgb(67,73,80)">Repeatable Read</span></p>&#13;\n</td>&#13;\n<td valign="top">&#13;\n<p style="margin-top:0px; margin-bottom:0px; padding-top:0px; padding-bottom:0px">&#13;\n<span style="color:rgb(67,73,80)">否</span></p>&#13;\n</td>&#13;\n<td valign="top">&#13;\n<p style="margin-top:0px; margin-bottom:0px; padding-top:0px; padding-bottom:0px">&#13;\n<span style="color:rgb(67,73,80)">否</span></p>&#13;\n</td>&#13;\n<td valign="top">&#13;\n<p style="margin-top:0px; margin-bottom:0px; padding-top:0px; padding-bottom:0px">&#13;\n<span style="color:rgb(67,73,80)">否</span></p>&#13;\n</td>&#13;\n<td valign="top">&#13;\n<p style="margin-top:0px; margin-bottom:0px; padding-top:0px; padding-bottom:0px">&#13;\n<span style="color:rgb(67,73,80)">是</span></p>&#13;\n</td>&#13;\n<td valign="top">&#13;\n<p style="margin-top:0px; margin-bottom:0px; padding-top:0px; padding-bottom:0px">&#13;\n<span style="color:rgb(67,73,80)">悲观</span></p>&#13;\n</td>&#13;\n<td valign="top">&#13;\n<p style="margin-top:0px; margin-bottom:0px; padding-top:0px; padding-bottom:0px">&#13;\n<span style="color:rgb(67,73,80)">否</span></p>&#13;\n</td>&#13;\n</tr>&#13;\n<tr>&#13;\n<td valign="top">&#13;\n<p style="margin-top:0px; margin-bottom:0px; padding-top:0px; padding-bottom:0px">&#13;\n<span style="color:rgb(67,73,80)">可串行读：</span><span style="color:rgb(67,73,80)">Serializable</span></p>&#13;\n</td>&#13;\n<td valign="top">&#13;\n<p style="margin-top:0px; margin-bottom:0px; padding-top:0px; padding-bottom:0px">&#13;\n<span style="color:rgb(67,73,80)">否</span></p>&#13;\n</td>&#13;\n<td valign="top">&#13;\n<p style="margin-top:0px; margin-bottom:0px; padding-top:0px; padding-bottom:0px">&#13;\n<span style="color:rgb(67,73,80)">否</span></p>&#13;\n</td>&#13;\n<td valign="top">&#13;\n<p style="margin-top:0px; margin-bottom:0px; padding-top:0px; padding-bottom:0px">&#13;\n<span style="color:rgb(67,73,80)">否</span></p>&#13;\n</td>&#13;\n<td valign="top">&#13;\n<p style="margin-top:0px; margin-bottom:0px; padding-top:0px; padding-bottom:0px">&#13;\n<span style="color:rgb(67,73,80)">否</span></p>&#13;\n</td>&#13;\n<td valign="top">&#13;\n<p style="margin-top:0px; margin-bottom:0px; padding-top:0px; padding-bottom:0px">&#13;\n<span style="color:rgb(67,73,80)">悲观</span></p>&#13;\n</td>&#13;\n<td valign="top">&#13;\n<p style="margin-top:0px; margin-bottom:0px; padding-top:0px; padding-bottom:0px">&#13;\n<span style="color:rgb(67,73,80)">否</span></p>&#13;\n</td>&#13;\n</tr>&#13;\n</tbody>&#13;\n</table>&#13;\n<p style="margin-top:0px; margin-bottom:0px; padding-top:0px; padding-bottom:0px; color:rgb(85,85,85); font-family:'microsoft yahei'; font-size:15px; line-height:35px">&#13;\n<span style="color:rgb(67,73,80)">    </span></p>&#13;\n<p style="margin-top:0px; margin-bottom:0px; padding-top:0px; padding-bottom:0px; color:rgb(85,85,85); font-family:'microsoft yahei'; font-size:15px; line-height:35px">&#13;\n<span style="color:rgb(67,73,80)">       SQL Server</span><span style="color:rgb(67,73,80)">隔离事务之间的影响是通过锁来实现的，通过阻塞来阻止上述影响。不同的隔离级别是通过加不同的锁，造成阻塞来实现的，所以会以付出性能作为代价；安全级别越高，处理效率越低；安全级别越低，效率高。</span></p>&#13;\n<p style="margin-top:0px; margin-bottom:0px; padding-top:0px; padding-bottom:0px; color:rgb(85,85,85); font-family:'microsoft yahei'; font-size:15px; line-height:35px">&#13;\n<span style="color:rgb(67,73,80)"> </span></p>&#13;\n<p style="margin-top:0px; margin-bottom:0px; padding-top:0px; padding-bottom:0px; color:rgb(85,85,85); font-family:'microsoft yahei'; font-size:15px; line-height:35px">&#13;\n<span style="color:rgb(67,73,80)">       </span><strong><span style="color:rgb(67,73,80)">使用方法：</span></strong><span style="color:rgb(67,73,80)">SET TRANSACTIONISOLATION LEVEL REPEATABLE READ</span></p>&#13;\n<p style="margin-top:0px; margin-bottom:0px; padding-top:0px; padding-bottom:0px; color:rgb(85,85,85); font-family:'microsoft yahei'; font-size:15px; line-height:35px">&#13;\n<strong><span style="color:rgb(67,73,80)"> </span></strong></p>&#13;\n<p style="margin-top:0px; margin-bottom:0px; padding-top:0px; padding-bottom:0px; color:rgb(85,85,85); font-family:'microsoft yahei'; font-size:15px; line-height:35px">&#13;\n<span style="color:rgb(67,73,80)">       </span><strong><span style="color:rgb(67,73,80)">未提交读：</span></strong><span style="color:rgb(67,73,80)"> </span><span style="color:rgb(67,73,80)">在读数据时不会检查或使用任何锁。因此，在这种隔离级别中可能读取到没有提交的数据。</span><span style="color:rgb(67,73,80)">  </span></p>&#13;\n<p style="margin-top:0px; margin-bottom:0px; padding-top:0px; padding-bottom:0px; color:rgb(85,85,85); font-family:'microsoft yahei'; font-size:15px; line-height:35px">&#13;\n<strong><span style="color:rgb(67,73,80)">       已提交读：</span></strong><span style="color:rgb(67,73,80)">只读取提交的数据并等待其他事务释放排他锁。读数据的共享锁在读操作完成后立即释放。已提交读是</span><span style="color:rgb(67,73,80)">SQL Server</span><span style="color:rgb(67,73,80)">的默认隔离级别。</span><span style="color:rgb(67,73,80)"> </span></p>&#13;\n<p style="margin-top:0px; margin-bottom:0px; padding-top:0px; padding-bottom:0px; color:rgb(85,85,85); font-family:'microsoft yahei'; font-size:15px; line-height:35px">&#13;\n<span style="color:rgb(67,73,80)">       </span><strong><span style="color:rgb(67,73,80)">可重复读：</span></strong><span style="color:rgb(67,73,80)"> </span><span style="color:rgb(67,73,80)">像已提交读级别那样读数据，但会保持共享锁直到事务结束。</span><span style="color:rgb(67,73,80)">  </span></p>&#13;\n<p style="margin-top:0px; margin-bottom:0px; padding-top:0px; padding-bottom:0px; color:rgb(85,85,85); font-family:'microsoft yahei'; font-size:15px; line-height:35px">&#13;\n<span style="color:rgb(67,73,80)">       <strong>可串行读：</strong></span><span style="color:rgb(67,73,80)">工作方式类似于可重复读。但它不仅会锁定受影响的数据，还会锁定这个范围。这就阻止了新数据插入查询所涉及的范围。</span></p>&#13;\n<p style="margin-top:0px; margin-bottom:0px; padding-top:0px; padding-bottom:0px; color:rgb(85,85,85); font-family:'microsoft yahei'; font-size:15px; line-height:35px">&#13;\n<span style="color:rgb(67,73,80)"><br />&#13;\n</span></p>&#13;\n<p align="left" style="margin-top:0px; margin-bottom:0px; padding-top:0px; padding-bottom:0px; color:rgb(85,85,85); font-family:'microsoft yahei'; font-size:15px; line-height:35px">&#13;\n<strong>六.持久性</strong></p>&#13;\n<p style="margin-top:0px; margin-bottom:0px; padding-top:0px; padding-bottom:0px; color:rgb(85,85,85); font-family:'microsoft yahei'; font-size:15px; line-height:35px">&#13;\n<span style="color:rgb(67,73,80)">       </span><span style="color:rgb(67,73,80)">持久性，意味着在事务完成以后，该事务所对数据库所作的更改便持久的保存在数据库之中，并不会被回滚。</span></p>&#13;\n<p style="margin-top:0px; margin-bottom:0px; padding-top:0px; padding-bottom:0px; color:rgb(85,85,85); font-family:'microsoft yahei'; font-size:15px; line-height:35px">&#13;\n<span style="color:rgb(67,73,80)">       </span><span style="color:rgb(67,73,80)">即使出现了任何事故比如断电等，事务一旦提交，则持久化保存在数据库中。</span></p>&#13;\n<p style="margin-top:0px; margin-bottom:0px; padding-top:0px; padding-bottom:0px; color:rgb(85,85,85); font-family:'microsoft yahei'; font-size:15px; line-height:35px">&#13;\n<span style="color:rgb(67,73,80)">       SQL SERVER</span><span style="color:rgb(67,73,80)">通过</span><span style="color:rgb(67,73,80)">write-ahead transaction log</span><span style="color:rgb(67,73,80)">来保证持久性。</span><span style="color:rgb(67,73,80)">write-ahead&#13;\n transaction log</span><span style="color:rgb(67,73,80)">的意思是，事务中对数据库的改变在写入到数据库之前，首先写入到事务日志中。而事务日志是按照顺序排号的（</span><span style="color:rgb(67,73,80)">LSN</span><span style="color:rgb(67,73,80)">）。当数据库崩溃或者服务器断点时，重启动</span><span style="color:rgb(67,73,80)">SQL&#13;\n SERVER</span><span style="color:rgb(67,73,80)">，</span><span style="color:rgb(67,73,80)">SQLSERVER</span><span style="color:rgb(67,73,80)">首先会检查日志顺序号，将本应对数据库做更改而未做的部分持久化到数据库，从而保证了持久性。</span></p>&#13;\n<p style="margin-top:0px; margin-bottom:0px; padding-top:0px; padding-bottom:0px; color:rgb(85,85,85); font-family:'microsoft yahei'; font-size:15px; line-height:35px">&#13;\n<span style="color:rgb(67,73,80)"><br />&#13;\n</span></p>&#13;\n<p align="left" style="margin-top:0px; margin-bottom:0px; padding-top:0px; padding-bottom:0px; color:rgb(85,85,85); font-family:'microsoft yahei'; font-size:15px; line-height:35px">&#13;\n<strong>七.总结</strong></p>&#13;\n<p style="margin-top:0px; margin-bottom:0px; padding-top:0px; padding-bottom:0px; color:rgb(85,85,85); font-family:'microsoft yahei'; font-size:15px; line-height:35px">&#13;\n<span style="color:rgb(67,73,80)">       </span><span style="color:rgb(67,73,80)">事务的（</span><span style="color:rgb(67,73,80)">ACID</span><span style="color:rgb(67,73,80)">）特性是由关系数据库管理系统（</span><span style="color:rgb(67,73,80)">RDBMS</span><span style="color:rgb(67,73,80)">，数据库系统）来实现的。数据库管理系统采用日志来保证事务的原子性、一致性和持久性。日志记录了事务对数据库所做的更新，如果某个事务在执行过程中发生错误，就可以根据日志，撤销事务对数据库已做的更新，使数据库退回到执行事务前的初始状态。</span></p>&#13;\n<p style="margin-top:0px; margin-bottom:0px; padding-top:0px; padding-bottom:0px; color:rgb(85,85,85); font-family:'microsoft yahei'; font-size:15px; line-height:35px">&#13;\n<span style="color:rgb(67,73,80)">　　数据库管理系统采用锁机制来实现事务的隔离性。当多个事务同时更新数据库中相同的数据时，只允许持有锁的事务能更新该数据，其他事务必须等待，直到前一个事务释放了锁，其他事务才有机会更新该数据。</span></p>&#13;\n<p style="margin-top:0px; margin-bottom:0px; padding-top:0px; padding-bottom:0px; color:rgb(85,85,85); font-family:'microsoft yahei'; font-size:15px; line-height:35px">&#13;\n<span style="color:rgb(67,73,80)"><br />&#13;\n</span></p>&#13;\n<p style="margin-top:0px; margin-bottom:0px; padding-top:0px; padding-bottom:0px; color:rgb(85,85,85); font-family:'microsoft yahei'; font-size:15px; line-height:35px">&#13;\n<span style="color:rgb(67,73,80)"><a target="_blank" href="http://www.behindhouse.com/" style="text-decoration:none; color:rgb(12,137,207)">转载</a>请注明出处：<a target="_blank" href="http://blog.csdn.net/shuaihj/article/details/14163713" style="text-decoration:none; color:rgb(12,137,207)">http://blog.csdn.net/shuaihj/article/details/14163713</a></span></p>&#13;\n<p style="margin-top:0px; margin-bottom:0px; padding-top:0px; padding-bottom:0px; color:rgb(85,85,85); font-family:'microsoft yahei'; font-size:15px; line-height:35px">&#13;\n<br />&#13;\n</p>&#13;\n<p style="margin-top:0px; margin-bottom:0px; padding-top:0px; padding-bottom:0px; color:rgb(85,85,85); font-family:'microsoft yahei'; font-size:15px; line-height:35px">&#13;\n<br />&#13;\n</p>&#13;\n &#13;\n
