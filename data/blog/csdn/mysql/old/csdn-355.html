\n\n<pre><a target="_blank" href="http://blog.csdn.net/l1028386804/article/details/48289765">转载请注明出处:http://blog.csdn.net/l1028386804/article/details/48289765</a><strong>\n</strong></pre>&#13;\n<p><strong>操作系统：CentOS6.5</strong></p>&#13;\n<p>    本文档主要讲解，如何在CentOS6.5下搭建Nginx+Tomcat+Memcached负载均衡集群服务器，Nginx负责负载均衡，Tomcat负责实际服务，Memcached负责同步Tomcat的Session，达到Session共享的目的。</p>&#13;\n<p>修改tomcat的server.xml文件</p>&#13;\n<p><span style="color:#ff0000"><span style="font-family:Microsoft YaHei">打开server.xml文件，在&lt;Engine&gt;节点的中添加jvmRoute="tomcatRoute1"，这个是用于指定Tomcat集群的路由。Tomcat2设置成jvmRoute="tomcatRoute2"，Tomcat3设置成jvmRoute="tomcatRoute3"，依次类推。</span></span><br />&#13;\n</p>&#13;\n<div>&#13;\n<h3>1.安装Nginx</h3>&#13;\n</div>&#13;\n<p>Nginx官网：<a target="_blank" href="http://nginx.org/">http://nginx.org/</a></p>&#13;\n<p>下载最新稳定版本。在安装Nginx之前，需要先安装gcc、 openssl、 pcre和zlib软件库。</p>&#13;\n<p><img src="http://img.blog.csdn.net/20150908132127253?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQv/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/Center" alt="" /></p>&#13;\n<h4>1.1安装gcc、gcc-c++</h4>&#13;\n<p>安装命令：</p>&#13;\n<pre code_snippet_id="1594823" snippet_file_name="blog_20160302_1_997554" name="code" class="plain">#sudo yum install gcc\n# sudo yum install gcc-c++</pre>&#13;\n<h4>1.2安装openssl</h4>&#13;\n<p>openssl官网：<a target="_blank" href="http://www.openssl.org/">http://www.openssl.org/</a></p>&#13;\n<p>安装版本：openssl-1.0.1i.tar.gz</p>&#13;\n<p>安装命令：</p>&#13;\n<pre code_snippet_id="1594823" snippet_file_name="blog_20160302_2_6984391" name="code" class="plain">#tar -zxvf openssl-1.0.1i.tar.gz\n#cd openssl-1.0.1i\n#sudo ./config --prefix=/usr/local/openssl-1.0.1i #prefix指定安装目录\n#sudo make\n#sudo make install</pre>&#13;\n<p>【注意】：此处使用的是config命令，而不是平常的configure命令</p>&#13;\n<p>安装完成后，到/usr/local/下查看是否安装成功。如果安装出错，需要重新加压缩，重新安装。</p>&#13;\n<h4>1.3安装pcre</h4>&#13;\n<p>pcre官网：<a target="_blank" href="http://www.pcre.org/">http://www.pcre.org/</a></p>&#13;\n<p>安装版本：pcre-8.35.tar.gz</p>&#13;\n<p>安装命令：</p>&#13;\n<pre code_snippet_id="1594823" snippet_file_name="blog_20160302_3_2174842" name="code" class="plain">#tar -zxvf pcre-8.35.tar.gz\n#cd pcre-8.35\n#sudo ./configure --prefix=/usr/local/pcre-8.35 #prefix指定安装目录\n#sudo make\n#sudo make install</pre>&#13;\n<p>安装完成后，到/usr/local/下查看是否安装成功。如果安装出错，需要重新加压缩，重新安装。</p>&#13;\n<p>【注意】：如果没有安装c++编译器，这个软件的安装会报错！</p>&#13;\n<h4>1.4安装zlib</h4>&#13;\n<p>zlib官网：<a target="_blank" href="http://www.zlib.net/">http://www.zlib.net/</a></p>&#13;\n<p>安装版本：zlib-1.2.8.tar.gz</p>&#13;\n<p>安装命令：</p>&#13;\n<pre code_snippet_id="1594823" snippet_file_name="blog_20160302_4_81291" name="code" class="plain">#tar -zxvf zlib-1.2.8.tar.gz\n#cd zlib-1.2.8\n#sudo ./configure --prefix=/usr/local/zlib-1.2.8 #prefix指定安装目录\n#sudo make\n#sudo make install</pre>&#13;\n<p>安装完成后，到/usr/local/下查看是否安装成功。如果安装出错，需要重新加压缩，重新安装。</p>&#13;\n<h4>1.5安装Nginx</h4>&#13;\n<p>安装版本：nginx-1.6.1.tar.gz</p>&#13;\n<p>安装命令：</p>&#13;\n<pre code_snippet_id="1594823" snippet_file_name="blog_20160302_5_5271741" name="code" class="plain">#tar -zxvf nginx-1.6.1.tar.gz\n#cd nginx-1.6.1\n#sudo ./configure\n--prefix=/usr/local/nginx-1.6.1 #prefix指定安装目录\n--with-openssl=/home/zht/src/openssl-1.0.1i #指的是openssl源码路径\n--with-pcre=/home/zht/src/pcre-8.3.5 #指的是pcre的源码路径\n--with-zlib=/home/zht/src/zlib-1.2.8 #指的是zlib 的源码路径\n--with-http_ssl_module\n#sudo make\n#make install</pre>&#13;\n<p>安装完成后，到/usr/local/下查看是否安装成功。如果安装出错，需要重新加压缩，重新安装。</p>&#13;\n<p></p>&#13;\n<p><img src="http://img.blog.csdn.net/20150908132233424?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQv/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/Center" alt="" /></p>&#13;\n<h5>1.5.1 配置Nginx</h5>&#13;\n<p>配置文件目录：<strong>/usr/local/nginx-1.6.1/conf/nginx.conf</strong></p>&#13;\n<pre code_snippet_id="1594823" snippet_file_name="blog_20160302_6_3526855" name="code" class="plain"># cd /usr/local/nginx-1.6.1/conf\n# sudo vi nginx.conf</pre>&#13;\n<p>【修改后的配置文件如下】：</p>&#13;\n<p></p><pre code_snippet_id="1594823" snippet_file_name="blog_20160302_7_669153" name="code" class="plain">#创建进程的用户和用户组\n\nuser liuyazhuang liuyazhuang;\n\n#服务进程数量，一般等于CPU数量\n\nworker_processes 2;\n\n\n#全局错误日志定义，建议开启error级别日志.[ debug | info | notice | warn | error | crit ]\n\nerror_log logs/error.log error;\n\n#error_log logs/error.log notice;\n\n#error_log logs/error.log info;\n\n \n\n#记录进程ID的文件\n\n#pid logs/nginx.pid;\n\n \n\n \n\nevents {\n\n #epoll是多路复用IO(I/O Multiplexing)中的一种方式,但是仅用于linux2.6以上内核,可以大大提高nginx的性能.Linux建议使用epoll，FreeBSD建议使用kqueue.\n\n use epoll;\n\n #一个worker_processe允许的最近并发连接数量\n\n worker_connections 1024;\n\n}\n\n \n\n \n\nhttp {\n\n include mime.types;\n\n default_type application/octet-stream;\n\n \t client_max_body_size 16m;\n client_body_buffer_size 256k;\n proxy_connect_timeout 1200;\n proxy_read_timeout 1200;\n proxy_send_timeout 6000;\n proxy_buffer_size 32k;\n proxy_buffers 4 64k;\n proxy_busy_buffers_size 128k;\n proxy_temp_file_write_size 128k;\n\n #log_format main '$remote_addr - $remote_user [$time_local]"$request" '\n\n # '$status $body_bytes_sent"$http_referer" '\n\n # '"$http_user_agent""$http_x_forwarded_for"';\n\n \n\n #access_log logs/access.log main;\n\n \n\n sendfile on;\n\n #tcp_nopush on;\n\n \n\n #http连接的持续时间\n\n keepalive_timeout 65;\n\n \n\n #gzip压缩设置\n\n gzip on; #开启gzip\n\n gzip_min_length 1k; #最小压缩文件大小\n\n gzip_buffers 4 16k; #压缩缓冲区\n\n #http的协议版本(1.0/1.1),默认1.1，前端如果是squid2.5请使用1.0\n\n gzip_http_version 1.1;\n\n #gzip压缩比，1压缩比最小处理速度最快，9压缩比最大但处理速度最慢(传输快但比较消耗cpu)\n\n gzip_comp_level 2; \n\n #和http头有关系，加个vary头，给代理服务器用的，有的浏览器支持压缩，有的不支持，所以避免浪费不支持的也压缩，所以根据客户端的HTTP头来判断，是否需要压缩\n\n gzip_vary on;\n\n #gzip压缩类型，不用添加text/html，否则会有警告信息\n\n gzip_types text/plain text/javascript text/css application/xmlapplication/x-javascript application/json;\n\n \n\n #设定负载均衡的服务器列表，可以设置多个upstream，但mysvr名字要区分\n\n upstream myClusterServer1 {\n\n #weigth参数表示权值，权值越高被分配到的几率越大\n\n #本机上的Squid开启3128端口\n\n server 127.0.0.1:8081 weight=5;\n\n server 127.0.0.1:8082 weight=5;\n\n server 127.0.0.1:8083 weight=5;\n\n }\n\n \n\n server {\n\n #nginx监听的端口号\n\n listen 80;\n\n #域名可以有多个，用空格隔开\n\n server_name 127.0.0.1;\n\n \n\n #字符编码方式\n\n charset utf-8;\n\n \n\n #设定本虚拟主机的访问日志。关闭日志可以减少IO，提高性能。\n\n #access_log logs/host.access.log main;\n\n \n\n #默认请求\n\n location / {\n\n #定义服务器的默认网站根目录位置\n\n root html;\n\n #定义首页索引文件的名称\n\n index index.html index.htmindex.jsp;\n\n #请求转向mysvr 定义的服务器列表\n\n proxy_pass http://myClusterServer1;\n\n proxy_redirect default;\n\n #跟代理服务器连接的超时时间，必须留意这个time out时间不能超过75秒，当一台服务器当掉时，过10秒转发到另外一台服务器。\n\n proxy_connect_timeout 10;\n\n }\n\n \n\n #error_page 404 /404.html;\n\n \n\n #redirect server error pages to the static page /50x.html\n\n #\n\n error_page 500 502 503 504 /50x.html;\n\n location = /50x.html {\n\n root html;\n\n }\n\n \n\n #proxy the PHP scripts to Apache listening on 127.0.0.1:80\n\n #\n\n #location ~ \\.php$ {\n\n # proxy_pass http://127.0.0.1;\n\n #}\n\n \n\n #pass the PHP scripts to FastCGI server listening on 127.0.0.1:9000\n\n #\n\n #location ~ \\.php$ {\n\n # root html;\n\n # fastcgi_pass 127.0.0.1:9000;\n\n # fastcgi_index index.php;\n\n # fastcgi_param SCRIPT_FILENAME /scripts$fastcgi_script_name;\n\n # include fastcgi_params;\n\n #}\n\n \n\n #deny access to .htaccess files, if Apache's document root\n\n #concurs with nginx's one\n\n #\n\n #location ~ /\\.ht {\n\n # deny all;\n\n #}\n\n }\n\n \n\n \n\n # anothervirtual host using mix of IP-, name-, and port-based configuration\n\n #\n\n #server {\n\n # listen 8000;\n\n # listen somename:8080;\n\n # server_name somename alias another.alias;\n\n \n\n # location / {\n\n # root html;\n\n # index index.html index.htm;\n\n # }\n\n #}\n\n \n\n \n\n # HTTPS server\n\n #\n\n #server {\n\n # listen 443 ssl;\n\n # server_name localhost;\n\n \n\n # ssl_certificate cert.pem;\n\n # ssl_certificate_key cert.key;\n\n \n\n # ssl_session_cache shared:SSL:1m;\n\n # ssl_session_timeout 5m;\n\n \n\n # ssl_ciphers HIGH:!aNULL:!MD5;\n\n # ssl_prefer_server_ciphers on;\n\n \n\n # location / {\n\n # root html;\n\n # index index.html index.htm;\n\n # }\n\n #}\n\n \n\n}</pre>&#13;\n<p></p>&#13;\n<h5>1.5.2启动与关闭Nginx</h5>&#13;\n<p>(1)启动</p>&#13;\n<p></p>&#13;\n<pre code_snippet_id="1594823" snippet_file_name="blog_20160302_8_1955909" name="code" class="plain"># sudo /usr/local/nginx-1.6.1/sbin/nginx</pre>&#13;\n<p></p>&#13;\n<p>确保系统的 80 端口没被其他程序占用</p>&#13;\n<p>重启：</p>&#13;\n<p></p>&#13;\n<pre code_snippet_id="1594823" snippet_file_name="blog_20160302_9_1814205" name="code" class="plain"># sudo /usr/local/nginx-1.6.1/sbin/nginx -s reload</pre>&#13;\n<p></p>&#13;\n<p>(2)关闭：</p>&#13;\n<p></p>&#13;\n<pre code_snippet_id="1594823" snippet_file_name="blog_20160302_10_8117470" name="code" class="plain">ps -ef | grep nginx</pre>&#13;\n<p></p>&#13;\n<p>找到主进程ID，然后kill即可，如：</p>&#13;\n<p></p>&#13;\n<pre code_snippet_id="1594823" snippet_file_name="blog_20160302_11_6895971" name="code" class="plain"># kill -9 [进程号]</pre>&#13;\n<p></p>&#13;\n<p></p>&#13;\n<p> <img src="http://img.blog.csdn.net/20150908132357599?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQv/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/Center" alt="" /><br />&#13;\n</p>&#13;\n<p>(3)检查是否启动成功：</p>&#13;\n<p></p>&#13;\n<pre code_snippet_id="1594823" snippet_file_name="blog_20160302_12_7626319" name="code" class="plain">netstat -ano | grep80</pre>&#13;\n<p></p>&#13;\n<p> 有结果输入说明启动成功</p>&#13;\n<p>打开浏览器访问此机器的 IP，如果浏览器出现Welcome to nginx! 则表示 Nginx 已经安装并运行成功。如果已经配置了负载均衡服务器，则会看Tomcat中的网站页面，如下图：</p>&#13;\n<p></p>&#13;\n<p> <img src="http://img.blog.csdn.net/20150908132439483?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQv/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/Center" alt="" /></p>&#13;\n<div>&#13;\n<h3>2. Memcache安装</h3>&#13;\n</div>&#13;\n<p>Memcached官网：<a target="_blank" href="http://memcached.org/">http://memcached.org/</a></p>&#13;\n<p>安装memcached需要先安装libevent，libevent官网：<a target="_blank" href="http://libevent.org/">http://libevent.org/</a></p>&#13;\n<p>本次安装版本：</p>&#13;\n<p>memcached-1.4.20.tar.gz</p>&#13;\n<p>libevent-2.0.21-stable.tar.gz</p>&#13;\n<h4>2.1安装livevent</h4>&#13;\n<p>查看是否已安装：# rpm qa | grep libevent</p>&#13;\n<p>如果已安装且版本低于1.3，则先通过：</p>&#13;\n<p></p>&#13;\n<pre code_snippet_id="1594823" snippet_file_name="blog_20160302_13_3929585" name="code" class="plain"># rpm -e libevent --nodeps</pre>&#13;\n<p></p>&#13;\n<p> 进行卸载。</p>&#13;\n<p></p>&#13;\n<pre code_snippet_id="1594823" snippet_file_name="blog_20160302_14_3580138" name="code" class="plain"># tar zxvf libevent-2.0.21-stable.tar.gz\n# cd libevent-2.0.21-stable\n# sudo ./configure --prefix=/usr/local/libevent-2.0.21-stable #prefix指定安装路径\n# sudo make\n# sudo make install</pre>&#13;\n<p></p>&#13;\n<p>安装完成后，到prefix指定的目录下，看看是否存在libevent-2.0.21-stable目录，如下图所示。</p>&#13;\n<p><img src="http://img.blog.csdn.net/20150908132518428?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQv/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/Center" alt="" width="582" height="324" /></p>&#13;\n<h4>2.2安装Memcached</h4>&#13;\n<p></p>&#13;\n<pre code_snippet_id="1594823" snippet_file_name="blog_20160302_15_6295353" name="code" class="plain"># tar zxvf memcached-1.4.20.tar.gz\n# cd memcached-1.4.20\n# sudo ./configure\n--prefix=/usr/local/memcached-1.4.20\n--with-libevent=/usr/local/libevent-2.0.21-stable\n# sudo make\n# sudo make install</pre>&#13;\n<p></p>&#13;\n<h5>2.2.1检查看装情况</h5>&#13;\n<p>安装完成后，到prefix指定的目录下查看是否有memcached-1.4.20目录，如下图所示。</p>&#13;\n<p></p>&#13;\n<p> <img src="http://img.blog.csdn.net/20150908132602499?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQv/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/Center" alt="" width="583" height="322" /></p>&#13;\n<h5>2.2.2查看memcached和libevent版本信息</h5>&#13;\n<p>首先定位到Memcached的bin目录下：</p>&#13;\n<p></p>&#13;\n<pre code_snippet_id="1594823" snippet_file_name="blog_20160302_16_3122007" name="code" class="plain"># cd /usr/local/memcached-1.4.20/bin</pre>&#13;\n<p></p>&#13;\n<p>执行命令：</p>&#13;\n<p></p>&#13;\n<pre code_snippet_id="1594823" snippet_file_name="blog_20160302_17_1900508" name="code" class="plain"># sudo ./memcached -i</pre>&#13;\n<p></p>&#13;\n<p></p>&#13;\n<p> <img src="http://img.blog.csdn.net/20150908132644136?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQv/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/Center" alt="" width="578" height="321" /></p>&#13;\n<h5>2.2.3启动memcached</h5>&#13;\n<p></p>&#13;\n<pre code_snippet_id="1594823" snippet_file_name="blog_20160302_18_8552437" name="code" class="plain"># sudo ./memcached -d -v -p 12000 -m 512 -u zht</pre>&#13;\n<p></p>&#13;\n<p>解释：-d表示以守护进程方式运行memcached；-v表示输出浸膏和错误信息；-p指定监听的端口号；-m指定能使用的最大内存，单位MB；-u指定运行memcached的账户，非root用户。</p>&#13;\n<p>使用# ps -ef | grep memcached查看进程。</p>&#13;\n<p><img src="http://img.blog.csdn.net/20150908132727235?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQv/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/Center" alt="" /></p>&#13;\n<table border="1" cellpadding="0" cellspacing="0">&#13;\n<tbody>&#13;\n<tr>&#13;\n<td valign="top">&#13;\n<p><strong>关注基本选项：</strong></p>&#13;\n</td>&#13;\n<td valign="top">&#13;\n<p><strong>说明</strong></p>&#13;\n</td>&#13;\n</tr>&#13;\n<tr>&#13;\n<td valign="top">&#13;\n<p>-p &lt;num&gt;</p>&#13;\n</td>&#13;\n<td valign="top">&#13;\n<p>监听的TCP端口 (缺省: 11211)</p>&#13;\n</td>&#13;\n</tr>&#13;\n<tr>&#13;\n<td valign="top">&#13;\n<p>-d</p>&#13;\n</td>&#13;\n<td valign="top">&#13;\n<p>以守护进程方式运行memcached</p>&#13;\n</td>&#13;\n</tr>&#13;\n<tr>&#13;\n<td valign="top">&#13;\n<p>-u &lt;username&gt;</p>&#13;\n</td>&#13;\n<td valign="top">&#13;\n<p>运行memcached的账户，非root用户</p>&#13;\n</td>&#13;\n</tr>&#13;\n<tr>&#13;\n<td valign="top">&#13;\n<p>-m &lt;num&gt;</p>&#13;\n</td>&#13;\n<td valign="top">&#13;\n<p>最大的内存使用，单位是MB，缺省是 64 MB</p>&#13;\n</td>&#13;\n</tr>&#13;\n<tr>&#13;\n<td valign="top">&#13;\n<p>-c &lt;num&gt;</p>&#13;\n</td>&#13;\n<td valign="top">&#13;\n<p>软连接数量，缺省是1024（最大并发连接数）</p>&#13;\n</td>&#13;\n</tr>&#13;\n<tr>&#13;\n<td valign="top">&#13;\n<p>-v</p>&#13;\n</td>&#13;\n<td valign="top">&#13;\n<p>输出警告和错误信息</p>&#13;\n</td>&#13;\n</tr>&#13;\n<tr>&#13;\n<td valign="top">&#13;\n<p>-vv</p>&#13;\n</td>&#13;\n<td valign="top">&#13;\n<p>打印客户端的请求和返回信息</p>&#13;\n</td>&#13;\n</tr>&#13;\n<tr>&#13;\n<td valign="top">&#13;\n<p>-h</p>&#13;\n</td>&#13;\n<td valign="top">&#13;\n<p>打印帮助信息</p>&#13;\n</td>&#13;\n</tr>&#13;\n<tr>&#13;\n<td valign="top">&#13;\n<p>-i</p>&#13;\n</td>&#13;\n<td valign="top">&#13;\n<p>打印memcached和libevent的版权信息</p>&#13;\n</td>&#13;\n</tr>&#13;\n</tbody>&#13;\n</table>&#13;\n<h5>2.2.4使用telnet验证服务是否可用</h5>&#13;\n<p>Win7安装telnet：控制面板-&gt; 程序和功能-&gt;打开或安装Windows功能-&gt;勾选Telnet服务端、Telnet客户端。</p>&#13;\n<p><img src="http://img.blog.csdn.net/20150908132817723?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQv/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/Center" alt="" /><br />&#13;\n</p>&#13;\n<p></p>&#13;\n<p>CentOS安装telnet客户端：</p>&#13;\n<p></p>&#13;\n<pre code_snippet_id="1594823" snippet_file_name="blog_20160302_19_711246" name="code" class="plain"># sudo yum install telnet</pre>&#13;\n<p></p>&#13;\n<p>Windows命令：</p>&#13;\n<p></p>&#13;\n<p> <img src="http://img.blog.csdn.net/20150908132850276?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQv/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/Center" alt="" /></p>&#13;\n<p>CentOS（Linux）下命令：</p>&#13;\n<p></p>&#13;\n<pre code_snippet_id="1594823" snippet_file_name="blog_20160302_20_5029644" name="code" class="plain"># telnet 127.0.0.1 12000</pre>&#13;\n<p></p>&#13;\n<p>Trying 127.0.0.1...</p>&#13;\n<p>Connected to localhost (127.0.0.1).</p>&#13;\n<p>Escape character is '^]'.</p>&#13;\n<p>连接成功后，手动输入命令：stats</p>&#13;\n<p>即可看到如下信息：</p>&#13;\n<p><img src="http://img.blog.csdn.net/20150908132932288?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQv/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/Center" alt="" /><br />&#13;\n</p>&#13;\n<p>手动输入：quit   //退出</p>&#13;\n<p>Connection closed by foreign host</p>&#13;\n<p><img src="http://img.blog.csdn.net/20150908133017198?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQv/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/Center" alt="" /><br />&#13;\n</p>&#13;\n<h5>2.2.5停止memcached服务</h5>&#13;\n<p></p>&#13;\n<pre code_snippet_id="1594823" snippet_file_name="blog_20160302_21_1332910" name="code" class="plain"># ps -ef | grep memcached</pre>&#13;\n<p></p>&#13;\n<p>找到memcached进程ID号，然后强制杀死：</p>&#13;\n<p></p>&#13;\n<pre code_snippet_id="1594823" snippet_file_name="blog_20160302_22_6872024" name="code" class="plain">kill - 9 2439</pre>&#13;\n<p></p>&#13;\n<div>&#13;\n<h3>3.安装Tomcat+配置memcached</h3>&#13;\n</div>&#13;\n<p>Tomcat官网：<a target="_blank" href="http://tomcat.apache.org/">http://tomcat.apache.org/</a></p>&#13;\n<h4>3.1安装Tomcat</h4>&#13;\n<p>本次使用Tomcat版本：apache-tomcat-7.0.55.tar.gz</p>&#13;\n<p>将Tomcat解压到任意目录下。</p>&#13;\n<p><img src="http://img.blog.csdn.net/20150908133131198?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQv/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/Center" alt="" /></p>&#13;\n<h4>3.2为Tomcat配置memcached</h4>&#13;\n<h5>3.2.1为Tomcat添加库文件</h5>&#13;\n<p>Tomcat要支持memcached管理Session，需要调用一些jar库文件：</p>&#13;\n<table border="1" cellpadding="0" cellspacing="0">&#13;\n<tbody>&#13;\n<tr>&#13;\n<td valign="top">&#13;\n<p>添加mem和msm的依赖jar包：</p>&#13;\n</td>&#13;\n</tr>&#13;\n<tr>&#13;\n<td valign="top">&#13;\n<p><strong><span style="color:#0070C0">couchbase-client-1.2.2.jar</span></strong></p>&#13;\n<p><strong><span style="color:#0070C0">javolution-5.4.3.1.jar</span></strong></p>&#13;\n<p><strong><span style="color:#0070C0">kryo-1.03.jar</span></strong></p>&#13;\n<p><strong><span style="color:#0070C0">kryo-serializers-0.10.jar</span></strong></p>&#13;\n<p><strong><span style="color:#0070C0">memcached-session-manager-1.6.5.jar</span></strong></p>&#13;\n<p><strong><span style="color:#0070C0">memcached-session-manager-tc6-1.6.5.jar</span></strong></p>&#13;\n<p><strong><span style="color:#0070C0">minlog-1.2.jar</span></strong></p>&#13;\n<p><strong><span style="color:#0070C0">msm-kryo-serializer-1.6.5.jar</span></strong></p>&#13;\n<p><strong><span style="color:#0070C0">reflectasm-0.9.jar</span></strong></p>&#13;\n<p><strong><span style="color:#0070C0">spymemcached-2.10.2.jar</span></strong></p>&#13;\n</td>&#13;\n</tr>&#13;\n</tbody>&#13;\n</table>&#13;\n<p>【注意】：</p>&#13;\n<p>msm1.6.5依赖了Couchbase，需要添加couchbase-client的jar包，否则启动会报：java.lang.NoClassDefFoundError:com/couchbase/client/CouchbaseClient。</p>&#13;\n<p>Tomcat6和Tomcat7使用不同msm支持包：memcached-session-manager-tc6-1.6.5.jar和memcached-session-manager-tc7-1.6.5.jar，只可选一，否则启动报错。</p>&#13;\n<p>msm源码中的lib包版本太低：spymemcached需要使用2.10.2，否则启动tomcat报错：</p>&#13;\n<p>java.lang.NoSuchMethodError:net.spy.memcached.MemcachedClient.set(Ljava/lang/String;ILjava/lang/Object;)Lnet/spy/memcached/internal/OperationFuture;</p>&#13;\n<p>atde.javakaffee.web.msm.BackupSessionTask.storeSessionInMemcached(BackupSessionTask.java:227)</p>&#13;\n<p>kryo-serializers需要使用0.10版本，否则报错：</p>&#13;\n<p>Caused by:java.lang.ClassNotFoundException: de.javakaffee.kryoserializers.DateSerializer</p>&#13;\n<p>部分文件下载地址：<a target="_blank" href="http://code.google.com/p/memcached-session-manager/downloads/list">http://code.google.com/p/memcached-session-manager/downloads/list</a></p>&#13;\n<p>其他的文件自己找。</p>&#13;\n<p>下载后，将这些库文件放到<strong>tomcat\\lib</strong>目录下。</p>&#13;\n<h5>3.2.2为Tomcat配置memcached</h5>&#13;\n<p>配置文件目录：<strong>tomcat\\conf\\context.xml</strong></p>&#13;\n<p>打开配置文件，在&lt;Context&gt;...&lt;/Context&gt;节点中添加如下内容：</p>&#13;\n<p></p>&#13;\n<pre code_snippet_id="1594823" snippet_file_name="blog_20160302_23_8715187" name="code" class="html">&lt;Manager className="de.javakaffee.web.msm.MemcachedBackupSessionManager"\n memcachedNodes="n1:127.0.0.1:12000"\n requestUriIgnorePattern=".*\\.(png|gif|jpg|css|js|ico|jpeg|htm|html)$"\n sessionBackupAsync="false"\n sessionBackupTimeout="100"\n copyCollectionsForSerialization="false" transcoderFactoryClass="de.javakaffee.web.msm.serializer.kryo.KryoTranscoderFactory"/&gt; \n</pre>&#13;\n<p></p>&#13;\n<p>【参数说明】：</p>&#13;\n<p>docBase：与&lt;Host&gt;中的appBase一致，网站部署目录。</p>&#13;\n<p>memcachedNodes：memcached服务器信息，多个服务器时，使用空格分开，如：</p>&#13;\n<p>n1:127.0.0.1:12001 n2:127.0.0.1:12002  n3:127.0.0.1:12003</p>&#13;\n<p>配置文件如下图所示：</p>&#13;\n<p> <img src="http://img.blog.csdn.net/20150908133242453?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQv/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/Center" alt="" /></p>&#13;\n<p></p>&#13;\n<p>还有在server.xml中配置&lt;Host&gt;节点的appBase="部署目录"</p>&#13;\n<p></p>&#13;\n<p> <img src="http://img.blog.csdn.net/20150908133312857?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQv/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/Center" alt="" /></p>&#13;\n<h5>3.2.3测试Session共享</h5>&#13;\n<p>测试JSP代码如下：index.jsp</p>&#13;\n<p></p>&#13;\n<p><img src="http://img.blog.csdn.net/20150908133344022?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQv/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/Center" alt="" /></p>&#13;\n<p></p>&#13;\n<p>同时启动多个Tomcat，我部署了3个，打开浏览器去访问第一个Tomcat，然后在访问第二个和第三个Tomcat，页面Session信息如下：</p>&#13;\n<p><img src="http://img.blog.csdn.net/20150908133431345?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQv/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/Center" alt="" /></p>&#13;\n<p><img src="http://img.blog.csdn.net/20150908133505588?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQv/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/Center" alt="" /><br />&#13;\n</p>&#13;\n<p></p>&#13;\n<p>由图可以看到，三个Tomcat的SessionID都是一样的：5FBF6D6B6F37BE8248ED965536427005-n1，只要不关闭浏览器，不管怎么刷新，SessionID都是不变了。由此可以，三个Tomcat通过memcached实现了Session信息共享。</p>&#13;\n<div>&#13;\n<h3>4.安装Samba共享文件服务</h3>&#13;\n</div>&#13;\n<p>查看是否已经安装samba：</p>&#13;\n<p></p>&#13;\n<pre code_snippet_id="1594823" snippet_file_name="blog_20160302_24_3905638" name="code" class="plain"># rpm -qa | grep samba</pre>&#13;\n<p></p>&#13;\n<h4>4.1安装samba</h4>&#13;\n<p>使用网络安装快速方便，命令如下：</p>&#13;\n<p></p>&#13;\n<pre code_snippet_id="1594823" snippet_file_name="blog_20160302_25_4320342" name="code" class="plain"># sudo yum install samba samba-client</pre>&#13;\n<p></p>&#13;\n<h4>4.2配置共享文件夹</h4>&#13;\n<p>(1)修改配置文件：</p>&#13;\n<p></p>&#13;\n<pre code_snippet_id="1594823" snippet_file_name="blog_20160302_26_2019048" name="code" class="plain"># sudo vi /etc/samba/smb.conf</pre>&#13;\n<p></p>&#13;\n<p>[SharedFolder]</p>&#13;\n<pre code_snippet_id="1594823" snippet_file_name="blog_20160302_27_1669601" name="code" class="plain">path = /home/zht/SharedFolder #共享目录的路径\nwriteable = yes #是否允许写\nbrowsable = yes #是否允许以浏览目录内容\nvalid user = zht #访问目录的账户名</pre>&#13;\n<p>(2)添加账户</p>&#13;\n<p>添加zht账户：</p>&#13;\n<p></p>&#13;\n<pre code_snippet_id="1594823" snippet_file_name="blog_20160302_28_9576048" name="code" class="plain"># sudosmbpasswd -a zht</pre>&#13;\n<p></p>&#13;\n<p>按照提示输出访问密码。</p>&#13;\n<h4>4.3开启端口号</h4>&#13;\n<pre code_snippet_id="1594823" snippet_file_name="blog_20160302_29_6751366" name="code" class="plain">Port 137 (UDP) --NetBIOS name server and nmbd\nPort 138 (UDP) --NetBIOS datagram service\nPort 139 (TCP) --File and printer sharing and smbd\nPort 389 (TCP) --for LDAP(Active Directory Mode)\nPort 445 (TCP) --NetBIOS was moved to 445 after 2000 and beyond(CIFS)\nPort 901 (TCP) --for SWAT</pre>&#13;\n<p>(1) CentOS使用图形化添加端口号：sudo setup；</p>&#13;\n<p>(2) 使用以下命令开启：</p>&#13;\n<pre code_snippet_id="1594823" snippet_file_name="blog_20160302_30_1941818" name="code" class="plain"># iptables -I INPUT -p udp --dport [端口号] -j ACCEPT\n# iptables -I INPUT -p tcp --dport [端口号] -j ACCEPT</pre>&#13;\n<p>保存：</p>&#13;\n<p></p>&#13;\n<pre code_snippet_id="1594823" snippet_file_name="blog_20160302_31_8245083" name="code" class="plain"># sudo service iptables save</pre>&#13;\n<p></p>&#13;\n<p><img src="http://img.blog.csdn.net/20150908133605686?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQv/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/Center" alt="" /></p>&#13;\n<h4>4.4关闭SELinux</h4>&#13;\n<p>查看状态：</p>&#13;\n<p></p>&#13;\n<pre code_snippet_id="1594823" snippet_file_name="blog_20160302_32_8975431" name="code" class="plain"># getenforce</pre>&#13;\n<p></p>&#13;\n<p>关闭： <br />&#13;\n</p>&#13;\n<p></p>&#13;\n<pre code_snippet_id="1594823" snippet_file_name="blog_20160302_33_5245677" name="code" class="plain"># setenforce 0</pre>&#13;\n<p></p>&#13;\n<p>SELinux几种状态：</p>&#13;\n<p>enforcing：强制模式，代表SELinux运行中且正确限制；</p>&#13;\n<p>permissive：宽容模式，代表SELinux运行中，不过仅有警告信息，并不实际限制；</p>&#13;\n<p>disable：关闭，SELinux未运行。</p>&#13;\n<p>永久关闭方法：</p>&#13;\n<pre code_snippet_id="1594823" snippet_file_name="blog_20160302_34_8692023" name="code" class="plain"># sudo vi /etc/selinux/config\n# SELINUX = enforcing 注释掉\n# SELINUXTYPE = targeted 注释掉</pre>&#13;\n<p>在末尾添加一行：</p>&#13;\n<p></p>&#13;\n<pre code_snippet_id="1594823" snippet_file_name="blog_20160302_35_7295801" name="code" class="plain">SELINUX = disable</pre>&#13;\n<p></p>&#13;\n<p>保存关闭：</p>&#13;\n<p></p>&#13;\n<pre code_snippet_id="1594823" snippet_file_name="blog_20160302_36_3566047" name="code" class="plain">:wq</pre>&#13;\n<p></p>&#13;\n<p>重启系统</p>&#13;\n<p></p>&#13;\n<p> <img src="http://img.blog.csdn.net/20150908133635421?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQv/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/Center" alt="" /></p>&#13;\n<h4>4.5启动与停止服务</h4>&#13;\n<p>（1）查看运行状态：</p>&#13;\n<p></p>&#13;\n<pre code_snippet_id="1594823" snippet_file_name="blog_20160302_37_9836292" name="code" class="plain"># sudo service smb status</pre>&#13;\n<p></p>&#13;\n<p>（2）启动和停止服务：</p>&#13;\n<p></p>&#13;\n<pre code_snippet_id="1594823" snippet_file_name="blog_20160302_38_8614793" name="code" class="plain"># sudo /etc/init.d/smb start/stop/restart</pre>&#13;\n<p></p>&#13;\n<p>或者</p>&#13;\n<p></p>&#13;\n<pre code_snippet_id="1594823" snippet_file_name="blog_20160302_39_7949702" name="code" class="plain"># sudo service smb start/stop/restart</pre>&#13;\n<p></p>&#13;\n<p>（3）设置开启启动：</p>&#13;\n<p></p>&#13;\n<pre code_snippet_id="1594823" snippet_file_name="blog_20160302_40_3521837" name="code" class="plain"># sudo chkconfig --level 35 smb on</pre>&#13;\n<p></p>&#13;\n<p>在3,5级别上自动运行smb服务</p>&#13;\n<p>（4）验证服务</p>&#13;\n<p></p>&#13;\n<pre code_snippet_id="1594823" snippet_file_name="blog_20160302_41_3380133" name="code" class="plain"># smbclient -L //192.168.101.249 -U rxyy</pre>&#13;\n<p></p>&#13;\n<p>或者</p>&#13;\n<p></p>&#13;\n<pre code_snippet_id="1594823" snippet_file_name="blog_20160302_42_3063705" name="code" class="plain"># smbclient //192.168.101.249/sharedFolder -U rxyy</pre>&#13;\n<p></p>&#13;\n<div>&#13;\n<h3>5安装配置JDK</h3>&#13;\n</div>&#13;\n<p>本次使用JDK版本为：jdk-7u60-linux-x64.tar.gz</p>&#13;\n<h4>5.1卸载已安装的JDK</h4>&#13;\n<p>查看已经安装的JDK</p>&#13;\n<p></p>&#13;\n<pre code_snippet_id="1594823" snippet_file_name="blog_20160302_43_7763787" name="code" class="plain"># rpm -qa | grep jdk*</pre>&#13;\n<p></p>&#13;\n<p>卸载JDK：</p>&#13;\n<p></p>&#13;\n<pre code_snippet_id="1594823" snippet_file_name="blog_20160302_44_6018901" name="code" class="plain"># sudo yum -y remove [包名]</pre>&#13;\n<p></p>&#13;\n<p>如下图所示：</p>&#13;\n<p><img src="http://img.blog.csdn.net/20150908133723896?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQv/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/Center" alt="" /></p>&#13;\n<p>安装新的JDK：将jdk-7u60-linux-x64.tar.gz解压缩到指定目录下即可。</p>&#13;\n<p><img src="http://img.blog.csdn.net/20150908133813950?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQv/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/Center" alt="" /><br />&#13;\n</p>&#13;\n<p></p>&#13;\n<h4>5.2配置Java环境变量</h4>&#13;\n<p></p>&#13;\n<pre code_snippet_id="1594823" snippet_file_name="blog_20160302_45_7621301" name="code" class="plain"># sudo vi /etc/profile</pre>&#13;\n<p></p>&#13;\n<p>在末尾添加：</p>&#13;\n<p>#JDK</p>&#13;\n<pre code_snippet_id="1594823" snippet_file_name="blog_20160302_46_3401179" name="code" class="plain">exportJAVA_HOME=/home/zht/BalanceServer/Java/jdk1.7.0_60\nexport JRE_HOME=$JAVA_HOME/jre\nexport CLASSPATH=$CLASSPATH:.:$JRE_HOME/lib:$JAVA_HOME/lib\nexport PATH=$PATH:$JAVA_HOME/bin:$JRE_HOME/bin</pre>&#13;\n<p>如下图所示：</p>&#13;\n<p><img src="http://img.blog.csdn.net/20150908133837956?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQv/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/Center" alt="" /></p>&#13;\n<div>&#13;\n<h3>6安装MySQL数据库</h3>&#13;\n</div>&#13;\n<h4>6.1卸载已安装的mysql</h4>&#13;\n<p>查看已经安装的mysql数据库：</p>&#13;\n<p></p>&#13;\n<pre code_snippet_id="1594823" snippet_file_name="blog_20160302_47_20090" name="code" class="plain"># rpm -qa | grep mysql</pre>&#13;\n<p></p>&#13;\n<p>卸载已安装的mysql数据库：</p>&#13;\n<pre code_snippet_id="1594823" snippet_file_name="blog_20160302_48_4338488" name="code" class="plain"># rpm -e [包名] //普通卸载，可能因为依赖无法卸载\n# rpm -e --nodeps [包名] //强制卸载，有依赖也能卸载</pre>&#13;\n<p>或者</p>&#13;\n<p></p>&#13;\n<pre code_snippet_id="1594823" snippet_file_name="blog_20160302_49_8656886" name="code" class="plain"># yum -y remove [包名] //卸载时自动处理依赖</pre>&#13;\n<p></p>&#13;\n<h4>6.2安装mysql</h4>&#13;\n<p>    安装MySQL数据库需要安装4个组件：mysql--shared-compat 、mysql-server、mysql-client和mysql-workbench，安装方法如下。</p>&#13;\n<p>（1）安装mysql共享库：</p>&#13;\n<p></p>&#13;\n<pre code_snippet_id="1594823" snippet_file_name="blog_20160302_50_7435387" name="code" class="plain"># rpm -ivh MySQL-shared-compat-5.6.20-1.el6.x86_64.rpm</pre>&#13;\n<p></p>&#13;\n<p>（2）安装mysql服务端：：</p>&#13;\n<p></p>&#13;\n<pre code_snippet_id="1594823" snippet_file_name="blog_20160302_51_8165735" name="code" class="plain"># rpm -ivh MySQL-server-5.6.20-1.el6.x86_64.rpm</pre>&#13;\n<p></p>&#13;\n<p>（3）安装mysql客户端：</p>&#13;\n<p></p>&#13;\n<pre code_snippet_id="1594823" snippet_file_name="blog_20160302_52_880951" name="code" class="plain"># rpm -ivh MySQL-client-5.6.20-1.el6.x86_64.rpm</pre>&#13;\n<p></p>&#13;\n<p>（4）安装mysql-workbench工具：</p>&#13;\n<p></p>&#13;\n<pre code_snippet_id="1594823" snippet_file_name="blog_20160302_53_5232369" name="code" class="plain"># rpm -ivh mysql-workbench-community-6.1.7-1.el6.x86_64.rpm</pre>&#13;\n<p></p>&#13;\n<p>【说明】：RPM安装包，在CentOS下可以直接双击运行安装，系统会自动处理依赖。</p>&#13;\n<p>另附：yum安装方法</p>&#13;\n<p>查看yum上可安装的版本：</p>&#13;\n<p></p>&#13;\n<pre code_snippet_id="1594823" snippet_file_name="blog_20160302_54_5962717" name="code" class="plain"># yumlist | grep mysql</pre>&#13;\n<p></p>&#13;\n<p>安装：</p>&#13;\n<p></p>&#13;\n<pre code_snippet_id="1594823" snippet_file_name="blog_20160302_55_281116" name="code" class="plain"># yum install -y mysql-server mysql mysql-devel</pre>&#13;\n<p></p>&#13;\n<h4>6.3配置mysql</h4>&#13;\n<p>配置文件目录：</p>&#13;\n<p></p>&#13;\n<pre code_snippet_id="1594823" snippet_file_name="blog_20160302_56_9408280" name="code" class="plain">/usr/my.cnf或者/etc/mysql/my.cnf</pre>&#13;\n<p></p>&#13;\n<p>打开文件后，在[mysqld]后面添加如下配置：</p>&#13;\n<p>#字符编码</p>&#13;\n<p></p>&#13;\n<pre code_snippet_id="1594823" snippet_file_name="blog_20160302_57_8186781" name="code" class="plain">character-set-server=utf-8</pre>&#13;\n<p></p>&#13;\n<p>#存储引擎</p>&#13;\n<pre code_snippet_id="1594823" snippet_file_name="blog_20160302_58_3933640" name="code" class="plain">default-storage-engine=INNODB\ninnodb_flush_log_at_trx_commit=2</pre>&#13;\n<p>#缓冲池</p>&#13;\n<pre code_snippet_id="1594823" snippet_file_name="blog_20160302_59_5253415" name="code" class="plain">innodb_additional_mem_pool_size=16M\ninnodb_buffer_pool_size=1024M</pre>&#13;\n<p>#最大连接数</p>&#13;\n<p></p>&#13;\n<pre code_snippet_id="1594823" snippet_file_name="blog_20160302_60_4380580" name="code" class="plain">max_connections=1000</pre>&#13;\n<p></p>&#13;\n<p>#允许的最大包大小（例如一个Blob字段）</p>&#13;\n<p></p>&#13;\n<pre code_snippet_id="1594823" snippet_file_name="blog_20160302_61_9571030" name="code" class="plain">max_allowed_packet=16M</pre>&#13;\n<p></p>&#13;\n<p> <img src="http://img.blog.csdn.net/20150908133930485?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQv/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/Center" alt="" /></p>&#13;\n<p></p>&#13;\n<h4>6.4启动mysql</h4>&#13;\n<p>（1）启动mysql：</p>&#13;\n<p></p>&#13;\n<pre code_snippet_id="1594823" snippet_file_name="blog_20160302_62_2809634" name="code" class="plain"># sudo service mysql start/stop/restart</pre>&#13;\n<p></p>&#13;\n<p>或</p>&#13;\n<p></p>&#13;\n<pre code_snippet_id="1594823" snippet_file_name="blog_20160302_63_4652797" name="code" class="plain"># sudo /etc/rc.d/init.d/mysql start/stop/restart</pre>&#13;\n<p></p>&#13;\n<p>（或 # sudo /etc/rc.d/init.d/mysqld  start/stop/restart）</p>&#13;\n<p>启动mysql出错时，请到/var/liv/mysql/xxx.err查看错误信息。</p>&#13;\n<p><img src="http://img.blog.csdn.net/20150908134013284?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQv/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/Center" alt="" /><br />&#13;\n</p>&#13;\n<p></p>&#13;\n<p>（2）登录MySQL</p>&#13;\n<pre code_snippet_id="1594823" snippet_file_name="blog_20160302_64_2351503" name="code" class="plain"># mysql -u root -p\n# 输入密码\n# mysql&gt; show databases;\n# mysql&gt; show variables like '%character_set%'\n# mysql&gt; ...</pre>&#13;\n<p>（3）创建远程连接用户</p>&#13;\n<p>启用sxzl用户在本地（localhost）的登录权限，密码hymmldr.</p>&#13;\n<p></p>&#13;\n<pre code_snippet_id="1594823" snippet_file_name="blog_20160302_65_431893" name="code" class="plain"># mysql&gt; grant all privileges on csdn-100.html csdn-101.html csdn-102.html csdn-103.html csdn-104.html csdn-105.html csdn-106.html csdn-107.html csdn-108.html csdn-109.html csdn-10.html csdn-110.html csdn-111.html csdn-112.html csdn-113.html csdn-114.html csdn-115.html csdn-116.html csdn-117.html csdn-118.html csdn-119.html csdn-11.html csdn-120.html csdn-121.html csdn-122.html csdn-123.html csdn-124.html csdn-125.html csdn-126.html csdn-127.html csdn-128.html csdn-129.html csdn-12.html csdn-130.html csdn-131.html csdn-132.html csdn-133.html csdn-134.html csdn-135.html csdn-136.html csdn-137.html csdn-138.html csdn-139.html csdn-13.html csdn-140.html csdn-141.html csdn-142.html csdn-143.html csdn-144.html csdn-145.html csdn-146.html csdn-147.html csdn-148.html csdn-149.html csdn-14.html csdn-150.html csdn-151.html csdn-152.html csdn-153.html csdn-154.html csdn-155.html csdn-156.html csdn-157.html csdn-158.html csdn-159.html csdn-15.html csdn-160.html csdn-161.html csdn-162.html csdn-163.html csdn-164.html csdn-165.html csdn-166.html csdn-167.html csdn-168.html csdn-169.html csdn-16.html csdn-170.html csdn-171.html csdn-172.html csdn-173.html csdn-174.html csdn-175.html csdn-176.html csdn-177.html csdn-178.html csdn-179.html csdn-17.html csdn-180.html csdn-181.html csdn-182.html csdn-183.html csdn-184.html csdn-185.html csdn-186.html csdn-187.html csdn-188.html csdn-189.html csdn-18.html csdn-190.html csdn-191.html csdn-192.html csdn-193.html csdn-194.html csdn-195.html csdn-196.html csdn-197.html csdn-198.html csdn-199.html csdn-19.html csdn-1.html csdn-200.html csdn-201.html csdn-202.html csdn-203.html csdn-204.html csdn-205.html csdn-206.html csdn-207.html csdn-208.html csdn-209.html csdn-20.html csdn-210.html csdn-211.html csdn-212.html csdn-213.html csdn-214.html csdn-215.html csdn-216.html csdn-217.html csdn-218.html csdn-219.html csdn-21.html csdn-220.html csdn-221.html csdn-222.html csdn-223.html csdn-224.html csdn-225.html csdn-226.html csdn-227.html csdn-228.html csdn-229.html csdn-22.html csdn-230.html csdn-231.html csdn-232.html csdn-233.html csdn-234.html csdn-235.html csdn-236.html csdn-237.html csdn-238.html csdn-239.html csdn-23.html csdn-240.html csdn-241.html csdn-242.html csdn-243.html csdn-244.html csdn-245.html csdn-246.html csdn-247.html csdn-248.html csdn-249.html csdn-24.html csdn-250.html csdn-251.html csdn-252.html csdn-253.html csdn-254.html csdn-255.html csdn-256.html csdn-257.html csdn-258.html csdn-259.html csdn-25.html csdn-260.html csdn-261.html csdn-262.html csdn-263.html csdn-264.html csdn-265.html csdn-266.html csdn-267.html csdn-268.html csdn-269.html csdn-26.html csdn-270.html csdn-271.html csdn-272.html csdn-273.html csdn-274.html csdn-275.html csdn-276.html csdn-277.html csdn-278.html csdn-279.html csdn-27.html csdn-280.html csdn-281.html csdn-282.html csdn-283.html csdn-284.html csdn-285.html csdn-286.html csdn-287.html csdn-288.html csdn-289.html csdn-28.html csdn-290.html csdn-291.html csdn-292.html csdn-293.html csdn-294.html csdn-295.html csdn-296.html csdn-297.html csdn-298.html csdn-299.html csdn-29.html csdn-2.html csdn-300.html csdn-301.html csdn-302.html csdn-303.html csdn-304.html csdn-305.html csdn-306.html csdn-307.html csdn-308.html csdn-309.html csdn-30.html csdn-310.html csdn-311.html csdn-312.html csdn-313.html csdn-314.html csdn-315.html csdn-316.html csdn-317.html csdn-318.html csdn-319.html csdn-31.html csdn-320.html csdn-321.html csdn-322.html csdn-323.html csdn-324.html csdn-325.html csdn-326.html csdn-327.html csdn-328.html csdn-329.html csdn-32.html csdn-330.html csdn-331.html csdn-332.html csdn-333.html csdn-334.html csdn-335.html csdn-336.html csdn-337.html csdn-338.html csdn-339.html csdn-33.html csdn-340.html csdn-341.html csdn-342.html csdn-343.html csdn-344.html csdn-345.html csdn-346.html csdn-347.html csdn-348.html csdn-349.html csdn-34.html csdn-350.html csdn-351.html csdn-352.html csdn-353.html csdn-354.html csdn-35.html csdn-36.html csdn-37.html csdn-38.html csdn-39.html csdn-3.html csdn-40.html csdn-41.html csdn-42.html csdn-43.html csdn-44.html csdn-45.html csdn-46.html csdn-47.html csdn-48.html csdn-49.html csdn-4.html csdn-50.html csdn-51.html csdn-52.html csdn-53.html csdn-54.html csdn-55.html csdn-56.html csdn-57.html csdn-58.html csdn-59.html csdn-5.html csdn-60.html csdn-61.html csdn-62.html csdn-63.html csdn-64.html csdn-65.html csdn-66.html csdn-67.html csdn-68.html csdn-69.html csdn-6.html csdn-70.html csdn-71.html csdn-72.html csdn-73.html csdn-74.html csdn-75.html csdn-76.html csdn-77.html csdn-78.html csdn-79.html csdn-7.html csdn-80.html csdn-81.html csdn-82.html csdn-83.html csdn-84.html csdn-85.html csdn-86.html csdn-87.html csdn-88.html csdn-89.html csdn-8.html csdn-90.html csdn-91.html csdn-92.html csdn-93.html csdn-94.html csdn-95.html csdn-96.html csdn-97.html csdn-98.html csdn-99.html csdn-9.html mysql.sh tosxzl@localhost identified by 'hymmldr.' with grant option;</pre>&#13;\n<p></p>&#13;\n<p>启用sxzl用户远程（%）登录权限，密码hymmldr.</p>&#13;\n<p></p>&#13;\n<pre code_snippet_id="1594823" snippet_file_name="blog_20160302_66_7814953" name="code" class="plain"># mysql&gt; grant all privileges on csdn-100.html csdn-101.html csdn-102.html csdn-103.html csdn-104.html csdn-105.html csdn-106.html csdn-107.html csdn-108.html csdn-109.html csdn-10.html csdn-110.html csdn-111.html csdn-112.html csdn-113.html csdn-114.html csdn-115.html csdn-116.html csdn-117.html csdn-118.html csdn-119.html csdn-11.html csdn-120.html csdn-121.html csdn-122.html csdn-123.html csdn-124.html csdn-125.html csdn-126.html csdn-127.html csdn-128.html csdn-129.html csdn-12.html csdn-130.html csdn-131.html csdn-132.html csdn-133.html csdn-134.html csdn-135.html csdn-136.html csdn-137.html csdn-138.html csdn-139.html csdn-13.html csdn-140.html csdn-141.html csdn-142.html csdn-143.html csdn-144.html csdn-145.html csdn-146.html csdn-147.html csdn-148.html csdn-149.html csdn-14.html csdn-150.html csdn-151.html csdn-152.html csdn-153.html csdn-154.html csdn-155.html csdn-156.html csdn-157.html csdn-158.html csdn-159.html csdn-15.html csdn-160.html csdn-161.html csdn-162.html csdn-163.html csdn-164.html csdn-165.html csdn-166.html csdn-167.html csdn-168.html csdn-169.html csdn-16.html csdn-170.html csdn-171.html csdn-172.html csdn-173.html csdn-174.html csdn-175.html csdn-176.html csdn-177.html csdn-178.html csdn-179.html csdn-17.html csdn-180.html csdn-181.html csdn-182.html csdn-183.html csdn-184.html csdn-185.html csdn-186.html csdn-187.html csdn-188.html csdn-189.html csdn-18.html csdn-190.html csdn-191.html csdn-192.html csdn-193.html csdn-194.html csdn-195.html csdn-196.html csdn-197.html csdn-198.html csdn-199.html csdn-19.html csdn-1.html csdn-200.html csdn-201.html csdn-202.html csdn-203.html csdn-204.html csdn-205.html csdn-206.html csdn-207.html csdn-208.html csdn-209.html csdn-20.html csdn-210.html csdn-211.html csdn-212.html csdn-213.html csdn-214.html csdn-215.html csdn-216.html csdn-217.html csdn-218.html csdn-219.html csdn-21.html csdn-220.html csdn-221.html csdn-222.html csdn-223.html csdn-224.html csdn-225.html csdn-226.html csdn-227.html csdn-228.html csdn-229.html csdn-22.html csdn-230.html csdn-231.html csdn-232.html csdn-233.html csdn-234.html csdn-235.html csdn-236.html csdn-237.html csdn-238.html csdn-239.html csdn-23.html csdn-240.html csdn-241.html csdn-242.html csdn-243.html csdn-244.html csdn-245.html csdn-246.html csdn-247.html csdn-248.html csdn-249.html csdn-24.html csdn-250.html csdn-251.html csdn-252.html csdn-253.html csdn-254.html csdn-255.html csdn-256.html csdn-257.html csdn-258.html csdn-259.html csdn-25.html csdn-260.html csdn-261.html csdn-262.html csdn-263.html csdn-264.html csdn-265.html csdn-266.html csdn-267.html csdn-268.html csdn-269.html csdn-26.html csdn-270.html csdn-271.html csdn-272.html csdn-273.html csdn-274.html csdn-275.html csdn-276.html csdn-277.html csdn-278.html csdn-279.html csdn-27.html csdn-280.html csdn-281.html csdn-282.html csdn-283.html csdn-284.html csdn-285.html csdn-286.html csdn-287.html csdn-288.html csdn-289.html csdn-28.html csdn-290.html csdn-291.html csdn-292.html csdn-293.html csdn-294.html csdn-295.html csdn-296.html csdn-297.html csdn-298.html csdn-299.html csdn-29.html csdn-2.html csdn-300.html csdn-301.html csdn-302.html csdn-303.html csdn-304.html csdn-305.html csdn-306.html csdn-307.html csdn-308.html csdn-309.html csdn-30.html csdn-310.html csdn-311.html csdn-312.html csdn-313.html csdn-314.html csdn-315.html csdn-316.html csdn-317.html csdn-318.html csdn-319.html csdn-31.html csdn-320.html csdn-321.html csdn-322.html csdn-323.html csdn-324.html csdn-325.html csdn-326.html csdn-327.html csdn-328.html csdn-329.html csdn-32.html csdn-330.html csdn-331.html csdn-332.html csdn-333.html csdn-334.html csdn-335.html csdn-336.html csdn-337.html csdn-338.html csdn-339.html csdn-33.html csdn-340.html csdn-341.html csdn-342.html csdn-343.html csdn-344.html csdn-345.html csdn-346.html csdn-347.html csdn-348.html csdn-349.html csdn-34.html csdn-350.html csdn-351.html csdn-352.html csdn-353.html csdn-354.html csdn-35.html csdn-36.html csdn-37.html csdn-38.html csdn-39.html csdn-3.html csdn-40.html csdn-41.html csdn-42.html csdn-43.html csdn-44.html csdn-45.html csdn-46.html csdn-47.html csdn-48.html csdn-49.html csdn-4.html csdn-50.html csdn-51.html csdn-52.html csdn-53.html csdn-54.html csdn-55.html csdn-56.html csdn-57.html csdn-58.html csdn-59.html csdn-5.html csdn-60.html csdn-61.html csdn-62.html csdn-63.html csdn-64.html csdn-65.html csdn-66.html csdn-67.html csdn-68.html csdn-69.html csdn-6.html csdn-70.html csdn-71.html csdn-72.html csdn-73.html csdn-74.html csdn-75.html csdn-76.html csdn-77.html csdn-78.html csdn-79.html csdn-7.html csdn-80.html csdn-81.html csdn-82.html csdn-83.html csdn-84.html csdn-85.html csdn-86.html csdn-87.html csdn-88.html csdn-89.html csdn-8.html csdn-90.html csdn-91.html csdn-92.html csdn-93.html csdn-94.html csdn-95.html csdn-96.html csdn-97.html csdn-98.html csdn-99.html csdn-9.html mysql.sh to sxzl@"%"identified by 'hymmldr.' with grant option;</pre>&#13;\n<p></p>&#13;\n<p>刷新权限</p>&#13;\n<p></p>&#13;\n<pre code_snippet_id="1594823" snippet_file_name="blog_20160302_67_5513659" name="code" class="plain"># mysql&gt; flush privileges;</pre>&#13;\n<p></p>&#13;\n<p>第一次安装需要重设mysql密码，详见如下。</p>&#13;\n<h4>6.5重设mysql密码（官网方法）</h4>&#13;\n<p>启动mysql，然后执行如下命令：</p>&#13;\n<p></p>&#13;\n<pre code_snippet_id="1594823" snippet_file_name="blog_20160302_68_7672466" name="code" class="plain"># ps -ef | grep -i mysql</pre>&#13;\n<p></p>&#13;\n<p>查看mysqld_safe的路径，例如：/usr/bin/mysqld_safe</p>&#13;\n<p><img src="http://img.blog.csdn.net/20150908134107136?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQv/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/Center" alt="" /><br />&#13;\n</p>&#13;\n<p></p>&#13;\n<p>停止mysql，然后以安全方式启动mysql：</p>&#13;\n<p></p>&#13;\n<pre code_snippet_id="1594823" snippet_file_name="blog_20160302_69_1816142" name="code" class="plain"># sudo /usr/bin/mysqld_safe --skip-grant-tables &gt;/dev/null 2&gt;&amp;1 &amp;</pre>&#13;\n<p></p>&#13;\n<p>5秒钟后执行：</p>&#13;\n<p></p>&#13;\n<pre code_snippet_id="1594823" snippet_file_name="blog_20160302_70_7770743" name="code" class="plain"># sudo /usr/bin/mysql -u root mysql</pre>&#13;\n<p></p>&#13;\n<p>重设root用户的密码：</p>&#13;\n<p></p>&#13;\n<pre code_snippet_id="1594823" snippet_file_name="blog_20160302_71_2961194" name="code" class="plain"># mysql&gt; update user SET PASSWORD=PASSWORD('root')where user='root'</pre>&#13;\n<p></p>&#13;\n<p>刷新权限</p>&#13;\n<pre code_snippet_id="1594823" snippet_file_name="blog_20160302_72_6025073" name="code" class="plain"># mysql&gt; flush privileges;\n# mysql&gt; exit;</pre>&#13;\n<p>接着再次登录mysql：</p>&#13;\n<p></p>&#13;\n<pre code_snippet_id="1594823" snippet_file_name="blog_20160302_73_5185258" name="code" class="plain"># mysql -u root -p</pre>&#13;\n<p></p>&#13;\n<p># 输入密码</p>&#13;\n<p>然后执行：</p>&#13;\n<p></p>&#13;\n<pre code_snippet_id="1594823" snippet_file_name="blog_20160302_74_5599962" name="code" class="plain"># mysql&gt; show databases;</pre>&#13;\n<p></p>&#13;\n<p>报错：You must SET PASSWORD before executing thisstatement.</p>&#13;\n<p>解决办法，重设一次密码：</p>&#13;\n<pre code_snippet_id="1594823" snippet_file_name="blog_20160302_75_6886717" name="code" class="plain"># mysql&gt; SET PASSWORD=PASSWORD('root');\n# mysql&gt; flush privileges;</pre>&#13;\n<p></p>&#13;\n<p> <img src="http://img.blog.csdn.net/20150908134136940?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQv/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/Center" alt="" /></p>&#13;\n<p>设置完毕后，就可以打开mysql-workbench连接到数据库了。</p>&#13;\n<div>&#13;\n<h3>7命令说明：yum</h3>&#13;\n</div>&#13;\n<p>yum安装选项说明：</p>&#13;\n<pre code_snippet_id="1594823" snippet_file_name="blog_20160302_76_6013882" name="code" class="plain">yum -y install 包名（支持*） ：自动选择y，全自动\nyum install 包名（支持*） ：手动选择y or n\nyum -y remove [package name] ：自动处理依赖\nyum remove 包名（不支持*）\nrpm -ivh 包名（支持*）：安装rpm包</pre>&#13;\n<h3>8、温馨提示</h3>&#13;\n<p><span style="font-size:18px">大家可以到链接<a target="_blank" href="http://download.csdn.net/detail/l1028386804/9092633">http://download.csdn.net/detail/l1028386804/9092633</a>下载Nginx+Tomcat+Memcached负载均衡集群服务搭建所需的完整工具包</span><br />&#13;\n</p>&#13;\n &#13;\n
