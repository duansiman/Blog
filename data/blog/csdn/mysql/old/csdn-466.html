\n\n<div style="margin:0px; padding:0px; font-family:Tahoma,'Microsoft Yahei'; line-height:22px">&#13;\n<span style="margin:0px; padding:0px"><span style="font-size:14px">SSD与FlashCaceh相关参考资料推荐：</span></span></div>&#13;\n<div style="margin:0px; padding:0px; font-family:Tahoma,'Microsoft Yahei'; line-height:22px">&#13;\n<span style="font-size:14px"><span style="margin:0px; padding:0px">《</span><a target="_blank" href="http://wenku.it168.com/d_129111.shtml" title="http://wenku.it168.com/d_129111.shtml" style="color:rgb(73,139,49); margin:0px; padding:0px; text-decoration:none">Mysql基于SSD_flashcache优化实践</a>》</span></div>&#13;\n<div style="margin:0px; padding:0px; font-family:Tahoma,'Microsoft Yahei'; line-height:22px">&#13;\n<span style="font-size:14px"><span style="margin:0px; padding:0px">《<a target="_blank" href="http://v.youku.com/v_show/id_XNTA3OTExMDEy.html" title="http://v.youku.com/v_show/id_XNTA3OTExMDEy.html" style="color:rgb(73,139,49); margin:0px; padding:0px; text-decoration:none">SSD+&#13;\n RAID卡和PCI-E flash卡在淘宝的应用实践</a>》</span></span></div>&#13;\n<div style="margin:0px; padding:0px; font-family:Tahoma,'Microsoft Yahei'; line-height:22px">&#13;\n<span style="font-size:14px"><span style="margin:0px; padding:0px"><span style="margin:0px; padding:0px">《</span></span><a target="_blank" href="http://wenku.it168.com/d_000284285.shtml" title="http://wenku.it168.com/d_000284285.shtml" style="color:rgb(73,139,49); margin:0px; padding:0px; text-decoration:none">淘宝商品库MySQL优化实践</a><span style="margin:0px; padding:0px">》 </span></span></div>&#13;\n<div style="margin:0px; padding:0px; font-family:Tahoma,'Microsoft Yahei'; line-height:22px">&#13;\n<span style="margin:0px; padding:0px"><span style="font-size:14px">《<a target="_blank" href="http://download.csdn.net/detail/wyzxg/4394020" title="http://dldx.csdn.net/fd.php?i=477943940207422&amp;s=f91150f59d1305c901575ed15c5ea4db" style="color:rgb(73,139,49); margin:0px; padding:0px; text-decoration:none">混合存储测试结果</a>》</span></span></div>&#13;\n<div style="margin:0px; padding:0px; font-family:Tahoma,'Microsoft Yahei'; line-height:22px">&#13;\n<span style="margin:0px; padding:0px"><span style="font-size:14px"><span style="margin:0px; padding:0px"> </span></span></span></div>&#13;\n<div style="margin:0px; padding:0px; font-family:Tahoma,'Microsoft Yahei'; line-height:22px">&#13;\n<span style="font-size:14px">国内的<a target="_blank" href="http://www.jd.com/writer/%E5%A7%9C%E6%89%BF%E5%B0%A7_1.html" style="margin:0px; padding:0px; color:rgb(0,90,160); text-decoration:none; font-family:Arial,Verdana,宋体; line-height:18px">姜承尧</a>开发一个INNODB的二级缓存（<span style="color:rgb(102,102,102); font-family:Arial; line-height:20px; text-indent:24px">InnoDB&#13;\n Secondary Buffer Pool)</span>，是利用SSD做为二级缓存。Facebook在这个基础上做了扩充将其放到操操作系统的存储层做为一种通用的缓存。</span></div>&#13;\n<div style="margin:0px; padding:0px; font-family:Tahoma,'Microsoft Yahei'; line-height:22px">&#13;\n<span style="font-size:14px"><br />&#13;\n<span style="margin:0px; padding:0px; color:rgb(51,51,51); font-family:微软雅黑,Verdana,sans-serif,宋体; letter-spacing:1px">Flashcache是Facebook技术团队的又一力作，最初是为加速MySQL设计的。Flashcache是在Linux层面的，所以任何受磁盘IO困绕的软件或应用都可以方便的使用之。</span><br />&#13;\n</span></div>&#13;\n<div style="margin:0px; padding:0px; line-height:22px; color:rgb(51,51,51); font-family:&#x5FAE;&#x8F6F;&#x96C5;&#x9ED1;,Verdana,sans-serif,&#x5B8B;&#x4F53;">&#13;\n<span style="font-size:14px"><br />&#13;\n1. Why Flashcache</span></div>&#13;\n<p style="margin-top:12px; margin-bottom:12px; padding-top:0px; padding-bottom:0px; line-height:22px; letter-spacing:1px; color:rgb(51,51,51); font-family:&#x5FAE;&#x8F6F;&#x96C5;&#x9ED1;,Verdana,sans-serif,&#x5B8B;&#x4F53;">&#13;\n<span style="font-size:14px">随着时间的流逝，网站上的数据一直在不停的积累。如果你经营的只是一个博客的话，这不会是问题，因为10G的空间，大概就够你写一辈子了（如果放在硬盘上，其实一辈子很短）。如果你恰巧在一个快速增长的公司，数据会越来越多，从MB，到GB，再到TB。</span></p>&#13;\n<p style="margin-top:12px; margin-bottom:12px; padding-top:0px; padding-bottom:0px; line-height:22px; letter-spacing:1px; color:rgb(51,51,51); font-family:&#x5FAE;&#x8F6F;&#x96C5;&#x9ED1;,Verdana,sans-serif,&#x5B8B;&#x4F53;">&#13;\n<span style="font-size:14px">如果将这些数据全部放在大容量的SATA、SAS盘上时，会发现性能（响应时间）不够；如果全放在SSD上时，又会发现成本很高。即使公司能够大气 到都放到SSD上，你会发现1TB的数据里面可能只有200G是经常被访问的，300G可能偶尔被访问到，最后剩下的500G可能已经成为历史数据了，几 乎不被访问到，如果全部都放在SSD上有略有浪费。于是就有了<a target="_blank" href="http://www.facebook.com/note.php?note_id=388112370932" style="color:rgb(68,102,187); margin:0px; padding:0px; text-decoration:none; outline:0px">Flashcache</a>。</span></p>&#13;\n<p style="margin-top:12px; margin-bottom:12px; padding-top:0px; padding-bottom:0px; line-height:22px; letter-spacing:1px; color:rgb(51,51,51); font-family:&#x5FAE;&#x8F6F;&#x96C5;&#x9ED1;,Verdana,sans-serif,&#x5B8B;&#x4F53;">&#13;\n<span style="font-size:14px">Flashcache一个非常不错的软件（准确的说是一个<a target="_blank" href="http://tldp.org/LDP/lkmpg/2.6/html/" style="color:rgb(68,102,187); margin:0px; padding:0px; text-decoration:none; outline:0px">Linux的模块</a>）， 可以动态加载。Flashcache通过在文件系统（VFS）和设备驱动之间新增了一次缓存层，来实现对热门的缓存。Flashcache是另一种缓存，&#13;\n 一般用SSD作为介质的缓存（一般的缓存用的是内存），通过将传统硬盘上的热门数据缓存到SSD上，然后利用SSD优秀的读性能，来加速系统。这个方法较 之内存缓存，没有内存快，但是空间可以比内存大很多。</span></p>&#13;\n<p style="margin-top:12px; margin-bottom:12px; padding-top:0px; padding-bottom:0px; line-height:22px; letter-spacing:1px; color:rgb(51,51,51); font-family:&#x5FAE;&#x8F6F;&#x96C5;&#x9ED1;,Verdana,sans-serif,&#x5B8B;&#x4F53;">&#13;\n<span style="font-size:14px">本文是一个关于Flashcache的初步介绍。</span></p>&#13;\n<div style="margin:0px; padding:0px; line-height:22px; color:rgb(51,51,51); font-family:&#x5FAE;&#x8F6F;&#x96C5;&#x9ED1;,Verdana,sans-serif,&#x5B8B;&#x4F53;">&#13;\n<span style="font-size:14px">2. 谁适合用Flashcache</span></div>&#13;\n<p style="margin-top:12px; margin-bottom:12px; padding-top:0px; padding-bottom:0px; line-height:22px; letter-spacing:1px; color:rgb(51,51,51); font-family:&#x5FAE;&#x8F6F;&#x96C5;&#x9ED1;,Verdana,sans-serif,&#x5B8B;&#x4F53;">&#13;\n<span style="font-size:14px">数据量很大（例如4TB），热门数据也很大（800GB），不必要或者不舍得全部买内存来缓存。</span></p>&#13;\n<div style="margin:0px; padding:0px; line-height:22px; color:rgb(51,51,51); font-family:&#x5FAE;&#x8F6F;&#x96C5;&#x9ED1;,Verdana,sans-serif,&#x5B8B;&#x4F53;">&#13;\n<span style="font-size:14px">3. 谁 <span style="margin:0px; padding:0px">不</span>适合用Flashcache</span></div>&#13;\n<p style="margin-top:12px; margin-bottom:12px; padding-top:0px; padding-bottom:0px; line-height:22px; letter-spacing:1px; color:rgb(51,51,51); font-family:&#x5FAE;&#x8F6F;&#x96C5;&#x9ED1;,Verdana,sans-serif,&#x5B8B;&#x4F53;">&#13;\n<span style="font-size:14px">数据量不大的话，一般Flashcache就没什么用武之地了，内存就可以帮你解决问题了；</span></p>&#13;\n<p style="margin-top:12px; margin-bottom:12px; padding-top:0px; padding-bottom:0px; line-height:22px; letter-spacing:1px; color:rgb(51,51,51); font-family:&#x5FAE;&#x8F6F;&#x96C5;&#x9ED1;,Verdana,sans-serif,&#x5B8B;&#x4F53;">&#13;\n<span style="font-size:14px">不差钱，买内存呗；</span></p>&#13;\n<p style="margin-top:12px; margin-bottom:12px; padding-top:0px; padding-bottom:0px; line-height:22px; letter-spacing:1px; color:rgb(51,51,51); font-family:&#x5FAE;&#x8F6F;&#x96C5;&#x9ED1;,Verdana,sans-serif,&#x5B8B;&#x4F53;">&#13;\n<span style="font-size:14px">另外Flashcache的加入也使得系统的复杂度增加了一层，如果你坚持<a target="_blank" href="http://en.wikipedia.org/wiki/KISS_principle" style="color:rgb(68,102,187); margin:0px; padding:0px; text-decoration:none; outline:0px">KISS原则</a>（Keep it&#13;\n simple, Stupid!），也可以弃用之。</span></p>&#13;\n<div style="margin:0px; padding:0px; line-height:22px; color:rgb(51,51,51); font-family:&#x5FAE;&#x8F6F;&#x96C5;&#x9ED1;,Verdana,sans-serif,&#x5B8B;&#x4F53;">&#13;\n<span style="font-size:14px">4. 基本原理图 <br style="padding:0px; margin:0px" />&#13;\n<a target="_blank" href="http://www.neatstudio.com/attachment.php?id=736" style="color:rgb(68,102,187); margin:0px; padding:0px; text-decoration:none; outline:0px"></a><a target="_blank" href="http://ugc.qpic.cn/adapt/0/acfc735c-4534-039d-90da-600321c06642/800" style="color:rgb(68,102,187); margin:0px; padding:0px; text-decoration:none; outline:0px"><img src="http://ugc.qpic.cn/adapt/0/acfc735c-4534-039d-90da-600321c06642/800" alt="大小: 48.66 K 尺寸: 500 x 296 浏览: 116 次 点击打开新窗口浏览全图" width="500" height="296" style="margin:10px 0px; padding:8px; border:1px solid rgb(221,221,221); vertical-align:top; max-width:640px" /></a></span></div>&#13;\n<p style="margin-top:12px; margin-bottom:12px; padding-top:0px; padding-bottom:0px; line-height:22px; letter-spacing:1px; color:rgb(51,51,51); font-family:&#x5FAE;&#x8F6F;&#x96C5;&#x9ED1;,Verdana,sans-serif,&#x5B8B;&#x4F53;">&#13;\n<span style="font-size:14px">上图中，Flashcache将普通的SAS盘（/dev/sda）和一个高速的SSD(/dev/sdb)虚拟成一个带缓存的块设备（/dev/mapper/cachedev）。<br />&#13;\n<span style="margin:0px; padding:0px"><br />&#13;\n</span><span style="margin:0px; padding:0px; color:rgb(67,67,67); font-family:微软雅黑,Tahoma,Verdana,宋体; letter-spacing:normal">Facebook 称，Flashcache是其内部开发用于帮助扩展InnoDB/MySQL数据库，但同时Flashcache也是作为一个通用的缓存模块设计的，因此 能用在任何搭建在块设备之上的应用程序。</span><span style="margin:0px; padding:0px"> <br />&#13;\n<span style="margin:0px; padding:0px"><br />&#13;\n</span></span><span style="margin:0px; padding:0px; color:rgb(0,0,0); font-family:微软雅黑,Tahoma,Verdana,宋体; letter-spacing:normal">对于InnoDB，当工作集不与 InnoDB缓冲池一致，由于更多的工作集缓存在快速的媒介如固态硬盘上，将能显著的改进读取延迟。<br />&#13;\n<span style="margin:0px; padding:0px"><br />&#13;\n<br />&#13;\n利用FlashCache，就可以将MySQL的数据，索引，日志写到FlashCache设备上，并可以将下面参数都特定优化：<br />&#13;\n</span></span></span></p>&#13;\n<p style="margin-top:12px; margin-bottom:12px; padding-top:0px; padding-bottom:0px; font-family:Tahoma,'Microsoft Yahei'; line-height:22px">&#13;\n<span style="margin:0px; padding:0px; font-family:微软雅黑,Tahoma,Verdana,宋体"><span style="font-size:14px">日志</span></span></p>&#13;\n<p style="margin-top:12px; margin-bottom:12px; padding-top:0px; padding-bottom:0px; font-family:Tahoma,'Microsoft Yahei'; line-height:22px">&#13;\n<span style="margin:0px; padding:0px; font-family:微软雅黑,Tahoma,Verdana,宋体"><span style="font-size:14px">1、减少切换次数</span></span></p>&#13;\n<p style="margin-top:12px; margin-bottom:12px; padding-top:0px; padding-bottom:0px; font-family:Tahoma,'Microsoft Yahei'; line-height:22px">&#13;\n<span style="margin:0px; padding:0px; font-family:微软雅黑,Tahoma,Verdana,宋体"><span style="font-size:14px">innodb_log_file_size=1300m</span></span></p>&#13;\n<p style="margin-top:12px; margin-bottom:12px; padding-top:0px; padding-bottom:0px; font-family:Tahoma,'Microsoft Yahei'; line-height:22px">&#13;\n<span style="margin:0px; padding:0px; font-family:微软雅黑,Tahoma,Verdana,宋体"><span style="font-size:14px">innodb_log_files_in_group=3</span></span></p>&#13;\n<p style="margin-top:12px; margin-bottom:12px; padding-top:0px; padding-bottom:0px; font-family:Tahoma,'Microsoft Yahei'; line-height:22px">&#13;\n<span style="font-size:14px"><span style="margin:0px; padding:0px; font-family:微软雅黑,Tahoma,Verdana,宋体">2、独立硬盘</span><br />&#13;\n</span></p>&#13;\n<p style="margin-top:12px; margin-bottom:12px; padding-top:0px; padding-bottom:0px; font-family:Tahoma,'Microsoft Yahei'; line-height:22px">&#13;\n<span style="margin:0px; padding:0px; font-family:微软雅黑,Tahoma,Verdana,宋体"><span style="font-size:14px">redo log   240G/天</span></span></p>&#13;\n<p style="margin-top:12px; margin-bottom:12px; padding-top:0px; padding-bottom:0px; font-family:Tahoma,'Microsoft Yahei'; line-height:22px">&#13;\n<span style="margin:0px; padding:0px; font-family:微软雅黑,Tahoma,Verdana,宋体"><span style="font-size:14px">并发线程</span></span></p>&#13;\n<p style="margin-top:12px; margin-bottom:12px; padding-top:0px; padding-bottom:0px; font-family:Tahoma,'Microsoft Yahei'; line-height:22px">&#13;\n<span style="margin:0px; padding:0px; font-family:微软雅黑,Tahoma,Verdana,宋体"><span style="font-size:14px">innodb_thread_concurrency</span></span></p>&#13;\n<p style="margin-top:12px; margin-bottom:12px; padding-top:0px; padding-bottom:0px; font-family:Tahoma,'Microsoft Yahei'; line-height:22px">&#13;\n<span style="margin:0px; padding:0px; font-family:微软雅黑,Tahoma,Verdana,宋体"><span style="font-size:14px"><br />&#13;\n</span></span></p>&#13;\n<p style="margin-top:12px; margin-bottom:12px; padding-top:0px; padding-bottom:0px; font-family:Tahoma,'Microsoft Yahei'; line-height:22px">&#13;\n<span style="margin:0px; padding:0px; font-family:微软雅黑,Tahoma,Verdana,宋体"><span style="font-size:14px">IO</span></span></p>&#13;\n<p style="margin-top:12px; margin-bottom:12px; padding-top:0px; padding-bottom:0px; font-family:Tahoma,'Microsoft Yahei'; line-height:22px">&#13;\n<span style="margin:0px; padding:0px; font-family:微软雅黑,Tahoma,Verdana,宋体"><span style="font-size:14px">innodb_io_capacity</span></span></p>&#13;\n<p style="margin-top:12px; margin-bottom:12px; padding-top:0px; padding-bottom:0px; font-family:Tahoma,'Microsoft Yahei'; line-height:22px">&#13;\n<span style="margin:0px; padding:0px; font-family:微软雅黑,Tahoma,Verdana,宋体"><span style="font-size:14px">innodb_read_io_threads</span></span></p>&#13;\n<p style="margin-top:12px; margin-bottom:12px; padding-top:0px; padding-bottom:0px; font-family:Tahoma,'Microsoft Yahei'; line-height:22px">&#13;\n<span style="margin:0px; padding:0px; font-family:微软雅黑,Tahoma,Verdana,宋体"><span style="font-size:14px">innodb_write_io_threads</span></span></p>&#13;\n<p style="margin-top:12px; margin-bottom:12px; padding-top:0px; padding-bottom:0px; font-family:Tahoma,'Microsoft Yahei'; line-height:22px">&#13;\n<span style="margin:0px; padding:0px; font-family:微软雅黑,Tahoma,Verdana,宋体"><span style="font-size:14px"><br />&#13;\n</span></span></p>&#13;\n<p style="margin-top:12px; margin-bottom:12px; padding-top:0px; padding-bottom:0px; font-family:Tahoma,'Microsoft Yahei'; line-height:22px">&#13;\n<span style="margin:0px; padding:0px; font-family:微软雅黑,Tahoma,Verdana,宋体"><span style="font-size:14px">未定</span></span></p>&#13;\n<p style="margin-top:12px; margin-bottom:12px; padding-top:0px; padding-bottom:0px; font-family:Tahoma,'Microsoft Yahei'; line-height:22px">&#13;\n<span style="margin:0px; padding:0px; font-family:微软雅黑,Tahoma,Verdana,宋体"><span style="font-size:14px">innodb_change_buffering=none</span></span></p>&#13;\n<p style="margin-top:12px; margin-bottom:12px; padding-top:0px; padding-bottom:0px; font-family:Tahoma,'Microsoft Yahei'; line-height:22px">&#13;\n<span style="margin:0px; padding:0px; font-family:微软雅黑,Tahoma,Verdana,宋体"><span style="font-size:14px">adaptive_flushing</span></span></p>&#13;\n<p style="margin-top:12px; margin-bottom:12px; padding-top:0px; padding-bottom:0px; font-family:Tahoma,'Microsoft Yahei'; line-height:22px">&#13;\n<span style="margin:0px; padding:0px; font-family:微软雅黑,Tahoma,Verdana,宋体"><span style="font-size:14px">ssd随机写,不需要顺序化的额外代价</span></span></p>&#13;\n &#13;\n
