\n <div class="markdown_views"><h1 id="mysql学习笔记sql服务器模式汇总">MySQL学习笔记—SQL服务器模式汇总</h1>\n\n<hr />\n\n<p>MySQL服务器可以以不同的SQL模式来操作，并且可以为不同客户端应用不同模式。这样每个应用程序可以根据自己的需求来定制服务器的操作模式。</p>\n\n<p>模式定义MySQL应支持哪些SQL语法，以及应执行哪种数据验证检查。这样可以更容易地在不同的环境中使用MySQL，并结合其它数据库服务器使用MySQL。</p>\n\n<p>你可以用–sql-mode=”modes”选项启动mysqld来设置默认SQL模式。如果你想要重设，该值还可以为空(–sql-mode =”“)。</p>\n\n<p>你还可以在启动后用SET [SESSION|GLOBAL] sql_mode=’modes’语句设置sql_mode变量来更改SQL模式。设置 GLOBAL变量时需要拥有SUPER权限，并且会影响从那时起连接的所有客户端的操作。设置SESSION变量只影响当前的客户端。任何客户端可以随时更改自己的会话 sql_mode值。</p>\n\n<p>Modesis是用逗号(‘，’)间隔开的一系列不同的模式。你可以用SELECT @@sql_mode语句查询当前的模式。默认值是空(没有设置任何模式)。 <br />\n<img src="http://img.blog.csdn.net/20160419102736215" alt="这里写图片描述" title="" /></p>\n\n<hr />\n\n\n\n<h2 id="主要的重要sqlmode值为">主要的重要sql_mode值为：</h2>\n\n<hr />\n\n<pre><code>·ANSI\n</code></pre>\n\n<p>更改语法和行为，使其更符合标准SQL。</p>\n\n<p><img src="http://img.blog.csdn.net/20160419103126571" alt="这里写图片描述" title="" /></p>\n\n<p>由以上操作可知，设置sql_mode为ANSI后，支持的SQL语法，以及数据验证检查等属性都相应的改变了。</p>\n\n<hr />\n\n<pre><code>·STRICT_TRANS_TABLES\n</code></pre>\n\n<p>如果不能将给定的值插入到事务表中，则放弃该语句。对于非事务表，如果值出现在单行语句或多行语句的第1行，则放弃该语句。本节后面给出了更详细的描述。</p>\n\n<hr />\n\n<pre><code>·TRADITIONAL\n</code></pre>\n\n<p>该sql_mode模式使MySQL的行为象“传统”SQL数据库系统。该模式的简单描述是当在列中插入不正确的值时“给出错误而不是警告”。一旦发现错误立即放弃INSERT/UPDATE。如果你使用非事务存储引擎，这种方式不是你想要的，因为出现错误前进行的数据更改不会“滚动”，结果是更新“只进行了一部分”。 <br />\n <img src="http://img.blog.csdn.net/20160419104056100" alt="这里写图片描述" title="" /></p>\n\n<blockquote>\n <p>“严格模式”，表示至少STRICT _TRANS_TABLES或STRICT _ALL_TABLES被启用的模式。</p>\n</blockquote>\n\n<hr />\n\n\n\n<h2 id="sqlmode支持的所有模式">sql_mode支持的所有模式：</h2>\n\n<hr />\n\n<pre><code>· ALLOW_INVALID_DATES\n</code></pre>\n\n<p>在严格模式下不要检查全部日期。只检查1到12之间的月份和1到31之间的日。这在Web应用程序中，当你从三个不同的字段获取年、月、日，并且想要确切保存用户插入的内容(不进行日期验证)时很重要。该模式适用于DATE和DATETIME列。不适合TIMESTAMP列，TIMESTAMP列需要验证日期。</p>\n\n<p>启用严格模式后，服务器需要合法的月和日，不仅仅是分别在1到12和1到31范围内。例如，禁用严格模式时’2004-04-31’是合法的，但启用严格模式后是非法的。要想在严格模式允许遮掩固定日期，还应启用ALLOW_INVALID_DATES。</p>\n\n<hr />\n\n<pre><code>· ANSI_QUOTES\n</code></pre>\n\n<p>将双引号“ ”视为识别符引号，不要视为字符串的引号字符。在ANSI模式，你可以仍然使用‘`’来引用识别符。启用ANSI_QUOTES后，你不能用双引号来引用字符串，因为它被解释为识别符。 如下图： <br />\n<img src="http://img.blog.csdn.net/20160419105447258" alt="这里写图片描述" title="" /></p>\n\n<hr />\n\n<pre><code>· ERROR_FOR_DIVISION_BY_ZERO\n</code></pre>\n\n<p>在严格模式，在INSERT或UPDATE过程中，如果被零除(或MOD(X，0))，则产生错误(否则为警告)。如果未给出该模式，被零除时MySQL返回NULL。例如，如果用到INSERT IGNORE或UPDATE IGNORE模式中，MySQL生成被零除警告，但操作结果为NULL。</p>\n\n<hr />\n\n<pre><code>· HIGH_NOT_PRECEDENCE\n</code></pre>\n\n<p>NOT操作符的优先顺序是表达式例如NOT a BETWEEN b AND c被解释为NOT (a BETWEEN b AND c)。在一些旧版本MySQL中， 表达式被解释为(NOT a) BETWEEN b AND c。启用HIGH_NOT_PRECEDENCESQL模式，可以获得以前的更高优先级的结果。</p>\n\n<p>例如： <br />\n<img src="http://img.blog.csdn.net/20160419110157017" alt="" title="" /></p>\n\n<hr />\n\n<pre><code>· IGNORE_SPACE\n</code></pre>\n\n<p>允许函数名和‘(’之间有空格。强制将所有函数名视为保存的字。结果是，如果你想要访问保存为字的数据库、表或列名，你必须引用它。例如，因为有USER()函数，mysql数据库中的user表名和该表内的User列被保存下来，因此你必须引用它们：</p>\n\n<pre><code>SELECT "User" FROM mysql."user";\n</code></pre>\n\n<hr />\n\n<pre><code>· NO_AUTO_CREATE_USER\n</code></pre>\n\n<p>防止GRANT自动创建新用户，除非还指定了密码。</p>\n\n<hr />\n\n<pre><code>· NO_AUTO_VALUE_ON_ZERO\n</code></pre>\n\n<p>NO_AUTO_VALUE_ON_ZERO影响AUTO_INCREMENT列的处理。一般情况，你可以向该列插入NULL或0生成下一个序列号。NO_AUTO_VALUE_ON_ZERO禁用0，因此只有NULL可以生成下一个序列号。</p>\n\n<p>如果将0保存到表的AUTO_INCREMENT列，该模式会很有用。(不推荐采用该惯例)。例如，如果你用mysqldump转储表并重载，MySQL遇到0值一般会生成新的序列号，生成的表的内容与转储的表不同。重载转储文件前启用NO_AUTO_VALUE_ON_ZERO可以解决该问题。mysqldump在输出中自动包括启用NO_AUTO_VALUE_ON_ZERO的语句。</p>\n\n<hr />\n\n<pre><code>· NO_BACKSLASH_ESCAPES\n</code></pre>\n\n<p>禁用反斜线字符(‘\\’)做为字符串内的退出字符。启用该模式，反斜线则成为普通字符。 <br />\n<img src="http://img.blog.csdn.net/20160419111041874" alt="这里写图片描述" title="" /></p>\n\n<hr />\n\n<pre><code>· NO_DIR_IN_CREATE\n</code></pre>\n\n<p>创建表时，忽视所有INDEX DIRECTORY和DATA DIRECTORY指令。该选项对从复制服务器有用。</p>\n\n<hr />\n\n<pre><code>· NO_ENGINE_SUBSTITUTION\n</code></pre>\n\n<p>如果需要的存储引擎被禁用或未编译，可以防止自动替换存储引擎。</p>\n\n<hr />\n\n<pre><code>· NO_FIELD_OPTIONS\n</code></pre>\n\n<p>不要在SHOW CREATE TABLE的输出中打印MySQL专用列选项。该模式在可移植模式（portability mode）下用于mysqldump。</p>\n\n<hr />\n\n<pre><code>· NO_KEY_OPTIONS\n</code></pre>\n\n<p>不要在SHOW CREATE TABLE的输出中打印MySQL专用索引选项。该模式在可移植模式（portability mode）下用于mysqldump。</p>\n\n<hr />\n\n<pre><code>· NO_TABLE_OPTIONS\n</code></pre>\n\n<p>不要在SHOW CREATE TABLE的输出中打印MySQL专用表选项（例如ENGINE）。该模式在可移植模式（portability mode）下用于mysqldump。</p>\n\n<hr />\n\n<pre><code>· NO_UNSIGNED_SUBTRACTION\n</code></pre>\n\n<p>在减运算中，如果某个操作数没有符号，不要将结果标记为UNSIGNED。请注意这样使UNSIGNED BIGINT不能100%用于上下文中。</p>\n\n<hr />\n\n<pre><code>· NO_ZERO_DATE\n</code></pre>\n\n<p>在严格模式，不要将 ‘0000-00-00’做为合法日期。你仍然可以用IGNORE选项插入零日期。在非严格模式，可以接受该日期，但会生成警告。</p>\n\n<hr />\n\n<pre><code>· NO_ZERO_IN_DATE\n</code></pre>\n\n<p>在严格模式，不接受月或日部分为0的日期。如果使用IGNORE选项，我们为类似的日期插入’0000-00-00’。在非严格模式，可以接受该日期，但会生成警告。</p>\n\n<hr />\n\n<pre><code>· ONLY_FULL_GROUP_BY\n</code></pre>\n\n<p>不要让GROUP BY部分中的查询指向未选择的列。</p>\n\n<hr />\n\n<pre><code>· PIPES_AS_CONCAT\n</code></pre>\n\n<p>将||视为字符串连接操作符（＋）(同CONCAT())，而不视为OR。</p>\n\n<hr />\n\n<pre><code>· REAL_AS_FLOAT\n</code></pre>\n\n<p>将REAL视为FLOAT的同义词，而不是DOUBLE的同义词。</p>\n\n<hr />\n\n<pre><code>· STRICT_TRANS_TABLES\n</code></pre>\n\n<p>为所有存储引擎启用严格模式。非法数据值被拒绝。</p>\n\n<p>· STRICT_TRANS_TABLES</p>\n\n<p>为事务存储引擎启用严格模式，也可能为非事务存储引擎启用严格模式。</p>\n\n<p>严格模式控制MySQL如何处理非法或丢失的输入值。有几种原因可以使一个值为非法。例如，数据类型错误，不适合列，或超出范围。当新插入的行不包含某列的没有显示定义DEFAULT子句的值，则该值被丢失。</p>\n\n<p>对于事务表，当启用STRICT_ALL_TABLES或STRICT_TRANS_TABLES模式时，如果语句中有非法或丢失值，则会出现错误。语句被放弃并滚动。</p>\n\n<p>对于非事务表，如果插入或更新的第1行出现坏值，两种模式的行为相同。语句被放弃，表保持不变。如果语句插入或修改多行，并且坏值出现在第2或后面的行，结果取决于启用了哪个严格选项：</p>\n\n<ul>\n<li><p>对于STRICT_ALL_TABLES，MySQL返回错误并忽视剩余的行。但是，在这种情况下，前面的行已经被插入或更新。这说明你可以部分更新，这可能不是你想要的。要避免这点，最好使用单行语句，因为这样可以不更改表即可以放弃。</p></li>\n<li><p>对于STRICT_TRANS_TABLES，MySQL将非法值转换为最接近该列的合法值并插入调整后的值。如果值丢失，MySQL在列中插入隐式 默认值。在任何情况下，MySQL都会生成警告而不是给出错误并继续执行语句。</p></li>\n</ul>\n\n<p>严格模式不允许非法日期，例如’2004-04-31’。它不允许禁止日期使用“零”部分，例如’2004-04-00’或“零”日期。要想禁止，应在严格模式基础上，启用NO_ZERO_IN_DATE和NO_ZERO_DATE SQL模式。</p>\n\n<p>如果你不使用严格模式(即不启用STRICT_TRANS_TABLES或STRICT_ALL_TABLES模式)，对于非法或丢失的值，MySQL将插入调整后的值并给出警告。在严格模式，你可以通过INSERT IGNORE或UPDATE IGNORE来实现。</p>\n\n<hr />\n\n\n\n<h2 id="以下特殊模式快速组合了前面所列的模式中的一个或几个">以下特殊模式快速组合了前面所列的模式中的一个或几个。</h2>\n\n<hr />\n\n<p>其中包括大多数最新版本MySQL中的所有模式值。旧版本中，组合模式不包括新版本中没有的不适用的具体模式值。</p>\n\n<ul>\n<li><p>ANSI <br />\n等同REAL_AS_FLOAT、PIPES_AS_CONCAT、ANSI_QUOTES、IGNORE_SPACE。</p></li>\n<li><p>DB2 <br />\n等同PIPES_AS_CONCAT、ANSI_QUOTES、IGNORE_SPACE、NO_KEY_OPTIONS、NO_TABLE_OPTIONS、NO_FIELD_OPTIONS。</p></li>\n<li><p>MAXDB <br />\n等同PIPES_AS_CONCAT、ANSI_QUOTES、IGNORE_SPACE、NO_KEY_OPTIONS、NO_TABLE_OPTIONS、NO_FIELD_OPTIONS、 NO_AUTO_CREATE_USER。</p></li>\n<li><p>MSSQL <br />\n等同PIPES_AS_CONCAT、ANSI_QUOTES、IGNORE_SPACE、NO_KEY_OPTIONS、NO_TABLE_OPTIONS、 NO_FIELD_OPTIONS。</p></li>\n<li><p>MYSQL323 <br />\n等同NO_FIELD_OPTIONS、HIGH_NOT_PRECEDENCE。</p></li>\n<li><p>MYSQL40 <br />\n等同NO_FIELD_OPTIONS、HIGH_NOT_PRECEDENCE。</p></li>\n<li><p>ORACLE <br />\n等同PIPES_AS_CONCAT、ANSI_QUOTES、IGNORE_SPACE、NO_KEY_OPTIONS、NO_TABLE_OPTIONS、NO_FIELD_OPTIONS、NO_AUTO_CREATE_USER。</p></li>\n<li><p>POSTGRESQL <br />\n等同PIPES_AS_CONCAT、ANSI_QUOTES、IGNORE_SPACE、NO_KEY_OPTIONS、NO_TABLE_OPTIONS、NO_FIELD_OPTIONS。</p></li>\n<li><p>TRADITIONAL <br />\n等同STRICT_TRANS_TABLES、STRICT_ALL_TABLES、NO_ZERO_IN_DATE、NO_ZERO_DATE、ERROR_FOR_DIVISION_BY_ZERO、NO_AUTO_CREATE_USER。</p></li>\n</ul>\n\n<hr />\n\n<p>如果要自己组装不同的模式，只需在set的时候将不同的模式用逗号隔开就可以了： <br />\n<img src="http://img.blog.csdn.net/20160419113236960" alt="这里写图片描述" title="" /></p></div>&#13;\n <script type="text/javascript">&#13;\n $(function () {&#13;\n $('pre.prettyprint code').each(function () {&#13;\n var lines = $(this).text().split('\\n').length;&#13;\n var $numbering = $('&lt;ul/&gt;').addClass('pre-numbering').hide();&#13;\n $(this).addClass('has-numbering').parent().append($numbering);&#13;\n for (i = 1; i &lt;= lines; i++) {&#13;\n $numbering.append($('&lt;li/&gt;').text(i));&#13;\n };&#13;\n $numbering.fadeIn(1700);&#13;\n });&#13;\n });&#13;\n </script>&#13;\n &#13;\n
