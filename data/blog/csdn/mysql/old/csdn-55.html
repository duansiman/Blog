\n\n<p>        在实际录入数据库的过程中，如果数据量比较大的话，难免会因为一些原因，而录入多条重复的记录，那么应该如何操作才能删除重复行，并且保留一条id较大，或者较小的记录呢。</p>&#13;\n<p>        在本例中所用数据表结构如下所示tdb_goods</p>&#13;\n<p><img src="http://img.blog.csdn.net/20160907093140316?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQv/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/Center" alt="" /></p>&#13;\n<p>        表中数据重复如图所示</p>&#13;\n<p><img src="http://img.blog.csdn.net/20160907094739176?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQv/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/Center" alt="" /><br />&#13;\n</p>&#13;\n<p>        首先第一步，利用group by分组查出每组中数目大于2的（即重复记录的）内容</p>&#13;\n<p></p>&#13;\n<pre name="code" class="sql">mysql&gt; SELECT goods_id,goods_name FROM tdb_goods GROUP BY goods_name HAVING COUN\nT(goods_name)&gt;=2;\n+----------+------------------------------+\n| goods_id | goods_name |\n+----------+------------------------------+\n| 20 | X3250 M4机架式服务器 2583i14 |\n| 19 | 商务双肩背包 |\n+----------+------------------------------+\n2 rows in set (0.01 sec)</pre><br />&#13;\n        然后使用LEFT JOIN使原始表和上述查询结果进行连接，删除重复记录，保留id较小的记录&#13;\n<p></p>&#13;\n<p></p>&#13;\n<pre name="code" class="sql">mysql&gt; DELETE t1 FROM tdb_goods AS t1 LEFT JOIN( SELECT goods_id,goods_name FROM\n tdb_goods GROUP BY goods_name HAVING COUNT(goods_name)&gt;=2) AS t2 ON t1.goods_na\nme = t2.goods_name WHERE t1.goods_id&gt;t2.goods_id;\nQuery OK, 2 rows affected (0.06 sec)</pre><br />&#13;\n        从上述语句可以看出，条件是名称相同的，然后删除所有goods_id大的记录。这样就可以实现想要的效果。&#13;\n<p></p>&#13;\n<p>        如果想保留id较大的同理，如下所示</p>&#13;\n<p>        </p>&#13;\n<pre name="code" class="sql">mysql&gt; DELETE t1 FROM tdb_goods AS t1 LEFT JOIN( SELECT max(goods_id) AS goods_i\nd,goods_name FROM tdb_goods GROUP BY goods_name HAVING COUNT(goods_name)&gt;=2) AS\nt2 ON t1.goods_name = t2.goods_name WHERE t1.goods_id&lt;t2.goods_id;\nQuery OK, 2 rows affected (0.03 sec)</pre><br />&#13;\n<p></p>&#13;\n<p><br />&#13;\n</p>&#13;\n<p>注关于表连接，如有疑问请查看<a target="_blank" href="http://blog.csdn.net/qq_28602957/article/details/52142737">JOIN的用法。</a><br />&#13;\n</p>&#13;\n<p><br />&#13;\n</p>&#13;\n<p><br />&#13;\n</p>&#13;\n<p><br />&#13;\n</p>&#13;\n &#13;\n
