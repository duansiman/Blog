\n\n<p><br />&#13;\n</p>&#13;\n<p>CleverCode最近在导出报表的时候，在整数做减法的时候，发现整数减去null得到是null。这是一个细节问题，希望大家以后注意。</p>&#13;\n<p><br />&#13;\n</p>&#13;\n<h1>1 表中的数据</h1>&#13;\n<div>total，used都是整形，允许为空。</div>&#13;\n<p><img src="http://img.blog.csdn.net/20150724093151840?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQv/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast" alt="" /><br />&#13;\n</p>&#13;\n<p><br />&#13;\n</p>&#13;\n<h1>2 有问题的运算语句</h1>&#13;\n<div>减法问题</div>&#13;\n<div><pre name="code" class="sql">select \n\tid,\n\ttotal,\n\tused,\n\t(total - used) as have \nfrom test_table</pre><br />&#13;\n<pre></pre>&#13;\n</div>&#13;\n<p><img src="http://img.blog.csdn.net/20150724093638933?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQv/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast" alt="" /></p>&#13;\n<p></p>&#13;\n<p></p>&#13;\n<h1>3 正确的写法</h1>&#13;\n<h1></h1>&#13;\n<div>使用ifnull，来处理null。</div>&#13;\n<div><pre name="code" class="sql">select \n\tid,\n\tifnull(total,0) as total,\n\tifnull(used,0) as used,\n\t(ifnull(total,0) - ifnull(used,0)) as have \nfrom test_table</pre><br />&#13;\n<img src="http://img.blog.csdn.net/20150724093943365?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQv/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast" alt="" /><br />&#13;\n</div>&#13;\n<br />&#13;\n<p></p>&#13;\n<p></p>&#13;\n<h1>4 建议</h1>&#13;\n<div><br />&#13;\n</div>&#13;\n<div>1） 在设计表的时候，如果发现这列是需要运算的列，建议设置默认值，比如0；</div>&#13;\n<div>2） 在整形列的运算的时候，不管是加，减，乘，除等。都需要使用ifnull，对列进行处理。否则报表数据就会错。</div>&#13;\n<div><br />&#13;\n</div>&#13;\n<div><span style="color:#ff0000">这些都是细节小问题，大家一看就能明白，希望大家在细节上注意，否则一份财务表报计算出错了，那后果是很严重的！</span></div>&#13;\n<div><br />&#13;\n</div>&#13;\n<div><br />&#13;\n</div>&#13;\n<div>&#13;\n<h1><span style="font-size:14px">版权声明：</span></h1>&#13;\n<span style="font-size:14px">1）原创作品，出自"CleverCode的博客"，请勿转载，否则追究版权法律责任。<br />&#13;\n2）原创地址：<a target="_blank" href="http://blog.csdn.net/clevercode/article/details/47035975">http://blog.csdn.net/clevercode/article/details/47035975</a>。<br />&#13;\n3）分类地址（Mysql数据库总结）：<a target="_blank" href="http://blog.csdn.net/clevercode/article/category/3262205">http://blog.csdn.net/clevercode/article/category/3262205</a>（博客持续增加，关注请收藏）<br />&#13;\n4）欢迎大家关注我博客更多的精彩内容：<a target="_blank" href="http://blog.csdn.net/CleverCode">http://blog.csdn.net/CleverCode</a>。<br />&#13;\n</span><br />&#13;\n</div>&#13;\n<br />&#13;\n<p></p>&#13;\n<p><br />&#13;\n</p>&#13;\n<div><span style="font-size:14px"><br />&#13;\n</span></div>&#13;\n<div style="top:686px">&#13;\n<p></p>&#13;\n<h1>4 建议</h1>&#13;\n</div>&#13;\n &#13;\n
