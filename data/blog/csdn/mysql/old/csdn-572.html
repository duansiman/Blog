\n <div class="markdown_views"><p>对数据库产生的影响因素： <br />\n<img src="http://img.blog.csdn.net/20161230163413499?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvcXFfMzM5MzY0ODE=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast" alt="这里写图片描述" title="" /> <br />\nwindows默认的tcp并发数只有十个； <br />\nmysql插件式存储引擎； <br />\n<img src="http://img.blog.csdn.net/20161230163707969?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvcXFfMzM5MzY0ODE=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast" alt="这里写图片描述" title="" /> <br />\n<img src="http://img.blog.csdn.net/20161230163850892?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvcXFfMzM5MzY0ODE=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast" alt="这里写图片描述" title="" /> <br />\n业务一旦上线，很难对相对的库表进行修改。 <br />\n<img src="http://img.blog.csdn.net/20161230164052783?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvcXFfMzM5MzY0ODE=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast" alt="这里写图片描述" title="" /> <br />\nCPU和可用内存大小，热数据远远超过可用内存大小时，网络（大量数据被查询），比如使用memcache存储引擎时，缓存失效产生大量的网络传输。 <br />\n<strong>当出现I/O系统瓶颈时，最好的解决办法就是升级I/O子系统，增加更多的内存。</strong></p>\n\n<ol>\n<li>如何选择CPU？（频率&amp;数量） <br />\n<img src="http://img.blog.csdn.net/20161230172759209?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvcXFfMzM5MzY0ODE=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast" alt="这里写图片描述" title="" /> <br />\n尴尬….. <br />\n<img src="http://img.blog.csdn.net/20161230173019210?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvcXFfMzM5MzY0ODE=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast" alt="这里写图片描述" title="" /> <br />\n所以，我们要确定应用是CPU密集型吗？（答：更好的CPU） <br />\n目前版本MYSQL不支持多CPU对**同一**SQL并发处理。</li>\n<li>然后我们系统的并发量如何？答：CPU越多越好，比如一个CPU处理一个SQL（纳秒级的）。 <br />\n衡量数据库处理能力的指标不是有嘛，<strong>QPS：同时处理SQL的数量（每秒钟处理SQL的数量）。</strong>韩信点兵，多多益善咯！ <br />\nMysql主要是应用于WEB类的应用中 <br />\nweb类应用：核心数量比频率更重要</li>\n<li>选择MYSQL的版本。 <br />\n老版本对于多核CPU的支持并不是很好。5.0之前的现象很严重。5.6以后有了很大的改善。我们可以使用16核或者32核的CPU.</li>\n<li><p>选择32位还是64位的CPU? <br />\n当然是64位的了。 <br />\n还有注意服务器是多少位的，如果32位，沃日，运维，你当初干嘛的？</p></li>\n<li><p>内存的选择 <br />\n<img src="http://img.blog.csdn.net/20161230174819751?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvcXFfMzM5MzY0ODE=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast" alt="这里写图片描述" title="" /> <br />\n内存的IO效率远远高于硬盘； <br />\n所以，把数据缓存到内存中进行读取，就可以大大的提高数据库的效率</p></li>\n</ol>\n\n<p><img src="http://img.blog.csdn.net/20161230175308596?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvcXFfMzM5MzY0ODE=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast" alt="这里写图片描述" title="" /></p>\n\n<p><img src="http://img.blog.csdn.net/20161230175515706?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvcXFfMzM5MzY0ODE=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast" alt="这里写图片描述" title="" /> <br />\n<img src="http://img.blog.csdn.net/20161230180256660?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvcXFfMzM5MzY0ODE=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast" alt="这里写图片描述" title="" /> <br />\n当缓存的数据和磁盘存储的数据一样时，也就是说所有数据都缓存了，再加内存还要毛线意思。 <br />\n不过多余的内存，会增加其他服务的性能。 <br />\n <img src="http://img.blog.csdn.net/20161230180854338?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvcXFfMzM5MzY0ODE=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast" alt="这里写图片描述" title="" /> <br />\n内存对读写都很有帮助 <br />\n <img src="http://img.blog.csdn.net/20161230181004530?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvcXFfMzM5MzY0ODE=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast" alt="这里写图片描述" title="" /> <br />\n多次写入变成一次写入，配置中可以将缓存池中对数据库多次的写操作修改为1次 <br />\n我们选择主频时，要选择服务器支持的最高内存频率。 <br />\n<img src="http://img.blog.csdn.net/20161230181459427?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvcXFfMzM5MzY0ODE=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast" alt="这里写图片描述" title="" /> <br />\n根据数据库大小选择内存（最好选择比数据库大小大一倍多的内存）</p>\n\n<p><strong>磁盘的配置和选择</strong> <br />\n <img src="http://img.blog.csdn.net/20161230182015388?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvcXFfMzM5MzY0ODE=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast" alt="这里写图片描述" title="" /> <br />\n - 传统机器硬盘 <br />\n最常见，使用最多，价格低，存储空间大，读写比较慢 <br />\n<img src="http://img.blog.csdn.net/20161230182212375?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvcXFfMzM5MzY0ODE=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast" alt="这里写图片描述" title="" /> <br />\n<img src="http://img.blog.csdn.net/20161230182549693?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvcXFfMzM5MzY0ODE=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast" alt="这里写图片描述" title="" /> <br />\n - RAID技术组合磁盘，增加存储容量； <br />\n - 由于主机接口限制，对顺序存取，传输速度（取决于主轴转动的速度）是不会成为我们的瓶颈的。 <br />\n - 更快的访问时间 <br />\n - 主流是7200转或者是10000转，15000转 <br />\n - <br />\n<img src="http://img.blog.csdn.net/20161230182645955?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvcXFfMzM5MzY0ODE=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast" alt="这里写图片描述" title="" /> <br />\n（1） <br />\n<img src="http://img.blog.csdn.net/20161230183159373?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvcXFfMzM5MzY0ODE=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast" alt="这里写图片描述" title="" /> <br />\n在数据不丢失的情况下可以使用，或者一次性数据库。因为丢失数据成本太高 <br />\n（2） <br />\n<img src="http://img.blog.csdn.net/20161230183355177?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvcXFfMzM5MzY0ODE=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast" alt="这里写图片描述" title="" /> <br />\n磁盘利用率百分之五十。硬盘损坏后需要及时更换。同步镜像还需要很长的时间。比raid0快一些，适合存放日志。 <br />\n（3）常用的RAID组别–RAID5 <br />\n<img src="http://img.blog.csdn.net/20161230184103915?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvcXFfMzM5MzY0ODE=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast" alt="这里写图片描述" title="" /> <br />\n<img src="http://img.blog.csdn.net/20161230184221057?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvcXFfMzM5MzY0ODE=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast" alt="这里写图片描述" title="" /> <br />\n最经济的冗余配置，随机写比较慢，在底层两次读两次写，计算校验位的数值，但是随机读和顺序读很快。读取不用计算奇偶校验位。所以适合以读为主的业务。 因为数据要分配到其他磁盘上，这会严重影响磁盘的性能，所以最好使用在从数据库服务器上 <br />\n（4）常用的RAID组别–RAID10 <br />\n<img src="http://img.blog.csdn.net/20161230184905871?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvcXFfMzM5MzY0ODE=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast" alt="这里写图片描述" title="" /> <br />\n<img src="http://img.blog.csdn.net/20161230184955731?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvcXFfMzM5MzY0ODE=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast" alt="这里写图片描述" title="" /> <br />\n总结： <br />\n<img src="http://img.blog.csdn.net/20161230185219857?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvcXFfMzM5MzY0ODE=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast" alt="这里写图片描述" title="" /></p>\n\n<p><strong>下面再来聊聊固态存储</strong> <br />\n<img src="http://img.blog.csdn.net/20170309141646556?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvcXFfMzM5MzY0ODE=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast" alt="这里写图片描述" title="" /></p>\n\n<ul>\n<li>相对机械磁盘，固态磁盘有更好的随机读写性能（读&gt;&gt;写）</li>\n<li>相对机械磁盘，固态磁盘能更好的支持并发；（大并发情况下才能更好的体现它的优势，提供良好的随机IO性能，关系形数据库所需要）</li>\n<li><p>相对机械磁盘，固态磁盘更容易损坏。（因为每次写入前都要对此单元进行擦除操作，长时间密集的写操作）随着占用空间的增长，性能也会有所降低。</p>\n\n<p><strong>SSD=固态硬盘</strong> <br />\n<img src="http://img.blog.csdn.net/20170309142511081?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvcXFfMzM5MzY0ODE=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast" alt="这里写图片描述" title="" /> <br />\nSSD硬盘也会受到接口的影响，比如SATA3.0(6Gbps)接到SATA2.0(3Gbps)的接口上。 <br />\n<strong>PCI-E卡</strong> <br />\nFusion-io就是一种使用闪存技术的PCI-E卡设备；</p></li>\n<li><p>无法使用SATA接口，需要独特的驱动和配置</p></li>\n<li>价格相对于SSD要贵，但是性能比SSD更好</li>\n<li>大部分情况下，PCI-O还需要使用服务器的内存和CPU资源（当初老师配置Fusion-io的使用，服务器莫名自瞄的少了几十个G的内存）</li>\n<li>不建议使用RAID技术，因为支持PCIO的RAID控制器比较少，同时价格过高，无法接受。</li>\n</ul>\n\n<p>随机I/O是通常是由于数据库中的应用数据远远大于服务器的内存大小所导致的。同时我们提到过，如果服务器内存足够大，那我们就可以大量的把随机I/O改为顺序I/O。但是内存不可能无限的增加。当数据库中的应用数据远远大于服务器的内存容量时，就不能通过增加服务器的内存的方式来减少随机I/O了。这时候我们就可以通过固态存储设备获得额外的好处。 <br />\n <img src="http://img.blog.csdn.net/20170309145344949?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvcXFfMzM5MzY0ODE=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast" alt="这里写图片描述" title="" /> <br />\n （对于通讯上的功能负载通常可以简单的加大并行性，来获得更高的吞吐量） <br />\n 单线程对延迟比较敏感，如果要增加吞吐量，只能通过加快I/O来解决了。</p>\n\n<p>附：如果只有一块固态硬盘，是放在mysql主服务器上还是主从复制的从服务器上呢？ <br />\n 从服务器上，因为从服务器是单线程的，而主是多线程的，为了产生更少的延迟。我们就应该增加从服务器的I/O性能， 而且由于容易损耗，所以用在主服务器上不安全。</p>\n\n<p><strong>下面说一下网络存储SAN和NAS</strong> <br />\n<strong>都是将外部文件存储设备加载到服务器上的方法</strong> <br />\nSAN（Storage Area Network,存储区域网络）通过光纤通道连接到一群计算机上。在该网络中提供 了多主机连接，但并非通过标准的网络拓扑。 <br />\nps:DAS（Direct Access Storage—直接连接存储）是指将存储设备通过SCSI接口或光纤通道直接连接到一台计算机上。</p>\n\n<p><img src="http://img.blog.csdn.net/20170309152209384?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvcXFfMzM5MzY0ODE=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast" alt="这里写图片描述" title="" /> <br />\n<img src="http://img.blog.csdn.net/20170309152304085?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvcXFfMzM5MzY0ODE=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast" alt="这里写图片描述" title="" /> <br />\nNAS（Network Attached Storage）—网络连接存储，即将存储设备通过标准的网络拓扑结构（例如以太网），连接到一群计算机上。NAS是部件级的存储方法，它的重点在于帮助工作组和部门级机构解决迅速增加存储容量的需求。需要共享大型CAD文档的工程小组就是典型的例子。 <br />\n<img src="http://img.blog.csdn.net/20170309152427635?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvcXFfMzM5MzY0ODE=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast" alt="这里写图片描述" title="" /> <br />\n通常有网络延迟。 <br />\n数据库的存储瓶颈经常出现在随机I/O上，所以网络存储弱鸡了；牺牲性能的高可用性（两台服务器挂载在同一台网络存储设备上(主服务器宕机，主备服务器上)，有点像甲骨文的RAC），而且网络存储设备本身出现问题，需要更多的维护时间（等待厂商） <br />\n所以说网络存储最实用的场景就是 <br />\n<strong>数据库备份</strong></p>\n\n<p>对于磁盘性能的限制都是：<strong>延迟，吞吐量</strong> <br />\n对于网络性能的限制都是：<strong>延迟，带宽，网络质量（丢包-&gt;网络风暴）</strong> <br />\n<img src="http://img.blog.csdn.net/20170309154431848?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvcXFfMzM5MzY0ODE=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast" alt="" title="" /> <br />\n<img src="http://img.blog.csdn.net/20170309154923053?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvcXFfMzM5MzY0ODE=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast" alt="这里写图片描述" title="" /></p>\n\n<p><strong><em>总结：</em></strong> <br />\n<img src="http://img.blog.csdn.net/20170309155206148?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvcXFfMzM5MzY0ODE=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast" alt="这里写图片描述" title="" /> <br />\n<img src="http://img.blog.csdn.net/20170309155316305?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvcXFfMzM5MzY0ODE=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast" alt="这里写图片描述" title="" /> <br />\n（对数据进行缓存和随机I/O顺序I/O） <br />\n<img src="http://img.blog.csdn.net/20170309155652947?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvcXFfMzM5MzY0ODE=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast" alt="这里写图片描述" title="" /></p></div>&#13;\n <script type="text/javascript">&#13;\n $(function () {&#13;\n $('pre.prettyprint code').each(function () {&#13;\n var lines = $(this).text().split('\\n').length;&#13;\n var $numbering = $('&lt;ul/&gt;').addClass('pre-numbering').hide();&#13;\n $(this).addClass('has-numbering').parent().append($numbering);&#13;\n for (i = 1; i &lt;= lines; i++) {&#13;\n $numbering.append($('&lt;li/&gt;').text(i));&#13;\n };&#13;\n $numbering.fadeIn(1700);&#13;\n });&#13;\n });&#13;\n </script>&#13;\n &#13;\n
