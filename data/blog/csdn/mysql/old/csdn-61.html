\n\n<div><span style="">        在MySQL的性能优化中，我们时常需要用到慢查日志，并以此来分析，进行性能的优化。</span></div>&#13;\n<div><span style=""><span style=""><span style="">        MySQL的慢查询日志是MySQL提供的一种日志记录，它用来记录在MySQL中响应时间超过阀值的语句，具体指运行时间超过long_query_time值的SQL，则会被记录到慢查询日志中。long_query_time的默认值为10，意思是运行10S以上的语句。默认情况下，Mysql数据库并不启动慢查询日志，需要我们手动来设置这个参数，当然，如果不是调优需要的话，一般不建议启动该参数，因为开启慢查询日志会或多或少带来一定的性能影响。慢查询日志支持将日志记录写入文件，也支持将日志记录写入数据库表。</span></span></span></div>&#13;\n<div><span style=""><span style=""><span style=""><br />&#13;\n</span></span></span></div>&#13;\n<div><span style=""><span style=""><span style=""><br />&#13;\n</span></span></span></div>&#13;\n<div><span style=""><span style=""><span style=""><span style="">查看慢查日志是否开启：</span></span></span></span></div>&#13;\n<span style=""><span style=""><span style=""></span></span></span><pre code_snippet_id="1805810" snippet_file_name="blog_20160804_1_6692128" class="sql" name="code">show variables like 'slow_query_log';</pre>&#13;\n<div><img src="http://img.blog.csdn.net/20160804084234699?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQv/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/Center" alt="" /></div>&#13;\n<div><br />&#13;\n</div>&#13;\n<div>&#13;\n<div style="">在开启之前，我们要确认一下，是否将没有使用索引的sql，记录进慢查日志中：</div>&#13;\n<div style=""><pre code_snippet_id="1805810" snippet_file_name="blog_20160804_2_640034" class="sql" name="code">show variables like '%log%';</pre></div>&#13;\n<div style=""><br />&#13;\n</div>&#13;\n</div>&#13;\n<div><img src="http://img.blog.csdn.net/20160804084330429?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQv/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/Center" alt="" /></div>&#13;\n<div><br />&#13;\n</div>&#13;\n<div><span style="">将其改为开启状态</span><pre code_snippet_id="1805810" snippet_file_name="blog_20160804_3_924224" class="sql" name="code"> set global log_queries_not_using_indexes=on;</pre><br />&#13;\n</div>&#13;\n<div><img src="http://img.blog.csdn.net/20160804084425195?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQv/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/Center" alt="" /></div>&#13;\n<div><br />&#13;\n</div>&#13;\n<div><span style="">查看超过多长时间的sql会被记录进入慢查日志中</span></div>&#13;\n<div><pre code_snippet_id="1805810" snippet_file_name="blog_20160804_4_95599" class="sql" name="code">show variables like 'long_query_time';</pre><img src="http://img.blog.csdn.net/20160804084531414?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQv/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/Center" alt="" /><br />&#13;\n</div>&#13;\n<div><br />&#13;\n</div>&#13;\n<div><span style="">修改long_query_time的值</span>用set，例如：</div>&#13;\n<div><pre code_snippet_id="1805810" snippet_file_name="blog_20160804_5_1252625" class="sql" name="code"> set long_query_time=0</pre><br />&#13;\n</div>&#13;\n<div><span style="">开启慢查日志</span></div>&#13;\n<div><pre code_snippet_id="1805810" snippet_file_name="blog_20160804_6_8995540" class="sql" name="code"> set global slow_query_log=on;</pre><br />&#13;\n</div>&#13;\n<div><span style="">查看慢查日志的存储位置</span></div>&#13;\n<div><pre code_snippet_id="1805810" snippet_file_name="blog_20160804_7_8723323" class="sql" name="code">show variables like 'slow%';</pre><img src="http://img.blog.csdn.net/20160804084642362?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQv/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/Center" alt="" /><br />&#13;\n</div>&#13;\n<div><br />&#13;\n</div>&#13;\n<div><br />&#13;\n</div>&#13;\n<div><span style=""><span style="">慢查日志的记录格式</span></span></div>&#13;\n<div><span style=""><img src="http://img.blog.csdn.net/20160804084716394?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQv/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/Center" alt="" /></span></div>&#13;\n<div><span style="font-family:微软雅黑"><br />&#13;\n</span></div>&#13;\n<div><img src="http://img.blog.csdn.net/20160804084733051?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQv/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/Center" alt="" /></div>&#13;\n<div><br />&#13;\n</div>&#13;\n<div><br />&#13;\n</div>&#13;\n<div><br />&#13;\n</div>&#13;\n<div><br />&#13;\n</div>&#13;\n<div><br />&#13;\n</div>&#13;\n<div><br />&#13;\n</div>&#13;\n &#13;\n
