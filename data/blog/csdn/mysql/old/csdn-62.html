\n\n<div style=""><span style="font-size:18px; color:#ff0000; background-color:inherit"><strong style="background-color:inherit">使用默认模式-----PDO::ERRMODE_SILENT</strong></span></div>&#13;\n<div style="">在默认模式中设置PDOStatement对象的errorCode属性，但不进行其他任何操作。</div>&#13;\n<div style="">例如：</div>&#13;\n<div style="">通过prepare()和execute()方法向数据库中添加数据，设置PDOStatement对象的erroCode属性，手动检测代码中的错误，操作步骤如下。</div>&#13;\n<p><br />&#13;\n</p>&#13;\n<p></p>&#13;\n<pre name="code" class="php">$dbms='mysql';//数据库类型\n$dbName='admin';//使用的数据库\n$user='root';//数据库连接用户名\n$pwd='password';//数据库连接密码\n$host='localhost';//数据库主机名\n$dsn="$dbms:host=$host;port=3306;dbname=$dbName";\n$pdo=new PDO($dsn,$user,$pwd);//初始化一个PDO对象，就是创建了数据库连接对象$pdo\n$query="insert into user (username,password) values('admin')";//需要执行的sql语句\n$res=$pdo-&gt;prepare($query);\n$res-&gt;execute();\n$code=$res-&gt;errorCode();\necho $code.'&lt;br&gt;';\nif($code==00000){//如果没有任何错误, errorCode() 返回的是: 00000 ，否则就会返回一些错误代码\necho "数据添加成功";\n}else{\necho "数据库错误：&lt;br&gt;";\necho 'SQL Query:'.$query;\necho '&lt;pre&gt;';\nvar_dump($res-&gt;errorInfo());\necho '&lt;pre&gt;';\n}</pre><br />&#13;\n<p></p>&#13;\n<pre style="">运行结果如下</pre>&#13;\n<pre style="">21S01<br style="background-color:inherit" />数据库错误：<br style="background-color:inherit" />SQL Query:insert into user (username,password) values('admin')<pre style="font-family:Monaco,Consolas,Courier,'Lucida Console',monospace; font-style:normal; background-color:inherit">array(3) {\n [0]=&gt;\n string(5) "21S01"\n [1]=&gt;\n int(1136)\n [2]=&gt;\n string(47) "Column count doesn't match value count at row 1"\n}\n\n\n</pre></pre>&#13;\n<pre style=""><span style="font-size:18px; color:#ff0000; background-color:inherit"><strong style="background-color:inherit">使用警告模式-----PDO::ERRMODE_WARNING</strong></span></pre>&#13;\n<pre style="">警告模式会产生一个PHP警告，并设置errorCode属性。如果设置的是警告模式，那么除非明确的检查错误代码，否则程序将继续按照其方式运行。</pre>&#13;\n<pre style="">例如：</pre>&#13;\n<pre style="">设置警告模式，通过prepare()和execute()方法读取数据库中数据，并且通过while语句和fetch()方法完成数据的循环输出，体会在设置成警告模式后执行错误的SQL的语句。</pre>&#13;\n<pre name="code" class="php">$dbms='mysql';//数据库类型\n$dbName='admin';//使用的数据库\n$user='root';//数据库连接用户名\n$pwd='password';//数据库连接密码\n$host='localhost';//数据库主机名\n$dsn="$dbms:host=$host;port=3306;dbname=$dbName";\ntry {\n$pdo = new PDO($dsn, $user, $pwd);//初始化一个PDO对象，就是创建了数据库连接对象$pdo\n$pdo-&gt;setAttribute(PDO::ATTR_ERRMODE, PDO::ERRMODE_WARNING);//设置为警告模式\n$query = "select csdn-10.html csdn-11.html csdn-12.html csdn-13.html csdn-14.html csdn-15.html csdn-16.html csdn-17.html csdn-18.html csdn-19.html csdn-1.html csdn-20.html csdn-21.html csdn-22.html csdn-23.html csdn-24.html csdn-25.html csdn-26.html csdn-27.html csdn-28.html csdn-29.html csdn-2.html csdn-30.html csdn-31.html csdn-32.html csdn-33.html csdn-34.html csdn-35.html csdn-36.html csdn-37.html csdn-38.html csdn-39.html csdn-3.html csdn-40.html csdn-41.html csdn-42.html csdn-43.html csdn-44.html csdn-45.html csdn-46.html csdn-47.html csdn-48.html csdn-49.html csdn-4.html csdn-50.html csdn-51.html csdn-52.html csdn-53.html csdn-54.html csdn-55.html csdn-56.html csdn-57.html csdn-58.html csdn-59.html csdn-5.html csdn-60.html csdn-61.html csdn-6.html csdn-7.html csdn-8.html csdn-9.html mysql.sh from userrr";//需要执行的sql语句\n$res = $pdo-&gt;prepare($query);//准备查询语句\n$res-&gt;execute();\nwhile ($result = $res-&gt;fetch(PDO::FETCH_ASSOC)) {//while循环输出查询结果集并设置结果集以关联数组的形式返回。\necho $result['id'] . " " . $result['username'] . " " . $result['password'];\n }\n}catch(PDOException $e){\ndie("ERROR!:".$e-&gt;getMessage().'&lt;br&gt;');\n}\necho "继续继续继续继续继续继续继续";</pre><br />&#13;\n<pre style="">运行结果如下：</pre>&#13;\n<pre style=""><strong style="background-color:inherit">Warning</strong>: PDOStatement::execute() [<a target="_blank" href="http://localhost/test/test/pdostatement.execute" style="background-color:inherit">pdostatement.execute</a>]: SQLSTATE[42S02]: Base table or view not found: 1146 Table 'admin.userrr' doesn't exist in <strong style="background-color:inherit">D:\\wampserver\\www\\test\\test\\index1.php</strong> on line <strong style="background-color:inherit">14</strong><br style="background-color:inherit" />\n继续继续继续继续继续继续继续</pre>&#13;\n<pre style=""><br style="background-color:inherit" /></pre>&#13;\n<pre style="">可以看出在设置警告模式后，如果SQL语句出现错误将给出一个提示信息，但是程序仍能够继续执行下去。</pre>&#13;\n<pre style=""><br style="background-color:inherit" /></pre>&#13;\n<pre style=""><span style="font-size:18px; color:#ff0000; background-color:inherit"><strong style="background-color:inherit">使用异常模式----PDO::ERRMODE_EXCEPTION</strong></span></pre>&#13;\n<pre style="">异常模式将会创建一个PDOException,并设置errorCode属性，它可以将执行代码封装到一个try{}catch{}语句块中。未捕获的异常将会导致脚本中断，并显示堆栈跟踪让用户了解是哪里出现了问题。</pre>&#13;\n<pre style="">例如：</pre>&#13;\n<pre style="">删除一个错误的数据表中的信息</pre>&#13;\n<p></p>&#13;\n<p></p>&#13;\n<pre name="code" class="php">$dbms='mysql';//数据库类型\n$dbName='admin';//使用的数据库\n$user='root';//数据库连接用户名\n$pwd='password';//数据库连接密码\n$host='localhost';//数据库主机名\n$dsn="$dbms:host=$host;port=3306;dbname=$dbName";\ntry {\n$pdo = new PDO($dsn, $user, $pwd);//初始化一个PDO对象，就是创建了数据库连接对象$pdo\n$pdo-&gt;setAttribute(PDO::ATTR_ERRMODE, PDO::ERRMODE_EXCEPTION);//设置异常模式\n$query = "delete from userrr where id=1";//需要执行的sql语句\n$res = $pdo-&gt;prepare($query);//准备删除语句\n$res-&gt;execute();\n}catch(PDOException $e){\necho 'PDO Exception Caught: ';\necho "Error with the database:&lt;br&gt;";\necho 'SQL Query:'.$query;\necho '&lt;pre&gt;';\necho "ERROR:".$e-&gt;getMessage().'&lt;br&gt;';\necho "Code:".$e-&gt;getCode().'&lt;br&gt;';\necho "File:".$e-&gt;getFile().'&lt;br&gt;';\necho "Line:".$e-&gt;getLine().'&lt;br&gt;';\necho "Trace:".$e-&gt;getTraceAsString().'&lt;br&gt;';\necho '&lt;/pre&gt;';\n}</pre><br />&#13;\n<p></p>&#13;\n<pre style="">运行结果：</pre>&#13;\n<pre style="">PDO Exception Caught: Error with the database:<br style="background-color:inherit" />SQL Query:delete from userrr where id=1<pre style="font-family:Monaco,Consolas,Courier,'Lucida Console',monospace; font-style:normal; background-color:inherit">ERROR:SQLSTATE[42S02]: Base table or view not found: 1146 Table 'admin.userrr' doesn't exist<br style="background-color:inherit" />Code:42S02<br style="background-color:inherit" />File:D:\\wampserver\\www\\test\\test\\index1.php<br style="background-color:inherit" />Line:14<br style="background-color:inherit" />Trace:#0 D:\\wampserver\\www\\test\\test\\index1.php(14): PDOStatement-&gt;execute()\n#1 {main}</pre></pre>&#13;\n<br />&#13;\n<p></p>&#13;\n<p><br />&#13;\n</p>&#13;\n<p><br />&#13;\n</p>&#13;\n<p><br />&#13;\n</p>&#13;\n &#13;\n
