\n<p>重启了一下服务器，启动后就报以下错误了：</p><p>Starting MySQL...The server quit without updating PID file [失败]lib/mysql/localhost.localdomain.pid).</p><p>纠结了很久没找到解决办法，后来突然想到修改了mysql的配置文件“/usr/my.cnf”</p><p>之前配置默认编码，在配置文件中添加了“<code class="sql keyword" style="line-height: 15.399999618530273px; font-size: 14px; white-space: pre; border-top-left-radius: 0px !important; border-top-right-radius: 0px !important; border-bottom-right-radius: 0px !important; border-bottom-left-radius: 0px !important; border: 0px !important; bottom: auto !important; float: none !important; height: auto !important; left: auto !important; margin: 0px !important; outline: 0px !important; overflow: visible !important; padding: 0px !important; position: static !important; right: auto !important; top: auto !important; vertical-align: baseline !important; width: auto !important; box-sizing: content-box !important; font-family: Consolas, 'Bitstream Vera Sans Mono', 'Courier New', Courier, monospace !important; font-weight: bold !important; min-height: inherit !important; color: rgb(0, 102, 153) !important; background: none !important;">default</code><code class="sql plain" style="line-height: 15.399999618530273px; font-size: 14px; white-space: pre; border-top-left-radius: 0px !important; border-top-right-radius: 0px !important; border-bottom-right-radius: 0px !important; border-bottom-left-radius: 0px !important; border: 0px !important; bottom: auto !important; float: none !important; height: auto !important; left: auto !important; margin: 0px !important; outline: 0px !important; overflow: visible !important; padding: 0px !important; position: static !important; right: auto !important; top: auto !important; vertical-align: baseline !important; width: auto !important; box-sizing: content-box !important; font-family: Consolas, 'Bitstream Vera Sans Mono', 'Courier New', Courier, monospace !important; min-height: inherit !important; background: none !important;">-</code><code class="sql keyword" style="line-height: 15.399999618530273px; font-size: 14px; white-space: pre; border-top-left-radius: 0px !important; border-top-right-radius: 0px !important; border-bottom-right-radius: 0px !important; border-bottom-left-radius: 0px !important; border: 0px !important; bottom: auto !important; float: none !important; height: auto !important; left: auto !important; margin: 0px !important; outline: 0px !important; overflow: visible !important; padding: 0px !important; position: static !important; right: auto !important; top: auto !important; vertical-align: baseline !important; width: auto !important; box-sizing: content-box !important; font-family: Consolas, 'Bitstream Vera Sans Mono', 'Courier New', Courier, monospace !important; font-weight: bold !important; min-height: inherit !important; color: rgb(0, 102, 153) !important; background: none !important;">character</code><code class="sql plain" style="line-height: 15.399999618530273px; font-size: 14px; white-space: pre; border-top-left-radius: 0px !important; border-top-right-radius: 0px !important; border-bottom-right-radius: 0px !important; border-bottom-left-radius: 0px !important; border: 0px !important; bottom: auto !important; float: none !important; height: auto !important; left: auto !important; margin: 0px !important; outline: 0px !important; overflow: visible !important; padding: 0px !important; position: static !important; right: auto !important; top: auto !important; vertical-align: baseline !important; width: auto !important; box-sizing: content-box !important; font-family: Consolas, 'Bitstream Vera Sans Mono', 'Courier New', Courier, monospace !important; min-height: inherit !important; background: none !important;">-</code><code class="sql keyword" style="line-height: 15.399999618530273px; font-size: 14px; white-space: pre; border-top-left-radius: 0px !important; border-top-right-radius: 0px !important; border-bottom-right-radius: 0px !important; border-bottom-left-radius: 0px !important; border: 0px !important; bottom: auto !important; float: none !important; height: auto !important; left: auto !important; margin: 0px !important; outline: 0px !important; overflow: visible !important; padding: 0px !important; position: static !important; right: auto !important; top: auto !important; vertical-align: baseline !important; width: auto !important; box-sizing: content-box !important; font-family: Consolas, 'Bitstream Vera Sans Mono', 'Courier New', Courier, monospace !important; font-weight: bold !important; min-height: inherit !important; color: rgb(0, 102, 153) !important; background: none !important;">set</code><code class="sql plain" style="line-height: 15.399999618530273px; font-size: 14px; white-space: pre; border-top-left-radius: 0px !important; border-top-right-radius: 0px !important; border-bottom-right-radius: 0px !important; border-bottom-left-radius: 0px !important; border: 0px !important; bottom: auto !important; float: none !important; height: auto !important; left: auto !important; margin: 0px !important; outline: 0px !important; overflow: visible !important; padding: 0px !important; position: static !important; right: auto !important; top: auto !important; vertical-align: baseline !important; width: auto !important; box-sizing: content-box !important; font-family: Consolas, 'Bitstream Vera Sans Mono', 'Courier New', Courier, monospace !important; min-height: inherit !important; background: none !important;">=utf8</code>”</p><p><img src="http://img.blog.csdn.net/20140905131626181?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvdGVzdGNzX2Ru/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast" alt="" /><br /></p><p>把这一句删除了，再启动mysql就好了。</p><p><br /></p><p>在解决这个问题过程中找到的比较好的资料，这里收藏一下：</p><p></p><p style="margin-top: 0px; margin-bottom: 0px; padding-top: 0px; padding-bottom: 0px; font-family: Arial; font-size: 14px; line-height: 26px;"><strong>问题起因：</strong><br />今天做了一件事情：我在VM 上将一数据库的数据文件（/var/lib/mysql整个文件夹）拷贝到另外一台VM上，然后新的VM 上启动MYSQL，结果报如下异常：<br /><span style="background-color: rgb(204, 255, 255);"><span style="white-space: pre;"></span>[root@localhost mysql]# service mysql start<br /><span style="white-space: pre;"></span>Starting MySQL.. ERROR! The server quit without updating PID file (/var/lib/mysql/localhost.localdomain.pid).</span><br />于是Google之，大部分的答案都是：<br /><span style="background-color: rgb(204, 255, 255);"><span style="white-space: pre;"></span>1. 注释/etc/my.cnf里的skip-federated注释掉即#skip-federated；<br /><span style="white-space: pre;"></span>2. my.cnf文件配置过高，重新定义其中的参数（根据服务器情况定义）；<br /><span style="white-space: pre;"></span>3. 杀掉mysql_safe和mysqld进程，然后再重启；<br /><span style="white-space: pre;"></span>4. 当前日志文件过大，超出了my.cnf中定义的大小（默认为64M），删除日志文件再重启；<br /></span></p><p style="margin-top: 0px; margin-bottom: 0px; padding-top: 0px; padding-bottom: 0px; font-family: Arial; font-size: 14px; line-height: 26px;"><span style="background-color: rgb(204, 255, 255);"><span style="white-space: pre;"></span>5. 其他情况，查看日志文件（我的是localhost.localdomain.err，具体因人而异），然后具体分析；</span></p><p style="margin-top: 0px; margin-bottom: 0px; padding-top: 0px; padding-bottom: 0px; font-family: Arial; font-size: 14px; line-height: 26px;"><br /></p><p style="margin-top: 0px; margin-bottom: 0px; padding-top: 0px; padding-bottom: 0px; font-family: Arial; font-size: 14px; line-height: 26px;"><strong>问题解决：</strong></p><p style="margin-top: 0px; margin-bottom: 0px; padding-top: 0px; padding-bottom: 0px; font-family: Arial; font-size: 14px; line-height: 26px;">其中，我查看了日志内容，如下：</p><p style="margin-top: 0px; margin-bottom: 0px; padding-top: 0px; padding-bottom: 0px; font-family: Arial; font-size: 14px; line-height: 26px;"><span style="background-color: rgb(204, 255, 255);">[root@localhost mysql]# less localhost.localdomain.err <br />111203 22:09:03 mysqld_safe Starting mysqld daemon with databases from /var/lib/mysql<br />^G/usr/sbin/mysqld: File './mysql-bin.index' not found (Errcode: 13)<br />111203 22:09:03 [ERROR] Aborting<br /><br />111203 22:09:03 [Note] /usr/sbin/mysqld: Shutdown complete<br /><br />111203 22:09:03 mysqld_safe mysqld from pid file /var/lib/mysql/localhost.localdomain.pid ended</span><br /></p><p style="margin-top: 0px; margin-bottom: 0px; padding-top: 0px; padding-bottom: 0px; font-family: Arial; font-size: 14px; line-height: 26px;"><br /></p><p style="margin-top: 0px; margin-bottom: 0px; padding-top: 0px; padding-bottom: 0px; font-family: Arial; font-size: 14px; line-height: 26px;">但是我查看了我的目录文件，mysql-bin.index文件是存在的呀，奇怪：</p><p style="margin-top: 0px; margin-bottom: 0px; padding-top: 0px; padding-bottom: 0px; font-family: Arial; font-size: 14px; line-height: 26px;"><span style="background-color: rgb(204, 255, 255);">[root@localhost mysql]# ll<br />total 49828<br />-rw-rw----. 1 mysql mysql 35651584 Dec  3 17:55 ibdata1<br />-rw-rw----. 1 mysql mysql  5242880 Dec  3 17:55 ib_logfile0<br />-rw-rw----. 1 mysql mysql  5242880 Dec  3 15:45 ib_logfile1<br />-rw-rw----. 1 mysql root      1376 Dec  3 22:02 localhost.localdomain.err<br />drwx--x--x. 2 mysql mysql     4096 Dec  3 17:55 mysql<br />-rw-rw----. 1 mysql mysql  4847020 Dec  3 17:55 mysql-bin.000001<br />-rw-rw----. 1 mysql mysql     1373 Dec  3 17:56 mysql-bin.000002<br /><strong>-rw-r--r--. 1 root  root        19 Dec  3 15:38 mysql-bin.index</strong><br />drwx------. 2 mysql mysql     4096 Dec  3 17:55 performance_schema<br />-rw-r--r--. 1 root  root       116 Nov 25 21:03 RPM_UPGRADE_HISTORY<br />-rw-r--r--. 1 mysql mysql      116 Nov 25 21:03 RPM_UPGRADE_MARKER-LAST<br />drwxr-xr-x. 2 mysql mysql     4096 Dec  3 17:55 test</span><br /></p><p style="margin-top: 0px; margin-bottom: 0px; padding-top: 0px; padding-bottom: 0px; font-family: Arial; font-size: 14px; line-height: 26px;">仔细看了下，咦？<span style="background-color: rgb(204, 255, 255);"><strong>-rw-r--r--. 1 root  root        19 Dec  3 15:38 mysql-bin.index</strong></span>----难道是权限不够？于是将该文件加了写权限，重启，涛声依旧！！！噢噢！</p><p style="margin-top: 0px; margin-bottom: 0px; padding-top: 0px; padding-bottom: 0px; font-family: Arial; font-size: 14px; line-height: 26px;"><br /></p><p style="margin-top: 0px; margin-bottom: 0px; padding-top: 0px; padding-bottom: 0px; font-family: Arial; font-size: 14px; line-height: 26px;">难道是编码问题？难道是....继续猜测。。。问题还是没解决，后来我做了一件事情，将mysql-bin.index文件删除掉！重启！！OH！No！！</p><p style="margin-top: 0px; margin-bottom: 0px; padding-top: 0px; padding-bottom: 0px; font-family: Arial; font-size: 14px; line-height: 26px;"><span style="background-color: rgb(204, 255, 255);">[root@localhost mysql]# rm -rf mysql-bin.index <br />[root@localhost mysql]#  <br />[root@localhost mysql]# service mysql start<br />Starting MySQL... SUCCESS! </span><br /></p><p style="margin-top: 0px; margin-bottom: 0px; padding-top: 0px; padding-bottom: 0px; font-family: Arial; font-size: 14px; line-height: 26px;"><br /></p><p style="margin-top: 0px; margin-bottom: 0px; padding-top: 0px; padding-bottom: 0px; font-family: Arial; font-size: 14px; line-height: 26px;">就这样？？为什么呢？至今这个仍然是未解之谜（对我来说），如有知情者请告知：）</p><p style="margin-top: 0px; margin-bottom: 0px; padding-top: 0px; padding-bottom: 0px; font-family: Arial; font-size: 14px; line-height: 26px;"><br /></p><p style="margin-top: 0px; margin-bottom: 0px; padding-top: 0px; padding-bottom: 0px; font-family: Arial; font-size: 14px; line-height: 26px;"><strong><span style="color: rgb(255, 0, 0);">补充：</span></strong></p><p style="margin-top: 0px; margin-bottom: 0px; padding-top: 0px; padding-bottom: 0px; font-family: Arial; font-size: 14px; line-height: 26px;">很多时候，我们在做主从同步的时候，将数据库目录整体打包拷贝到从机上的时候，重启也往往会出现类似的问题，解决方法仍然是：</p><p style="margin-top: 0px; margin-bottom: 0px; padding-top: 0px; padding-bottom: 0px; font-family: Arial; font-size: 14px; line-height: 26px;">1）给MYSQL数据库数据目录权限：chown -R mysql:mysql 目录名称</p><p style="margin-top: 0px; margin-bottom: 0px; padding-top: 0px; padding-bottom: 0px; font-family: Arial; font-size: 14px; line-height: 26px;">2）务必保证MYSQL的进程是已经关闭了的；</p><p style="margin-top: 0px; margin-bottom: 0px; padding-top: 0px; padding-bottom: 0px; font-family: Arial; font-size: 14px; line-height: 26px;"><br /></p><p style="margin-top: 0px; margin-bottom: 0px; padding-top: 0px; padding-bottom: 0px; font-family: Arial; font-size: 14px; line-height: 26px;">另外要注意的地方就是：ib_*, mysql-bin-*, *.err(log文件)以及master-info和relay-info文件都是可以删除的，相当于重新初始化数据库的数据，但是前提是：</p><p style="margin-top: 0px; margin-bottom: 0px; padding-top: 0px; padding-bottom: 0px; font-family: Arial; font-size: 14px; line-height: 26px;">1）操作前要先关掉MYSQL的进程；</p><p style="margin-top: 0px; margin-bottom: 0px; padding-top: 0px; padding-bottom: 0px; font-family: Arial; font-size: 14px; line-height: 26px;">2）删掉文件后要重新启动MYSQL，如果有异常，请自行查看日志找问题，一般都比较好定位和解决。</p><br /> &#13;\n
