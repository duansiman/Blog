\n\n<a target="_blank" class="postTitle2" id="cb_post_title_url" href="http://www.cnblogs.com/wenanry/archive/2010/05/18/1737939.html"></a>&#13;\n<p><strong><span style="color:#ff0000">MYSQL的备份有多少种，请简要的描述：<br />&#13;\n</span></strong>数据库分逻辑备份\\物理备份<br />&#13;\n物理备份又分冷备和热备</p>&#13;\n<p>A.直接拷贝数据文件到安全地方进行保存<br />&#13;\nB.使用MYSQLHOSTCOPY备分数据<br />&#13;\nC.使用MYSQLDUMP备份数据<br />&#13;\nD.使用MYSQL的同步复制，实现数据实时数据同步备份</p>&#13;\n<p>常用的逻辑备份主要就是两种：一种是将数据生成为可以完全重现当前数据库中的数据的insert语句，另一种是将数据通过逻辑备份软件，将数据库表的数据以特定分隔符进行分割后记录在文本中。</p>&#13;\n<p>对于第一种生成insert语句来说我们可以直接使用mysql自带的工具mysqldump来完成。这种方式不好之处在于可能导致数据的不一致，或是不完整。解决办法：一个是通过在数据库系统中加入写入锁，只提供数据库的查询服务；第二种是对于支持事务的存储引擎来说，INNODB BDB可以通过将整个备份过程控制在一个事务中，来达到备份数据的一致性和完整性；并且可以不用影响到数据库的正常运行。<br />&#13;\n恢复方式则是通过mysql&lt;backup.sql直接运行的。<br />&#13;\n第二种直接生成数据格式。占用的空间小，数据格式清晰。可是没有数据库结构的脚本。不容易控制<br />&#13;\n实现方式：通过select******* to outfile from***命令来实现。恢复方式就是通过，load data infile和mysqlimport命令来做。</p>&#13;\n<p>这一过程相当的复杂需要实时的进行恢复测试，保证备份数据是可用的<br />&#13;\n数据库的物理备份，主要的对象是数据库的物理数据文件，日志文件以及配置文件等。<br />&#13;\n</p>&#13;\n<div>物理数据文件有哪些呢？<br />&#13;\n</div>&#13;\n<div>一是<span style="color:rgb(0,255,0)">日志文件</span>6大类：<span style="color:rgb(255,0,0)">错误日志error Log、二进制日志binary Log、更新日志 update log、查询日志 query log、慢查询日志 slow query log、innodb的redo日志。</span></div>&#13;\n<div style="font-size:14px; font-family:Simsun">二是<span style="color:rgb(0,255,0)">数据文件</span>？对于myisam来说的话，.frm表结构信息.myd数据信息.myi数据的索引信息。对于Innodb来说的<span style="color:rgb(255,0,0)">话.ibd文件（独享表空间）和.ibdata（共享表空间）文件</span>。</div>&#13;\n<div>三是<span style="color:rgb(0,255,0)">replication文件</span>？master.info存储在slave端的数据目录下，存放了slave和master的相关信息，relay log和 relay log index主要存储了I/O进程从Master端读取到的binary log信息，然后由slave端的SQL线程从该binary log中读取解析过的日志信息，转化成master所能执行的query语句。index则是存放binarylog的路径也就是目录文件。</div>&#13;\n<div class="postBody">&#13;\n<div id="cnblogs_post_body">&#13;\n<p><br />&#13;\n</p>&#13;\n<p><br />&#13;\n</p>&#13;\n<p></p>&#13;\n<div style="font-size:14px; font-family:Simsun">四是<span style="color:rgb(0,255,0)">系统文件</span>？如my.cnf、pid文件是mysqld应用程序中的一个进程文件存放自己的进程id还有就是socket文件它只有在linux下才有的，可以不通过tcp/ip网络协议直接连接mysql</div>&#13;\n<div><br clear="none" />&#13;\n</div>&#13;\n<div>如果是做冷备的话，直接复制所有的数据文件和日志文件到备份集存放的地方，</div>&#13;\n<div><br clear="none" />&#13;\n</div>&#13;\n<div><strong>热备的方法针对不多的数据库有不同的方案</strong></div>&#13;\n<div>对于myisam存储引擎来说，做法就是给数据库表加锁来阻止写操作，可以直接复制物理文件，或者也可以通过mysql专门的mysqlhotcopy（原理就是现锁住表，然后进行操作）程序来完成相应的备份任务。</div>&#13;\n<div><span style="color:rgb(255,0,0)">flush tables with read lock</span></div>&#13;\n<div>cp -R test /tmp/backup/test</div>&#13;\n<div>unlock tables;</div>&#13;\n<div><br clear="none" />&#13;\n</div>&#13;\n<div>innodb数据库引擎来说，有一款商业软件ibbackup，在线物理备份功能。还有一款开源的工具xtrabackup，</div>&#13;\n<div>如果在备份过程中，把INNODB数据文件备份完成后，会锁住整个库，并开始复制MYISAM等非事务引擎的数据和.frm；所以如果你拥有比较多的MYISAM表，锁库的时候会持续很长。如果是在主库上运行，千万注意。</div>&#13;\n<div><br clear="none" />&#13;\n</div>&#13;\n<div><span style="color:rgb(255,0,0)">同样也只能通过xtrabackup进行增量的备份，其实这一工具只是备份innobd的日志信息。</span></div>&#13;\n<p></p>&#13;\n<p><span style="color:#0000ff">4 xtrabackup/ibbackup<br />&#13;\n</span>xtrabackup --backup --datadir=/var/lib/mysql/ --target-<br />&#13;\ndir=/data/backups/mysql/</p>&#13;\n<p>xtrabackup --backup  --defaults-file=/etc/my.cnf --target-<br />&#13;\ndir=/data/backups/mysql/<br />&#13;\nmysql的备份方式<br />&#13;\n<br />&#13;\n<strong>1.mysqldump<br />&#13;\n</strong>效率比较低，备份和还原的速度都很慢,任何数据插入和更新操作都会被挂起<br />&#13;\n<br />&#13;\n<strong>2.mysqlhotcopy<br />&#13;\n</strong>mysqlhotcopy 是专门针对myisam 数据表进行备份,备份的过程中，任何数据插入和更新操作都会被挂起<br />&#13;\n<br />&#13;\n<strong>3.准备一台从服务器,专门做备份（master-slave方式）<br />&#13;\n<br />&#13;\n4.xtrabackup 是 percona 的一个开源项目，可热备份innodb ,XtraDB,MyISAM(会锁表)<br />&#13;\n</strong> <br />&#13;\nXtrabackup有两个主要的工具：xtrabackup、innobackupex<br />&#13;\nxtrabackup只能备份InnoDB和XtraDB两种数据表，而不能备份MyISAM数据表<br />&#13;\ninnobackupex-1.5.1则封装了xtrabackup，是一个脚本封装，所以能同时备份处理innodb和myisam，但在处理myisam时需要加一个读锁<br />&#13;\n</p>&#13;\n<br />&#13;\n<p></p>&#13;\n<p>Øxtra备份原理<br />&#13;\n记住开始时候的LSN号，然后开始拷备文件，同时运<br />&#13;\n行一个后台进程监视重做日志，并将变化拷备下来到<br />&#13;\nxtrabackup_logfile。</p>&#13;\n<p>innobackupex可以备份myisam表和frm文件。当<br />&#13;\nxtrabackup结束后，执行flush tables with read lock，避<br />&#13;\n免数据更改，然后刷新所有myisam表到磁盘。拷备结<br />&#13;\n束后，释放锁。</p>&#13;\n<p>mysqlbinlog也是一个恢复工具，是基于时间点来处理二进制文件的</p>&#13;\n<p><strong>Ø备份：直接拷备</strong></p>&#13;\n<p><strong>Ø还原：<br />&#13;\n</strong>ü时间点还原：mysqlbinlog --stop-date="2005-04-20 9:59:59"<br />&#13;\n/var/log/mysql/bin.123456 | mysql -u root –pmypwd</p>&#13;\n<p>mysqlbinlog --start-date="2005-04-20 10:01:00"<br />&#13;\n/var/log/mysql/bin.123456| mysql -u root –pmypwd</p>&#13;\n<p><strong>Ø日志点还原：<br />&#13;\n</strong>mysqlbinlog --stop-position="368312" /var/log/mysql/bin.123456 \\<br />&#13;\n| mysql -u root -pmypwd<br />&#13;\nmysqlbinlog --start-position="368315" /var/log/mysql/bin.123456 \\<br />&#13;\n| mysql -u root -pmypwd \\</p>&#13;\n<p>LVM是 Logical Volume Manager（逻辑卷管理）的简写，它是Linux环境下对磁盘分区进行管理的一种机制。<br />&#13;\nLSN定义：</p>&#13;\n<p><strong><span style="color:#ff0000">日志序号<br />&#13;\n</span></strong>日志序号 (LSN) 标识特定日志文件记录在日志文件中的位置。 </p>&#13;\n<p>LSN 由 DB2® 产品中的许多组件用来维护数据库一致性和完整性。除其他作用外，LSN 还对于分区数据库环境中的落实和回滚操作、崩溃和前滚恢复以及数据库操作同步起非常重要的作用。&#13;\n</p>&#13;\n<p>日志文件中 LSN 的增长率与数据库活动直接相关联。也就是说，随着事务发生并且条目被写入日志文件，LSN 会不断增大。数据库中的活动越多，LSN 增长得越快。&#13;\n</p>&#13;\n<p>日志序号的上限 </p>&#13;\n<p>在 DB2 V9.5 和较早版本中，日志序号 (LSN) 是 6 字节数字。从 FP3 开始，LSN 的范围在 0x0000 0000 0000（首次创建数据库时）到 0xFFFF 0000 0000（约 256 太字节）之间。在 FP3 之前，上限为 0xFFFF FFFF FFFF。随着记录被添加到日志文件中，LSN 在数据库生命期不断增长。</p>&#13;\n<p></p>&#13;\n<div id="art_xg">&#13;\n<h4><br />&#13;\n</h4>&#13;\n<ul>&#13;\n<li>&#13;\n<ul>&#13;\n<li><a target="_blank" title="MySQL数据库备份与恢复方法" href="http://www.jb51.net/article/25686.htm">MySQL数据库备份与恢复方法</a></li><li><a target="_blank" title="解析Mysql备份与恢复简单总结与tee命令的使用介绍" href="http://www.jb51.net/article/38926.htm">解析Mysql备份与恢复简单总结与tee命令的使用介绍</a></li><li><a target="_blank" title="MySQL备份与恢复之冷备（1）" href="http://www.jb51.net/article/70960.htm">MySQL备份与恢复之冷备（1）</a></li><li><a target="_blank" title="MySQL备份与恢复之真实环境使用冷备（2）" href="http://www.jb51.net/article/70964.htm">MySQL备份与恢复之真实环境使用冷备（2）</a></li><li><a target="_blank" title="MySQL备份与恢复之热备（3）" href="http://www.jb51.net/article/70967.htm">MySQL备份与恢复之热备（3）</a></li><li><a target="_blank" title="MySQL备份与恢复之热拷贝（4）" href="http://www.jb51.net/article/70972.htm">MySQL备份与恢复之热拷贝（4）</a></li><li><a target="_blank" title="MySQL备份与恢复之保证数据一致性(5)" href="http://www.jb51.net/article/71074.htm">MySQL备份与恢复之保证数据一致性(5)</a></li></ul>&#13;\n<br />&#13;\n</li></ul>&#13;\n</div>&#13;\n<br />&#13;\n<p></p>&#13;\n<div class="cnblogs_code"></div>&#13;\n</div>&#13;\n</div>&#13;\n &#13;\n
